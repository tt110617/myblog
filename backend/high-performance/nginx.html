<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.49" />
    <meta name="theme" content="VuePress Theme Hope" />
    <title>Nginx | tt110617</title><meta name="description" content="ç½‘ç«™">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/myblog/assets/style.f2a6604f.css">
    <link rel="modulepreload" href="/myblog/assets/app.6a2d513d.js"><link rel="modulepreload" href="/myblog/assets/nginx.html.96457f50.js"><link rel="modulepreload" href="/myblog/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/myblog/assets/nginx.html.feb27b40.js"><link rel="prefetch" href="/myblog/assets/index.html.d1ca62f7.js"><link rel="prefetch" href="/myblog/assets/index.html.b5c38db1.js"><link rel="prefetch" href="/myblog/assets/index.html.feb38b0c.js"><link rel="prefetch" href="/myblog/assets/algorithm01.html.dd1af2b2.js"><link rel="prefetch" href="/myblog/assets/algorithm02.html.6645e291.js"><link rel="prefetch" href="/myblog/assets/algorithm03.html.9da54164.js"><link rel="prefetch" href="/myblog/assets/LeetCode Hot 100.html.95af3c37.js"><link rel="prefetch" href="/myblog/assets/index.html.2770fb04.js"><link rel="prefetch" href="/myblog/assets/index.html.9f31cb98.js"><link rel="prefetch" href="/myblog/assets/MongoDB.html.747bd522.js"><link rel="prefetch" href="/myblog/assets/index.html.7970fd4d.js"><link rel="prefetch" href="/myblog/assets/index.html.d76d8eeb.js"><link rel="prefetch" href="/myblog/assets/Docker.html.7e9153cc.js"><link rel="prefetch" href="/myblog/assets/ElasticSearch.html.68bc187d.js"><link rel="prefetch" href="/myblog/assets/index.html.c88cf0a5.js"><link rel="prefetch" href="/myblog/assets/java8æ–°ç‰¹æ€§.html.eba77086.js"><link rel="prefetch" href="/myblog/assets/index.html.db442bd7.js"><link rel="prefetch" href="/myblog/assets/index.html.e978b3f4.js"><link rel="prefetch" href="/myblog/assets/vue2.html.cd054f5f.js"><link rel="prefetch" href="/myblog/assets/vue3.html.09644e9e.js"><link rel="prefetch" href="/myblog/assets/mysql01.html.14852074.js"><link rel="prefetch" href="/myblog/assets/mysql02.html.19638d4a.js"><link rel="prefetch" href="/myblog/assets/mysql03.html.19940ab5.js"><link rel="prefetch" href="/myblog/assets/mysql04.html.ff20e708.js"><link rel="prefetch" href="/myblog/assets/index.html.aeaeabce.js"><link rel="prefetch" href="/myblog/assets/mianshi.html.5de27bef.js"><link rel="prefetch" href="/myblog/assets/network01.html.d374f53e.js"><link rel="prefetch" href="/myblog/assets/network02.html.612f1790.js"><link rel="prefetch" href="/myblog/assets/network03.html.f409d6e1.js"><link rel="prefetch" href="/myblog/assets/network04.html.417995ce.js"><link rel="prefetch" href="/myblog/assets/network05.html.383f02d3.js"><link rel="prefetch" href="/myblog/assets/network06.html.6b7b74f3.js"><link rel="prefetch" href="/myblog/assets/index.html.a5289baa.js"><link rel="prefetch" href="/myblog/assets/index.html.1ad05321.js"><link rel="prefetch" href="/myblog/assets/Redis01.html.43cb742a.js"><link rel="prefetch" href="/myblog/assets/Redis02.html.ba0a875f.js"><link rel="prefetch" href="/myblog/assets/Redis03.html.c65b1aff.js"><link rel="prefetch" href="/myblog/assets/Redis04.html.8d20d57a.js"><link rel="prefetch" href="/myblog/assets/Redis05.html.66a2065a.js"><link rel="prefetch" href="/myblog/assets/RedissonåŸç†.html.e587d689.js"><link rel="prefetch" href="/myblog/assets/basics.html.ec7af011.js"><link rel="prefetch" href="/myblog/assets/practice.html.3d6fcedb.js"><link rel="prefetch" href="/myblog/assets/index.html.195983d3.js"><link rel="prefetch" href="/myblog/assets/index.html.ffce25e3.js"><link rel="prefetch" href="/myblog/assets/SpringBoot01.html.1539f2df.js"><link rel="prefetch" href="/myblog/assets/SpringBoot02.html.8d492936.js"><link rel="prefetch" href="/myblog/assets/Dubbo.html.25f8081d.js"><link rel="prefetch" href="/myblog/assets/index.html.25b97898.js"><link rel="prefetch" href="/myblog/assets/SpringCloud.html.11fa754a.js"><link rel="prefetch" href="/myblog/assets/SpringCloudAibaba.html.ba7822c1.js"><link rel="prefetch" href="/myblog/assets/mianshi.html.e3fba77d.js"><link rel="prefetch" href="/myblog/assets/RabbitMQ.html.d245b413.js"><link rel="prefetch" href="/myblog/assets/index.html.2e0e8a71.js"><link rel="prefetch" href="/myblog/assets/OAuth2.0.html.ec57b0c6.js"><link rel="prefetch" href="/myblog/assets/index.html.195b9b99.js"><link rel="prefetch" href="/myblog/assets/SpringSecurity.html.f53a3387.js"><link rel="prefetch" href="/myblog/assets/design01.html.a9ca0966.js"><link rel="prefetch" href="/myblog/assets/design02.html.14685d48.js"><link rel="prefetch" href="/myblog/assets/design03.html.d0742e22.js"><link rel="prefetch" href="/myblog/assets/design04.html.4b4d3a60.js"><link rel="prefetch" href="/myblog/assets/design05.html.dd009a09.js"><link rel="prefetch" href="/myblog/assets/index.html.de8a79d7.js"><link rel="prefetch" href="/myblog/assets/juc01.html.7b5b2a61.js"><link rel="prefetch" href="/myblog/assets/juc02.html.e7af61bf.js"><link rel="prefetch" href="/myblog/assets/juc03.html.c680cb04.js"><link rel="prefetch" href="/myblog/assets/index.html.3ef30b14.js"><link rel="prefetch" href="/myblog/assets/jvm01.html.226ff0ab.js"><link rel="prefetch" href="/myblog/assets/jvm02.html.ad530863.js"><link rel="prefetch" href="/myblog/assets/jvm03.html.af77ed0d.js"><link rel="prefetch" href="/myblog/assets/jvm04.html.dd845ccc.js"><link rel="prefetch" href="/myblog/assets/jvm05.html.56d56c94.js"><link rel="prefetch" href="/myblog/assets/jvm06.html.8c5c08ed.js"><link rel="prefetch" href="/myblog/assets/jvm07.html.8713dffe.js"><link rel="prefetch" href="/myblog/assets/jvm08.html.396f92cc.js"><link rel="prefetch" href="/myblog/assets/index.html.cacef81d.js"><link rel="prefetch" href="/myblog/assets/404.html.82bd4b1a.js"><link rel="prefetch" href="/myblog/assets/index.html.2f713335.js"><link rel="prefetch" href="/myblog/assets/index.html.1a811f74.js"><link rel="prefetch" href="/myblog/assets/index.html.79fe6d6e.js"><link rel="prefetch" href="/myblog/assets/index.html.dcd15e89.js"><link rel="prefetch" href="/myblog/assets/index.html.e8952663.js"><link rel="prefetch" href="/myblog/assets/index.html.5ad7ff00.js"><link rel="prefetch" href="/myblog/assets/index.html.92637d35.js"><link rel="prefetch" href="/myblog/assets/index.html.6033e64c.js"><link rel="prefetch" href="/myblog/assets/index.html.29a3be67.js"><link rel="prefetch" href="/myblog/assets/index.html.d2aef326.js"><link rel="prefetch" href="/myblog/assets/index.html.61fd0259.js"><link rel="prefetch" href="/myblog/assets/index.html.cf3e5974.js"><link rel="prefetch" href="/myblog/assets/index.html.b7fddec6.js"><link rel="prefetch" href="/myblog/assets/index.html.2d1c3407.js"><link rel="prefetch" href="/myblog/assets/index.html.f6e57d32.js"><link rel="prefetch" href="/myblog/assets/index.html.57cfa80f.js"><link rel="prefetch" href="/myblog/assets/index.html.5f4c6904.js"><link rel="prefetch" href="/myblog/assets/index.html.adc9fbf5.js"><link rel="prefetch" href="/myblog/assets/index.html.de6bf546.js"><link rel="prefetch" href="/myblog/assets/index.html.5802a134.js"><link rel="prefetch" href="/myblog/assets/index.html.00532d93.js"><link rel="prefetch" href="/myblog/assets/index.html.dcdb8b0c.js"><link rel="prefetch" href="/myblog/assets/index.html.64a2ffc8.js"><link rel="prefetch" href="/myblog/assets/index.html.aa56265b.js"><link rel="prefetch" href="/myblog/assets/index.html.cf5fc743.js"><link rel="prefetch" href="/myblog/assets/index.html.dd0debdd.js"><link rel="prefetch" href="/myblog/assets/index.html.598a85b3.js"><link rel="prefetch" href="/myblog/assets/algorithm01.html.9516ff71.js"><link rel="prefetch" href="/myblog/assets/algorithm02.html.f215eb2a.js"><link rel="prefetch" href="/myblog/assets/algorithm03.html.b981d3d4.js"><link rel="prefetch" href="/myblog/assets/LeetCode Hot 100.html.921fe2c8.js"><link rel="prefetch" href="/myblog/assets/index.html.9ff070dd.js"><link rel="prefetch" href="/myblog/assets/index.html.f985f07c.js"><link rel="prefetch" href="/myblog/assets/MongoDB.html.367811ae.js"><link rel="prefetch" href="/myblog/assets/index.html.ccc78fec.js"><link rel="prefetch" href="/myblog/assets/index.html.cd9c8951.js"><link rel="prefetch" href="/myblog/assets/Docker.html.9aa6750f.js"><link rel="prefetch" href="/myblog/assets/ElasticSearch.html.834de972.js"><link rel="prefetch" href="/myblog/assets/index.html.5f9750b5.js"><link rel="prefetch" href="/myblog/assets/java8æ–°ç‰¹æ€§.html.72523a0c.js"><link rel="prefetch" href="/myblog/assets/index.html.4267a9c7.js"><link rel="prefetch" href="/myblog/assets/index.html.64b7cc16.js"><link rel="prefetch" href="/myblog/assets/vue2.html.019d3a52.js"><link rel="prefetch" href="/myblog/assets/vue3.html.f014c692.js"><link rel="prefetch" href="/myblog/assets/mysql01.html.1f3c1d4e.js"><link rel="prefetch" href="/myblog/assets/mysql02.html.6085f62b.js"><link rel="prefetch" href="/myblog/assets/mysql03.html.a05b3e35.js"><link rel="prefetch" href="/myblog/assets/mysql04.html.f83e6c8a.js"><link rel="prefetch" href="/myblog/assets/index.html.c2377b6c.js"><link rel="prefetch" href="/myblog/assets/mianshi.html.62e502c2.js"><link rel="prefetch" href="/myblog/assets/network01.html.bb391280.js"><link rel="prefetch" href="/myblog/assets/network02.html.4835dc75.js"><link rel="prefetch" href="/myblog/assets/network03.html.529a44ea.js"><link rel="prefetch" href="/myblog/assets/network04.html.c4a9ab39.js"><link rel="prefetch" href="/myblog/assets/network05.html.fefe6411.js"><link rel="prefetch" href="/myblog/assets/network06.html.4098bbbd.js"><link rel="prefetch" href="/myblog/assets/index.html.9a37999d.js"><link rel="prefetch" href="/myblog/assets/index.html.25f73ada.js"><link rel="prefetch" href="/myblog/assets/Redis01.html.4774eebb.js"><link rel="prefetch" href="/myblog/assets/Redis02.html.7aa43754.js"><link rel="prefetch" href="/myblog/assets/Redis03.html.3b35817c.js"><link rel="prefetch" href="/myblog/assets/Redis04.html.1eb9f421.js"><link rel="prefetch" href="/myblog/assets/Redis05.html.445e2fb4.js"><link rel="prefetch" href="/myblog/assets/RedissonåŸç†.html.a6281fb0.js"><link rel="prefetch" href="/myblog/assets/basics.html.64ecf975.js"><link rel="prefetch" href="/myblog/assets/practice.html.9bd91dc4.js"><link rel="prefetch" href="/myblog/assets/index.html.45528417.js"><link rel="prefetch" href="/myblog/assets/index.html.2765f82f.js"><link rel="prefetch" href="/myblog/assets/SpringBoot01.html.5e31fcb7.js"><link rel="prefetch" href="/myblog/assets/SpringBoot02.html.bbddd314.js"><link rel="prefetch" href="/myblog/assets/Dubbo.html.ccbf57f9.js"><link rel="prefetch" href="/myblog/assets/index.html.534d4ae8.js"><link rel="prefetch" href="/myblog/assets/SpringCloud.html.eab22d83.js"><link rel="prefetch" href="/myblog/assets/SpringCloudAibaba.html.79284ee6.js"><link rel="prefetch" href="/myblog/assets/mianshi.html.da3eb94f.js"><link rel="prefetch" href="/myblog/assets/RabbitMQ.html.1224037c.js"><link rel="prefetch" href="/myblog/assets/index.html.668ad86c.js"><link rel="prefetch" href="/myblog/assets/OAuth2.0.html.aabd01a5.js"><link rel="prefetch" href="/myblog/assets/index.html.9cd27700.js"><link rel="prefetch" href="/myblog/assets/SpringSecurity.html.469ecc81.js"><link rel="prefetch" href="/myblog/assets/design01.html.2b9f9e86.js"><link rel="prefetch" href="/myblog/assets/design02.html.849b42b0.js"><link rel="prefetch" href="/myblog/assets/design03.html.e4be33cd.js"><link rel="prefetch" href="/myblog/assets/design04.html.bc31a0d9.js"><link rel="prefetch" href="/myblog/assets/design05.html.d5c35997.js"><link rel="prefetch" href="/myblog/assets/index.html.4a7a1688.js"><link rel="prefetch" href="/myblog/assets/juc01.html.5bb1f884.js"><link rel="prefetch" href="/myblog/assets/juc02.html.0ce510cd.js"><link rel="prefetch" href="/myblog/assets/juc03.html.e93fe7b6.js"><link rel="prefetch" href="/myblog/assets/index.html.b5425fa1.js"><link rel="prefetch" href="/myblog/assets/jvm01.html.f238e096.js"><link rel="prefetch" href="/myblog/assets/jvm02.html.a9498b0d.js"><link rel="prefetch" href="/myblog/assets/jvm03.html.460f2e71.js"><link rel="prefetch" href="/myblog/assets/jvm04.html.7205bd05.js"><link rel="prefetch" href="/myblog/assets/jvm05.html.edac738a.js"><link rel="prefetch" href="/myblog/assets/jvm06.html.91cbb3f0.js"><link rel="prefetch" href="/myblog/assets/jvm07.html.f40c12f1.js"><link rel="prefetch" href="/myblog/assets/jvm08.html.fb107a67.js"><link rel="prefetch" href="/myblog/assets/index.html.3ba3011a.js"><link rel="prefetch" href="/myblog/assets/404.html.1f196261.js"><link rel="prefetch" href="/myblog/assets/index.html.1375c5bc.js"><link rel="prefetch" href="/myblog/assets/index.html.90d1ac0c.js"><link rel="prefetch" href="/myblog/assets/index.html.4d12ff1c.js"><link rel="prefetch" href="/myblog/assets/index.html.8ddb93d5.js"><link rel="prefetch" href="/myblog/assets/index.html.dd098c61.js"><link rel="prefetch" href="/myblog/assets/index.html.cebf8dc1.js"><link rel="prefetch" href="/myblog/assets/index.html.5674ca1e.js"><link rel="prefetch" href="/myblog/assets/index.html.d2abca49.js"><link rel="prefetch" href="/myblog/assets/index.html.1351de8d.js"><link rel="prefetch" href="/myblog/assets/index.html.9de6b46c.js"><link rel="prefetch" href="/myblog/assets/index.html.611ec9ae.js"><link rel="prefetch" href="/myblog/assets/index.html.a02c1bed.js"><link rel="prefetch" href="/myblog/assets/index.html.eb87c7a9.js"><link rel="prefetch" href="/myblog/assets/index.html.33261d15.js"><link rel="prefetch" href="/myblog/assets/index.html.5589fc08.js"><link rel="prefetch" href="/myblog/assets/index.html.f989be9b.js"><link rel="prefetch" href="/myblog/assets/index.html.9f0a51f1.js"><link rel="prefetch" href="/myblog/assets/index.html.49bd673c.js"><link rel="prefetch" href="/myblog/assets/index.html.f1449990.js"><link rel="prefetch" href="/myblog/assets/index.html.b063a78e.js"><link rel="prefetch" href="/myblog/assets/index.html.3f40e5f3.js"><link rel="prefetch" href="/myblog/assets/index.html.56c44de1.js"><link rel="prefetch" href="/myblog/assets/index.html.f8a7efd0.js"><link rel="prefetch" href="/myblog/assets/index.html.c2db4fad.js"><link rel="prefetch" href="/myblog/assets/404.d0d6ec4e.js"><link rel="prefetch" href="/myblog/assets/Layout.4e3e5e78.js"><link rel="prefetch" href="/myblog/assets/Slide.81c38424.js"><link rel="prefetch" href="/myblog/assets/Blog.d28c723c.js"><link rel="prefetch" href="/myblog/assets/auto.264f6c8c.js"><link rel="prefetch" href="/myblog/assets/index.d8a59108.js"><link rel="prefetch" href="/myblog/assets/index.1842ee54.js"><link rel="prefetch" href="/myblog/assets/mermaid.esm.min.fac286bf.js"><link rel="prefetch" href="/myblog/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/myblog/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/myblog/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/myblog/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/myblog/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/myblog/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/myblog/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/myblog/assets/Playground.c4bd3c9e.js"><link rel="prefetch" href="/myblog/assets/photoswipe.esm.218074cd.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/myblog/" class="brand"><img class="logo" src="/myblog/avatar.jpg" alt="tt110617"><!----><span class="site-name hide-in-pad">tt110617</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/myblog/" class="nav-link" aria-label="é¦–é¡µ"><span class="icon iconfont icon-home"></span>é¦–é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/myblog/backend/" class="nav-link active" aria-label="åç«¯"><span class="icon iconfont icon-java"></span>åç«¯<!----></a></div><div class="nav-item hide-in-mobile"><a href="/myblog/frontend/" class="nav-link" aria-label="å‰ç«¯"><span class="icon iconfont icon-vue"></span>å‰ç«¯<!----></a></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/tt110617" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><form class="search-box" role="search"><input type="search" placeholder="æœç´¢" autocomplete="off" spellcheck="false" value><!----></form><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-java"></span><span class="title">Java</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><img class="icon" src="/myblog/icon/gaoxingneng.png"><span class="title">é«˜æ€§èƒ½</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a aria-current="page" href="/myblog/backend/high-performance/nginx.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Nginx"><span class="icon iconfont icon-nginx"></span>Nginx<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_0-é˜…è¯»é¡»çŸ¥" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="0.é˜…è¯»é¡»çŸ¥"><!---->0.é˜…è¯»é¡»çŸ¥<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_1-ä»‹ç»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.ä»‹ç»"><!---->1.ä»‹ç»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_2-å®‰è£…" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.å®‰è£…"><!---->2.å®‰è£…<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_3-åŸºæœ¬è¿è¡ŒåŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.åŸºæœ¬è¿è¡ŒåŸç†"><!---->3.åŸºæœ¬è¿è¡ŒåŸç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_4-nginxé…ç½®ä½¿ç”¨åœºæ™¯" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.Nginxé…ç½®ä½¿ç”¨åœºæ™¯"><!---->4.Nginxé…ç½®ä½¿ç”¨åœºæ™¯<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_4-1-nginxç›®å½•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.1 Nginxç›®å½•"><!---->4.1 Nginxç›®å½•<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_4-2-ç®€åŒ–ç‰ˆçš„nginx-conf" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.2 ç®€åŒ–ç‰ˆçš„nginx.conf"><!---->4.2 ç®€åŒ–ç‰ˆçš„nginx.conf<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_4-3-è™šæ‹Ÿä¸»æœº" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.3 è™šæ‹Ÿä¸»æœº"><!---->4.3 è™šæ‹Ÿä¸»æœº<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_5-åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡"><!---->5.åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_5-1-ç½‘å…³ã€ä»£ç†ä¸åå‘ä»£ç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.1 ç½‘å…³ã€ä»£ç†ä¸åå‘ä»£ç†"><!---->5.1 ç½‘å…³ã€ä»£ç†ä¸åå‘ä»£ç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_5-2-åå‘ä»£ç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.2 åå‘ä»£ç†"><!---->5.2 åå‘ä»£ç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_5-3-è´Ÿè½½å‡è¡¡ç­–ç•¥" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.3 è´Ÿè½½å‡è¡¡ç­–ç•¥"><!---->5.3 è´Ÿè½½å‡è¡¡ç­–ç•¥<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_5-4-åŠ¨é™åˆ†ç¦»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.4 åŠ¨é™åˆ†ç¦»"><!---->5.4 åŠ¨é™åˆ†ç¦»<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_5-5-urlé‡å†™" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.5 URLé‡å†™"><!---->5.5 URLé‡å†™<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_5-6-ç½‘å…³æœåŠ¡å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.6 ç½‘å…³æœåŠ¡å™¨"><!---->5.6 ç½‘å…³æœåŠ¡å™¨<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_6-é˜²ç›—é“¾" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="6.é˜²ç›—é“¾"><!---->6.é˜²ç›—é“¾<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_7-é«˜å¯ç”¨åœºæ™¯-keepalived" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="7.é«˜å¯ç”¨åœºæ™¯-keepalived"><!---->7.é«˜å¯ç”¨åœºæ™¯-keepalived<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_8-é…ç½®è¯ä¹¦" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.é…ç½®è¯ä¹¦"><!---->8.é…ç½®è¯ä¹¦<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_8-1-ä¸å®‰å…¨çš„httpåè®®" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.1 ä¸å®‰å…¨çš„httpåè®®"><!---->8.1 ä¸å®‰å…¨çš„httpåè®®<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_8-2-éå¯¹ç§°ç®—æ³•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="8.2 éå¯¹ç§°ç®—æ³•"><!---->8.2 éå¯¹ç§°ç®—æ³•<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/myblog/backend/high-performance/Docker.html" class="nav-link sidebar-link sidebar-page" aria-label="DockeråŸºç¡€ç¯‡"><img class="icon" src="/myblog/icon/docker.png">DockeråŸºç¡€ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/myblog/backend/high-performance/ElasticSearch.html" class="nav-link sidebar-link sidebar-page" aria-label="ElasticSearch"><span class="icon iconfont icon-search"></span>ElasticSearch<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><img class="icon" src="/myblog/icon/xiaoxiduilie.png"><span class="title">æ¶ˆæ¯é˜Ÿåˆ—</span><span class="arrow right"></span></button><!----></section><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-computer"></span><span class="title">è®¡ç®—æœºåŸºç¡€</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-frame"></span><span class="title">æ¡†æ¶</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><img class="icon" src="/myblog/icon/odbc-full.png"><span class="title">æ•°æ®åº“</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-snow"></span><span class="title">ç®—æ³•</span><span class="arrow right"></span></button><!----></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="icon iconfont icon-nginx"></span>Nginx</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down" localizeddate="2022å¹´8æœˆ16æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="/myblog/article/" target="_blank" rel="noopener noreferrer">åä¸€</a></span><span property="author" content="åä¸€"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022å¹´8æœˆ16æ—¥</span><meta property="datePublished" content="2022-08-16T00:00:00.000Z"></span><span class="category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down" localizeddate="2022å¹´8æœˆ16æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><ul class="categories-wrapper"><li class="category category4 clickable" role="navigation">Nginx</li><meta property="articleSection" content="Nginx"></ul></span><span aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down" localizeddate="2022å¹´8æœˆ16æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><ul class="tags-wrapper"><li class="tag tag6 clickable" role="navigation">é«˜æ€§èƒ½</li></ul><meta property="keywords" content="é«˜æ€§èƒ½"></span><span class="words-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="down" localizeddate="2022å¹´8æœˆ16æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 3885 å­—</span><meta property="wordCount" content="3885"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_0-é˜…è¯»é¡»çŸ¥" class="router-link-active router-link-exact-active toc-link level2">0.é˜…è¯»é¡»çŸ¥</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_1-ä»‹ç»" class="router-link-active router-link-exact-active toc-link level2">1.ä»‹ç»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_2-å®‰è£…" class="router-link-active router-link-exact-active toc-link level2">2.å®‰è£…</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_3-åŸºæœ¬è¿è¡ŒåŸç†" class="router-link-active router-link-exact-active toc-link level2">3.åŸºæœ¬è¿è¡ŒåŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_4-nginxé…ç½®ä½¿ç”¨åœºæ™¯" class="router-link-active router-link-exact-active toc-link level2">4.Nginxé…ç½®ä½¿ç”¨åœºæ™¯</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_4-1-nginxç›®å½•" class="router-link-active router-link-exact-active toc-link level3">4.1 Nginxç›®å½•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_4-2-ç®€åŒ–ç‰ˆçš„nginx-conf" class="router-link-active router-link-exact-active toc-link level3">4.2 ç®€åŒ–ç‰ˆçš„nginx.conf</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_4-3-è™šæ‹Ÿä¸»æœº" class="router-link-active router-link-exact-active toc-link level3">4.3 è™šæ‹Ÿä¸»æœº</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_5-åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" class="router-link-active router-link-exact-active toc-link level2">5.åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_5-1-ç½‘å…³ã€ä»£ç†ä¸åå‘ä»£ç†" class="router-link-active router-link-exact-active toc-link level3">5.1 ç½‘å…³ã€ä»£ç†ä¸åå‘ä»£ç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_5-2-åå‘ä»£ç†" class="router-link-active router-link-exact-active toc-link level3">5.2 åå‘ä»£ç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_5-3-è´Ÿè½½å‡è¡¡ç­–ç•¥" class="router-link-active router-link-exact-active toc-link level3">5.3 è´Ÿè½½å‡è¡¡ç­–ç•¥</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_5-4-åŠ¨é™åˆ†ç¦»" class="router-link-active router-link-exact-active toc-link level3">5.4 åŠ¨é™åˆ†ç¦»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_5-5-urlé‡å†™" class="router-link-active router-link-exact-active toc-link level3">5.5 URLé‡å†™</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_5-6-ç½‘å…³æœåŠ¡å™¨" class="router-link-active router-link-exact-active toc-link level3">5.6 ç½‘å…³æœåŠ¡å™¨</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_6-é˜²ç›—é“¾" class="router-link-active router-link-exact-active toc-link level2">6.é˜²ç›—é“¾</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_7-é«˜å¯ç”¨åœºæ™¯-keepalived" class="router-link-active router-link-exact-active toc-link level2">7.é«˜å¯ç”¨åœºæ™¯-keepalived</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_8-é…ç½®è¯ä¹¦" class="router-link-active router-link-exact-active toc-link level2">8.é…ç½®è¯ä¹¦</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_8-1-ä¸å®‰å…¨çš„httpåè®®" class="router-link-active router-link-exact-active toc-link level3">8.1 ä¸å®‰å…¨çš„httpåè®®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/nginx.html#_8-2-éå¯¹ç§°ç®—æ³•" class="router-link-active router-link-exact-active toc-link level3">8.2 éå¯¹ç§°ç®—æ³•</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="nginx" tabindex="-1"><a class="header-anchor" href="#nginx" aria-hidden="true">#</a> Nginx</h1><h2 id="_0-é˜…è¯»é¡»çŸ¥" tabindex="-1"><a class="header-anchor" href="#_0-é˜…è¯»é¡»çŸ¥" aria-hidden="true">#</a> 0.é˜…è¯»é¡»çŸ¥</h2><blockquote><p>æœ¬ç¬”è®°æ¥æºï¼š</p><ul><li>åšå®¢ï¼š<a href="https://heyingjiee.github.io/otherLanguage/Nginx%E5%AD%A6%E4%B9%A0.html#%E5%89%8D%E6%8F%90%E5%87%86%E5%A4%87" target="_blank" rel="noopener noreferrer">https://heyingjiee.github.io/otherLanguage/Nginxå­¦ä¹ .html#å‰æå‡†å¤‡<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>å°šç¡…è°· nginx è¯¾ä»¶</li><li>ä¸ªäººç¬”è®°ä»¥åŠä¿®æ”¹ by åä¸€</li></ul></blockquote><h2 id="_1-ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#_1-ä»‹ç»" aria-hidden="true">#</a> 1.ä»‹ç»</h2><ul><li><p>Nginxå¼€æºç‰ˆ <a href="http://nginx.org/en/" target="_blank" rel="noopener noreferrer">http://nginx.org/en/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>å®˜æ–¹åŸå§‹çš„Nginxç‰ˆæœ¬</p></li><li><p>Nginx pluså•†ä¸šç‰ˆ</p><p>å¼€ç®±å³ç”¨ï¼Œé›†æˆäº†å¤§é‡åŠŸèƒ½</p></li><li><p>Open Resty <a href="https://openresty.org/cn/" target="_blank" rel="noopener noreferrer">https://openresty.org/cn/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>OpenRestyæ˜¯ä¸€ä¸ªåŸºäº <strong>Nginxä¸ Lua çš„é«˜æ€§èƒ½ Web å¹³å°</strong>ï¼Œå…¶å†…éƒ¨é›†æˆäº†å¤§é‡ç²¾è‰¯çš„ Lua åº“ã€ç¬¬ä¸‰æ–¹æ¨¡å—ä»¥åŠå¤§å¤šæ•°çš„ä¾èµ–é¡¹ã€‚<strong>æ›´é€‚ç”¨äºéœ€è¦å¤§é‡äºŒæ¬¡å¼€å‘çš„åœºæ™¯ï¼Œæœ‰æå¼ºçš„æ‰©å±•æ€§</strong></p></li><li><p>Tengine <a href="https://tengine.taobao.org/" target="_blank" rel="noopener noreferrer">https://tengine.taobao.org/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>ç”±æ·˜å®ç½‘å‘èµ·çš„WebæœåŠ¡å™¨é¡¹ç›®ã€‚å®ƒåœ¨<a href="http://nginx.org/" target="_blank" rel="noopener noreferrer">Nginx (opens new window)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>çš„åŸºç¡€ä¸Šï¼Œé’ˆå¯¹å¤§è®¿é—®é‡ç½‘ç«™çš„éœ€æ±‚ï¼Œæ·»åŠ äº†å¾ˆå¤šé«˜çº§åŠŸèƒ½å’Œç‰¹æ€§ã€‚Tengineçš„æ€§èƒ½å’Œç¨³å®šæ€§å·²ç»åœ¨å¤§å‹çš„ç½‘ç«™å¦‚<a href="http://www.taobao.com/" target="_blank" rel="noopener noreferrer">æ·˜å®ç½‘ (opens new window)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œ<a href="http://www.tmall.com/" target="_blank" rel="noopener noreferrer">å¤©çŒ«å•†åŸ (opens new window)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ç­‰å¾—åˆ°äº†å¾ˆå¥½çš„æ£€éªŒã€‚ç›¸æ¯”äºOpen Restyï¼Œæ‰©å±•æ€§ä¸å¤Ÿå¼ºï¼Œä½†æ˜¯èƒ½å¤Ÿæ»¡è¶³ç»å¤šæ•°ä½¿ç”¨åœºæ™¯</p></li></ul><h2 id="_2-å®‰è£…" tabindex="-1"><a class="header-anchor" href="#_2-å®‰è£…" aria-hidden="true">#</a> 2.å®‰è£…</h2><p>è§£å‹NginxåŒ…ï¼Œå¹¶å®‰è£…</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">tar</span> -zxvf  nginx-1.21.6.tar.gz è§£å‹åˆ°å½“å‰ç›®å½•
<span class="token builtin class-name">cd</span> nginx-1.21.6 è¿›å…¥è§£å‹åçš„æ–‡ä»¶å¤¹
<span class="token function">ls</span> æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ï¼šauto     CHANGES.ru  configure  html     <span class="token function">man</span>     src CHANGES  conf        contrib    LICENSE  README
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®‰è£…ä¾èµ–åº“</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># å®‰è£…Cç¼–è¯‘å™¨</span>
yum <span class="token function">install</span> -y gcc

<span class="token comment"># å®‰è£…pcreåº“</span>
yum <span class="token function">install</span> -y pcre pcre-devel

<span class="token comment"># å®‰è£…zlib</span>
yum <span class="token function">install</span> -y zlib zlib-devel
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># ä½¿ç”¨prefixé€‰é¡¹æŒ‡å®šå®‰è£…çš„ç›®å½•</span>
./configure --prefix<span class="token operator">=</span>/usr/local/nginx 
<span class="token function">make</span>
<span class="token function">make</span> <span class="token function">install</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯åŠ¨</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /usr/local/nginx/sbin

<span class="token function">ls</span>  é‡Œé¢æ˜¯ä¸€ä¸ªnginxçš„å¯æ‰§è¡Œæ–‡ä»¶

./nginx  å¯åŠ¨è¿™ä¸ªå¯æ‰§è¡Œ
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…³é—­é˜²ç«å¢™</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>systemctl stop firewalld
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>è¡¥å……Nginxå‘½ä»¤</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>./nginx -s stop å¿«é€Ÿåœæ­¢
./nginx -s quit å®Œæˆå·²æ¥å—çš„è¯·æ±‚åï¼Œåœæ­¢
./nginx -s reload é‡æ–°åŠ è½½é…ç½®
./nginx -t æ£€æŸ¥nginxé…ç½®æ˜¯å¦æ­£ç¡®
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥çœ‹nginxçŠ¶æ€</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">ps</span> -ef<span class="token operator">|</span><span class="token function">grep</span> nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¯åŠ¨æ—¶ï¼š</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220501205303265.png" alt="image-20220501205303265"></p><p>åœæ­¢æ—¶ï¼š</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220501205333304.png" alt="image-20220501205333304"></p><p>æ³¨å†Œç³»ç»ŸæœåŠ¡</p><p>é€šè¿‡ç³»ç»ŸæœåŠ¡çš„æ–¹å¼å¯åŠ¨nginx</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>vim usr/lib/systemd/system/nginx.service
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>Unit<span class="token punctuation">]</span> 
<span class="token assign-left variable">Description</span><span class="token operator">=</span>nginx
<span class="token assign-left variable">After</span><span class="token operator">=</span>network.target remote-fs.target nss-lookup.target

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>forking
<span class="token assign-left variable">PIDFile</span><span class="token operator">=</span>/usr/local/nginx/logs/nginx.pid
<span class="token assign-left variable">ExecStartPre</span><span class="token operator">=</span>/usr/local/nginx/sbin/nginx -t -c /usr/local/nginx/conf/nginx.conf
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf
<span class="token assign-left variable">ExecReload</span><span class="token operator">=</span>/usr/local/nginx/sbin/nginx -s reload
<span class="token assign-left variable">ExecStop</span><span class="token operator">=</span>/usr/local/nginx/sbin/nginx -s stop
<span class="token assign-left variable">ExecQuit</span><span class="token operator">=</span>/usr/local/nginx/sbin/nginx -s quit 
<span class="token assign-left variable">PrivateTmp</span><span class="token operator">=</span>true
   
<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>   
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target   å¤šç”¨æˆ·
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># é‡æ–°åŠ è½½ç³»ç»ŸæœåŠ¡</span>
systemctl daemon-reload
<span class="token comment"># å¯åŠ¨æœåŠ¡</span>
systemctl start nginx.service
<span class="token comment"># å¼€æœºå¯åŠ¨</span>
systemctl <span class="token builtin class-name">enable</span> nginx.service
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-åŸºæœ¬è¿è¡ŒåŸç†" tabindex="-1"><a class="header-anchor" href="#_3-åŸºæœ¬è¿è¡ŒåŸç†" aria-hidden="true">#</a> 3.åŸºæœ¬è¿è¡ŒåŸç†</h2><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220803212952361.png" alt="image-20220803212952361"></p><h2 id="_4-nginxé…ç½®ä½¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#_4-nginxé…ç½®ä½¿ç”¨åœºæ™¯" aria-hidden="true">#</a> 4.Nginxé…ç½®ä½¿ç”¨åœºæ™¯</h2><h3 id="_4-1-nginxç›®å½•" tabindex="-1"><a class="header-anchor" href="#_4-1-nginxç›®å½•" aria-hidden="true">#</a> 4.1 Nginxç›®å½•</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>conf é…ç½®æ–‡ä»¶
	ï½œ-nginx.conf  ä¸»é…ç½®æ–‡ä»¶
	ï½œ-å…¶ä»–é…ç½®æ–‡ä»¶ï¼Œéƒ½è¢«å¼•å…¥åˆ°äº†nginx.conf
html é™æ€é¡µé¢ï¼ˆé¦–é¡µå’Œé”™è¯¯é¡µï¼‰
logs
	ï½œ-access.log è®¿é—®æ—¥å¿—(è®°å½•ç”¨æˆ·è®¿é—®çš„è¯¦ç»†ä¿¡æ¯ï¼Œæœ‰å¯èƒ½å å¾ˆå¤§ç©ºé—´ï¼ŒæŠŠç£ç›˜å†™æ»¡äº†)
	ï½œ-error.log é”™è¯¯æ—¥å¿—
	ï½œ-nginx.pid è¿›ç¨‹å·
sbin
	ï½œ-nginx æ‰§è¡Œæ–‡ä»¶
*_temp è¿è¡Œæ—¶ï¼Œç”Ÿæˆä¸´æ—¶æ–‡ä»¶
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-2-ç®€åŒ–ç‰ˆçš„nginx-conf" tabindex="-1"><a class="header-anchor" href="#_4-2-ç®€åŒ–ç‰ˆçš„nginx-conf" aria-hidden="true">#</a> 4.2 ç®€åŒ–ç‰ˆçš„nginx.conf</h3><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">worker_processes</span>  <span class="token number">1</span></span><span class="token punctuation">;</span>  <span class="token comment"># é»˜è®¤ä¸º1ï¼Œè¡¨ç¤ºå¼€å¯ä¸€ä¸ªä¸šåŠ¡è¿›ç¨‹</span>

<span class="token directive"><span class="token keyword">events</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">worker_connections</span>  <span class="token number">1024</span></span><span class="token punctuation">;</span> <span class="token comment"># å•ä¸ªä¸šåŠ¡è¿›ç¨‹å¯æ¥å—è¿æ¥æ•°</span>
<span class="token punctuation">}</span>


<span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">include</span>       mime.types</span><span class="token punctuation">;</span> <span class="token comment"># includeæ˜¯å¼•å…¥å…³é”®å­—ï¼Œè¿™é‡Œå¼•å…¥äº†mime.typesè¿™ä¸ªé…ç½®æ–‡ä»¶ï¼ˆåŒåœ¨confç›®å½•ä¸‹ï¼Œmime.typesæ˜¯ç”¨æ¥å®šä¹‰ï¼Œè¯·æ±‚è¿”å›çš„content-typeï¼Œä¹Ÿå°±æ˜¯å‘Šè¯‰æµè§ˆå™¨è¿”å›çš„æ˜¯ä»€ä¹ˆç±»å‹çš„æ–‡ä»¶ï¼‰</span>
    <span class="token directive"><span class="token keyword">default_type</span>  application/octet-stream</span><span class="token punctuation">;</span> <span class="token comment"># å¦‚æœmimeç±»å‹æ²¡åŒ¹é…ä¸Šï¼Œé»˜è®¤ä½¿ç”¨äºŒè¿›åˆ¶æµçš„æ–¹å¼ä¼ è¾“ã€‚</span>

    <span class="token directive"><span class="token keyword">sendfile</span>        <span class="token boolean">on</span></span><span class="token punctuation">;</span> <span class="token comment"># é«˜æ•ˆç½‘ç»œä¼ è¾“ï¼Œä¹Ÿå°±æ˜¯æ•°æ®0æ‹·è´ã€‚</span>
    <span class="token directive"><span class="token keyword">keepalive_timeout</span>  <span class="token number">65</span></span><span class="token punctuation">;</span> <span class="token comment"># é•¿é“¾æ¥è¶…æ—¶æ—¶é—´</span>
	
	<span class="token comment"># ä¸€ä¸ªnginxå¯ä»¥å¯ç”¨å¤šä¸ªserverï¼ˆè™šæ‹Ÿä¸»æœº vhostï¼‰</span>
    <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span></span><span class="token punctuation">;</span> <span class="token comment"># ç›‘å¬80ç«¯å£</span>
        <span class="token directive"><span class="token keyword">server_name</span>  localhost</span><span class="token punctuation">;</span>  <span class="token comment"># æ¥æ”¶çš„åŸŸåã€ä¸»æœºå</span>

        <span class="token comment"># åŒ¹é…è·¯å¾„</span>
        <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span> 
            <span class="token directive"><span class="token keyword">root</span>   html</span><span class="token punctuation">;</span> <span class="token comment"># æ–‡ä»¶æ ¹ç›®å½•</span>
            <span class="token directive"><span class="token keyword">index</span>  index.html index.htm</span><span class="token punctuation">;</span> <span class="token comment"># é»˜è®¤é¡µåç§°</span>
        <span class="token punctuation">}</span>

        <span class="token directive"><span class="token keyword">error_page</span>   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html</span><span class="token punctuation">;</span>  <span class="token comment"># æŠ¥é”™ç¼–ç å¯¹åº”é¡µé¢</span>
        <span class="token directive"><span class="token keyword">location</span> = /50x.html</span> <span class="token punctuation">{</span> 
            <span class="token directive"><span class="token keyword">root</span>   html</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸ä½¿ç”¨ sendfile</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220803214324360.png" alt="image-20220803214324360"></p><p>æ‰“å¼€sendfileï¼Œç”¨æˆ·è¯·æ±‚çš„æ•°æ®ä¸ç”¨å†åŠ è½½åˆ°nginxçš„å†…å­˜ä¸­ï¼Œè€Œæ˜¯ç›´æ¥å‘é€</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220502113913235.png" alt="image-20220502113913235"></p><h3 id="_4-3-è™šæ‹Ÿä¸»æœº" tabindex="-1"><a class="header-anchor" href="#_4-3-è™šæ‹Ÿä¸»æœº" aria-hidden="true">#</a> 4.3 è™šæ‹Ÿä¸»æœº</h3><blockquote><p>åŸæœ¬ä¸€å°æœåŠ¡å™¨åªèƒ½å¯¹åº”ä¸€ä¸ªç«™ç‚¹ï¼Œé€šè¿‡è™šæ‹Ÿä¸»æœºæŠ€æœ¯å¯ä»¥è™šæ‹ŸåŒ–æˆå¤šä¸ªç«™ç‚¹åŒæ—¶å¯¹å¤–æä¾›æœåŠ¡</p></blockquote><p>æµè§ˆå™¨ã€Nginxä¸httpåè®®</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220803220149093.png" alt="image-20220803220149093"></p><p>è™šæ‹Ÿä¸»æœºåŸç†</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220803220427466.png" alt="image-20220803220427466"></p><p>ä¿®æ”¹nginxé…ç½®æ–‡ä»¶åï¼Œè®°å¾—é‡æ–°åŠ è½½nginx</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>systemctl reload nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">{</span>
    
    ...

    <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">server_name</span>  www.tt110617.xyz</span><span class="token punctuation">;</span>

        <span class="token directive"><span class="token keyword">location</span> /www/www</span> <span class="token punctuation">{</span>
            <span class="token directive"><span class="token keyword">root</span>   html</span><span class="token punctuation">;</span>
            <span class="token directive"><span class="token keyword">index</span>  index.html index.htm</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token directive"><span class="token keyword">error_page</span>   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">location</span> = /50x.html</span> <span class="token punctuation">{</span>
            <span class="token directive"><span class="token keyword">root</span>   html</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      
    <span class="token punctuation">}</span>
	
	<span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">88</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">server_name</span>  vod.tt110617.xyz</span><span class="token punctuation">;</span>

        <span class="token directive"><span class="token keyword">location</span> /www/vod</span> <span class="token punctuation">{</span>
            <span class="token directive"><span class="token keyword">root</span>   html</span><span class="token punctuation">;</span>
            <span class="token directive"><span class="token keyword">index</span>  index.html index.htm</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token directive"><span class="token keyword">error_page</span>   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">location</span> = /50x.html</span> <span class="token punctuation">{</span>
            <span class="token directive"><span class="token keyword">root</span>   html</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      
    <span class="token punctuation">}</span>
	
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-servernameåŒ¹é…è§„åˆ™" tabindex="-1"><a class="header-anchor" href="#_1-servernameåŒ¹é…è§„åˆ™" aria-hidden="true">#</a> 1.servernameåŒ¹é…è§„åˆ™</h4><p>æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯servernameåŒ¹é…åˆ†å…ˆåé¡ºåºï¼Œå†™åœ¨å‰é¢çš„åŒ¹é…ä¸Šå°±ä¸ä¼šç»§ç»­å¾€ä¸‹åŒ¹é…äº†ã€‚</p><p><strong>å®Œæ•´åŒ¹é…</strong></p><p>æˆ‘ä»¬å¯ä»¥åœ¨åŒä¸€servernameä¸­åŒ¹é…å¤šä¸ªåŸŸå</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server_name</span> vod.mmban.com www1.mmban.com</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>é€šé…ç¬¦åŒ¹é…</strong></p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code>server_name *.mmban.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>é€šé…ç¬¦ç»“æŸåŒ¹é…</strong></p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server_name</span> vod.*</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>æ­£åˆ™åŒ¹é…</strong></p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server_name</span> ~^[0-9]+\.mmban\.com$</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_2-åŸŸåè§£æç›¸å…³ä¼ä¸šé¡¹ç›®å®æˆ˜æŠ€æœ¯æ¶æ„" tabindex="-1"><a class="header-anchor" href="#_2-åŸŸåè§£æç›¸å…³ä¼ä¸šé¡¹ç›®å®æˆ˜æŠ€æœ¯æ¶æ„" aria-hidden="true">#</a> 2.åŸŸåè§£æç›¸å…³ä¼ä¸šé¡¹ç›®å®æˆ˜æŠ€æœ¯æ¶æ„</h4><ul><li>å¤šç”¨æˆ·äºŒçº§åŸŸå</li><li>çŸ­ç½‘å€</li><li>httpdns</li></ul><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220803225701375.png" alt="image-20220803225701375"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220803225705317.png" alt="image-20220803225705317"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220803225735821.png" alt="image-20220803225735821"></p><h2 id="_5-åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" tabindex="-1"><a class="header-anchor" href="#_5-åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡" aria-hidden="true">#</a> 5.åå‘ä»£ç†ä¸è´Ÿè½½å‡è¡¡</h2><h3 id="_5-1-ç½‘å…³ã€ä»£ç†ä¸åå‘ä»£ç†" tabindex="-1"><a class="header-anchor" href="#_5-1-ç½‘å…³ã€ä»£ç†ä¸åå‘ä»£ç†" aria-hidden="true">#</a> 5.1 ç½‘å…³ã€ä»£ç†ä¸åå‘ä»£ç†</h3><p>åå‘ä»£ç†å’Œæ­£å‘ä»£ç†</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220803230611707.png" alt="image-20220803230611707"></p><p>éš§é“å¼ä»£ç† å’Œ DR</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220803230813141.png" alt="image-20220803230813141"></p><h3 id="_5-2-åå‘ä»£ç†" tabindex="-1"><a class="header-anchor" href="#_5-2-åå‘ä»£ç†" aria-hidden="true">#</a> 5.2 åå‘ä»£ç†</h3><p><strong>åå‘ä»£ç†</strong>ï¼šè¿™ç§ä»£ç†æ–¹å¼å«åšï¼Œéš§é“ä»£ç†ã€‚æœ‰æ€§èƒ½ç“¶é¢ˆï¼Œå› ä¸ºæ‰€æœ‰çš„æ•°æ®éƒ½ç»è¿‡Nginxï¼Œæ‰€ä»¥NginxæœåŠ¡å™¨çš„æ€§èƒ½è‡³å…³é‡è¦</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220502173846436.png" alt="image-20220502173846436"></p><p><strong>nginx.confé…ç½®æ–‡ä»¶</strong></p><ul><li><p>å¯ç”¨proxy_passï¼Œrootå’Œindexå­—æ®µå°±ä¼šå¤±æ•ˆ</p></li><li><p>proxy_passåçš„åœ°å€å¿…é¡»å†™å®Œæ•´ <code>http://xxx;</code> ï¼Œ<code>ä¸æ”¯æŒhttps</code></p></li><li><p>å½“è®¿é—®localhostæ—¶ï¼ˆNginxæœåŠ¡å™¨ï¼‰ï¼Œ<code>proxy_pass http://www.atguigu.com;</code> æ˜¯è¯·æ±‚è½¬å‘ï¼Œæµè§ˆå™¨åœ°å€è¿˜æ˜¯åŸæ¥çš„åœ°å€</p></li><li><p>å½“è®¿é—®localhostæ—¶ï¼ˆNginxæœåŠ¡å™¨ï¼‰ï¼Œ<code>proxy_pass http://atguigu.com;</code> æ˜¯é‡å®šå‘ï¼Œå“åº”ç æ˜¯ 302 ï¼Œæµè§ˆå™¨åœ°å€æ˜¯ <code>æ–°åœ°å€</code></p></li></ul><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">http</span></span><span class="token punctuation">{</span> 		
    <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">server_name</span>  localhost</span><span class="token punctuation">;</span>

        <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span> 
            <span class="token directive"><span class="token keyword">proxy_pass</span> http://xxx</span><span class="token punctuation">;</span>
            <span class="token comment"># å¯ç”¨proxy_passï¼Œrootå’Œindexå­—æ®µå°±ä¼šå¤±æ•ˆ</span>
            <span class="token comment"># root   html/test; </span>
            <span class="token comment"># index  index.html index.htm;</span>
        <span class="token punctuation">}</span>

        <span class="token directive"><span class="token keyword">error_page</span>   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">location</span> = /50x.html</span> <span class="token punctuation">{</span>
            <span class="token directive"><span class="token keyword">root</span>   html</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-3-è´Ÿè½½å‡è¡¡ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#_5-3-è´Ÿè½½å‡è¡¡ç­–ç•¥" aria-hidden="true">#</a> 5.3 è´Ÿè½½å‡è¡¡ç­–ç•¥</h3><p><strong>è´Ÿè½½å‡è¡¡</strong>ï¼šæŠŠè¯·æ±‚ï¼ŒæŒ‰ç…§ä¸€å®šç®—æ³•è§„åˆ™ï¼Œåˆ†é…ç»™å¤šå°ä¸šåŠ¡æœåŠ¡å™¨ï¼ˆå³ä½¿å…¶ä¸­ä¸€ä¸ªåäº†/ç»´æŠ¤å‡çº§ï¼Œè¿˜æœ‰å…¶ä»–æœåŠ¡å™¨å¯ä»¥ç»§ç»­æä¾›æœåŠ¡ï¼‰</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220803231522376.png" alt=""></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220502174023144.png" alt="image-20220502174023144"></p><p>ä½¿ç”¨upstreamå®šä¹‰ä¸€ç»„åœ°å€ã€åœ¨serverå­—æ®µä¸‹ã€‘</p><p>è®¿é—®localhostï¼Œè®¿é—®éƒ½ä¼šä»£ç†åˆ°<code>192.168.174.133:80</code>å’Œ<code>192.168.174.134:80</code>è¿™ä¸¤ä¸ªåœ°å€ä¹‹ä¸€ï¼Œæ¯æ¬¡è®¿é—®è¿™ä¸¤ä¸ªåœ°å€è½®ç€åˆ‡æ¢ <code>è½®è¯¢</code></p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">http</span></span><span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">upstream</span> httpds</span><span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">server</span> 192.168.174.133:80</span><span class="token punctuation">;</span>  <span class="token comment"># å¦‚æœæ˜¯80ç«¯å£ï¼Œå¯ä»¥çœç•¥ä¸å†™</span>
        <span class="token directive"><span class="token keyword">server</span> 192.168.174.134:80</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
        ...

        <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span> 
            <span class="token directive"><span class="token keyword">proxy_pass</span> http://httpds</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

     	...
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="è½®è¯¢" tabindex="-1"><a class="header-anchor" href="#è½®è¯¢" aria-hidden="true">#</a> è½®è¯¢</h4><p>é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨è½®è¯¢æ–¹å¼ï¼Œé€ä¸€è½¬å‘ï¼Œè¿™ç§æ–¹å¼é€‚ç”¨äºæ— çŠ¶æ€è¯·æ±‚ã€‚</p><h4 id="weight-æƒé‡" tabindex="-1"><a class="header-anchor" href="#weight-æƒé‡" aria-hidden="true">#</a> weight(æƒé‡)</h4><p>æŒ‡å®šè½®è¯¢å‡ ç‡ï¼Œweightå’Œè®¿é—®æ¯”ç‡æˆæ­£æ¯”ï¼Œç”¨äºåç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡çš„æƒ…å†µã€‚</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">upstream</span> httpds</span><span class="token punctuation">{</span>
		<span class="token directive"><span class="token keyword">server</span> 192.168.174.133:80 weight=10</span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">server</span> 192.168.174.134:80 weight=80</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…³é—­</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">upstream</span> httpds</span><span class="token punctuation">{</span>
		<span class="token directive"><span class="token keyword">server</span> 192.168.174.133:80 weight=10 down</span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">server</span> 192.168.174.134:80 weight=80</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¤‡ç”¨æœº</p><p>å¦‚æœ<code>192.168.174.133:80</code>å‡ºç°æ•…éšœï¼Œæ— æ³•æä¾›æœåŠ¡ï¼Œå°±ç”¨ä½¿ç”¨backupçš„è¿™ä¸ªæœºå™¨</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">upstream</span> httpds</span><span class="token punctuation">{</span>
		<span class="token directive"><span class="token keyword">server</span> 192.168.174.133:80 weight=10</span><span class="token punctuation">;</span>
		<span class="token directive"><span class="token keyword">server</span> 192.168.174.134:80 weight=80 backup</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ip-hash" tabindex="-1"><a class="header-anchor" href="#ip-hash" aria-hidden="true">#</a> ip_hash</h4><p>æ ¹æ®å®¢æˆ·ç«¯çš„ipåœ°å€è½¬å‘åŒä¸€å°æœåŠ¡å™¨ã€‚</p><h4 id="least-conn" tabindex="-1"><a class="header-anchor" href="#least-conn" aria-hidden="true">#</a> least_conn</h4><p>æœ€å°‘è¿æ¥è®¿é—®</p><h4 id="url-hash" tabindex="-1"><a class="header-anchor" href="#url-hash" aria-hidden="true">#</a> url_hash</h4><p>æ ¹æ®ç”¨æˆ·è®¿é—®çš„urlå®šå‘è½¬å‘è¯·æ±‚</p><h4 id="fair" tabindex="-1"><a class="header-anchor" href="#fair" aria-hidden="true">#</a> fair</h4><p>æ ¹æ®åç«¯æœåŠ¡å™¨å“åº”æ—¶é—´è½¬å‘è¯·æ±‚</p><h3 id="_5-4-åŠ¨é™åˆ†ç¦»" tabindex="-1"><a class="header-anchor" href="#_5-4-åŠ¨é™åˆ†ç¦»" aria-hidden="true">#</a> 5.4 åŠ¨é™åˆ†ç¦»</h3><p>å½“ç”¨æˆ·è¯·æ±‚æ—¶ï¼ŒåŠ¨æ€è¯·æ±‚åˆ†é…åˆ°Tomcatä¸šåŠ¡æœåŠ¡å™¨ï¼Œé™æ€èµ„æºè¯·æ±‚æ”¾åœ¨NginxæœåŠ¡å™¨ä¸­</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220805114357013.png" alt="image-20220805114357013"></p><p>ä¾‹å­ï¼š</p><ul><li>å¦‚æœè¯·æ±‚çš„èµ„æºåœ°å€æ˜¯<code>location/</code>ï¼Œ<code>/</code>çš„ä¼˜å…ˆçº§æ¯”è¾ƒä½ï¼Œå¦‚æœä¸‹é¢çš„locationæ²¡åŒ¹é…åˆ°ï¼Œå°±ä¼šèµ°<a href="http://xn--xxx-l68dw09aj8ahd200mp02a066c" target="_blank" rel="noopener noreferrer">http://xxxè¿™ä¸ªåœ°å€çš„æœºå™¨<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>å¦‚æœè¯·æ±‚çš„èµ„æºåœ°å€æ˜¯<code>location/css/*</code>ï¼Œå°±ä¼šè¢«åŒ¹é…åˆ°nginxçš„htmlç›®å½•ä¸‹çš„cssæ–‡ä»¶å¤¹ä¸­ï¼ˆæˆ‘ä»¬æŠŠcssé™æ€èµ„æºæ”¾åœ¨è¿™ä¸ªä½ç½®ï¼‰</li></ul><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span>  localhost</span><span class="token punctuation">;</span>

    <span class="token comment"># /çš„ä¼˜å…ˆçº§æ¯”è¾ƒä½ï¼Œå¦‚æœä¸‹é¢çš„locationæ²¡åŒ¹é…åˆ°ï¼Œå°±ä¼šèµ°http://127.0.0.1:8080 è¿™ä¸ªåœ°å€çš„æœºå™¨</span>
    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>  
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://127.0.0.1:8080</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment"># rootæŒ‡çš„æ˜¯htmlï¼Œlocation/cssæŒ‡çš„æ˜¯rootä¸‹çš„cssï¼Œæ‰€ä»¥å°±æ˜¯html/css</span>
    <span class="token directive"><span class="token keyword">location</span> /css</span> <span class="token punctuation">{</span>   
        <span class="token directive"><span class="token keyword">root</span> html</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">index</span>  index.html index.htm</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token directive"><span class="token keyword">error_page</span>   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">location</span> = /50x.html</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">root</span>   html</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨æ­£åˆ™</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> ~*/(js|css|img)</span><span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">root</span> html</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">index</span>  index.html index.htm</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-5-urlé‡å†™" tabindex="-1"><a class="header-anchor" href="#_5-5-urlé‡å†™" aria-hidden="true">#</a> 5.5 URLé‡å†™</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>rewriteæ˜¯URLé‡å†™çš„å…³é”®æŒ‡ä»¤ï¼Œæ ¹æ®regexï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰éƒ¨åˆ†å†…å®¹ï¼Œé‡å®šå‘åˆ°replacementï¼Œç»“å°¼æ˜¯flagæ ‡è®°ã€‚

rewrite    <span class="token operator">&lt;</span>regex<span class="token operator">&gt;</span>   <span class="token operator">&lt;</span>replacement<span class="token operator">&gt;</span>  <span class="token punctuation">[</span>flag<span class="token punctuation">]</span><span class="token punctuation">;</span>
å…³é”®å­—		 æ­£åˆ™		  æ›¿ä»£å†…å®¹        flagtæ ‡è®°

æ­£åˆ™ï¼šper1æ£®å®¹æ­£åˆ™è¡¨è¾¾å¼è¯­å¥è¿›è¡Œè§„åˆ™åŒ¹é…
æ›¿ä»£å†…å®¹ï¼šå°†æ­£åˆ™åŒ¹é…çš„å†…å®¹æ›¿æ¢æˆreplacement

flagæ ‡è®°è¯´æ˜ï¼š
last  <span class="token comment"># æœ¬æ¡è§„åˆ™åŒ¹é…å®Œæˆåï¼Œç»§ç»­å‘ä¸‹åŒ¹é…æ–°çš„1ocation URIè§„åˆ™</span>
<span class="token builtin class-name">break</span> <span class="token comment"># æœ¬æ¡è§„åˆ™åŒ¹é…å®Œæˆå³ç»ˆæ­¢ï¼Œä¸å†åŒ¹é…åé¢çš„ä»»ä½•è§„åˆ™</span>

redirect <span class="token comment"># è¿”å›302ä¸´æ—¶é‡å®šå‘ï¼Œæ¸¸è§ˆå™¨åœ°å€ä¼šæ˜¾ç¤ºè·³è½¬åçš„URLåœ°å€</span>
permanent <span class="token comment"># è¿”å›301æ°¸ä¹…é‡å®šå‘ï¼Œæµ‹è§ˆå™¨åœ°å€æ ä¼šæ˜¾ç¤ºè·³è½¬åçš„URLåœ°å€</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµè§ˆå™¨åœ°å€æ è®¿é—® <code>xxx/123.html</code>å®é™…ä¸Šæ˜¯è®¿é—®<code>xxx/index.jsp?pageNum=123</code></p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span>  localhost</span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span> 
        <span class="token directive"><span class="token keyword">rewrite</span> ^/([0-9]+).html$ /index.jsp?pageNum=<span class="token variable">$1</span>  break</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://xxx</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token directive"><span class="token keyword">error_page</span>   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">location</span> = /50x.html</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">root</span>   html</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-6-ç½‘å…³æœåŠ¡å™¨" tabindex="-1"><a class="header-anchor" href="#_5-6-ç½‘å…³æœåŠ¡å™¨" aria-hidden="true">#</a> 5.6 ç½‘å…³æœåŠ¡å™¨</h3><p><img src="https://hedaodao-1256075778.cos.ap-beijing.myqcloud.com/Nginx/image-20220503121135171.png" alt="image-20220503121135171"></p><p>ä¸Šå›¾ä¸­ï¼Œåº”ç”¨æœåŠ¡å™¨ï¼Œä¸èƒ½ç›´æ¥è¢«å¤–ç½‘è®¿é—®åˆ°ï¼Œ<code>åªèƒ½é€šè¿‡NginxæœåŠ¡å™¨è¿›è¡Œè®¿é—®ï¼ˆä½¿ç”¨proxy_passï¼‰</code>ï¼Œè¿™æ—¶å€™è¿™å°NginxæœåŠ¡å™¨å°±æˆä¸ºäº†ç½‘å…³æœåŠ¡å™¨ï¼ˆæ‰¿æ‹…å…¥å£çš„åŠŸèƒ½ï¼‰</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯åŠ¨åº”ç”¨æœåŠ¡å™¨çš„é˜²ç«å¢™ï¼Œè®¾ç½®å…¶åªèƒ½æ¥å—è¿™å°NginxæœåŠ¡å™¨çš„è¯·æ±‚</p><p><strong>å¼€å¯é˜²ç«å¢™</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>systemctl start firewalld
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>æ·»åŠ richè§„åˆ™</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># è¿™é‡Œçš„192.168.13.20æ˜¯ç½‘å…³æœåŠ¡å™¨åœ°å€</span>
firewall-cmd --permanent --add-rich-rule<span class="token operator">=</span><span class="token string">&quot;rule family=&quot;</span>ipv4<span class="token string">&quot; source address=&quot;</span><span class="token number">192.168</span>.13.20<span class="token string">&quot; port protocol=&quot;</span>tcp<span class="token string">&quot; port=&quot;</span><span class="token number">8080</span><span class="token string">&quot; accept&quot;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç§»é™¤richè§„åˆ™</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>firewall-cmd --permanent --remove-rich-rule<span class="token operator">=</span><span class="token string">&quot;rule family=&quot;</span>ipv4<span class="token string">&quot; source address=&quot;</span><span class="token number">192.168</span>.13.20<span class="token string">&quot; port port=&quot;</span><span class="token number">8080</span><span class="token string">&quot; protocol=&quot;</span>tcp<span class="token string">&quot; accept&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>é‡å¯</strong></p><p>ç§»é™¤å’Œæ·»åŠ è§„åˆ™éƒ½è¦é‡å¯æ‰èƒ½ç”Ÿæ•ˆ</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>firewall-cmd --reload
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>æŸ¥çœ‹æ‰€æœ‰è§„åˆ™</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># æ‰€æœ‰å¼€å¯çš„è§„åˆ™</span>
firewall-cmd --list-all 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç½‘å…³é…ç½®</strong></p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">upstream</span> httpds</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">server</span> 192.168.44.102 weight=8 down</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server</span> 192.168.44.103:8080 weight=2</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server</span> 192.168.44.104:8080 weight=1 backup</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">rewrite</span> ^/([0-9]+).html$ /index.jsp?pageNum=<span class="token variable">$1</span> redirect</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">proxy_pass</span> http://httpds</span> <span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-é˜²ç›—é“¾" tabindex="-1"><a class="header-anchor" href="#_6-é˜²ç›—é“¾" aria-hidden="true">#</a> 6.é˜²ç›—é“¾</h2><p>å½“æˆ‘ä»¬è¯·æ±‚åˆ°ä¸€ä¸ªé¡µé¢åï¼Œè¿™ä¸ªé¡µé¢ä¸€èˆ¬ä¼šå†å»è¯·æ±‚å…¶ä¸­çš„é™æ€èµ„æºï¼Œè¿™æ—¶å€™è¯·æ±‚å¤´ä¸­ï¼Œä¼šæœ‰ä¸€ä¸ªreferå­—æ®µï¼Œè¡¨ç¤ºå½“å‰è¿™ä¸ªè¯·æ±‚çš„æ¥æºï¼Œæˆ‘ä»¬å¯ä»¥é™åˆ¶æŒ‡å®šæ¥æºçš„è¯·æ±‚æ‰è¿”å›ï¼Œå¦åˆ™å°±ä¸è¿”å›ï¼Œè¿™æ ·å¯ä»¥èŠ‚çœèµ„æº</p><p><img src="https://hedaodao-1256075778.cos.ap-beijing.myqcloud.com/Nginx/image-20220503162830153.png" alt="image-20220503162830153"></p><p><strong>é˜²ç›—é“¾é…ç½®</strong></p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">valid_referers</span> none | blocked | server_names | strings ....</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>noneï¼Œ æ£€æµ‹ Referer å¤´åŸŸä¸å­˜åœ¨çš„æƒ…å†µã€‚</li><li>blockedï¼Œæ£€æµ‹ Referer å¤´åŸŸçš„å€¼è¢«é˜²ç«å¢™æˆ–è€…ä»£ç†æœåŠ¡å™¨åˆ é™¤æˆ–ä¼ªè£…çš„æƒ…å†µã€‚è¿™ç§æƒ…å†µè¯¥å¤´åŸŸçš„å€¼ä¸ä»¥â€œhttp://â€ æˆ– â€œhttps://â€ å¼€å¤´ã€‚</li><li>server_names ï¼Œè®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ª URL ï¼Œæ£€æµ‹ Referer å¤´åŸŸçš„å€¼æ˜¯å¦æ˜¯è¿™äº› URL ä¸­çš„æŸä¸€ä¸ªã€‚</li></ul><p>æ³¨æ„ï¼š<code>if ($invalid_referer)</code>ä¸­ifåæœ‰ä¸ªç©ºæ ¼ï¼Œä¸å†™å°±ä¼šæŠ¥é”™</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>nginx: <span class="token punctuation">[</span>emerg<span class="token punctuation">]</span> unknown directive <span class="token string">&quot;if(<span class="token variable">$invalid_referer</span>)&quot;</span> <span class="token keyword">in</span> /usr/local/nginx/conf/nginx.conf:27
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¾‹å­ï¼šè¿™é‡Œè®¾ç½®nginxæœåŠ¡å™¨ä¸­çš„imgç›®å½•ä¸‹çš„å›¾ç‰‡å¿…é¡»referä¸º <code>192.168.174.133</code> æ‰èƒ½è®¿é—®</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span>  localhost</span><span class="token punctuation">;</span>

    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span> 
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://xxx</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token directive"><span class="token keyword">location</span> /img</span><span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">valid_referers</span> 192.168.174.133</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$invalid_referer</span>)</span><span class="token punctuation">{</span> <span class="token comment"># æ— æ•ˆçš„</span>
            <span class="token directive"><span class="token keyword">return</span> <span class="token number">403</span></span><span class="token punctuation">;</span> <span class="token comment"># è¿”å›çŠ¶æ€ç 403</span>
        <span class="token punctuation">}</span>
        <span class="token directive"><span class="token keyword">root</span> html</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">index</span>  index.html index.htm</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token directive"><span class="token keyword">error_page</span>   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">location</span> = /50x.html</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">root</span>   html</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœå¼•ç”¨è¿™å¼ å›¾ç‰‡çš„é¡µé¢ä¸”referå¹¶æ²¡æœ‰è¢«è®¾ç½®ï¼Œå›¾ç‰‡æ— æ³•åŠ è½½å‡ºæ¥</p><p>å¦‚æœç›´æ¥è®¿é—®å›¾ç‰‡åœ°å€ï¼Œå› ä¸ºæ²¡æœ‰referå­—æ®µæŒ‡å‘æ¥æºï¼Œä¼šç›´æ¥æ˜¾ç¤ºNginxçš„é¡µé¢</p><p><img src="https://hedaodao-1256075778.cos.ap-beijing.myqcloud.com/Nginx/image-20220503153401325.png" alt="image-20220503153401325"></p><p><strong>ä½¿ç”¨curlæµ‹è¯•</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">curl</span> -I http://192.168.44.101/img/logo.png
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>å¸¦å¼•ç”¨</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">curl</span> -e <span class="token string">&quot;http://baidu.com&quot;</span> -I http://192.168.44.101/img/logo.png
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>è®¾ç½®ç›—é“¾å›¾ç‰‡</strong></p><p>å°†æç¤ºå›¾ç‰‡æ”¾åœ¨html/img/x.pngï¼Œè®¿é—®è®¾ç½®é˜²ç›—é“¾å›¾ç‰‡æ—¶ï¼Œå°±è¿”å›è¿™x.pngå¼ å›¾</p><div class="language-nginx ext-nginx line-numbers-mode"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> /img</span><span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">valid_referers</span> 192.168.174/133</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$invalid_referer</span>)</span><span class="token punctuation">{</span> <span class="token comment"># æ— æ•ˆçš„</span>
        <span class="token directive"><span class="token keyword">rewrite</span> ^/  /img/x.png break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token directive"><span class="token keyword">root</span> html</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">index</span>  index.html index.htm</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-é«˜å¯ç”¨åœºæ™¯-keepalived" tabindex="-1"><a class="header-anchor" href="#_7-é«˜å¯ç”¨åœºæ™¯-keepalived" aria-hidden="true">#</a> 7.é«˜å¯ç”¨åœºæ™¯-keepalived</h2><p><img src="https://hedaodao-1256075778.cos.ap-beijing.myqcloud.com/Nginx/image-20220503174125433.png" alt="image-20220503174125433"></p><p>ç”¨æˆ·è®¿é—®æ—¶ï¼Œè®¿é—®çš„æ˜¯ä¸€ä¸ªè™šæ‹ŸIPï¼Œkeepalivedä¼šé€‰å®šä¸€ä¸ªä¸»æœåŠ¡å™¨ä½¿ç”¨è¿™ä¸ªè™šæ‹ŸIPï¼Œå½“æœåŠ¡å®•æœºåï¼Œè™šæ‹ŸIPä¼šç§»åŠ¨åˆ°æ–°çš„ master èŠ‚ç‚¹</p><p>æ¯å°æœºå™¨ä¸Šçš„keepalivedä¼šç›¸äº’é€šä¿¡ï¼Œæ ¹æ®å…¶ä»–æœºå™¨ä¸Šçš„keepalivedè¿›ç¨‹æ˜¯å¦å­˜åœ¨ï¼Œåˆ¤æ–­æœåŠ¡å™¨çŠ¶æ€ï¼Œå¦‚æœé»˜è®¤çš„Masteråœæ­¢äº†ï¼Œå°±ä¼šåœ¨å‰©ä¸‹çš„Backupæœºå™¨ä¸­ï¼Œç«é€‰å‡ºä¸€å°NginxæœåŠ¡å™¨ä½œä¸ºMaster</p><p><strong>å®‰è£…keepalived</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>yum <span class="token function">install</span> -y keepalived
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>ä¿®æ”¹keepalivedé…ç½®</strong></p><ul><li>é…ç½®æ–‡ä»¶åœ¨ <code>/etc/keepalived/keepalived.conf</code></li><li><code>vrrp_instance</code>ã€<code>authentication</code>ã€<code>virtual_router_id</code>ã€<code>virtual_ipaddress</code>è¿™å‡ ä¸ªä¸€æ ·çš„æœºå™¨ï¼Œæ‰ç®—æ˜¯åŒä¸€ä¸ªç»„é‡Œã€‚è¿™ä¸ªç»„æ‰ä¼šé€‰å‡ºä¸€ä¸ªä½œä¸ºMasteræœºå™¨</li></ul><p>è¿™é‡Œæˆ‘ä»¬è®¾ç½®ä¸¤å°æœºå™¨ï¼Œåˆ†åˆ«ä¸‹è½½å¥½keepalivedï¼Œç„¶åè¿›è¡Œé…ç½®</p><p>æœºå™¨ä¸€ï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token operator">!</span> Configuration File <span class="token keyword">for</span> keepalived

global_defs <span class="token punctuation">{</span>
   router_id lb1  <span class="token comment"># åå­—ä¸å…¶ä»–é…ç½®äº†keepaliveçš„æœºå™¨ä¸é‡å¤å°±è¡Œ</span>
<span class="token punctuation">}</span>

vrrp_instance heyingjie <span class="token punctuation">{</span> <span class="token comment"># vrrpå®ä¾‹åå¯ä»¥éšæ„å–</span>
    state MASTER <span class="token comment"># åªèƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„Masterï¼Œå…¶ä»–å†™BACKUP</span>
    interface ens33  <span class="token comment"># ip addræŸ¥çœ‹ä¸‹ç½‘å¡åï¼Œé»˜è®¤æ—¶ens33</span>
    virtual_router_id <span class="token number">51</span>
    priority <span class="token number">100</span>  <span class="token comment"># å¤šå°å®‰è£…äº†keepalivedçš„æœºå™¨ç«äº‰æˆä¸ºMasterçš„ä¼˜å…ˆçº§</span>
    advert_int <span class="token number">1</span> <span class="token comment"># é€šä¿¡æ—¶é—´</span>
    authentication <span class="token punctuation">{</span>
        auth_type PASS
        auth_pass <span class="token number">1111</span>
    <span class="token punctuation">}</span>
    virtual_ipaddress <span class="token punctuation">{</span>
        <span class="token number">192.168</span>.200.16 <span class="token comment"># è™šæ‹ŸIP</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœºå™¨äºŒï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token operator">!</span> Configuration File <span class="token keyword">for</span> keepalived

global_defs <span class="token punctuation">{</span>
   router_id lb2 
<span class="token punctuation">}</span>

vrrp_instance heyingjie <span class="token punctuation">{</span>
    state BACKUP <span class="token comment"># åªèƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„Masterï¼Œå…¶ä»–å†™BACKUP</span>
    interface ens33 
    virtual_router_id <span class="token number">51</span>
    priority <span class="token number">50</span>
    advert_int <span class="token number">1</span> 
    authentication <span class="token punctuation">{</span>
        auth_type PASS
        auth_pass <span class="token number">1111</span>
    <span class="token punctuation">}</span>
    virtual_ipaddress <span class="token punctuation">{</span>
        <span class="token number">192.168</span>.200.16 <span class="token comment"># è™šæ‹ŸIP</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡å‘½ä»¤<code>ip addr</code>æŸ¥çœ‹æœºå™¨ä¸€çš„ipä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°è™šæ‹ŸIP</p><p><img src="https://hedaodao-1256075778.cos.ap-beijing.myqcloud.com/Nginx/image-20220503175414858.png" alt="image-20220503175414858"></p><h2 id="_8-é…ç½®è¯ä¹¦" tabindex="-1"><a class="header-anchor" href="#_8-é…ç½®è¯ä¹¦" aria-hidden="true">#</a> 8.é…ç½®è¯ä¹¦</h2><h3 id="_8-1-ä¸å®‰å…¨çš„httpåè®®" tabindex="-1"><a class="header-anchor" href="#_8-1-ä¸å®‰å…¨çš„httpåè®®" aria-hidden="true">#</a> 8.1 ä¸å®‰å…¨çš„httpåè®®</h3><p>å¯¹ç§°ç®—æ³•</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220806210941197.png" alt="image-20220806210941197"></p><h3 id="_8-2-éå¯¹ç§°ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#_8-2-éå¯¹ç§°ç®—æ³•" aria-hidden="true">#</a> 8.2 éå¯¹ç§°ç®—æ³•</h3><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220806211221446.png" alt="image-20220806211221446"></p><p><strong>éå¯¹ç§°åŠ å¯†ç®—æ³•åŒæ ·ä¸å®‰å…¨</strong></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220806211634309.png" alt="image-20220806211634309"></p><p>è§£å†³ï¼šCAæœºæ„å¯¹æœåŠ¡å™¨å…¬é’¥è¿›è¡Œéå¯¹ç§°åŠ å¯†ï¼ˆCA.ç§é’¥ + ç®—æ³•ï¼‰ï¼Œç”Ÿæˆè¯ä¹¦ï¼Œä¸‹å‘è¯ä¹¦ï¼Œé»‘å®¢å¯ä»¥è§£å¼€è¯ä¹¦ï¼Œä½†æ˜¯æ²¡æ³•ç”¨CA.ç§é’¥å†æ¬¡è¿›è¡ŒåŠ å¯†ï¼Œä¿è¯äº†å®‰å…¨æ€§ã€‚æˆ‘ä»¬çš„æ“ä½œç³»ç»Ÿå†…ç½®äº†CA.å…¬é’¥ï¼Œ<code>å¯ä»¥è§£å¼€è¯ä¹¦ï¼Œå¾—åˆ°æœåŠ¡å™¨å…¬é’¥</code>ï¼Œè¿™æ ·å°± <code>ä¿è¯äº†æœåŠ¡å™¨å…¬é’¥çš„å®‰å…¨æ€§</code></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220806212452529.png" alt="image-20220806212452529"></p><p>è´­ä¹°æœåŠ¡å™¨â€”â€”&gt;è´­ä¹°åŸŸåï¼Œå¹¶è§£æåˆ°è¿™ä¸ªä¸»æœºâ€”â€”&gt;è´­ä¹°è¯ä¹¦ï¼Œç»‘å®šåˆ°åŸŸåä¸Šï¼Œå¹¶ä¸”æŠŠè¯ä¹¦æ–‡ä»¶å®‰è£…åˆ°æœåŠ¡å™¨ï¼Œå¹¶åœ¨Nginxä¸Šé…ç½®å¥½</p><p>è¿™æ—¶å€™ï¼Œè¿™ä¸ªåŸŸåå°±å¯ä»¥ä½¿ç”¨httpsè¿›è¡Œè®¿é—®é‡Œï¼ˆ<code>https://xxxx</code>ï¼‰ï¼Œæµè§ˆå™¨ä¸Šä¼šæœ‰ä¸€ä¸ªå°é”</p><p><img src="https://hedaodao-1256075778.cos.ap-beijing.myqcloud.com/Nginx/image-20220503191754606.png" alt="image-20220503191754606"></p><p>ä¸Šé¢çš„æµç¨‹æˆ‘æ¯”è¾ƒç†Ÿæ‚‰äº†ï¼Œå°±ç›´æ¥è·³è¿‡äº†ï¼Œè¿™é‡Œç›´æ¥å†™ç”³è¯·åˆ°è¯ä¹¦åçš„Nginxé…ç½®éƒ¨åˆ†</p><p><strong>ä¸‹è½½è¯ä¹¦æ–‡ä»¶</strong></p><p><img src="https://hedaodao-1256075778.cos.ap-beijing.myqcloud.com/Nginx/image-20220503192840029.png" alt="image-20220503192840029"></p><p><img src="https://hedaodao-1256075778.cos.ap-beijing.myqcloud.com/Nginx/image-20220503192957256.png" alt="image-20220503192957256"></p><p>ä¸‹è½½åï¼Œè§£å‹å‹ç¼©åŒ…ï¼Œå¯ä»¥çœ‹åˆ°ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯ <code>xxx.key</code>ï¼ˆç§é’¥ï¼‰å’Œ<code>xxx.pem</code>ï¼ˆè¯ä¹¦ï¼‰</p><p><strong>é…ç½®</strong></p><p>å°†ä¸¤ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°Nginxç›®å½•ä¸­ï¼Œè®°å¾—æ”¾ç½®çš„ä½ç½®ã€‚æˆ‘è¿™é‡Œç›´æ¥æ”¾åœ¨nginx.confé…ç½®æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ï¼ˆ<code>/user/local/nginx/conf</code>ï¼‰ï¼Œæ‰€ä»¥å†™çš„éƒ½æ˜¯ç›¸å¯¹è·¯å¾„</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>server <span class="token punctuation">{</span>
	listen <span class="token number">443</span> ss1<span class="token punctuation">;</span>
	<span class="token comment"># è¿™é‡Œæ˜¯è¯ä¹¦è·¯å¾„</span>
	ss1 certificate  xxx.pem<span class="token punctuation">;</span> 
	<span class="token comment"># è¿™é‡Œæ˜¯ç§é’¥è·¯å¾„</span>
	ss1_ certificate_key  xxx.key  
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/tt110617/edit/main/demo/src/backend/high-performance/nginx.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="info">2022/9/20 21:33:09</span></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: 1253728268@qq.com">hzz</span><!--]--><!--]--></div></footer><nav class="page-nav"><!----><a href="/myblog/backend/high-performance/Docker.html" class="nav-link next" aria-label="DockeråŸºç¡€ç¯‡"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">DockeråŸºç¡€ç¯‡<img class="icon" src="/myblog/icon/docker.png"></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"></div><div class="copyright">Copyright Â© 2022 åä¸€</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/myblog/assets/app.6a2d513d.js" defer></script>
  </body>
</html>
