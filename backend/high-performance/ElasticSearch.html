<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.49" />
    <meta name="theme" content="VuePress Theme Hope" />
    <title>ElasticSearch | tt110617</title><meta name="description" content="ç½‘ç«™">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/myblog/assets/style.f2a6604f.css">
    <link rel="modulepreload" href="/myblog/assets/app.6a2d513d.js"><link rel="modulepreload" href="/myblog/assets/ElasticSearch.html.834de972.js"><link rel="modulepreload" href="/myblog/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/myblog/assets/ElasticSearch.html.68bc187d.js"><link rel="prefetch" href="/myblog/assets/index.html.d1ca62f7.js"><link rel="prefetch" href="/myblog/assets/index.html.b5c38db1.js"><link rel="prefetch" href="/myblog/assets/index.html.feb38b0c.js"><link rel="prefetch" href="/myblog/assets/algorithm01.html.dd1af2b2.js"><link rel="prefetch" href="/myblog/assets/algorithm02.html.6645e291.js"><link rel="prefetch" href="/myblog/assets/algorithm03.html.9da54164.js"><link rel="prefetch" href="/myblog/assets/LeetCode Hot 100.html.95af3c37.js"><link rel="prefetch" href="/myblog/assets/index.html.2770fb04.js"><link rel="prefetch" href="/myblog/assets/index.html.9f31cb98.js"><link rel="prefetch" href="/myblog/assets/MongoDB.html.747bd522.js"><link rel="prefetch" href="/myblog/assets/index.html.7970fd4d.js"><link rel="prefetch" href="/myblog/assets/index.html.d76d8eeb.js"><link rel="prefetch" href="/myblog/assets/Docker.html.7e9153cc.js"><link rel="prefetch" href="/myblog/assets/nginx.html.feb27b40.js"><link rel="prefetch" href="/myblog/assets/index.html.c88cf0a5.js"><link rel="prefetch" href="/myblog/assets/java8æ–°ç‰¹æ€§.html.eba77086.js"><link rel="prefetch" href="/myblog/assets/index.html.db442bd7.js"><link rel="prefetch" href="/myblog/assets/index.html.e978b3f4.js"><link rel="prefetch" href="/myblog/assets/vue2.html.cd054f5f.js"><link rel="prefetch" href="/myblog/assets/vue3.html.09644e9e.js"><link rel="prefetch" href="/myblog/assets/mysql01.html.14852074.js"><link rel="prefetch" href="/myblog/assets/mysql02.html.19638d4a.js"><link rel="prefetch" href="/myblog/assets/mysql03.html.19940ab5.js"><link rel="prefetch" href="/myblog/assets/mysql04.html.ff20e708.js"><link rel="prefetch" href="/myblog/assets/index.html.aeaeabce.js"><link rel="prefetch" href="/myblog/assets/mianshi.html.5de27bef.js"><link rel="prefetch" href="/myblog/assets/network01.html.d374f53e.js"><link rel="prefetch" href="/myblog/assets/network02.html.612f1790.js"><link rel="prefetch" href="/myblog/assets/network03.html.f409d6e1.js"><link rel="prefetch" href="/myblog/assets/network04.html.417995ce.js"><link rel="prefetch" href="/myblog/assets/network05.html.383f02d3.js"><link rel="prefetch" href="/myblog/assets/network06.html.6b7b74f3.js"><link rel="prefetch" href="/myblog/assets/index.html.a5289baa.js"><link rel="prefetch" href="/myblog/assets/index.html.1ad05321.js"><link rel="prefetch" href="/myblog/assets/Redis01.html.43cb742a.js"><link rel="prefetch" href="/myblog/assets/Redis02.html.ba0a875f.js"><link rel="prefetch" href="/myblog/assets/Redis03.html.c65b1aff.js"><link rel="prefetch" href="/myblog/assets/Redis04.html.8d20d57a.js"><link rel="prefetch" href="/myblog/assets/Redis05.html.66a2065a.js"><link rel="prefetch" href="/myblog/assets/RedissonåŸç†.html.e587d689.js"><link rel="prefetch" href="/myblog/assets/basics.html.ec7af011.js"><link rel="prefetch" href="/myblog/assets/practice.html.3d6fcedb.js"><link rel="prefetch" href="/myblog/assets/index.html.195983d3.js"><link rel="prefetch" href="/myblog/assets/index.html.ffce25e3.js"><link rel="prefetch" href="/myblog/assets/SpringBoot01.html.1539f2df.js"><link rel="prefetch" href="/myblog/assets/SpringBoot02.html.8d492936.js"><link rel="prefetch" href="/myblog/assets/Dubbo.html.25f8081d.js"><link rel="prefetch" href="/myblog/assets/index.html.25b97898.js"><link rel="prefetch" href="/myblog/assets/SpringCloud.html.11fa754a.js"><link rel="prefetch" href="/myblog/assets/SpringCloudAibaba.html.ba7822c1.js"><link rel="prefetch" href="/myblog/assets/mianshi.html.e3fba77d.js"><link rel="prefetch" href="/myblog/assets/RabbitMQ.html.d245b413.js"><link rel="prefetch" href="/myblog/assets/index.html.2e0e8a71.js"><link rel="prefetch" href="/myblog/assets/OAuth2.0.html.ec57b0c6.js"><link rel="prefetch" href="/myblog/assets/index.html.195b9b99.js"><link rel="prefetch" href="/myblog/assets/SpringSecurity.html.f53a3387.js"><link rel="prefetch" href="/myblog/assets/design01.html.a9ca0966.js"><link rel="prefetch" href="/myblog/assets/design02.html.14685d48.js"><link rel="prefetch" href="/myblog/assets/design03.html.d0742e22.js"><link rel="prefetch" href="/myblog/assets/design04.html.4b4d3a60.js"><link rel="prefetch" href="/myblog/assets/design05.html.dd009a09.js"><link rel="prefetch" href="/myblog/assets/index.html.de8a79d7.js"><link rel="prefetch" href="/myblog/assets/juc01.html.7b5b2a61.js"><link rel="prefetch" href="/myblog/assets/juc02.html.e7af61bf.js"><link rel="prefetch" href="/myblog/assets/juc03.html.c680cb04.js"><link rel="prefetch" href="/myblog/assets/index.html.3ef30b14.js"><link rel="prefetch" href="/myblog/assets/jvm01.html.226ff0ab.js"><link rel="prefetch" href="/myblog/assets/jvm02.html.ad530863.js"><link rel="prefetch" href="/myblog/assets/jvm03.html.af77ed0d.js"><link rel="prefetch" href="/myblog/assets/jvm04.html.dd845ccc.js"><link rel="prefetch" href="/myblog/assets/jvm05.html.56d56c94.js"><link rel="prefetch" href="/myblog/assets/jvm06.html.8c5c08ed.js"><link rel="prefetch" href="/myblog/assets/jvm07.html.8713dffe.js"><link rel="prefetch" href="/myblog/assets/jvm08.html.396f92cc.js"><link rel="prefetch" href="/myblog/assets/index.html.cacef81d.js"><link rel="prefetch" href="/myblog/assets/404.html.82bd4b1a.js"><link rel="prefetch" href="/myblog/assets/index.html.2f713335.js"><link rel="prefetch" href="/myblog/assets/index.html.1a811f74.js"><link rel="prefetch" href="/myblog/assets/index.html.79fe6d6e.js"><link rel="prefetch" href="/myblog/assets/index.html.dcd15e89.js"><link rel="prefetch" href="/myblog/assets/index.html.e8952663.js"><link rel="prefetch" href="/myblog/assets/index.html.5ad7ff00.js"><link rel="prefetch" href="/myblog/assets/index.html.92637d35.js"><link rel="prefetch" href="/myblog/assets/index.html.6033e64c.js"><link rel="prefetch" href="/myblog/assets/index.html.29a3be67.js"><link rel="prefetch" href="/myblog/assets/index.html.d2aef326.js"><link rel="prefetch" href="/myblog/assets/index.html.61fd0259.js"><link rel="prefetch" href="/myblog/assets/index.html.cf3e5974.js"><link rel="prefetch" href="/myblog/assets/index.html.b7fddec6.js"><link rel="prefetch" href="/myblog/assets/index.html.2d1c3407.js"><link rel="prefetch" href="/myblog/assets/index.html.f6e57d32.js"><link rel="prefetch" href="/myblog/assets/index.html.57cfa80f.js"><link rel="prefetch" href="/myblog/assets/index.html.5f4c6904.js"><link rel="prefetch" href="/myblog/assets/index.html.adc9fbf5.js"><link rel="prefetch" href="/myblog/assets/index.html.de6bf546.js"><link rel="prefetch" href="/myblog/assets/index.html.5802a134.js"><link rel="prefetch" href="/myblog/assets/index.html.00532d93.js"><link rel="prefetch" href="/myblog/assets/index.html.dcdb8b0c.js"><link rel="prefetch" href="/myblog/assets/index.html.64a2ffc8.js"><link rel="prefetch" href="/myblog/assets/index.html.aa56265b.js"><link rel="prefetch" href="/myblog/assets/index.html.cf5fc743.js"><link rel="prefetch" href="/myblog/assets/index.html.dd0debdd.js"><link rel="prefetch" href="/myblog/assets/index.html.598a85b3.js"><link rel="prefetch" href="/myblog/assets/algorithm01.html.9516ff71.js"><link rel="prefetch" href="/myblog/assets/algorithm02.html.f215eb2a.js"><link rel="prefetch" href="/myblog/assets/algorithm03.html.b981d3d4.js"><link rel="prefetch" href="/myblog/assets/LeetCode Hot 100.html.921fe2c8.js"><link rel="prefetch" href="/myblog/assets/index.html.9ff070dd.js"><link rel="prefetch" href="/myblog/assets/index.html.f985f07c.js"><link rel="prefetch" href="/myblog/assets/MongoDB.html.367811ae.js"><link rel="prefetch" href="/myblog/assets/index.html.ccc78fec.js"><link rel="prefetch" href="/myblog/assets/index.html.cd9c8951.js"><link rel="prefetch" href="/myblog/assets/Docker.html.9aa6750f.js"><link rel="prefetch" href="/myblog/assets/nginx.html.96457f50.js"><link rel="prefetch" href="/myblog/assets/index.html.5f9750b5.js"><link rel="prefetch" href="/myblog/assets/java8æ–°ç‰¹æ€§.html.72523a0c.js"><link rel="prefetch" href="/myblog/assets/index.html.4267a9c7.js"><link rel="prefetch" href="/myblog/assets/index.html.64b7cc16.js"><link rel="prefetch" href="/myblog/assets/vue2.html.019d3a52.js"><link rel="prefetch" href="/myblog/assets/vue3.html.f014c692.js"><link rel="prefetch" href="/myblog/assets/mysql01.html.1f3c1d4e.js"><link rel="prefetch" href="/myblog/assets/mysql02.html.6085f62b.js"><link rel="prefetch" href="/myblog/assets/mysql03.html.a05b3e35.js"><link rel="prefetch" href="/myblog/assets/mysql04.html.f83e6c8a.js"><link rel="prefetch" href="/myblog/assets/index.html.c2377b6c.js"><link rel="prefetch" href="/myblog/assets/mianshi.html.62e502c2.js"><link rel="prefetch" href="/myblog/assets/network01.html.bb391280.js"><link rel="prefetch" href="/myblog/assets/network02.html.4835dc75.js"><link rel="prefetch" href="/myblog/assets/network03.html.529a44ea.js"><link rel="prefetch" href="/myblog/assets/network04.html.c4a9ab39.js"><link rel="prefetch" href="/myblog/assets/network05.html.fefe6411.js"><link rel="prefetch" href="/myblog/assets/network06.html.4098bbbd.js"><link rel="prefetch" href="/myblog/assets/index.html.9a37999d.js"><link rel="prefetch" href="/myblog/assets/index.html.25f73ada.js"><link rel="prefetch" href="/myblog/assets/Redis01.html.4774eebb.js"><link rel="prefetch" href="/myblog/assets/Redis02.html.7aa43754.js"><link rel="prefetch" href="/myblog/assets/Redis03.html.3b35817c.js"><link rel="prefetch" href="/myblog/assets/Redis04.html.1eb9f421.js"><link rel="prefetch" href="/myblog/assets/Redis05.html.445e2fb4.js"><link rel="prefetch" href="/myblog/assets/RedissonåŸç†.html.a6281fb0.js"><link rel="prefetch" href="/myblog/assets/basics.html.64ecf975.js"><link rel="prefetch" href="/myblog/assets/practice.html.9bd91dc4.js"><link rel="prefetch" href="/myblog/assets/index.html.45528417.js"><link rel="prefetch" href="/myblog/assets/index.html.2765f82f.js"><link rel="prefetch" href="/myblog/assets/SpringBoot01.html.5e31fcb7.js"><link rel="prefetch" href="/myblog/assets/SpringBoot02.html.bbddd314.js"><link rel="prefetch" href="/myblog/assets/Dubbo.html.ccbf57f9.js"><link rel="prefetch" href="/myblog/assets/index.html.534d4ae8.js"><link rel="prefetch" href="/myblog/assets/SpringCloud.html.eab22d83.js"><link rel="prefetch" href="/myblog/assets/SpringCloudAibaba.html.79284ee6.js"><link rel="prefetch" href="/myblog/assets/mianshi.html.da3eb94f.js"><link rel="prefetch" href="/myblog/assets/RabbitMQ.html.1224037c.js"><link rel="prefetch" href="/myblog/assets/index.html.668ad86c.js"><link rel="prefetch" href="/myblog/assets/OAuth2.0.html.aabd01a5.js"><link rel="prefetch" href="/myblog/assets/index.html.9cd27700.js"><link rel="prefetch" href="/myblog/assets/SpringSecurity.html.469ecc81.js"><link rel="prefetch" href="/myblog/assets/design01.html.2b9f9e86.js"><link rel="prefetch" href="/myblog/assets/design02.html.849b42b0.js"><link rel="prefetch" href="/myblog/assets/design03.html.e4be33cd.js"><link rel="prefetch" href="/myblog/assets/design04.html.bc31a0d9.js"><link rel="prefetch" href="/myblog/assets/design05.html.d5c35997.js"><link rel="prefetch" href="/myblog/assets/index.html.4a7a1688.js"><link rel="prefetch" href="/myblog/assets/juc01.html.5bb1f884.js"><link rel="prefetch" href="/myblog/assets/juc02.html.0ce510cd.js"><link rel="prefetch" href="/myblog/assets/juc03.html.e93fe7b6.js"><link rel="prefetch" href="/myblog/assets/index.html.b5425fa1.js"><link rel="prefetch" href="/myblog/assets/jvm01.html.f238e096.js"><link rel="prefetch" href="/myblog/assets/jvm02.html.a9498b0d.js"><link rel="prefetch" href="/myblog/assets/jvm03.html.460f2e71.js"><link rel="prefetch" href="/myblog/assets/jvm04.html.7205bd05.js"><link rel="prefetch" href="/myblog/assets/jvm05.html.edac738a.js"><link rel="prefetch" href="/myblog/assets/jvm06.html.91cbb3f0.js"><link rel="prefetch" href="/myblog/assets/jvm07.html.f40c12f1.js"><link rel="prefetch" href="/myblog/assets/jvm08.html.fb107a67.js"><link rel="prefetch" href="/myblog/assets/index.html.3ba3011a.js"><link rel="prefetch" href="/myblog/assets/404.html.1f196261.js"><link rel="prefetch" href="/myblog/assets/index.html.1375c5bc.js"><link rel="prefetch" href="/myblog/assets/index.html.90d1ac0c.js"><link rel="prefetch" href="/myblog/assets/index.html.4d12ff1c.js"><link rel="prefetch" href="/myblog/assets/index.html.8ddb93d5.js"><link rel="prefetch" href="/myblog/assets/index.html.dd098c61.js"><link rel="prefetch" href="/myblog/assets/index.html.cebf8dc1.js"><link rel="prefetch" href="/myblog/assets/index.html.5674ca1e.js"><link rel="prefetch" href="/myblog/assets/index.html.d2abca49.js"><link rel="prefetch" href="/myblog/assets/index.html.1351de8d.js"><link rel="prefetch" href="/myblog/assets/index.html.9de6b46c.js"><link rel="prefetch" href="/myblog/assets/index.html.611ec9ae.js"><link rel="prefetch" href="/myblog/assets/index.html.a02c1bed.js"><link rel="prefetch" href="/myblog/assets/index.html.eb87c7a9.js"><link rel="prefetch" href="/myblog/assets/index.html.33261d15.js"><link rel="prefetch" href="/myblog/assets/index.html.5589fc08.js"><link rel="prefetch" href="/myblog/assets/index.html.f989be9b.js"><link rel="prefetch" href="/myblog/assets/index.html.9f0a51f1.js"><link rel="prefetch" href="/myblog/assets/index.html.49bd673c.js"><link rel="prefetch" href="/myblog/assets/index.html.f1449990.js"><link rel="prefetch" href="/myblog/assets/index.html.b063a78e.js"><link rel="prefetch" href="/myblog/assets/index.html.3f40e5f3.js"><link rel="prefetch" href="/myblog/assets/index.html.56c44de1.js"><link rel="prefetch" href="/myblog/assets/index.html.f8a7efd0.js"><link rel="prefetch" href="/myblog/assets/index.html.c2db4fad.js"><link rel="prefetch" href="/myblog/assets/404.d0d6ec4e.js"><link rel="prefetch" href="/myblog/assets/Layout.4e3e5e78.js"><link rel="prefetch" href="/myblog/assets/Slide.81c38424.js"><link rel="prefetch" href="/myblog/assets/Blog.d28c723c.js"><link rel="prefetch" href="/myblog/assets/auto.264f6c8c.js"><link rel="prefetch" href="/myblog/assets/index.d8a59108.js"><link rel="prefetch" href="/myblog/assets/index.1842ee54.js"><link rel="prefetch" href="/myblog/assets/mermaid.esm.min.fac286bf.js"><link rel="prefetch" href="/myblog/assets/highlight.esm.d982e650.js"><link rel="prefetch" href="/myblog/assets/markdown.esm.832a189d.js"><link rel="prefetch" href="/myblog/assets/math.esm.a3f84b6f.js"><link rel="prefetch" href="/myblog/assets/notes.esm.3c361cb7.js"><link rel="prefetch" href="/myblog/assets/reveal.esm.b96f05d8.js"><link rel="prefetch" href="/myblog/assets/search.esm.80da4a02.js"><link rel="prefetch" href="/myblog/assets/zoom.esm.8514a202.js"><link rel="prefetch" href="/myblog/assets/Playground.c4bd3c9e.js"><link rel="prefetch" href="/myblog/assets/photoswipe.esm.218074cd.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/myblog/" class="brand"><img class="logo" src="/myblog/avatar.jpg" alt="tt110617"><!----><span class="site-name hide-in-pad">tt110617</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/myblog/" class="nav-link" aria-label="é¦–é¡µ"><span class="icon iconfont icon-home"></span>é¦–é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/myblog/backend/" class="nav-link active" aria-label="åç«¯"><span class="icon iconfont icon-java"></span>åç«¯<!----></a></div><div class="nav-item hide-in-mobile"><a href="/myblog/frontend/" class="nav-link" aria-label="å‰ç«¯"><span class="icon iconfont icon-vue"></span>å‰ç«¯<!----></a></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/tt110617" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><form class="search-box" role="search"><input type="search" placeholder="æœç´¢" autocomplete="off" spellcheck="false" value><!----></form><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-java"></span><span class="title">Java</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><img class="icon" src="/myblog/icon/gaoxingneng.png"><span class="title">é«˜æ€§èƒ½</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/myblog/backend/high-performance/nginx.html" class="nav-link sidebar-link sidebar-page" aria-label="Nginx"><span class="icon iconfont icon-nginx"></span>Nginx<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/myblog/backend/high-performance/Docker.html" class="nav-link sidebar-link sidebar-page" aria-label="DockeråŸºç¡€ç¯‡"><img class="icon" src="/myblog/icon/docker.png">DockeråŸºç¡€ç¯‡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="ElasticSearch"><span class="icon iconfont icon-search"></span>ElasticSearch<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_1-elasticsearch-å…¨æ–‡æ£€ç´¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.ElasticSearch-å…¨æ–‡æ£€ç´¢"><!---->1.ElasticSearch-å…¨æ–‡æ£€ç´¢<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_1ã€å®‰è£…elastic-search" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1ã€å®‰è£…elastic search"><!---->1ã€å®‰è£…elastic search<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_2ã€åˆæ­¥æ£€ç´¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2ã€åˆæ­¥æ£€ç´¢"><!---->2ã€åˆæ­¥æ£€ç´¢<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_3ã€æ£€ç´¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3ã€æ£€ç´¢"><!---->3ã€æ£€ç´¢<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_4ã€elasticsearch-rest-client" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4ã€elasticsearch-Rest-Client"><!---->4ã€elasticsearch-Rest-Client<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_5ã€é™„å½•-å®‰è£…nginx" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5ã€é™„å½•ï¼šå®‰è£…Nginx"><!---->5ã€é™„å½•ï¼šå®‰è£…Nginx<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_2-springbootæ•´åˆelasticsearch" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.SpringBootæ•´åˆElasticSearch"><!---->2.SpringBootæ•´åˆElasticSearch<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_1ã€å¯¼å…¥ä¾èµ–" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1ã€å¯¼å…¥ä¾èµ–"><!---->1ã€å¯¼å…¥ä¾èµ–<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_2ã€ç¼–å†™æµ‹è¯•ç±»" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2ã€ç¼–å†™æµ‹è¯•ç±»"><!---->2ã€ç¼–å†™æµ‹è¯•ç±»<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><img class="icon" src="/myblog/icon/xiaoxiduilie.png"><span class="title">æ¶ˆæ¯é˜Ÿåˆ—</span><span class="arrow right"></span></button><!----></section><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-computer"></span><span class="title">è®¡ç®—æœºåŸºç¡€</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-frame"></span><span class="title">æ¡†æ¶</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><img class="icon" src="/myblog/icon/odbc-full.png"><span class="title">æ•°æ®åº“</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-snow"></span><span class="title">ç®—æ³•</span><span class="arrow right"></span></button><!----></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="icon iconfont icon-search"></span>ElasticSearch</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down" localizeddate="2022å¹´8æœˆ16æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="/myblog/article/" target="_blank" rel="noopener noreferrer">åä¸€</a></span><span property="author" content="åä¸€"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022å¹´8æœˆ16æ—¥</span><meta property="datePublished" content="2022-08-16T00:00:00.000Z"></span><!----><span aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down" localizeddate="2022å¹´8æœˆ16æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><ul class="tags-wrapper"><li class="tag tag6 clickable" role="navigation">é«˜æ€§èƒ½</li></ul><meta property="keywords" content="é«˜æ€§èƒ½"></span><span class="words-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="down" localizeddate="2022å¹´8æœˆ16æ—¥" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 11208 å­—</span><meta property="wordCount" content="11208"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_1-elasticsearch-å…¨æ–‡æ£€ç´¢" class="router-link-active router-link-exact-active toc-link level2">1.ElasticSearch-å…¨æ–‡æ£€ç´¢</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_1ã€å®‰è£…elastic-search" class="router-link-active router-link-exact-active toc-link level3">1ã€å®‰è£…elastic search</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_2ã€åˆæ­¥æ£€ç´¢" class="router-link-active router-link-exact-active toc-link level3">2ã€åˆæ­¥æ£€ç´¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_3ã€æ£€ç´¢" class="router-link-active router-link-exact-active toc-link level3">3ã€æ£€ç´¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_4ã€elasticsearch-rest-client" class="router-link-active router-link-exact-active toc-link level3">4ã€elasticsearch-Rest-Client</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_5ã€é™„å½•-å®‰è£…nginx" class="router-link-active router-link-exact-active toc-link level3">5ã€é™„å½•ï¼šå®‰è£…Nginx</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_2-springbootæ•´åˆelasticsearch" class="router-link-active router-link-exact-active toc-link level2">2.SpringBootæ•´åˆElasticSearch</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_1ã€å¯¼å…¥ä¾èµ–" class="router-link-active router-link-exact-active toc-link level3">1ã€å¯¼å…¥ä¾èµ–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/myblog/backend/high-performance/ElasticSearch.html#_2ã€ç¼–å†™æµ‹è¯•ç±»" class="router-link-active router-link-exact-active toc-link level3">2ã€ç¼–å†™æµ‹è¯•ç±»</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="elasticsearch" tabindex="-1"><a class="header-anchor" href="#elasticsearch" aria-hidden="true">#</a> ElasticSearch</h1><h2 id="_1-elasticsearch-å…¨æ–‡æ£€ç´¢" tabindex="-1"><a class="header-anchor" href="#_1-elasticsearch-å…¨æ–‡æ£€ç´¢" aria-hidden="true">#</a> 1.ElasticSearch-å…¨æ–‡æ£€ç´¢</h2><p>å…¨æ–‡æœç´¢å±äºæœ€å¸¸è§çš„éœ€æ±‚ï¼Œå¼€æºçš„ Elasticsearch æ˜¯ç›®å‰å…¨æ–‡æœç´¢å¼•æ“çš„é¦–é€‰ã€‚</p><p>å®ƒ<strong>å¯ä»¥å¿«é€Ÿåœ°å‚¨å­˜ã€æœç´¢å’Œåˆ†ææµ·é‡æ•°æ®</strong>ã€‚ç»´åŸºç™¾ç§‘ã€Stack Overflowã€Github éƒ½é‡‡ç”¨å®ƒ</p><p>lastic çš„åº•å±‚æ˜¯å¼€æºåº“ Luceneã€‚ä½†æ˜¯ï¼Œä½ æ²¡æ³•ç›´æ¥ç”¨ Luceneï¼Œå¿…é¡»è‡ªå·±å†™ä»£ç å»è°ƒç”¨å®ƒçš„æ¥å£ã€‚Elastic æ˜¯ Lucene çš„å°è£…ï¼Œæä¾›äº† REST API çš„æ“ä½œæ¥å£ï¼Œå¼€ç®±å³ç”¨ã€‚</p><p>REST APIï¼šå¤©ç„¶çš„è·¨å¹³å°ã€‚</p><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/elasticsearch/reference/current/index.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> å®˜æ–¹ä¸­æ–‡ï¼š<a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/foreword_id.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/cn/elasticsearch/guide/current/foreword_id.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ç¤¾åŒºä¸­æ–‡ï¼š <a href="https://es.xiaoleilu.com/index.html" target="_blank" rel="noopener noreferrer">https://es.xiaoleilu.com/index.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><a href="http://doc.codingdict.com/elasticsearch/0/" target="_blank" rel="noopener noreferrer">http://doc.codingdict.com/elasticsearch/0/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><blockquote><p>åŸºæœ¬æ¦‚å¿µ</p></blockquote><p>1ã€Indexï¼ˆç´¢å¼•ï¼‰</p><p>åŠ¨è¯ï¼Œç›¸å½“äºMySQL ä¸­çš„insertï¼›</p><p>åè¯ï¼Œç›¸å½“äºMySQL ä¸­çš„Database</p><p>2ã€Typeï¼ˆç±»å‹ï¼‰</p><p>åœ¨Indexï¼ˆç´¢å¼•ï¼‰ä¸­ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªç±»å‹ã€‚</p><p>ç±»ä¼¼äºMySQL ä¸­çš„Tableï¼›æ¯ä¸€ç§ç±»å‹çš„æ•°æ®æ”¾åœ¨ä¸€èµ·ï¼›</p><p>3ã€Documentï¼ˆæ–‡æ¡£ï¼‰</p><p>ä¿å­˜åœ¨æŸä¸ªç´¢å¼•ï¼ˆIndexï¼‰ä¸‹ï¼ŒæŸç§ç±»å‹ï¼ˆTypeï¼‰çš„ä¸€ä¸ªæ•°æ®ï¼ˆDocumentï¼‰ï¼Œæ–‡æ¡£æ˜¯ æ ¼å¼çš„ï¼ŒDocument å°±åƒæ˜¯ MySQL ä¸­çš„æŸä¸ª Table é‡Œé¢çš„å†…å®¹ï¼›</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220713153830043.png" alt="image-20220713153830043"></p><p>4ã€å€’æ’ç´¢å¼•æœºåˆ¶</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220713153848395.png" alt="image-20220713153848395"></p><h3 id="_1ã€å®‰è£…elastic-search" tabindex="-1"><a class="header-anchor" href="#_1ã€å®‰è£…elastic-search" aria-hidden="true">#</a> 1ã€å®‰è£…elastic search</h3><p>dokcerä¸­å®‰è£…elastic search</p><p>ï¼ˆ1ï¼‰ä¸‹è½½ealastic searchå’Œkibana</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> pull elasticsearch:7.6.2
<span class="token function">docker</span> pull kibana:7.6.2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ï¼ˆ2ï¼‰é…ç½®</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">mkdir</span> -p /mydata/elasticsearch/config  
<span class="token function">mkdir</span> -p /mydata/elasticsearch/data
<span class="token builtin class-name">echo</span> <span class="token string">&quot;http.host: 0.0.0.0&quot;</span> <span class="token operator">&gt;</span>/mydata/elasticsearch/config/elasticsearch.yml

//å°†mydata/elasticsearch/æ–‡ä»¶å¤¹ä¸­æ–‡ä»¶éƒ½å¯è¯»å¯å†™
<span class="token function">chmod</span> -R <span class="token number">777</span> /mydata/elasticsearch/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ï¼ˆ3ï¼‰å¯åŠ¨Elastic search</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run --name elasticsearch -p <span class="token number">9200</span>:9200 -p <span class="token number">9300</span>:9300 <span class="token punctuation">\</span>
-e  <span class="token string">&quot;discovery.type=single-node&quot;</span> <span class="token punctuation">\</span>
-e <span class="token assign-left variable">ES_JAVA_OPTS</span><span class="token operator">=</span><span class="token string">&quot;-Xms64m -Xmx512m&quot;</span> <span class="token punctuation">\</span>
-v /mydata/elasticsearch/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml <span class="token punctuation">\</span>
-v /mydata/elasticsearch/data:/usr/share/elasticsearch/data <span class="token punctuation">\</span>
-v  /mydata/elasticsearch/plugins:/usr/share/elasticsearch/plugins <span class="token punctuation">\</span>
-d elasticsearch:7.6.2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è®¾ç½®å¼€æœºå¯åŠ¨elasticsearch</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> update elasticsearch --restart<span class="token operator">=</span>always
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ï¼ˆ4ï¼‰å¯åŠ¨kibanaï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run --name kibana -e <span class="token assign-left variable">ELASTICSEARCH_HOSTS</span><span class="token operator">=</span>http://192.168.13.101:9200 -p <span class="token number">5601</span>:5601 -d kibana:7.6.2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è®¾ç½®å¼€æœºå¯åŠ¨kibana</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> update kibana  --restart<span class="token operator">=</span>always
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ï¼ˆ5ï¼‰æµ‹è¯•</p><p>æŸ¥çœ‹elasticsearchç‰ˆæœ¬ä¿¡æ¯ï¼š <a href="http://192.168.13.101:9200/" target="_blank" rel="noopener noreferrer">http://192.168.13.101:9200/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
    &quot;name&quot;: &quot;0adeb7852e00&quot;,
    &quot;cluster_name&quot;: &quot;elasticsearch&quot;,
    &quot;cluster_uuid&quot;: &quot;9gglpP0HTfyOTRAaSe2rIg&quot;,
    &quot;version&quot;: {
        &quot;number&quot;: &quot;7.6.2&quot;,
        &quot;build_flavor&quot;: &quot;default&quot;,
        &quot;build_type&quot;: &quot;docker&quot;,
        &quot;build_hash&quot;: &quot;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&quot;,
        &quot;build_date&quot;: &quot;2020-03-26T06:34:37.794943Z&quot;,
        &quot;build_snapshot&quot;: false,
        &quot;lucene_version&quot;: &quot;8.4.0&quot;,
        &quot;minimum_wire_compatibility_version&quot;: &quot;6.8.0&quot;,
        &quot;minimum_index_compatibility_version&quot;: &quot;6.0.0-beta1&quot;
    },
    &quot;tagline&quot;: &quot;You Know, for Search&quot;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ˜¾ç¤ºelasticsearch èŠ‚ç‚¹ä¿¡æ¯<a href="http://192.168.13.101:9200/_cat/nodes" target="_blank" rel="noopener noreferrer">http://192.168.13.101:9200/_cat/nodes<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ï¼Œ</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>127.0.0.1 76 95 1 0.26 1.40 1.22 dilm * 0adeb7852e00
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è®¿é—®Kibanaï¼š <a href="http://192.168.13.101:5601/app/kibana" target="_blank" rel="noopener noreferrer">http://192.168.13.101:5601/app/kibana<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501192629304.png" alt="image-20200501192629304"></p><h3 id="_2ã€åˆæ­¥æ£€ç´¢" tabindex="-1"><a class="header-anchor" href="#_2ã€åˆæ­¥æ£€ç´¢" aria-hidden="true">#</a> 2ã€åˆæ­¥æ£€ç´¢</h3><h4 id="_1-cat" tabindex="-1"><a class="header-anchor" href="#_1-cat" aria-hidden="true">#</a> 1ï¼‰_CAT</h4><p>ï¼ˆ1ï¼‰GET /_cat/nodesï¼šæŸ¥çœ‹æ‰€æœ‰èŠ‚ç‚¹</p><p>å¦‚ï¼š<a href="http://192.168.13.101:9200/_cat/nodes" target="_blank" rel="noopener noreferrer">http://192.168.13.101:9200/_cat/nodes<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> :</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>127.0.0.1 61 91 11 0.08 0.49 0.87 dilm * 0adeb7852e00
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ³¨ï¼š*è¡¨ç¤ºé›†ç¾¤ä¸­çš„ä¸»èŠ‚ç‚¹</p><p>ï¼ˆ2ï¼‰GET/_cat/healthï¼šæŸ¥çœ‹eså¥åº·çŠ¶å†µ</p><p>å¦‚ï¼š<a href="http://192.168.13.101:9200/_cat/health" target="_blank" rel="noopener noreferrer">http://192.168.13.101:9200/_cat/health<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>1588332616 11:30:16 elasticsearch green 1 1 3 3 0 0 0 0 - 100.0%
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ³¨ï¼šgreenè¡¨ç¤ºå¥åº·å€¼æ­£å¸¸</p><p>ï¼ˆ3ï¼‰GET/_cat/masterï¼šæŸ¥çœ‹ä¸»èŠ‚ç‚¹ä¿¡æ¯</p><p>å¦‚ï¼š <a href="http://192.168.13.101:9200/_cat/master" target="_blank" rel="noopener noreferrer">http://192.168.13.101:9200/_cat/master<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>vfpgxbusTC6-W3C2Np31EQ 127.0.0.1 127.0.0.1 0adeb7852e00
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ï¼ˆ4ï¼‰GET/_cat/indiciesï¼šæŸ¥çœ‹æ‰€æœ‰ç´¢å¼• ï¼Œç­‰ä»·äºmysqlæ•°æ®åº“çš„show databases;</p><p>å¦‚ï¼š <a href="http://192.168.13.101:9200/_cat/indices" target="_blank" rel="noopener noreferrer">http://192.168.13.101:9200/_cat/indices<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>green open .kibana_task_manager_1   KWLtjcKRRuaV9so_v15WYg 1 0 2 0 39.8kb 39.8kb
green open .apm-agent-configuration cuwCpJ5ER0OYsSgAJ7bVYA 1 0 0 0   283b   283b
green open .kibana_1                PqK_LdUYRpWMy4fK0tMSPw 1 0 7 0 31.2kb 31.2kb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-ç´¢å¼•ä¸€ä¸ªæ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#_2-ç´¢å¼•ä¸€ä¸ªæ–‡æ¡£" aria-hidden="true">#</a> 2ï¼‰ç´¢å¼•ä¸€ä¸ªæ–‡æ¡£</h4><p>ä¿å­˜ä¸€ä¸ªæ•°æ®ï¼Œä¿å­˜åœ¨å“ªä¸ªç´¢å¼•çš„å“ªä¸ªç±»å‹ä¸‹ï¼ŒæŒ‡å®šç”¨é‚£ä¸ªå”¯ä¸€æ ‡è¯† PUT customer/external/1; åœ¨customerç´¢å¼•ä¸‹çš„externalç±»å‹ä¸‹ä¿å­˜1å·æ•°æ®ä¸º</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>PUT customer/external/1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
 &quot;name&quot;:&quot;John Doe&quot;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>PUTå’ŒPOSTéƒ½å¯ä»¥</p><p>POSTæ–°å¢ã€‚å¦‚æœä¸æŒ‡å®šidï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆidã€‚æŒ‡å®šidå°±ä¼šä¿®æ”¹è¿™ä¸ªæ•°æ®ï¼Œå¹¶æ–°å¢ç‰ˆæœ¬å·ï¼›</p><p>PUTå¯ä»¥æ–°å¢ä¹Ÿå¯ä»¥ä¿®æ”¹ã€‚PUTå¿…é¡»æŒ‡å®šidï¼›ç”±äºPUTéœ€è¦æŒ‡å®šidï¼Œæˆ‘ä»¬ä¸€èˆ¬ç”¨æ¥åšä¿®æ”¹æ“ä½œï¼Œä¸æŒ‡å®šidä¼šæŠ¥é”™ã€‚</p><p>ä¸‹é¢æ˜¯åœ¨postmanä¸­çš„æµ‹è¯•æ•°æ®ï¼š <img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501194449944.png" alt="image-20200501194449944"></p><p>åˆ›å»ºæ•°æ®æˆåŠŸåï¼Œæ˜¾ç¤º201 createdè¡¨ç¤ºæ’å…¥è®°å½•æˆåŠŸã€‚</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
    &quot;_index&quot;: &quot;customer&quot;,
    &quot;_type&quot;: &quot;external&quot;,
    &quot;_id&quot;: &quot;1&quot;,
    &quot;_version&quot;: 1,
    &quot;result&quot;: &quot;created&quot;,
    &quot;_shards&quot;: {
        &quot;total&quot;: 2,
        &quot;successful&quot;: 1,
        &quot;failed&quot;: 0
    },
    &quot;_seq_no&quot;: 0,
    &quot;_primary_term&quot;: 1
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™äº›è¿”å›çš„ä¸²çš„å«ä¹‰ï¼›è¿™äº›å¸¦æœ‰ä¸‹åˆ’çº¿å¼€å¤´çš„ï¼Œç§°ä¸ºå…ƒæ•°æ®ï¼Œåæ˜ äº†å½“å‰çš„åŸºæœ¬ä¿¡æ¯ã€‚</p><p>&quot;_index&quot;: &quot;customer&quot; è¡¨æ˜è¯¥æ•°æ®åœ¨å“ªä¸ªç´¢å¼•ä¸‹ï¼›</p><p>&quot;_type&quot;: &quot;external&quot; è¡¨æ˜è¯¥æ•°æ®åœ¨å“ªä¸ªç±»å‹ä¸‹ï¼›</p><p>&quot;_id&quot;: &quot;1&quot; è¡¨æ˜è¢«ä¿å­˜æ•°æ®çš„idï¼›</p><p>&quot;_version&quot;: 1, è¢«ä¿å­˜æ•°æ®çš„ç‰ˆæœ¬</p><p>&quot;result&quot;: &quot;created&quot; è¿™é‡Œæ˜¯åˆ›å»ºäº†ä¸€æ¡æ•°æ®ï¼Œå¦‚æœé‡æ–°putä¸€æ¡æ•°æ®ï¼Œåˆ™è¯¥çŠ¶æ€ä¼šå˜ä¸ºupdatedï¼Œå¹¶ä¸”ç‰ˆæœ¬å·ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚</p><p>ä¸‹é¢é€‰ç”¨POSTæ–¹å¼ï¼š</p><p>æ·»åŠ æ•°æ®çš„æ—¶å€™ï¼Œä¸æŒ‡å®šIDï¼Œä¼šè‡ªåŠ¨çš„ç”Ÿæˆidï¼Œå¹¶ä¸”ç±»å‹æ˜¯æ–°å¢ï¼š</p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501195619925.png" alt="image-20200501195619925" style="zoom:52%;"><p>å†æ¬¡ä½¿ç”¨POSTæ’å…¥æ•°æ®ï¼Œä»ç„¶æ˜¯æ–°å¢çš„ï¼š</p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501195732492.png" alt="image-20200501195732492" style="zoom:80%;"><p>æ·»åŠ æ•°æ®çš„æ—¶å€™ï¼ŒæŒ‡å®šIDï¼Œä¼šä½¿ç”¨è¯¥idï¼Œå¹¶ä¸”ç±»å‹æ˜¯æ–°å¢ï¼š</p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501200048361.png" alt="image-20200501200048361" style="zoom:66%;"><p>å†æ¬¡ä½¿ç”¨POSTæ’å…¥æ•°æ®ï¼Œç±»å‹ä¸ºupdated</p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501200132199.png" alt="image-20200501200132199" style="zoom:67%;"><h4 id="_3-æŸ¥çœ‹æ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#_3-æŸ¥çœ‹æ–‡æ¡£" aria-hidden="true">#</a> 3ï¼‰æŸ¥çœ‹æ–‡æ¡£</h4><p>GET /customer/external/1</p><p><a href="http://192.168.13.101:9200/customer/external/1" target="_blank" rel="noopener noreferrer">http://192.168.13.101:9200/customer/external/1<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
    &quot;_index&quot;: &quot;customer&quot;,//åœ¨å“ªä¸ªç´¢å¼•
    &quot;_type&quot;: &quot;external&quot;,//åœ¨å“ªä¸ªç±»å‹
    &quot;_id&quot;: &quot;1&quot;,//è®°å½•id
    &quot;_version&quot;: 3,//ç‰ˆæœ¬å·
    &quot;_seq_no&quot;: 6,//å¹¶å‘æ§åˆ¶å­—æ®µï¼Œæ¯æ¬¡æ›´æ–°éƒ½ä¼š+1ï¼Œç”¨æ¥åšä¹è§‚é”
    &quot;_primary_term&quot;: 1,//åŒä¸Šï¼Œä¸»åˆ†ç‰‡é‡æ–°åˆ†é…ï¼Œå¦‚é‡å¯ï¼Œå°±ä¼šå˜åŒ–
    &quot;found&quot;: true,
    &quot;_source&quot;: {
        &quot;name&quot;: &quot;John Doe&quot;
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡â€œif_seq_no=1&amp;if_primary_term=1 â€ï¼Œå½“åºåˆ—å·åŒ¹é…çš„æ—¶å€™ï¼Œæ‰è¿›è¡Œä¿®æ”¹ï¼Œå¦åˆ™ä¸ä¿®æ”¹ã€‚</p><p>å®ä¾‹ï¼šå°†id=1çš„æ•°æ®æ›´æ–°ä¸ºname=1ï¼Œç„¶åå†æ¬¡æ›´æ–°ä¸ºname=2ï¼Œèµ·å§‹_seq_no=6ï¼Œ_primary_term=1</p><p>ï¼ˆ1ï¼‰å°†nameæ›´æ–°ä¸º1</p><p><a href="http://192.168.13.101:9200/customer/external/1?if_seq_no=1&amp;if_primary_term=1" target="_blank" rel="noopener noreferrer">http://192.168.13.101:9200/customer/external/1?if_seq_no=1&amp;if_primary_term=1<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501212224983.png" alt="image-20200501212224983" style="zoom:61%;"><p>ï¼ˆ2ï¼‰å°†nameæ›´æ–°ä¸º2ï¼Œæ›´æ–°è¿‡ç¨‹ä¸­ä½¿ç”¨seq_no=6</p><p><a href="http://192.168.13.101:9200/customer/external/1?if_seq_no=6&amp;if_primary_term=1" target="_blank" rel="noopener noreferrer">http://192.168.13.101:9200/customer/external/1?if_seq_no=6&amp;if_primary_term=1<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501213047499.png" alt="image-20200501213047499" style="zoom:60%;"><p>å‡ºç°æ›´æ–°é”™è¯¯ã€‚</p><p>ï¼ˆ3ï¼‰æŸ¥è¯¢æ–°çš„æ•°æ®</p><p><a href="http://192.168.13.101:9200/customer/external/1" target="_blank" rel="noopener noreferrer">http://192.168.13.101:9200/customer/external/1<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501212924094.png" alt="image-20200501212924094"></p><p>èƒ½å¤Ÿçœ‹åˆ°_seq_noå˜ä¸º7ã€‚</p><p>ï¼ˆ4ï¼‰å†æ¬¡æ›´æ–°ï¼Œæ›´æ–°æˆåŠŸ</p><p><a href="http://192.168.13.101:9200/customer/external/1?if_seq_no=7&amp;if_primary_term=1" target="_blank" rel="noopener noreferrer">http://192.168.13.101:9200/customer/external/1?if_seq_no=7&amp;if_primary_term=1<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501213130001.png" alt="image-20200501213130001" style="zoom:75%;"><h4 id="_4-æ›´æ–°æ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#_4-æ›´æ–°æ–‡æ¡£" aria-hidden="true">#</a> 4ï¼‰æ›´æ–°æ–‡æ¡£</h4><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501214522818.png" alt="image-20200501214522818"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501215746139.png" alt="image-20200501215746139"></p><p>ï¼ˆ1ï¼‰POSTæ›´æ–°æ–‡æ¡£ï¼Œå¸¦æœ‰_update</p><p><a href="http://192.168.13.101:9200/customer/external/1/_update" target="_blank" rel="noopener noreferrer">http://192.168.13.101:9200/customer/external/1/_update<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501214810741.png" alt="image-20200501214810741"></p><p>å¦‚æœå†æ¬¡æ‰§è¡Œæ›´æ–°ï¼Œåˆ™ä¸æ‰§è¡Œä»»ä½•æ“ä½œï¼Œåºåˆ—å·ä¹Ÿä¸å‘ç”Ÿå˜åŒ–</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501214912607.png" alt="image-20200501214912607"></p><p>POSTæ›´æ–°æ–¹å¼ï¼Œä¼šå¯¹æ¯”åŸæ¥çš„æ•°æ®ï¼Œå’ŒåŸæ¥çš„ç›¸åŒï¼Œåˆ™ä¸æ‰§è¡Œä»»ä½•æ“ä½œï¼ˆversionå’Œ_seq_noï¼‰éƒ½ä¸å˜ã€‚</p><p>ï¼ˆ2ï¼‰POSTæ›´æ–°æ–‡æ¡£ï¼Œä¸å¸¦_update</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501215358666.png" alt="image-20200501215358666"></p><p>åœ¨æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œé‡å¤æ‰§è¡Œæ›´æ–°æ“ä½œï¼Œæ•°æ®ä¹Ÿèƒ½å¤Ÿæ›´æ–°æˆåŠŸï¼Œä¸ä¼šå’ŒåŸæ¥çš„æ•°æ®è¿›è¡Œå¯¹æ¯”ã€‚</p><h4 id="_5-åˆ é™¤æ–‡æ¡£æˆ–ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_5-åˆ é™¤æ–‡æ¡£æˆ–ç´¢å¼•" aria-hidden="true">#</a> 5ï¼‰åˆ é™¤æ–‡æ¡£æˆ–ç´¢å¼•</h4><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>DELETE customer/external/1
DELETE customer
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨ï¼šelasticsearchå¹¶æ²¡æœ‰æä¾›åˆ é™¤ç±»å‹çš„æ“ä½œï¼Œåªæä¾›äº†åˆ é™¤ç´¢å¼•å’Œæ–‡æ¡£çš„æ“ä½œã€‚</p><p>å®ä¾‹ï¼šåˆ é™¤id=1çš„æ•°æ®ï¼Œåˆ é™¤åç»§ç»­æŸ¥è¯¢</p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501220559094.png" alt="image-20200501220559094" style="zoom:67%;"><p>å®ä¾‹ï¼šåˆ é™¤æ•´ä¸ªcostomerç´¢å¼•æ•°æ®</p><p>åˆ é™¤å‰ï¼Œæ‰€æœ‰çš„ç´¢å¼•</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>green  open .kibana_task_manager_1   KWLtjcKRRuaV9so_v15WYg 1 0 2 0 39.8kb 39.8kb
green  open .apm-agent-configuration cuwCpJ5ER0OYsSgAJ7bVYA 1 0 0 0   283b   283b
green  open .kibana_1                PqK_LdUYRpWMy4fK0tMSPw 1 0 7 0 31.2kb 31.2kb
yellow open customer                 nzDYCdnvQjSsapJrAIT8Zw 1 1 4 0  4.4kb  4.4kb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ é™¤â€œ customer â€ç´¢å¼•</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501221105476.png" alt="image-20200501221105476"></p><p>åˆ é™¤åï¼Œæ‰€æœ‰çš„ç´¢å¼•</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>green  open .kibana_task_manager_1   KWLtjcKRRuaV9so_v15WYg 1 0 2 0 39.8kb 39.8kb
green  open .apm-agent-configuration cuwCpJ5ER0OYsSgAJ7bVYA 1 0 0 0   283b   283b
green  open .kibana_1                PqK_LdUYRpWMy4fK0tMSPw 1 0 7 0 31.2kb 31.2kb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6-eleasticsearchçš„æ‰¹é‡æ“ä½œâ€”â€”bulk" tabindex="-1"><a class="header-anchor" href="#_6-eleasticsearchçš„æ‰¹é‡æ“ä½œâ€”â€”bulk" aria-hidden="true">#</a> 6ï¼‰eleasticsearchçš„æ‰¹é‡æ“ä½œâ€”â€”bulk</h4><p>è¯­æ³•æ ¼å¼ï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{action:{metadata}}\n   //ä¾‹å¦‚indexä¿å­˜è®°å½•ï¼Œupdateæ›´æ–°
{request body  }\n

{action:{metadata}}\n
{request body  }\n
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œçš„æ‰¹é‡æ“ä½œï¼Œå½“å‘ç”ŸæŸä¸€æ¡æ‰§è¡Œå‘ç”Ÿå¤±è´¥æ—¶ï¼Œå…¶ä»–çš„æ•°æ®ä»ç„¶èƒ½å¤Ÿæ¥ç€æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´å½¼æ­¤ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ã€‚</p><p>bulk apiä»¥æ­¤æŒ‰é¡ºåºæ‰§è¡Œæ‰€æœ‰çš„actionï¼ˆåŠ¨ä½œï¼‰ã€‚å¦‚æœä¸€ä¸ªå•ä¸ªçš„åŠ¨ä½œå› ä»»ä½•åŸå› å¤±è´¥ï¼Œå®ƒå°†ç»§ç»­å¤„ç†å®ƒåé¢å‰©ä½™çš„åŠ¨ä½œã€‚å½“bulk apiè¿”å›æ—¶ï¼Œå®ƒå°†æä¾›æ¯ä¸ªåŠ¨ä½œçš„çŠ¶æ€ï¼ˆä¸å‘é€çš„é¡ºåºç›¸åŒï¼‰ï¼Œæ‰€ä»¥æ‚¨å¯ä»¥æ£€æŸ¥æ˜¯å¦ä¸€ä¸ªæŒ‡å®šçš„åŠ¨ä½œæ˜¯å¦å¤±è´¥äº†ã€‚</p><p>å®ä¾‹1: æ‰§è¡Œå¤šæ¡æ•°æ® (postman æŠ¥é”™ï¼Œåœ¨kibanaä¸­çš„Dev_toolsä¸­æ‰§è¡Œ)</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>POST /customer/external/_bulk
{&quot;index&quot;:{&quot;_id&quot;:&quot;1&quot;}}
{&quot;name&quot;:&quot;John Doe&quot;}
{&quot;index&quot;:{&quot;_id&quot;:&quot;2&quot;}}
{&quot;name&quot;:&quot;John Doe&quot;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œç»“æœ</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>#! Deprecation: [types removal] Specifying types in bulk requests is deprecated.
{
  &quot;took&quot; : 491,
  &quot;errors&quot; : false,
  &quot;items&quot; : [
    {
      &quot;index&quot; : {
        &quot;_index&quot; : &quot;customer&quot;,
        &quot;_type&quot; : &quot;external&quot;,
        &quot;_id&quot; : &quot;1&quot;,
        &quot;_version&quot; : 1,
        &quot;result&quot; : &quot;created&quot;,
        &quot;_shards&quot; : {
          &quot;total&quot; : 2,
          &quot;successful&quot; : 1,
          &quot;failed&quot; : 0
        },
        &quot;_seq_no&quot; : 0,
        &quot;_primary_term&quot; : 1,
        &quot;status&quot; : 201
      }
    },
    {
      &quot;index&quot; : {
        &quot;_index&quot; : &quot;customer&quot;,
        &quot;_type&quot; : &quot;external&quot;,
        &quot;_id&quot; : &quot;2&quot;,
        &quot;_version&quot; : 1,
        &quot;result&quot; : &quot;created&quot;,
        &quot;_shards&quot; : {
          &quot;total&quot; : 2,
          &quot;successful&quot; : 1,
          &quot;failed&quot; : 0
        },
        &quot;_seq_no&quot; : 1,
        &quot;_primary_term&quot; : 1,
        &quot;status&quot; : 201
      }
    }
  ]
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®ä¾‹2ï¼šå¯¹äºæ•´ä¸ªç´¢å¼•æ‰§è¡Œæ‰¹é‡æ“ä½œ</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>POST /_bulk
{&quot;delete&quot;:{&quot;_index&quot;:&quot;website&quot;,&quot;_type&quot;:&quot;blog&quot;,&quot;_id&quot;:&quot;123&quot;}}
{&quot;create&quot;:{&quot;_index&quot;:&quot;website&quot;,&quot;_type&quot;:&quot;blog&quot;,&quot;_id&quot;:&quot;123&quot;}}
{&quot;title&quot;:&quot;my first blog post&quot;}
{&quot;index&quot;:{&quot;_index&quot;:&quot;website&quot;,&quot;_type&quot;:&quot;blog&quot;}}
{&quot;title&quot;:&quot;my second blog post&quot;}
{&quot;update&quot;:{&quot;_index&quot;:&quot;website&quot;,&quot;_type&quot;:&quot;blog&quot;,&quot;_id&quot;:&quot;123&quot;}}
{&quot;doc&quot;:{&quot;title&quot;:&quot;my updated blog post&quot;}}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>#! Deprecation: [types removal] Specifying types in bulk requests is deprecated.
{
  &quot;took&quot; : 608,
  &quot;errors&quot; : false,
  &quot;items&quot; : [
    {
      &quot;delete&quot; : {
        &quot;_index&quot; : &quot;website&quot;,
        &quot;_type&quot; : &quot;blog&quot;,
        &quot;_id&quot; : &quot;123&quot;,
        &quot;_version&quot; : 1,
        &quot;result&quot; : &quot;not_found&quot;,
        &quot;_shards&quot; : {
          &quot;total&quot; : 2,
          &quot;successful&quot; : 1,
          &quot;failed&quot; : 0
        },
        &quot;_seq_no&quot; : 0,
        &quot;_primary_term&quot; : 1,
        &quot;status&quot; : 404
      }
    },
    {
      &quot;create&quot; : {
        &quot;_index&quot; : &quot;website&quot;,
        &quot;_type&quot; : &quot;blog&quot;,
        &quot;_id&quot; : &quot;123&quot;,
        &quot;_version&quot; : 2,
        &quot;result&quot; : &quot;created&quot;,
        &quot;_shards&quot; : {
          &quot;total&quot; : 2,
          &quot;successful&quot; : 1,
          &quot;failed&quot; : 0
        },
        &quot;_seq_no&quot; : 1,
        &quot;_primary_term&quot; : 1,
        &quot;status&quot; : 201
      }
    },
    {
      &quot;index&quot; : {
        &quot;_index&quot; : &quot;website&quot;,
        &quot;_type&quot; : &quot;blog&quot;,
        &quot;_id&quot; : &quot;MCOs0HEBHYK_MJXUyYIz&quot;,
        &quot;_version&quot; : 1,
        &quot;result&quot; : &quot;created&quot;,
        &quot;_shards&quot; : {
          &quot;total&quot; : 2,
          &quot;successful&quot; : 1,
          &quot;failed&quot; : 0
        },
        &quot;_seq_no&quot; : 2,
        &quot;_primary_term&quot; : 1,
        &quot;status&quot; : 201
      }
    },
    {
      &quot;update&quot; : {
        &quot;_index&quot; : &quot;website&quot;,
        &quot;_type&quot; : &quot;blog&quot;,
        &quot;_id&quot; : &quot;123&quot;,
        &quot;_version&quot; : 3,
        &quot;result&quot; : &quot;updated&quot;,
        &quot;_shards&quot; : {
          &quot;total&quot; : 2,
          &quot;successful&quot; : 1,
          &quot;failed&quot; : 0
        },
        &quot;_seq_no&quot; : 3,
        &quot;_primary_term&quot; : 1,
        &quot;status&quot; : 200
      }
    }
  ]
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7-æ ·æœ¬æµ‹è¯•æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_7-æ ·æœ¬æµ‹è¯•æ•°æ®" aria-hidden="true">#</a> 7ï¼‰æ ·æœ¬æµ‹è¯•æ•°æ®</h4><p>å‡†å¤‡äº†ä¸€ä»½é¡¾å®¢é“¶è¡Œè´¦æˆ·ä¿¡æ¯çš„è™šæ„çš„æ–‡æ¡£æ ·æœ¬ã€‚æ¯ä¸ªæ–‡æ¡£éƒ½æœ‰ä¸‹åˆ—çš„schemaï¼ˆæ¨¡å¼ï¼‰ã€‚</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
	&quot;account_number&quot;: 1,
	&quot;balance&quot;: 39225,
	&quot;firstname&quot;: &quot;Amber&quot;,
	&quot;lastname&quot;: &quot;Duke&quot;,
	&quot;age&quot;: 32,
	&quot;gender&quot;: &quot;M&quot;,
	&quot;address&quot;: &quot;880 Holmes Lane&quot;,
	&quot;employer&quot;: &quot;Pyrami&quot;,
	&quot;email&quot;: &quot;amberduke@pyrami.com&quot;,
	&quot;city&quot;: &quot;Brogan&quot;,
	&quot;state&quot;: &quot;IL&quot;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="https://gitee.com/xlh_blog/common_content/blob/master/es%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE" target="_blank" rel="noopener noreferrer">https://gitee.com/xlh_blog/common_content/blob/master/esæµ‹è¯•æ•°æ®<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>. ï¼Œå¯¼å…¥æµ‹è¯•æ•°æ®ï¼Œ</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>POST bank/account/_bulk
<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3ã€æ£€ç´¢" tabindex="-1"><a class="header-anchor" href="#_3ã€æ£€ç´¢" aria-hidden="true">#</a> 3ã€æ£€ç´¢</h3><h4 id="_1-search-api" tabindex="-1"><a class="header-anchor" href="#_1-search-api" aria-hidden="true">#</a> 1ï¼‰search Api</h4><p>ESæ”¯æŒä¸¤ç§åŸºæœ¬æ–¹å¼æ£€ç´¢ï¼›</p><ul><li>é€šè¿‡REST request uri å‘é€æœç´¢å‚æ•° ï¼ˆuri +æ£€ç´¢å‚æ•°ï¼‰ï¼›</li><li>é€šè¿‡REST request body æ¥å‘é€å®ƒä»¬ï¼ˆuri+è¯·æ±‚ä½“ï¼‰ï¼›</li></ul><p>ä¿¡æ¯æ£€ç´¢</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200501233938697.png" alt="image-20200501233938697"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200502000221422.png" alt=""></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200502000733594.png" alt="image-20200502000733594"></p><p>uri+è¯·æ±‚ä½“è¿›è¡Œæ£€ç´¢</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET /bank/_search
{
  &quot;query&quot;: { &quot;match_all&quot;: {} },
  &quot;sort&quot;: [
    { &quot;account_number&quot;: &quot;asc&quot; },
    {&quot;balance&quot;:&quot;desc&quot;}
  ]
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>HTTPå®¢æˆ·ç«¯å·¥å…·ï¼ˆï¼‰ï¼Œgetè¯·æ±‚ä¸èƒ½å¤Ÿæºå¸¦è¯·æ±‚ä½“ï¼Œ</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>GET bank<span class="token operator">/</span>_search<span class="token operator">?</span>q<span class="token operator">=</span><span class="token operator">*</span><span class="token operator">&amp;</span>sort<span class="token operator">=</span>account_number<span class="token operator">:</span>asc
<span class="token comment">//q=* æŸ¥è¯¢æ‰€æœ‰ï¼Œsort=account_number:asc æŒ‰ç…§account_numberè¿›è¡Œascå‡åºæ’åˆ—sort</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿”å›ç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 235,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 1000,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : null,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;0&quot;,
        &quot;_score&quot; : null,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 0,
          &quot;balance&quot; : 16623,
          &quot;firstname&quot; : &quot;Bradshaw&quot;,
          &quot;lastname&quot; : &quot;Mckenzie&quot;,
          &quot;age&quot; : 29,
          &quot;gender&quot; : &quot;F&quot;,
          &quot;address&quot; : &quot;244 Columbus Place&quot;,
          &quot;employer&quot; : &quot;Euron&quot;,
          &quot;email&quot; : &quot;bradshawmckenzie@euron.com&quot;,
          &quot;city&quot; : &quot;Hobucken&quot;,
          &quot;state&quot; : &quot;CO&quot;
        },
        &quot;sort&quot; : [
          0
        ]
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;1&quot;,
        &quot;_score&quot; : null,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 1,
          &quot;balance&quot; : 39225,
          &quot;firstname&quot; : &quot;Amber&quot;,
          &quot;lastname&quot; : &quot;Duke&quot;,
          &quot;age&quot; : 32,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;880 Holmes Lane&quot;,
          &quot;employer&quot; : &quot;Pyrami&quot;,
          &quot;email&quot; : &quot;amberduke@pyrami.com&quot;,
          &quot;city&quot; : &quot;Brogan&quot;,
          &quot;state&quot; : &quot;IL&quot;
        },
        &quot;sort&quot; : [
          1
        ]
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;2&quot;,
        &quot;_score&quot; : null,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 2,
          &quot;balance&quot; : 28838,
          &quot;firstname&quot; : &quot;Roberta&quot;,
          &quot;lastname&quot; : &quot;Bender&quot;,
          &quot;age&quot; : 22,
          &quot;gender&quot; : &quot;F&quot;,
          &quot;address&quot; : &quot;560 Kingsway Place&quot;,
          &quot;employer&quot; : &quot;Chillium&quot;,
          &quot;email&quot; : &quot;robertabender@chillium.com&quot;,
          &quot;city&quot; : &quot;Bennett&quot;,
          &quot;state&quot; : &quot;LA&quot;
        },
        &quot;sort&quot; : [
          2
        ]
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;3&quot;,
        &quot;_score&quot; : null,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 3,
          &quot;balance&quot; : 44947,
          &quot;firstname&quot; : &quot;Levine&quot;,
          &quot;lastname&quot; : &quot;Burks&quot;,
          &quot;age&quot; : 26,
          &quot;gender&quot; : &quot;F&quot;,
          &quot;address&quot; : &quot;328 Wilson Avenue&quot;,
          &quot;employer&quot; : &quot;Amtap&quot;,
          &quot;email&quot; : &quot;levineburks@amtap.com&quot;,
          &quot;city&quot; : &quot;Cochranville&quot;,
          &quot;state&quot; : &quot;HI&quot;
        },
        &quot;sort&quot; : [
          3
        ]
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;4&quot;,
        &quot;_score&quot; : null,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 4,
          &quot;balance&quot; : 27658,
          &quot;firstname&quot; : &quot;Rodriquez&quot;,
          &quot;lastname&quot; : &quot;Flores&quot;,
          &quot;age&quot; : 31,
          &quot;gender&quot; : &quot;F&quot;,
          &quot;address&quot; : &quot;986 Wyckoff Avenue&quot;,
          &quot;employer&quot; : &quot;Tourmania&quot;,
          &quot;email&quot; : &quot;rodriquezflores@tourmania.com&quot;,
          &quot;city&quot; : &quot;Eastvale&quot;,
          &quot;state&quot; : &quot;HI&quot;
        },
        &quot;sort&quot; : [
          4
        ]
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;5&quot;,
        &quot;_score&quot; : null,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 5,
          &quot;balance&quot; : 29342,
          &quot;firstname&quot; : &quot;Leola&quot;,
          &quot;lastname&quot; : &quot;Stewart&quot;,
          &quot;age&quot; : 30,
          &quot;gender&quot; : &quot;F&quot;,
          &quot;address&quot; : &quot;311 Elm Place&quot;,
          &quot;employer&quot; : &quot;Diginetic&quot;,
          &quot;email&quot; : &quot;leolastewart@diginetic.com&quot;,
          &quot;city&quot; : &quot;Fairview&quot;,
          &quot;state&quot; : &quot;NJ&quot;
        },
        &quot;sort&quot; : [
          5
        ]
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;6&quot;,
        &quot;_score&quot; : null,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 6,
          &quot;balance&quot; : 5686,
          &quot;firstname&quot; : &quot;Hattie&quot;,
          &quot;lastname&quot; : &quot;Bond&quot;,
          &quot;age&quot; : 36,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;671 Bristol Street&quot;,
          &quot;employer&quot; : &quot;Netagy&quot;,
          &quot;email&quot; : &quot;hattiebond@netagy.com&quot;,
          &quot;city&quot; : &quot;Dante&quot;,
          &quot;state&quot; : &quot;TN&quot;
        },
        &quot;sort&quot; : [
          6
        ]
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;7&quot;,
        &quot;_score&quot; : null,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 7,
          &quot;balance&quot; : 39121,
          &quot;firstname&quot; : &quot;Levy&quot;,
          &quot;lastname&quot; : &quot;Richard&quot;,
          &quot;age&quot; : 22,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;820 Logan Street&quot;,
          &quot;employer&quot; : &quot;Teraprene&quot;,
          &quot;email&quot; : &quot;levyrichard@teraprene.com&quot;,
          &quot;city&quot; : &quot;Shrewsbury&quot;,
          &quot;state&quot; : &quot;MO&quot;
        },
        &quot;sort&quot; : [
          7
        ]
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;8&quot;,
        &quot;_score&quot; : null,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 8,
          &quot;balance&quot; : 48868,
          &quot;firstname&quot; : &quot;Jan&quot;,
          &quot;lastname&quot; : &quot;Burns&quot;,
          &quot;age&quot; : 35,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;699 Visitation Place&quot;,
          &quot;employer&quot; : &quot;Glasstep&quot;,
          &quot;email&quot; : &quot;janburns@glasstep.com&quot;,
          &quot;city&quot; : &quot;Wakulla&quot;,
          &quot;state&quot; : &quot;AZ&quot;
        },
        &quot;sort&quot; : [
          8
        ]
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;9&quot;,
        &quot;_score&quot; : null,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 9,
          &quot;balance&quot; : 24776,
          &quot;firstname&quot; : &quot;Opal&quot;,
          &quot;lastname&quot; : &quot;Meadows&quot;,
          &quot;age&quot; : 39,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;963 Neptune Avenue&quot;,
          &quot;employer&quot; : &quot;Cedward&quot;,
          &quot;email&quot; : &quot;opalmeadows@cedward.com&quot;,
          &quot;city&quot; : &quot;Olney&quot;,
          &quot;state&quot; : &quot;OH&quot;
        },
        &quot;sort&quot; : [
          9
        ]
      }
    ]
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ï¼ˆ1ï¼‰åªæœ‰9æ¡æ•°æ®ï¼Œè¿™æ˜¯å› ä¸ºå­˜åœ¨åˆ†é¡µæŸ¥è¯¢ï¼›</p><p>ï¼ˆ2ï¼‰è¯¦ç»†çš„å­—æ®µä¿¡æ¯ï¼Œå‚ç…§ï¼š <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/getting-started-search.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/elasticsearch/reference/current/getting-started-search.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><blockquote><p>The response also provides the following information about the search request:</p><ul><li><code>took</code> â€“ how long it took Elasticsearch to run the query, in milliseconds</li><li><code>timed_out</code> â€“ whether or not the search request timed out</li><li><code>_shards</code> â€“ how many shards were searched and a breakdown of how many shards succeeded, failed, or were skipped.</li><li><code>max_score</code> â€“ the score of the most relevant document found</li><li><code>hits.total.value</code> - how many matching documents were found</li><li><code>hits.sort</code> - the documentâ€™s sort position (when not sorting by relevance score)</li><li><code>hits._score</code> - the documentâ€™s relevance score (not applicable when using <code>match_all</code>)</li></ul></blockquote><h4 id="_2-query-dsl" tabindex="-1"><a class="header-anchor" href="#_2-query-dsl" aria-hidden="true">#</a> 2ï¼‰Query DSL</h4><h5 id="_1-åŸºæœ¬è¯­æ³•æ ¼å¼" tabindex="-1"><a class="header-anchor" href="#_1-åŸºæœ¬è¯­æ³•æ ¼å¼" aria-hidden="true">#</a> ï¼ˆ1ï¼‰åŸºæœ¬è¯­æ³•æ ¼å¼</h5><p>Elasticsearchæä¾›äº†ä¸€ä¸ªå¯ä»¥æ‰§è¡ŒæŸ¥è¯¢çš„é£æ ¼çš„DSLã€‚è¿™ä¸ªè¢«ç§°ä¸ºQuery DSLï¼Œè¯¥æŸ¥è¯¢è¯­è¨€éå¸¸å…¨é¢ã€‚</p><p>ä¸€ä¸ªæŸ¥è¯¢è¯­å¥çš„å…¸å‹ç»“æ„</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>QUERY_NAME:{
   ARGUMENT:VALUE,
   ARGUMENT:VALUE,...
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœé’ˆå¯¹äºæŸä¸ªå­—æ®µï¼Œé‚£ä¹ˆå®ƒçš„ç»“æ„å¦‚ä¸‹ï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  QUERY_NAME:{
     FIELD_NAME:{
       ARGUMENT:VALUE,
       ARGUMENT:VALUE,...
      }   
   }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;match_all&quot;: {}
  },
  &quot;from&quot;: 0,
  &quot;size&quot;: 5,
  &quot;sort&quot;: [
    {
      &quot;account_number&quot;: {
        &quot;order&quot;: &quot;desc&quot;
      }
    }
  ]
}
//match_alæŸ¥è¯¢æ‰€æœ‰ï¼Œä»ç¬¬0ä¸ªæ•°æ®æ‹¿5ä¸ªæ•°æ®
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>queryå®šä¹‰å¦‚ä½•æŸ¥è¯¢ï¼›</p><ul><li>match_allæŸ¥è¯¢ç±»å‹ã€ä»£è¡¨æŸ¥è¯¢æ‰€æœ‰çš„æ‰€æœ‰ã€‘ï¼Œesä¸­å¯ä»¥åœ¨queryä¸­ç»„åˆéå¸¸å¤šçš„æŸ¥è¯¢ç±»å‹å®Œæˆå¤æ‚æŸ¥è¯¢ï¼›</li><li>é™¤äº†queryå‚æ•°ä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä¹Ÿä¼ é€’å…¶ä»–çš„å‚æ•°ä»¥æ”¹å˜æŸ¥è¯¢ç»“æœï¼Œå¦‚sortï¼Œsizeï¼›</li><li>from+sizeé™å®šï¼Œå®Œæˆåˆ†é¡µåŠŸèƒ½ï¼›</li><li>sortæ’åºï¼Œå¤šå­—æ®µæ’åºï¼Œä¼šåœ¨å‰åºå­—æ®µç›¸ç­‰æ—¶åç»­å­—æ®µå†…éƒ¨æ’åºï¼Œå¦åˆ™ä»¥å‰åºä¸ºå‡†ï¼›</li></ul><h5 id="_2-è¿”å›éƒ¨åˆ†å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#_2-è¿”å›éƒ¨åˆ†å­—æ®µ" aria-hidden="true">#</a> ï¼ˆ2ï¼‰è¿”å›éƒ¨åˆ†å­—æ®µ</h5><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;match_all&quot;: {}
  },
  &quot;from&quot;: 0,
  &quot;size&quot;: 5,
  &quot;sort&quot;: [
    {
      &quot;account_number&quot;: {
        &quot;order&quot;: &quot;desc&quot;
      }
    }
  ],
  &quot;_source&quot;: [&quot;balance&quot;,&quot;firstname&quot;]
  
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥è¯¢ç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 18,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 1000,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : null,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;999&quot;,
        &quot;_score&quot; : null,
        &quot;_source&quot; : {
          &quot;firstname&quot; : &quot;Dorothy&quot;,
          &quot;balance&quot; : 6087
        },
        &quot;sort&quot; : [
          999
        ]
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;998&quot;,
        &quot;_score&quot; : null,
        &quot;_source&quot; : {
          &quot;firstname&quot; : &quot;Letha&quot;,
          &quot;balance&quot; : 16869
        },
        &quot;sort&quot; : [
          998
        ]
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;997&quot;,
        &quot;_score&quot; : null,
        &quot;_source&quot; : {
          &quot;firstname&quot; : &quot;Combs&quot;,
          &quot;balance&quot; : 25311
        },
        &quot;sort&quot; : [
          997
        ]
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;996&quot;,
        &quot;_score&quot; : null,
        &quot;_source&quot; : {
          &quot;firstname&quot; : &quot;Andrews&quot;,
          &quot;balance&quot; : 17541
        },
        &quot;sort&quot; : [
          996
        ]
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;995&quot;,
        &quot;_score&quot; : null,
        &quot;_source&quot; : {
          &quot;firstname&quot; : &quot;Phelps&quot;,
          &quot;balance&quot; : 21153
        },
        &quot;sort&quot; : [
          995
        ]
      }
    ]
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-matchåŒ¹é…æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_3-matchåŒ¹é…æŸ¥è¯¢" aria-hidden="true">#</a> ï¼ˆ3ï¼‰matchåŒ¹é…æŸ¥è¯¢</h5><ul><li>åŸºæœ¬ç±»å‹ï¼ˆéå­—ç¬¦ä¸²ï¼‰ï¼Œ&quot;account_number&quot;: 20 å¯åŠ å¯ä¸åŠ â€œ â€ ä¸åŠ å°±æ˜¯ç²¾ç¡®åŒ¹é…</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;account_number&quot;: &quot;20&quot;
    }
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>matchè¿”å›account_number=20çš„æ•°æ®ã€‚</p><p>æŸ¥è¯¢ç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 1,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 1,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 1.0,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;20&quot;,
        &quot;_score&quot; : 1.0,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 20,
          &quot;balance&quot; : 16418,
          &quot;firstname&quot; : &quot;Elinor&quot;,
          &quot;lastname&quot; : &quot;Ratliff&quot;,
          &quot;age&quot; : 36,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;282 Kings Place&quot;,
          &quot;employer&quot; : &quot;Scentric&quot;,
          &quot;email&quot; : &quot;elinorratliff@scentric.com&quot;,
          &quot;city&quot; : &quot;Ribera&quot;,
          &quot;state&quot; : &quot;WA&quot;
        }
      }
    ]
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>å­—ç¬¦ä¸²ï¼Œå…¨æ–‡æ£€ç´¢â€œ â€ æ¨¡ç³ŠæŸ¥è¯¢</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;address&quot;: &quot;kings&quot;
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å…¨æ–‡æ£€ç´¢ï¼Œæœ€ç»ˆä¼šæŒ‰ç…§è¯„åˆ†è¿›è¡Œæ’åºï¼Œä¼šå¯¹æ£€ç´¢æ¡ä»¶è¿›è¡Œåˆ†è¯åŒ¹é…ã€‚</p><p>æŸ¥è¯¢ç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 30,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 2,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 5.990829,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;20&quot;,
        &quot;_score&quot; : 5.990829,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 20,
          &quot;balance&quot; : 16418,
          &quot;firstname&quot; : &quot;Elinor&quot;,
          &quot;lastname&quot; : &quot;Ratliff&quot;,
          &quot;age&quot; : 36,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;282 Kings Place&quot;,
          &quot;employer&quot; : &quot;Scentric&quot;,
          &quot;email&quot; : &quot;elinorratliff@scentric.com&quot;,
          &quot;city&quot; : &quot;Ribera&quot;,
          &quot;state&quot; : &quot;WA&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;722&quot;,
        &quot;_score&quot; : 5.990829,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 722,
          &quot;balance&quot; : 27256,
          &quot;firstname&quot; : &quot;Roberts&quot;,
          &quot;lastname&quot; : &quot;Beasley&quot;,
          &quot;age&quot; : 34,
          &quot;gender&quot; : &quot;F&quot;,
          &quot;address&quot; : &quot;305 Kings Hwy&quot;,
          &quot;employer&quot; : &quot;Quintity&quot;,
          &quot;email&quot; : &quot;robertsbeasley@quintity.com&quot;,
          &quot;city&quot; : &quot;Hayden&quot;,
          &quot;state&quot; : &quot;PA&quot;
        }
      }
    ]
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_4-match-phrase-çŸ­å¥åŒ¹é…" tabindex="-1"><a class="header-anchor" href="#_4-match-phrase-çŸ­å¥åŒ¹é…" aria-hidden="true">#</a> ï¼ˆ4ï¼‰match_phrase [çŸ­å¥åŒ¹é…]</h5><p>å°†éœ€è¦åŒ¹é…çš„å€¼å½“æˆä¸€æ•´ä¸ªå•è¯ï¼ˆä¸åˆ†è¯ï¼‰è¿›è¡Œæ£€ç´¢</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;match_phrase&quot;: {
      &quot;address&quot;: &quot;mill road&quot;
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥å¤„addressä¸­åŒ…å«mill roadçš„æ‰€æœ‰è®°å½•ï¼Œå¹¶ç»™å‡ºç›¸å…³æ€§å¾—åˆ†</p><p>æŸ¥çœ‹ç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 32,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 1,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 8.926605,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;970&quot;,
        &quot;_score&quot; : 8.926605,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 970,
          &quot;balance&quot; : 19648,
          &quot;firstname&quot; : &quot;Forbes&quot;,
          &quot;lastname&quot; : &quot;Wallace&quot;,
          &quot;age&quot; : 28,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;990 Mill Road&quot;,
          &quot;employer&quot; : &quot;Pheast&quot;,
          &quot;email&quot; : &quot;forbeswallace@pheast.com&quot;,
          &quot;city&quot; : &quot;Lopezo&quot;,
          &quot;state&quot; : &quot;AK&quot;
        }
      }
    ]
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>match_phraseå’Œmatchçš„åŒºåˆ«ï¼Œè§‚å¯Ÿå¦‚ä¸‹å®ä¾‹ï¼š</p><p>match_phraseæ˜¯åšçŸ­è¯­åŒ¹é…</p><p>matchæ˜¯åˆ†è¯åŒ¹é…ï¼Œä¾‹å¦‚990 MillåŒ¹é…å«æœ‰<strong>990æˆ–è€…Mill</strong>çš„ç»“æœ</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;match_phrase&quot;: {
      &quot;address&quot;: &quot;990 Mill&quot;
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥è¯¢ç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 0,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 1,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 10.806405,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;970&quot;,
        &quot;_score&quot; : 10.806405,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 970,
          &quot;balance&quot; : 19648,
          &quot;firstname&quot; : &quot;Forbes&quot;,
          &quot;lastname&quot; : &quot;Wallace&quot;,
          &quot;age&quot; : 28,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;990 Mill Road&quot;,
          &quot;employer&quot; : &quot;Pheast&quot;,
          &quot;email&quot; : &quot;forbeswallace@pheast.com&quot;,
          &quot;city&quot; : &quot;Lopezo&quot;,
          &quot;state&quot; : &quot;AK&quot;
        }
      }
    ]
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨matchçš„keyword</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;address.keyword&quot;: &quot;990 Mill&quot;
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥è¯¢ç»“æœï¼Œä¸€æ¡ä¹ŸæœªåŒ¹é…åˆ°</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 0,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 0,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : null,
    &quot;hits&quot; : [ ]
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¿®æ”¹åŒ¹é…æ¡ä»¶ä¸ºâ€œ990 Mill Roadâ€</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;address.keyword&quot;: &quot;990 Mill Road&quot;
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥è¯¢å‡ºä¸€æ¡æ•°æ®</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 1,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 1,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 6.5032897,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;970&quot;,
        &quot;_score&quot; : 6.5032897,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 970,
          &quot;balance&quot; : 19648,
          &quot;firstname&quot; : &quot;Forbes&quot;,
          &quot;lastname&quot; : &quot;Wallace&quot;,
          &quot;age&quot; : 28,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;990 Mill Road&quot;,
          &quot;employer&quot; : &quot;Pheast&quot;,
          &quot;email&quot; : &quot;forbeswallace@pheast.com&quot;,
          &quot;city&quot; : &quot;Lopezo&quot;,
          &quot;state&quot; : &quot;AK&quot;
        }
      }
    ]
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ–‡æœ¬å­—æ®µçš„é…ï¼Œä½¿ç”¨keywordï¼ŒåŒ¹é…çš„æ¡ä»¶å°±æ˜¯è¦æ˜¾ç¤ºå­—æ®µçš„å…¨éƒ¨å€¼ï¼Œè¦è¿›è¡Œç²¾ç¡®åŒ¹é…çš„ã€‚</p><p>match_phraseæ˜¯åšçŸ­è¯­åŒ¹é…ï¼Œåªè¦æ–‡æœ¬ä¸­åŒ…å«åŒ¹é…æ¡ä»¶æ—¢åŒ…å«è¿™ä¸ªçŸ­è¯­ï¼Œå°±èƒ½åŒ¹é…åˆ°ã€‚</p><h5 id="_5-multi-mathã€å¤šå­—æ®µåŒ¹é…ã€‘" tabindex="-1"><a class="header-anchor" href="#_5-multi-mathã€å¤šå­—æ®µåŒ¹é…ã€‘" aria-hidden="true">#</a> ï¼ˆ5ï¼‰multi_mathã€å¤šå­—æ®µåŒ¹é…ã€‘</h5><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;multi_match&quot;: {
      &quot;query&quot;: &quot;mill&quot;,
      &quot;fields&quot;: [
        &quot;state&quot;,
        &quot;address&quot;
      ]
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>stateæˆ–è€…addressä¸­åŒ…å«millï¼Œå¹¶ä¸”åœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­ï¼Œä¼šå¯¹äºæŸ¥è¯¢æ¡ä»¶è¿›è¡Œåˆ†è¯ã€‚</p><p>æŸ¥è¯¢ç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 28,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 4,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 5.4032025,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;970&quot;,
        &quot;_score&quot; : 5.4032025,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 970,
          &quot;balance&quot; : 19648,
          &quot;firstname&quot; : &quot;Forbes&quot;,
          &quot;lastname&quot; : &quot;Wallace&quot;,
          &quot;age&quot; : 28,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;990 Mill Road&quot;,
          &quot;employer&quot; : &quot;Pheast&quot;,
          &quot;email&quot; : &quot;forbeswallace@pheast.com&quot;,
          &quot;city&quot; : &quot;Lopezo&quot;,
          &quot;state&quot; : &quot;AK&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;136&quot;,
        &quot;_score&quot; : 5.4032025,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 136,
          &quot;balance&quot; : 45801,
          &quot;firstname&quot; : &quot;Winnie&quot;,
          &quot;lastname&quot; : &quot;Holland&quot;,
          &quot;age&quot; : 38,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;198 Mill Lane&quot;,
          &quot;employer&quot; : &quot;Neteria&quot;,
          &quot;email&quot; : &quot;winnieholland@neteria.com&quot;,
          &quot;city&quot; : &quot;Urie&quot;,
          &quot;state&quot; : &quot;IL&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;345&quot;,
        &quot;_score&quot; : 5.4032025,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 345,
          &quot;balance&quot; : 9812,
          &quot;firstname&quot; : &quot;Parker&quot;,
          &quot;lastname&quot; : &quot;Hines&quot;,
          &quot;age&quot; : 38,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;715 Mill Avenue&quot;,
          &quot;employer&quot; : &quot;Baluba&quot;,
          &quot;email&quot; : &quot;parkerhines@baluba.com&quot;,
          &quot;city&quot; : &quot;Blackgum&quot;,
          &quot;state&quot; : &quot;KY&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;472&quot;,
        &quot;_score&quot; : 5.4032025,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 472,
          &quot;balance&quot; : 25571,
          &quot;firstname&quot; : &quot;Lee&quot;,
          &quot;lastname&quot; : &quot;Long&quot;,
          &quot;age&quot; : 32,
          &quot;gender&quot; : &quot;F&quot;,
          &quot;address&quot; : &quot;288 Mill Street&quot;,
          &quot;employer&quot; : &quot;Comverges&quot;,
          &quot;email&quot; : &quot;leelong@comverges.com&quot;,
          &quot;city&quot; : &quot;Movico&quot;,
          &quot;state&quot; : &quot;MT&quot;
        }
      }
    ]
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_6-boolç”¨æ¥åšå¤åˆæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#_6-boolç”¨æ¥åšå¤åˆæŸ¥è¯¢" aria-hidden="true">#</a> ï¼ˆ6ï¼‰boolç”¨æ¥åšå¤åˆæŸ¥è¯¢</h5><p>å¤åˆè¯­å¥å¯ä»¥åˆå¹¶ï¼Œä»»ä½•å…¶ä»–æŸ¥è¯¢è¯­å¥ï¼ŒåŒ…æ‹¬ç¬¦åˆè¯­å¥ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€ï¼Œå¤åˆè¯­å¥ä¹‹é—´ å¯ä»¥äº’ç›¸åµŒå¥—ï¼Œå¯ä»¥è¡¨è¾¾éå¸¸å¤æ‚çš„é€»è¾‘ã€‚</p><p>mustï¼šå¿…é¡»è¾¾åˆ°mustæ‰€åˆ—ä¸¾çš„æ‰€æœ‰æ¡ä»¶</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
   &quot;query&quot;:{
        &quot;bool&quot;:{
             &quot;must&quot;:[
              {&quot;match&quot;:{&quot;address&quot;:&quot;mill&quot;}},
              {&quot;match&quot;:{&quot;gender&quot;:&quot;M&quot;}}
             ]
         }
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>must_notï¼Œå¿…é¡»ä¸åŒ¹é…must_notæ‰€åˆ—ä¸¾çš„æ‰€æœ‰æ¡ä»¶ã€‚</p><p>shouldï¼Œåº”è¯¥æ»¡è¶³shouldæ‰€åˆ—ä¸¾çš„æ¡ä»¶ã€‚</p><p>å®ä¾‹ï¼šæŸ¥è¯¢gender=mï¼Œå¹¶ä¸”address=millçš„æ•°æ®</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;bool&quot;: {
      &quot;must&quot;: [
        {
          &quot;match&quot;: {
            &quot;gender&quot;: &quot;M&quot;
          }
        },
        {
          &quot;match&quot;: {
            &quot;address&quot;: &quot;mill&quot;
          }
        }
      ]
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥è¯¢ç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 1,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 3,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 6.0824604,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;970&quot;,
        &quot;_score&quot; : 6.0824604,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 970,
          &quot;balance&quot; : 19648,
          &quot;firstname&quot; : &quot;Forbes&quot;,
          &quot;lastname&quot; : &quot;Wallace&quot;,
          &quot;age&quot; : 28,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;990 Mill Road&quot;,
          &quot;employer&quot; : &quot;Pheast&quot;,
          &quot;email&quot; : &quot;forbeswallace@pheast.com&quot;,
          &quot;city&quot; : &quot;Lopezo&quot;,
          &quot;state&quot; : &quot;AK&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;136&quot;,
        &quot;_score&quot; : 6.0824604,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 136,
          &quot;balance&quot; : 45801,
          &quot;firstname&quot; : &quot;Winnie&quot;,
          &quot;lastname&quot; : &quot;Holland&quot;,
          &quot;age&quot; : 38,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;198 Mill Lane&quot;,
          &quot;employer&quot; : &quot;Neteria&quot;,
          &quot;email&quot; : &quot;winnieholland@neteria.com&quot;,
          &quot;city&quot; : &quot;Urie&quot;,
          &quot;state&quot; : &quot;IL&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;345&quot;,
        &quot;_score&quot; : 6.0824604,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 345,
          &quot;balance&quot; : 9812,
          &quot;firstname&quot; : &quot;Parker&quot;,
          &quot;lastname&quot; : &quot;Hines&quot;,
          &quot;age&quot; : 38,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;715 Mill Avenue&quot;,
          &quot;employer&quot; : &quot;Baluba&quot;,
          &quot;email&quot; : &quot;parkerhines@baluba.com&quot;,
          &quot;city&quot; : &quot;Blackgum&quot;,
          &quot;state&quot; : &quot;KY&quot;
        }
      }
    ]
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>must_notï¼šå¿…é¡»ä¸æ˜¯æŒ‡å®šçš„æƒ…å†µ</strong></p><p>å®ä¾‹ï¼šæŸ¥è¯¢gender=mï¼Œå¹¶ä¸”address=millçš„æ•°æ®ï¼Œä½†æ˜¯ageä¸ç­‰äº38çš„</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;bool&quot;: {
      &quot;must&quot;: [
        {
          &quot;match&quot;: {
            &quot;gender&quot;: &quot;M&quot;
          }
        },
        {
          &quot;match&quot;: {
            &quot;address&quot;: &quot;mill&quot;
          }
        }
      ],
      &quot;must_not&quot;: [
        {
          &quot;match&quot;: {
            &quot;age&quot;: &quot;38&quot;
          }
        }
      ]
    }
  }

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥è¯¢ç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 4,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 1,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 6.0824604,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;970&quot;,
        &quot;_score&quot; : 6.0824604,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 970,
          &quot;balance&quot; : 19648,
          &quot;firstname&quot; : &quot;Forbes&quot;,
          &quot;lastname&quot; : &quot;Wallace&quot;,
          &quot;age&quot; : 28,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;990 Mill Road&quot;,
          &quot;employer&quot; : &quot;Pheast&quot;,
          &quot;email&quot; : &quot;forbeswallace@pheast.com&quot;,
          &quot;city&quot; : &quot;Lopezo&quot;,
          &quot;state&quot; : &quot;AK&quot;
        }
      }
    ]
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>shouldï¼šåº”è¯¥è¾¾åˆ°shouldåˆ—ä¸¾çš„æ¡ä»¶ï¼Œå¦‚æœåˆ°è¾¾ä¼šå¢åŠ ç›¸å…³æ–‡æ¡£çš„è¯„åˆ†ï¼Œå¹¶ä¸ä¼šæ”¹å˜æŸ¥è¯¢çš„ç»“æœã€‚å¦‚æœqueryä¸­åªæœ‰shouldä¸”åªæœ‰ä¸€ç§åŒ¹é…è§„åˆ™ï¼Œé‚£ä¹ˆshouldçš„æ¡ä»¶å°±ä¼šè¢«ä½œä¸ºé»˜è®¤åŒ¹é…æ¡ä»¶è€Œå»æ”¹å˜æŸ¥è¯¢ç»“æœã€‚</strong></p><p>å®ä¾‹ï¼šåŒ¹é…lastNameåº”è¯¥ç­‰äºWallaceçš„æ•°æ®</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;bool&quot;: {
      &quot;must&quot;: [
        {
          &quot;match&quot;: {
            &quot;gender&quot;: &quot;M&quot;
          }
        },
        {
          &quot;match&quot;: {
            &quot;address&quot;: &quot;mill&quot;
          }
        }
      ],
      &quot;must_not&quot;: [
        {
          &quot;match&quot;: {
            &quot;age&quot;: &quot;18&quot;
          }
        }
      ],
      &quot;should&quot;: [
        {
          &quot;match&quot;: {
            &quot;lastname&quot;: &quot;Wallace&quot;
          }
        }
      ]
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥è¯¢ç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 5,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 3,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 12.585751,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;970&quot;,
        &quot;_score&quot; : 12.585751,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 970,
          &quot;balance&quot; : 19648,
          &quot;firstname&quot; : &quot;Forbes&quot;,
          &quot;lastname&quot; : &quot;Wallace&quot;,
          &quot;age&quot; : 28,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;990 Mill Road&quot;,
          &quot;employer&quot; : &quot;Pheast&quot;,
          &quot;email&quot; : &quot;forbeswallace@pheast.com&quot;,
          &quot;city&quot; : &quot;Lopezo&quot;,
          &quot;state&quot; : &quot;AK&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;136&quot;,
        &quot;_score&quot; : 6.0824604,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 136,
          &quot;balance&quot; : 45801,
          &quot;firstname&quot; : &quot;Winnie&quot;,
          &quot;lastname&quot; : &quot;Holland&quot;,
          &quot;age&quot; : 38,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;198 Mill Lane&quot;,
          &quot;employer&quot; : &quot;Neteria&quot;,
          &quot;email&quot; : &quot;winnieholland@neteria.com&quot;,
          &quot;city&quot; : &quot;Urie&quot;,
          &quot;state&quot; : &quot;IL&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;345&quot;,
        &quot;_score&quot; : 6.0824604,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 345,
          &quot;balance&quot; : 9812,
          &quot;firstname&quot; : &quot;Parker&quot;,
          &quot;lastname&quot; : &quot;Hines&quot;,
          &quot;age&quot; : 38,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;715 Mill Avenue&quot;,
          &quot;employer&quot; : &quot;Baluba&quot;,
          &quot;email&quot; : &quot;parkerhines@baluba.com&quot;,
          &quot;city&quot; : &quot;Blackgum&quot;,
          &quot;state&quot; : &quot;KY&quot;
        }
      }
    ]
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>èƒ½å¤Ÿçœ‹åˆ°ç›¸å…³åº¦è¶Šé«˜ï¼Œå¾—åˆ†ä¹Ÿè¶Šé«˜ã€‚</p><h5 id="_7-filterã€ç»“æœè¿‡æ»¤ã€‘" tabindex="-1"><a class="header-anchor" href="#_7-filterã€ç»“æœè¿‡æ»¤ã€‘" aria-hidden="true">#</a> ï¼ˆ7ï¼‰Filterã€ç»“æœè¿‡æ»¤ã€‘</h5><p>å¹¶ä¸æ˜¯æ‰€æœ‰çš„æŸ¥è¯¢éƒ½éœ€è¦äº§ç”Ÿåˆ†æ•°ï¼Œç‰¹åˆ«æ˜¯å“ªäº›ä»…ç”¨äºfilteringè¿‡æ»¤çš„æ–‡æ¡£ã€‚ä¸ºäº†ä¸è®¡ç®—åˆ†æ•°ï¼Œelasticsearchä¼šè‡ªåŠ¨æ£€æŸ¥åœºæ™¯å¹¶ä¸”ä¼˜åŒ–æŸ¥è¯¢çš„æ‰§è¡Œã€‚</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;bool&quot;: {
      &quot;filter&quot;: {
        &quot;range&quot;: {
          &quot;balance&quot;: {
            &quot;gte&quot;: &quot;10000&quot;,
            &quot;lte&quot;: &quot;20000&quot;
          }
        }
      }
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œå…ˆæ˜¯æŸ¥è¯¢æ‰€æœ‰åŒ¹é…address=millçš„æ–‡æ¡£ï¼Œç„¶åå†æ ¹æ®10000&lt;=balance&lt;=20000è¿›è¡Œè¿‡æ»¤æŸ¥è¯¢ç»“æœ</p><p>æŸ¥è¯¢ç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 2,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 1,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 5.4032025,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;970&quot;,
        &quot;_score&quot; : 5.4032025,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 970,
          &quot;balance&quot; : 19648,
          &quot;firstname&quot; : &quot;Forbes&quot;,
          &quot;lastname&quot; : &quot;Wallace&quot;,
          &quot;age&quot; : 28,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;990 Mill Road&quot;,
          &quot;employer&quot; : &quot;Pheast&quot;,
          &quot;email&quot; : &quot;forbeswallace@pheast.com&quot;,
          &quot;city&quot; : &quot;Lopezo&quot;,
          &quot;state&quot; : &quot;AK&quot;
        }
      }
    ]
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Each <code>must</code>, <code>should</code>, and <code>must_not</code> element in a Boolean query is referred to as a query clause. How well a document meets the criteria in each <code>must</code> or <code>should</code> clause contributes to the documentâ€™s <em>relevance score</em>. The higher the score, the better the document matches your search criteria. By default, Elasticsearch returns documents ranked by these relevance scores.</p><p>åœ¨booleanæŸ¥è¯¢ä¸­ï¼Œ<code>must</code>, <code>should</code> å’Œ<code>must_not</code> å…ƒç´ éƒ½è¢«ç§°ä¸ºæŸ¥è¯¢å­å¥ ã€‚ æ–‡æ¡£æ˜¯å¦ç¬¦åˆæ¯ä¸ªâ€œmustâ€æˆ–â€œshouldâ€å­å¥ä¸­çš„æ ‡å‡†ï¼Œå†³å®šäº†æ–‡æ¡£çš„â€œç›¸å…³æ€§å¾—åˆ†â€ã€‚ å¾—åˆ†è¶Šé«˜ï¼Œæ–‡æ¡£è¶Šç¬¦åˆæ‚¨çš„æœç´¢æ¡ä»¶ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒElasticsearchè¿”å›æ ¹æ®è¿™äº›ç›¸å…³æ€§å¾—åˆ†æ’åºçš„æ–‡æ¡£ã€‚</p><p>The criteria in a <code>must_not</code> clause is treated as a <em>filter</em>. It affects whether or not the document is included in the results, but does not contribute to how documents are scored. You can also explicitly specify arbitrary filters to include or exclude documents based on structured data.</p><p><code>â€œmust_notâ€å­å¥ä¸­çš„æ¡ä»¶è¢«è§†ä¸ºâ€œè¿‡æ»¤å™¨â€ã€‚</code> å®ƒå½±å“æ–‡æ¡£æ˜¯å¦åŒ…å«åœ¨ç»“æœä¸­ï¼Œ ä½† <code>ä¸å½±å“æ–‡æ¡£çš„è¯„åˆ†æ–¹å¼</code>ã€‚ è¿˜å¯ä»¥æ˜¾å¼åœ°æŒ‡å®šä»»æ„è¿‡æ»¤å™¨æ¥åŒ…å«æˆ–æ’é™¤åŸºäºç»“æ„åŒ–æ•°æ®çš„æ–‡æ¡£ã€‚</p><p><strong>filteråœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¹¶ä¸ä¼šè®¡ç®—ç›¸å…³æ€§å¾—åˆ†_scoreï¼š</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;bool&quot;: {
      &quot;filter&quot;: {
        &quot;range&quot;: {
          &quot;balance&quot;: {
            &quot;gte&quot;: &quot;10000&quot;,
            &quot;lte&quot;: &quot;20000&quot;
          }
        }
      }
    }
  }
}
//gte:&gt;=  lte:&lt;=
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥è¯¢ç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 1,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 213,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 0.0,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;20&quot;,
        &quot;_score&quot; : 0.0,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 20,
          &quot;balance&quot; : 16418,
          &quot;firstname&quot; : &quot;Elinor&quot;,
          &quot;lastname&quot; : &quot;Ratliff&quot;,
          &quot;age&quot; : 36,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;282 Kings Place&quot;,
          &quot;employer&quot; : &quot;Scentric&quot;,
          &quot;email&quot; : &quot;elinorratliff@scentric.com&quot;,
          &quot;city&quot; : &quot;Ribera&quot;,
          &quot;state&quot; : &quot;WA&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;37&quot;,
        &quot;_score&quot; : 0.0,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 37,
          &quot;balance&quot; : 18612,
          &quot;firstname&quot; : &quot;Mcgee&quot;,
          &quot;lastname&quot; : &quot;Mooney&quot;,
          &quot;age&quot; : 39,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;826 Fillmore Place&quot;,
          &quot;employer&quot; : &quot;Reversus&quot;,
          &quot;email&quot; : &quot;mcgeemooney@reversus.com&quot;,
          &quot;city&quot; : &quot;Tooleville&quot;,
          &quot;state&quot; : &quot;OK&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;51&quot;,
        &quot;_score&quot; : 0.0,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 51,
          &quot;balance&quot; : 14097,
          &quot;firstname&quot; : &quot;Burton&quot;,
          &quot;lastname&quot; : &quot;Meyers&quot;,
          &quot;age&quot; : 31,
          &quot;gender&quot; : &quot;F&quot;,
          &quot;address&quot; : &quot;334 River Street&quot;,
          &quot;employer&quot; : &quot;Bezal&quot;,
          &quot;email&quot; : &quot;burtonmeyers@bezal.com&quot;,
          &quot;city&quot; : &quot;Jacksonburg&quot;,
          &quot;state&quot; : &quot;MO&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;56&quot;,
        &quot;_score&quot; : 0.0,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 56,
          &quot;balance&quot; : 14992,
          &quot;firstname&quot; : &quot;Josie&quot;,
          &quot;lastname&quot; : &quot;Nelson&quot;,
          &quot;age&quot; : 32,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;857 Tabor Court&quot;,
          &quot;employer&quot; : &quot;Emtrac&quot;,
          &quot;email&quot; : &quot;josienelson@emtrac.com&quot;,
          &quot;city&quot; : &quot;Sunnyside&quot;,
          &quot;state&quot; : &quot;UT&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;121&quot;,
        &quot;_score&quot; : 0.0,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 121,
          &quot;balance&quot; : 19594,
          &quot;firstname&quot; : &quot;Acevedo&quot;,
          &quot;lastname&quot; : &quot;Dorsey&quot;,
          &quot;age&quot; : 32,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;479 Nova Court&quot;,
          &quot;employer&quot; : &quot;Netropic&quot;,
          &quot;email&quot; : &quot;acevedodorsey@netropic.com&quot;,
          &quot;city&quot; : &quot;Islandia&quot;,
          &quot;state&quot; : &quot;CT&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;176&quot;,
        &quot;_score&quot; : 0.0,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 176,
          &quot;balance&quot; : 18607,
          &quot;firstname&quot; : &quot;Kemp&quot;,
          &quot;lastname&quot; : &quot;Walters&quot;,
          &quot;age&quot; : 28,
          &quot;gender&quot; : &quot;F&quot;,
          &quot;address&quot; : &quot;906 Howard Avenue&quot;,
          &quot;employer&quot; : &quot;Eyewax&quot;,
          &quot;email&quot; : &quot;kempwalters@eyewax.com&quot;,
          &quot;city&quot; : &quot;Why&quot;,
          &quot;state&quot; : &quot;KY&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;183&quot;,
        &quot;_score&quot; : 0.0,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 183,
          &quot;balance&quot; : 14223,
          &quot;firstname&quot; : &quot;Hudson&quot;,
          &quot;lastname&quot; : &quot;English&quot;,
          &quot;age&quot; : 26,
          &quot;gender&quot; : &quot;F&quot;,
          &quot;address&quot; : &quot;823 Herkimer Place&quot;,
          &quot;employer&quot; : &quot;Xinware&quot;,
          &quot;email&quot; : &quot;hudsonenglish@xinware.com&quot;,
          &quot;city&quot; : &quot;Robbins&quot;,
          &quot;state&quot; : &quot;ND&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;222&quot;,
        &quot;_score&quot; : 0.0,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 222,
          &quot;balance&quot; : 14764,
          &quot;firstname&quot; : &quot;Rachelle&quot;,
          &quot;lastname&quot; : &quot;Rice&quot;,
          &quot;age&quot; : 36,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;333 Narrows Avenue&quot;,
          &quot;employer&quot; : &quot;Enaut&quot;,
          &quot;email&quot; : &quot;rachellerice@enaut.com&quot;,
          &quot;city&quot; : &quot;Wright&quot;,
          &quot;state&quot; : &quot;AZ&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;227&quot;,
        &quot;_score&quot; : 0.0,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 227,
          &quot;balance&quot; : 19780,
          &quot;firstname&quot; : &quot;Coleman&quot;,
          &quot;lastname&quot; : &quot;Berg&quot;,
          &quot;age&quot; : 22,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;776 Little Street&quot;,
          &quot;employer&quot; : &quot;Exoteric&quot;,
          &quot;email&quot; : &quot;colemanberg@exoteric.com&quot;,
          &quot;city&quot; : &quot;Eagleville&quot;,
          &quot;state&quot; : &quot;WV&quot;
        }
      },
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,
        &quot;_id&quot; : &quot;272&quot;,
        &quot;_score&quot; : 0.0,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 272,
          &quot;balance&quot; : 19253,
          &quot;firstname&quot; : &quot;Lilly&quot;,
          &quot;lastname&quot; : &quot;Morgan&quot;,
          &quot;age&quot; : 25,
          &quot;gender&quot; : &quot;F&quot;,
          &quot;address&quot; : &quot;689 Fleet Street&quot;,
          &quot;employer&quot; : &quot;Biolive&quot;,
          &quot;email&quot; : &quot;lillymorgan@biolive.com&quot;,
          &quot;city&quot; : &quot;Sunbury&quot;,
          &quot;state&quot; : &quot;OH&quot;
        }
      }
    ]
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>èƒ½çœ‹åˆ°æ‰€æœ‰æ–‡æ¡£çš„ &quot;_score&quot; : 0.0ã€‚</strong></p><h5 id="_8-term" tabindex="-1"><a class="header-anchor" href="#_8-term" aria-hidden="true">#</a> ï¼ˆ8ï¼‰term</h5><p>å’Œmatchä¸€æ ·ã€‚åŒ¹é…æŸä¸ªå±æ€§çš„å€¼ã€‚å…¨æ–‡æ£€ç´¢å­—æ®µç”¨matchï¼Œå…¶ä»–<strong>étextå­—æ®µ</strong>åŒ¹é…ç”¨termã€‚</p><blockquote><p>Avoid using the <code>term</code> query for <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.6/text.html" target="_blank" rel="noopener noreferrer"><code>text</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> fields.</p><p>é¿å…å¯¹æ–‡æœ¬å­—æ®µä½¿ç”¨â€œtermâ€æŸ¥è¯¢</p><p>By default, Elasticsearch changes the values of <code>text</code> fields as part of <a href="">analysis</a>. This can make finding exact matches for <code>text</code> field values difficult.</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒElasticsearchä½œä¸º<a href="">analysis</a>çš„ä¸€éƒ¨åˆ†æ›´æ”¹&#39; text &#39;å­—æ®µçš„å€¼ã€‚è¿™ä½¿å¾—ä¸ºâ€œtextâ€å­—æ®µå€¼å¯»æ‰¾ç²¾ç¡®åŒ¹é…å˜å¾—å›°éš¾ã€‚</p><p>To search <code>text</code> field values, use the match.</p><p>è¦æœç´¢â€œtextâ€å­—æ®µå€¼ï¼Œè¯·ä½¿ç”¨åŒ¹é…ã€‚</p><p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.6/query-dsl-term-query.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/elasticsearch/reference/7.6/query-dsl-term-query.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><p>ä½¿ç”¨termåŒ¹é…æŸ¥è¯¢</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;term&quot;: {
      &quot;age&quot;: &quot;28&quot;
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚æœæ˜¯textåˆ™æŸ¥ä¸åˆ°ï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;term&quot;: {
      &quot;gender&quot; : &quot;F&quot;
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 0,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 0,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : null,
    &quot;hits&quot; : [ ]
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸€æ¡ä¹Ÿæ²¡æœ‰åŒ¹é…åˆ°</p><p>è€Œæ›´æ¢ä¸ºmatchåŒ¹é…æ—¶ï¼Œèƒ½å¤ŸåŒ¹é…åˆ°32ä¸ªæ–‡æ¡£</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200502120921830.png" alt="image-20200502120921830"></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>å…¨æ–‡æ£€ç´¢å­—æ®µç”¨matchï¼Œå…¶ä»–étextå­—æ®µåŒ¹é…ç”¨term</strong>ã€‚</p><h5 id="_9-aggregation-æ‰§è¡Œèšåˆ" tabindex="-1"><a class="header-anchor" href="#_9-aggregation-æ‰§è¡Œèšåˆ" aria-hidden="true">#</a> ï¼ˆ9ï¼‰Aggregationï¼ˆæ‰§è¡Œèšåˆï¼‰</h5><p>èšåˆæä¾›äº†ä»æ•°æ®ä¸­åˆ†ç»„å’Œæå–æ•°æ®çš„èƒ½åŠ›ã€‚æœ€ç®€å•çš„èšåˆæ–¹æ³•å¤§è‡´ç­‰äºSQL Group byå’ŒSQLèšåˆå‡½æ•°ã€‚åœ¨elasticsearchä¸­ï¼Œæ‰§è¡Œæœç´¢è¿”å›thisï¼ˆå‘½ä¸­ç»“æœï¼‰ï¼Œå¹¶ä¸”åŒæ—¶è¿”å›èšåˆç»“æœï¼ŒæŠŠä»¥å“åº”ä¸­çš„æ‰€æœ‰hitsï¼ˆå‘½ä¸­ç»“æœï¼‰åˆ†éš”å¼€çš„èƒ½åŠ›ã€‚è¿™æ˜¯éå¸¸å¼ºå¤§ä¸”æœ‰æ•ˆçš„ï¼Œä½ å¯ä»¥æ‰§è¡ŒæŸ¥è¯¢å’Œå¤šä¸ªèšåˆï¼Œå¹¶ä¸”åœ¨ä¸€æ¬¡ä½¿ç”¨ä¸­å¾—åˆ°å„è‡ªçš„ï¼ˆä»»ä½•ä¸€ä¸ªçš„ï¼‰è¿”å›ç»“æœï¼Œä½¿ç”¨ä¸€æ¬¡ç®€æ´å’Œç®€åŒ–çš„APIå•¦é¿å…ç½‘ç»œå¾€è¿”ã€‚</p><p>&quot;size&quot;:0</p><p>size:0ä¸æ˜¾ç¤ºæœç´¢æ•°æ® aggsï¼šæ‰§è¡Œèšåˆã€‚èšåˆè¯­æ³•å¦‚ä¸‹ï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&quot;aggs&quot;:{
    &quot;aggs_nameè¿™æ¬¡èšåˆçš„åå­—ï¼Œæ–¹ä¾¿å±•ç¤ºåœ¨ç»“æœé›†ä¸­&quot;:{
        &quot;AGG_TYPEèšåˆçš„ç±»å‹(avg,term,terms)&quot;:{}
     }
}ï¼Œ
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æœç´¢addressä¸­åŒ…å«millçš„æ‰€æœ‰äººçš„å¹´é¾„åˆ†å¸ƒä»¥åŠå¹³å‡å¹´é¾„ï¼Œä½†ä¸æ˜¾ç¤ºè¿™äº›äººçš„è¯¦æƒ…</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;address&quot;: &quot;Mill&quot;
    }
  },
  &quot;aggs&quot;: {
    &quot;ageAgg&quot;: {
      &quot;terms&quot;: {
        &quot;field&quot;: &quot;age&quot;,
        &quot;size&quot;: 10
      }
    },
    &quot;ageAvg&quot;: {
      &quot;avg&quot;: {
        &quot;field&quot;: &quot;age&quot;
      }
    },
    &quot;balanceAvg&quot;: {
      &quot;avg&quot;: {
        &quot;field&quot;: &quot;balance&quot;
      }
    }
  },
  &quot;size&quot;: 0
}
//ageAgg:èšåˆåå­—  termsï¼šèšåˆç±»å‹  &quot;field&quot;: &quot;age&quot;:æŒ‰ç…§ageå­—æ®µèšåˆ  size:10ï¼šå–å‡ºå‰åç§age
//avgï¼šå¹³å‡å€¼èšåˆç±»å‹
//ä¸æ˜¾ç¤ºè¿™äº›äººçš„è¯¦æƒ…ï¼Œåªçœ‹èšåˆç»“æœ
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥è¯¢ç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 2,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 4,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : null,
    &quot;hits&quot; : [ ]
  },
  &quot;aggregations&quot; : {
    &quot;ageAgg&quot; : {
      &quot;doc_count_error_upper_bound&quot; : 0,
      &quot;sum_other_doc_count&quot; : 0,
      &quot;buckets&quot; : [
        {
          &quot;key&quot; : 38,
          &quot;doc_count&quot; : 2
        },
        {
          &quot;key&quot; : 28,
          &quot;doc_count&quot; : 1
        },
        {
          &quot;key&quot; : 32,
          &quot;doc_count&quot; : 1
        }
      ]
    },
    &quot;ageAvg&quot; : {
      &quot;value&quot; : 34.0
    },
    &quot;balanceAvg&quot; : {
      &quot;value&quot; : 25208.0
    }
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¤æ‚ï¼š æŒ‰ç…§å¹´é¾„èšåˆï¼Œå¹¶ä¸”æ±‚è¿™äº›å¹´é¾„æ®µçš„è¿™äº›äººçš„å¹³å‡è–ªèµ„</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;match_all&quot;: {}
  },
  &quot;aggs&quot;: {
    &quot;ageAgg&quot;: {
      &quot;terms&quot;: {
        &quot;field&quot;: &quot;age&quot;,
        &quot;size&quot;: 100
      },
      &quot;aggs&quot;: {
        &quot;ageAvg&quot;: {
          &quot;avg&quot;: {
            &quot;field&quot;: &quot;balance&quot;
          }
        }
      }
    }
  },
  &quot;size&quot;: 0
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 49,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 1000,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : null,
    &quot;hits&quot; : [ ]
  },
  &quot;aggregations&quot; : {
    &quot;ageAgg&quot; : {
      &quot;doc_count_error_upper_bound&quot; : 0,
      &quot;sum_other_doc_count&quot; : 0,
      &quot;buckets&quot; : [
        {
          &quot;key&quot; : 31,
          &quot;doc_count&quot; : 61,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 28312.918032786885
          }
        },
        {
          &quot;key&quot; : 39,
          &quot;doc_count&quot; : 60,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 25269.583333333332
          }
        },
        {
          &quot;key&quot; : 26,
          &quot;doc_count&quot; : 59,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 23194.813559322032
          }
        },
        {
          &quot;key&quot; : 32,
          &quot;doc_count&quot; : 52,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 23951.346153846152
          }
        },
        {
          &quot;key&quot; : 35,
          &quot;doc_count&quot; : 52,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 22136.69230769231
          }
        },
        {
          &quot;key&quot; : 36,
          &quot;doc_count&quot; : 52,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 22174.71153846154
          }
        },
        {
          &quot;key&quot; : 22,
          &quot;doc_count&quot; : 51,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 24731.07843137255
          }
        },
        {
          &quot;key&quot; : 28,
          &quot;doc_count&quot; : 51,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 28273.882352941175
          }
        },
        {
          &quot;key&quot; : 33,
          &quot;doc_count&quot; : 50,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 25093.94
          }
        },
        {
          &quot;key&quot; : 34,
          &quot;doc_count&quot; : 49,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 26809.95918367347
          }
        },
        {
          &quot;key&quot; : 30,
          &quot;doc_count&quot; : 47,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 22841.106382978724
          }
        },
        {
          &quot;key&quot; : 21,
          &quot;doc_count&quot; : 46,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 26981.434782608696
          }
        },
        {
          &quot;key&quot; : 40,
          &quot;doc_count&quot; : 45,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 27183.17777777778
          }
        },
        {
          &quot;key&quot; : 20,
          &quot;doc_count&quot; : 44,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 27741.227272727272
          }
        },
        {
          &quot;key&quot; : 23,
          &quot;doc_count&quot; : 42,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 27314.214285714286
          }
        },
        {
          &quot;key&quot; : 24,
          &quot;doc_count&quot; : 42,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 28519.04761904762
          }
        },
        {
          &quot;key&quot; : 25,
          &quot;doc_count&quot; : 42,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 27445.214285714286
          }
        },
        {
          &quot;key&quot; : 37,
          &quot;doc_count&quot; : 42,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 27022.261904761905
          }
        },
        {
          &quot;key&quot; : 27,
          &quot;doc_count&quot; : 39,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 21471.871794871793
          }
        },
        {
          &quot;key&quot; : 38,
          &quot;doc_count&quot; : 39,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 26187.17948717949
          }
        },
        {
          &quot;key&quot; : 29,
          &quot;doc_count&quot; : 35,
          &quot;ageAvg&quot; : {
            &quot;value&quot; : 29483.14285714286
          }
        }
      ]
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥å‡ºæ‰€æœ‰å¹´é¾„åˆ†å¸ƒï¼Œå¹¶ä¸”è¿™äº›å¹´é¾„æ®µä¸­Mçš„å¹³å‡è–ªèµ„å’ŒFçš„å¹³å‡è–ªèµ„ä»¥åŠè¿™ä¸ªå¹´é¾„æ®µçš„æ€»ä½“å¹³å‡è–ªèµ„</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;match_all&quot;: {}
  },
  &quot;aggs&quot;: {
    &quot;ageAgg&quot;: {
      &quot;terms&quot;: {
        &quot;field&quot;: &quot;age&quot;,
        &quot;size&quot;: 100
      },
      &quot;aggs&quot;: {
        &quot;genderAgg&quot;: {
          &quot;terms&quot;: {
            &quot;field&quot;: &quot;gender.keyword&quot;
          },
          &quot;aggs&quot;: {
            &quot;balanceAvg&quot;: {
              &quot;avg&quot;: {
                &quot;field&quot;: &quot;balance&quot;
              }
            }
          }
        },
        &quot;ageBalanceAvg&quot;: {
          &quot;avg&quot;: {
            &quot;field&quot;: &quot;balance&quot;
          }
        }
      }
    }
  },
  &quot;size&quot;: 0
}
//&quot;field&quot;: &quot;gender.keyword&quot; genderæ˜¯txtæ²¡æ³•èšåˆ å¿…é¡»åŠ .keywordç²¾ç¡®æ›¿ä»£
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 119,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 1000,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : null,
    &quot;hits&quot; : [ ]
  },
  &quot;aggregations&quot; : {
    &quot;ageAgg&quot; : {
      &quot;doc_count_error_upper_bound&quot; : 0,
      &quot;sum_other_doc_count&quot; : 0,
      &quot;buckets&quot; : [
        {
          &quot;key&quot; : 31,
          &quot;doc_count&quot; : 61,
          &quot;genderAgg&quot; : {
            &quot;doc_count_error_upper_bound&quot; : 0,
            &quot;sum_other_doc_count&quot; : 0,
            &quot;buckets&quot; : [
              {
                &quot;key&quot; : &quot;M&quot;,
                &quot;doc_count&quot; : 35,
                &quot;balanceAvg&quot; : {
                  &quot;value&quot; : 29565.628571428573
                }
              },
              {
                &quot;key&quot; : &quot;F&quot;,
                &quot;doc_count&quot; : 26,
                &quot;balanceAvg&quot; : {
                  &quot;value&quot; : 26626.576923076922
                }
              }
            ]
          },
          &quot;ageBalanceAvg&quot; : {
            &quot;value&quot; : 28312.918032786885
          }
        }
      ]
        .......//çœç•¥å…¶ä»–
    }
  }
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3-mapping" tabindex="-1"><a class="header-anchor" href="#_3-mapping" aria-hidden="true">#</a> 3ï¼‰Mapping</h4><h5 id="_1-å­—æ®µç±»å‹" tabindex="-1"><a class="header-anchor" href="#_1-å­—æ®µç±»å‹" aria-hidden="true">#</a> ï¼ˆ1ï¼‰å­—æ®µç±»å‹</h5><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200502161339291.png" alt="image-20200502161339291"></p><h5 id="_2-æ˜ å°„" tabindex="-1"><a class="header-anchor" href="#_2-æ˜ å°„" aria-hidden="true">#</a> ï¼ˆ2ï¼‰æ˜ å°„</h5><p>Mapping(æ˜ å°„) Mapingæ˜¯ç”¨æ¥å®šä¹‰ä¸€ä¸ªæ–‡æ¡£ï¼ˆdocumentï¼‰ï¼Œä»¥åŠå®ƒæ‰€åŒ…å«çš„å±æ€§ï¼ˆfieldï¼‰æ˜¯å¦‚ä½•å­˜å‚¨å’Œç´¢å¼•çš„ã€‚æ¯”å¦‚ï¼šä½¿ç”¨mapingæ¥å®šä¹‰ï¼š</p><ul><li><p>å“ªäº›å­—ç¬¦ä¸²å±æ€§åº”è¯¥è¢«çœ‹åšå…¨æ–‡æœ¬å±æ€§ï¼ˆfull text fieldsï¼‰ï¼›</p></li><li><p>å“ªäº›å±æ€§åŒ…å«æ•°å­—ï¼Œæ—¥æœŸæˆ–åœ°ç†ä½ç½®ï¼›</p></li><li><p>æ–‡æ¡£ä¸­çš„æ‰€æœ‰å±æ€§æ˜¯å¦éƒ½å«©è¢«ç´¢å¼•ï¼ˆall é…ç½®ï¼‰ï¼›</p></li><li><p>æ—¥æœŸçš„æ ¼å¼ï¼›</p></li><li><p>è‡ªå®šä¹‰æ˜ å°„è§„åˆ™æ¥æ‰§è¡ŒåŠ¨æ€æ·»åŠ å±æ€§ï¼›</p></li><li><p>æŸ¥çœ‹mappingä¿¡æ¯ GET bank/_mapping</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;bank&quot; : {
    &quot;mappings&quot; : {
      &quot;properties&quot; : {
        &quot;account_number&quot; : {
          &quot;type&quot; : &quot;long&quot;
        },
        &quot;address&quot; : {
          &quot;type&quot; : &quot;text&quot;,
          &quot;fields&quot; : {
            &quot;keyword&quot; : {
              &quot;type&quot; : &quot;keyword&quot;,
              &quot;ignore_above&quot; : 256
            }
          }
        },
        &quot;age&quot; : {
          &quot;type&quot; : &quot;long&quot;
        },
        &quot;balance&quot; : {
          &quot;type&quot; : &quot;long&quot;
        },
        &quot;city&quot; : {
          &quot;type&quot; : &quot;text&quot;,
          &quot;fields&quot; : {
            &quot;keyword&quot; : {
              &quot;type&quot; : &quot;keyword&quot;,
              &quot;ignore_above&quot; : 256
            }
          }
        },
        &quot;email&quot; : {
          &quot;type&quot; : &quot;text&quot;,
          &quot;fields&quot; : {
            &quot;keyword&quot; : {
              &quot;type&quot; : &quot;keyword&quot;,
              &quot;ignore_above&quot; : 256
            }
          }
        },
        &quot;employer&quot; : {
          &quot;type&quot; : &quot;text&quot;,
          &quot;fields&quot; : {
            &quot;keyword&quot; : {
              &quot;type&quot; : &quot;keyword&quot;,
              &quot;ignore_above&quot; : 256
            }
          }
        },
        &quot;firstname&quot; : {
          &quot;type&quot; : &quot;text&quot;,
          &quot;fields&quot; : {
            &quot;keyword&quot; : {
              &quot;type&quot; : &quot;keyword&quot;,
              &quot;ignore_above&quot; : 256
            }
          }
        },
        &quot;gender&quot; : {
          &quot;type&quot; : &quot;text&quot;,
          &quot;fields&quot; : {
            &quot;keyword&quot; : {
              &quot;type&quot; : &quot;keyword&quot;,
              &quot;ignore_above&quot; : 256
            }
          }
        },
        &quot;lastname&quot; : {
          &quot;type&quot; : &quot;text&quot;,
          &quot;fields&quot; : {
            &quot;keyword&quot; : {
              &quot;type&quot; : &quot;keyword&quot;,
              &quot;ignore_above&quot; : 256
            }
          }
        },
        &quot;state&quot; : {
          &quot;type&quot; : &quot;text&quot;,
          &quot;fields&quot; : {
            &quot;keyword&quot; : {
              &quot;type&quot; : &quot;keyword&quot;,
              &quot;ignore_above&quot; : 256
            }
          }
        }
      }
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ä¿®æ”¹mappingä¿¡æ¯</p></li></ul><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200502170924399.png" alt="image-20200502170924399"></p><h5 id="_3-æ–°ç‰ˆæœ¬æ”¹å˜" tabindex="-1"><a class="header-anchor" href="#_3-æ–°ç‰ˆæœ¬æ”¹å˜" aria-hidden="true">#</a> ï¼ˆ3ï¼‰æ–°ç‰ˆæœ¬æ”¹å˜</h5><p>ElasticSearch7-å»æ‰typeæ¦‚å¿µ</p><ol><li><p>å…³ç³»å‹æ•°æ®åº“ä¸­ä¸¤ä¸ªæ•°æ®è¡¨ç¤ºæ˜¯ç‹¬ç«‹çš„ï¼Œå³ä½¿ä»–ä»¬é‡Œé¢æœ‰ç›¸åŒåç§°çš„åˆ—ä¹Ÿä¸å½±å“ä½¿ç”¨ï¼Œä½†ESä¸­ä¸æ˜¯è¿™æ ·çš„ã€‚elasticsearchæ˜¯åŸºäºLuceneå¼€å‘çš„æœç´¢å¼•æ“ï¼Œè€ŒESä¸­ä¸åŒtypeä¸‹åç§°ç›¸åŒçš„filedæœ€ç»ˆåœ¨Luceneä¸­çš„å¤„ç†æ–¹å¼æ˜¯ä¸€æ ·çš„ã€‚</p><ul><li>ä¸¤ä¸ªä¸åŒtypeä¸‹çš„ä¸¤ä¸ªuser_nameï¼Œåœ¨ESåŒä¸€ä¸ªç´¢å¼•ä¸‹å…¶å®è¢«è®¤ä¸ºæ˜¯åŒä¸€ä¸ªfiledï¼Œä½ å¿…é¡»åœ¨ä¸¤ä¸ªä¸åŒçš„typeä¸­å®šä¹‰ç›¸åŒçš„filedæ˜ å°„ã€‚å¦åˆ™ï¼Œä¸åŒtypeä¸­çš„ç›¸åŒå­—æ®µåç§°å°±ä¼šåœ¨å¤„ç†ä¸­å‡ºç°å†²çªçš„æƒ…å†µï¼Œå¯¼è‡´Luceneå¤„ç†æ•ˆç‡ä¸‹é™ã€‚</li><li>å»æ‰typeå°±æ˜¯ä¸ºäº†æé«˜ESå¤„ç†æ•°æ®çš„æ•ˆç‡ã€‚</li></ul></li><li><p>Elasticsearch 7.x URLä¸­çš„typeå‚æ•°ä¸ºå¯é€‰ã€‚æ¯”å¦‚ï¼Œç´¢å¼•ä¸€ä¸ªæ–‡æ¡£ä¸å†è¦æ±‚æä¾›æ–‡æ¡£ç±»å‹ã€‚</p></li><li><p>Elasticsearch 8.x ä¸å†æ”¯æŒURLä¸­çš„typeå‚æ•°ã€‚</p></li><li><p>è§£å†³ï¼š å°†ç´¢å¼•ä»å¤šç±»å‹è¿ç§»åˆ°å•ç±»å‹ï¼Œæ¯ç§ç±»å‹æ–‡æ¡£ä¸€ä¸ªç‹¬ç«‹ç´¢å¼•</p><p>å°†å·²å­˜åœ¨çš„ç´¢å¼•ä¸‹çš„ç±»å‹æ•°æ®ï¼Œå…¨éƒ¨è¿ç§»åˆ°æŒ‡å®šä½ç½®å³å¯ã€‚è¯¦è§æ•°æ®è¿ç§»</p></li></ol><blockquote><p><strong>Elasticsearch 7.x</strong></p><ul><li>Specifying types in requests is deprecated. For instance, indexing a document no longer requires a document <code>type</code>. The new index APIs are <code>PUT {index}/_doc/{id}</code> in case of explicit ids and <code>POST {index}/_doc</code> for auto-generated ids. Note that in 7.0, <code>_doc</code> is a permanent part of the path, and represents the endpoint name rather than the document type.</li><li>The <code>include_type_name</code> parameter in the index creation, index template, and mapping APIs will default to <code>false</code>. Setting the parameter at all will result in a deprecation warning.</li><li>The <code>_default_</code> mapping type is removed.</li></ul><p><strong>Elasticsearch 8.x</strong></p><ul><li>Specifying types in requests is no longer supported.</li><li>The <code>include_type_name</code> parameter is removed.</li></ul></blockquote><h6 id="åˆ›å»ºæ˜ å°„" tabindex="-1"><a class="header-anchor" href="#åˆ›å»ºæ˜ å°„" aria-hidden="true">#</a> åˆ›å»ºæ˜ å°„</h6><p>åˆ›å»ºç´¢å¼•å¹¶æŒ‡å®šå±æ€§çš„æ˜ å°„è§„åˆ™ï¼ˆ<strong>ç›¸å½“äºæ–°å»ºè¡¨å¹¶åˆ¶å®šå­—æ®µå’Œå­—æ®µç±»å‹</strong>ï¼‰</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>PUT /my_index
{
  &quot;mappings&quot;: {
    &quot;properties&quot;: {
      &quot;age&quot;: {
        &quot;type&quot;: &quot;integer&quot;
      },
      &quot;email&quot;: {
        &quot;type&quot;: &quot;keyword&quot;
      },
      &quot;name&quot;: {
        &quot;type&quot;: &quot;text&quot;
      }
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;acknowledged&quot; : true,
  &quot;shards_acknowledged&quot; : true,
  &quot;index&quot; : &quot;my_index&quot;
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="æŸ¥çœ‹æ˜ å°„" tabindex="-1"><a class="header-anchor" href="#æŸ¥çœ‹æ˜ å°„" aria-hidden="true">#</a> æŸ¥çœ‹æ˜ å°„</h6><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET /my_index
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è¾“å‡ºç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>//&quot;index&quot; : false æ˜¯å¦è¢«ç´¢å¼•å³èƒ½è¢«æ£€ç´¢åˆ°ï¼Œé»˜è®¤æ˜¯true
{
  &quot;my_index&quot; : {
    &quot;aliases&quot; : { },
    &quot;mappings&quot; : {
      &quot;properties&quot; : {
        &quot;age&quot; : {
          &quot;type&quot; : &quot;integer&quot;
        },
        &quot;email&quot; : {
          &quot;type&quot; : &quot;keyword&quot;
        },
        &quot;employee-id&quot; : {
          &quot;type&quot; : &quot;keyword&quot;,
          &quot;index&quot; : false
        },
        &quot;name&quot; : {
          &quot;type&quot; : &quot;text&quot;
        }
      }
    },
    &quot;settings&quot; : {
      &quot;index&quot; : {
        &quot;creation_date&quot; : &quot;1588410780774&quot;,
        &quot;number_of_shards&quot; : &quot;1&quot;,
        &quot;number_of_replicas&quot; : &quot;1&quot;,
        &quot;uuid&quot; : &quot;ua0lXhtkQCOmn7Kh3iUu0w&quot;,
        &quot;version&quot; : {
          &quot;created&quot; : &quot;7060299&quot;
        },
        &quot;provided_name&quot; : &quot;my_index&quot;
      }
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="æ·»åŠ æ–°çš„å­—æ®µæ˜ å°„" tabindex="-1"><a class="header-anchor" href="#æ·»åŠ æ–°çš„å­—æ®µæ˜ å°„" aria-hidden="true">#</a> æ·»åŠ æ–°çš„å­—æ®µæ˜ å°„</h6><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>PUT /my_index/_mapping
{
  &quot;properties&quot;: {
    &quot;employee-id&quot;: {
      &quot;type&quot;: &quot;keyword&quot;,
      &quot;index&quot;: false
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œçš„ &quot;index&quot;: falseï¼Œè¡¨æ˜æ–°å¢çš„å­—æ®µä¸èƒ½è¢«æ£€ç´¢ï¼Œåªæ˜¯ä¸€ä¸ªå†—ä½™å­—æ®µã€‚</p><h6 id="æ›´æ–°æ˜ å°„" tabindex="-1"><a class="header-anchor" href="#æ›´æ–°æ˜ å°„" aria-hidden="true">#</a> æ›´æ–°æ˜ å°„</h6><p>å¯¹äºå·²ç»å­˜åœ¨çš„å­—æ®µæ˜ å°„ï¼Œæˆ‘ä»¬ä¸èƒ½æ›´æ–°ã€‚æ›´æ–°å¿…é¡»åˆ›å»ºæ–°çš„ç´¢å¼•ï¼Œè¿›è¡Œæ•°æ®è¿ç§»ã€‚</p><h6 id="æ•°æ®è¿ç§»" tabindex="-1"><a class="header-anchor" href="#æ•°æ®è¿ç§»" aria-hidden="true">#</a> æ•°æ®è¿ç§»</h6><p>å…ˆåˆ›å»ºnew_twitterçš„æ­£ç¡®æ˜ å°„ã€‚ç„¶åä½¿ç”¨å¦‚ä¸‹æ–¹å¼è¿›è¡Œæ•°æ®è¿ç§»ã€‚</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>POST reindex [å›ºå®šå†™æ³•]
{
  &quot;source&quot;:{
      &quot;index&quot;:&quot;twitter&quot;
   },
  &quot;dest&quot;:{
      &quot;index&quot;:&quot;new_twitters&quot;
   }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å°†æ—§ç´¢å¼•çš„typeä¸‹çš„æ•°æ®è¿›è¡Œè¿ç§»</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>POST reindex [å›ºå®šå†™æ³•]
{
  &quot;source&quot;:{
      &quot;index&quot;:&quot;twitter&quot;,
      &quot;twitter&quot;:&quot;twitter&quot;
   },
  &quot;dest&quot;:{
      &quot;index&quot;:&quot;new_twitters&quot;
   }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ›´å¤šè¯¦æƒ…è§ï¼š <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.6/docs-reindex.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/elasticsearch/reference/7.6/docs-reindex.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>GET /bank/_search</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;took&quot; : 0,
  &quot;timed_out&quot; : false,
  &quot;_shards&quot; : {
    &quot;total&quot; : 1,
    &quot;successful&quot; : 1,
    &quot;skipped&quot; : 0,
    &quot;failed&quot; : 0
  },
  &quot;hits&quot; : {
    &quot;total&quot; : {
      &quot;value&quot; : 1000,
      &quot;relation&quot; : &quot;eq&quot;
    },
    &quot;max_score&quot; : 1.0,
    &quot;hits&quot; : [
      {
        &quot;_index&quot; : &quot;bank&quot;,
        &quot;_type&quot; : &quot;account&quot;,//ç±»å‹ä¸ºaccount
        &quot;_id&quot; : &quot;1&quot;,
        &quot;_score&quot; : 1.0,
        &quot;_source&quot; : {
          &quot;account_number&quot; : 1,
          &quot;balance&quot; : 39225,
          &quot;firstname&quot; : &quot;Amber&quot;,
          &quot;lastname&quot; : &quot;Duke&quot;,
          &quot;age&quot; : 32,
          &quot;gender&quot; : &quot;M&quot;,
          &quot;address&quot; : &quot;880 Holmes Lane&quot;,
          &quot;employer&quot; : &quot;Pyrami&quot;,
          &quot;email&quot; : &quot;amberduke@pyrami.com&quot;,
          &quot;city&quot; : &quot;Brogan&quot;,
          &quot;state&quot; : &quot;IL&quot;
        }
      },
      ...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET /bank/_search
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200502174825233.png" alt="image-20200502174825233"></p><p>æƒ³è¦å°†å¹´é¾„ä¿®æ”¹ä¸ºinteger</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>PUT /newbank
{
  &quot;mappings&quot;: {
    &quot;properties&quot;: {
      &quot;account_number&quot;: {
        &quot;type&quot;: &quot;long&quot;
      },
      &quot;address&quot;: {
        &quot;type&quot;: &quot;text&quot;
      },
      &quot;age&quot;: {
        &quot;type&quot;: &quot;integer&quot;
      },
      &quot;balance&quot;: {
        &quot;type&quot;: &quot;long&quot;
      },
      &quot;city&quot;: {
        &quot;type&quot;: &quot;keyword&quot;
      },
      &quot;email&quot;: {
        &quot;type&quot;: &quot;keyword&quot;
      },
      &quot;employer&quot;: {
        &quot;type&quot;: &quot;keyword&quot;
      },
      &quot;firstname&quot;: {
        &quot;type&quot;: &quot;text&quot;
      },
      &quot;gender&quot;: {
        &quot;type&quot;: &quot;keyword&quot;
      },
      &quot;lastname&quot;: {
        &quot;type&quot;: &quot;text&quot;,
        &quot;fields&quot;: {
          &quot;keyword&quot;: {
            &quot;type&quot;: &quot;keyword&quot;,
            &quot;ignore_above&quot;: 256
          }
        }
      },
      &quot;state&quot;: {
        &quot;type&quot;: &quot;keyword&quot;
      }
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥çœ‹â€œnewbankâ€çš„æ˜ å°„ï¼š</p><p>GET /newbank/_mapping</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200502175901959.png" alt="image-20200502175901959"></p><p>èƒ½å¤Ÿçœ‹åˆ°ageçš„æ˜ å°„ç±»å‹è¢«ä¿®æ”¹ä¸ºäº†integer.</p><p>å°†bankä¸­çš„æ•°æ®è¿ç§»åˆ°newbankä¸­</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>POST _reindex
{
  &quot;source&quot;: {
    &quot;index&quot;: &quot;bank&quot;,
    &quot;type&quot;: &quot;account&quot;
  },
  &quot;dest&quot;: {
    &quot;index&quot;: &quot;newbank&quot;
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œè¾“å‡ºï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>#! Deprecation: [types removal] Specifying types in reindex requests is deprecated.
{
  &quot;took&quot; : 768,
  &quot;timed_out&quot; : false,
  &quot;total&quot; : 1000,
  &quot;updated&quot; : 0,
  &quot;created&quot; : 1000,
  &quot;deleted&quot; : 0,
  &quot;batches&quot; : 1,
  &quot;version_conflicts&quot; : 0,
  &quot;noops&quot; : 0,
  &quot;retries&quot; : {
    &quot;bulk&quot; : 0,
    &quot;search&quot; : 0
  },
  &quot;throttled_millis&quot; : 0,
  &quot;requests_per_second&quot; : -1.0,
  &quot;throttled_until_millis&quot; : 0,
  &quot;failures&quot; : [ ]
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥çœ‹newbankä¸­çš„æ•°æ®</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200502181432745.png" alt="image-20200502181432745"></p><h4 id="_4-åˆ†è¯" tabindex="-1"><a class="header-anchor" href="#_4-åˆ†è¯" aria-hidden="true">#</a> 4ï¼‰åˆ†è¯</h4><p>ä¸€ä¸ªtokenizerï¼ˆåˆ†è¯å™¨ï¼‰æ¥æ”¶ä¸€ä¸ªå­—ç¬¦æµï¼Œå°†ä¹‹åˆ†å‰²ä¸ºç‹¬ç«‹çš„tokensï¼ˆè¯å…ƒï¼Œé€šå¸¸æ˜¯ç‹¬ç«‹çš„å•è¯ï¼‰ï¼Œç„¶åè¾“å‡ºtokensæµã€‚</p><p>ä¾‹å¦‚ï¼šwhitespace tokenizeré‡åˆ°ç©ºç™½å­—ç¬¦æ—¶åˆ†å‰²æ–‡æœ¬ã€‚å®ƒä¼šå°†æ–‡æœ¬â€œQuick brown fox!â€åˆ†å‰²ä¸º[Quick,brown,fox!]ã€‚</p><p>è¯¥tokenizerï¼ˆåˆ†è¯å™¨ï¼‰è¿˜è´Ÿè´£è®°å½•å„ä¸ªterms(è¯æ¡)çš„é¡ºåºæˆ–positionä½ç½®ï¼ˆç”¨äºphraseçŸ­è¯­å’Œword proximityè¯è¿‘é‚»æŸ¥è¯¢ï¼‰ï¼Œä»¥åŠtermï¼ˆè¯æ¡ï¼‰æ‰€ä»£è¡¨çš„åŸå§‹wordï¼ˆå•è¯ï¼‰çš„startï¼ˆèµ·å§‹ï¼‰å’Œendï¼ˆç»“æŸï¼‰çš„character offsetsï¼ˆå­—ç¬¦ä¸²åç§»é‡ï¼‰ï¼ˆç”¨äºé«˜äº®æ˜¾ç¤ºæœç´¢çš„å†…å®¹ï¼‰ã€‚</p><p>elasticsearchæä¾›äº†å¾ˆå¤šå†…ç½®çš„åˆ†è¯å™¨ï¼Œå¯ä»¥ç”¨æ¥æ„å»ºcustom analyzersï¼ˆè‡ªå®šä¹‰åˆ†è¯å™¨ï¼‰ã€‚</p><p>å…³äºåˆ†è¯å™¨ï¼š <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.6/analysis.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/elasticsearch/reference/7.6/analysis.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>POST _analyze
{
  &quot;analyzer&quot;: &quot;standard&quot;,
  &quot;text&quot;: &quot;The 2 QUICK Brown-Foxes jumped over the lazy dog&#39;s bone.&quot;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;tokens&quot; : [
    {
      &quot;token&quot; : &quot;the&quot;,
      &quot;start_offset&quot; : 0,
      &quot;end_offset&quot; : 3,
      &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;,
      &quot;position&quot; : 0
    },
    {
      &quot;token&quot; : &quot;2&quot;,
      &quot;start_offset&quot; : 4,
      &quot;end_offset&quot; : 5,
      &quot;type&quot; : &quot;&lt;NUM&gt;&quot;,
      &quot;position&quot; : 1
    },
    {
      &quot;token&quot; : &quot;quick&quot;,
      &quot;start_offset&quot; : 6,
      &quot;end_offset&quot; : 11,
      &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;,
      &quot;position&quot; : 2
    },
    {
      &quot;token&quot; : &quot;brown&quot;,
      &quot;start_offset&quot; : 12,
      &quot;end_offset&quot; : 17,
      &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;,
      &quot;position&quot; : 3
    },
    {
      &quot;token&quot; : &quot;foxes&quot;,
      &quot;start_offset&quot; : 18,
      &quot;end_offset&quot; : 23,
      &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;,
      &quot;position&quot; : 4
    },
    {
      &quot;token&quot; : &quot;jumped&quot;,
      &quot;start_offset&quot; : 24,
      &quot;end_offset&quot; : 30,
      &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;,
      &quot;position&quot; : 5
    },
    {
      &quot;token&quot; : &quot;over&quot;,
      &quot;start_offset&quot; : 31,
      &quot;end_offset&quot; : 35,
      &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;,
      &quot;position&quot; : 6
    },
    {
      &quot;token&quot; : &quot;the&quot;,
      &quot;start_offset&quot; : 36,
      &quot;end_offset&quot; : 39,
      &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;,
      &quot;position&quot; : 7
    },
    {
      &quot;token&quot; : &quot;lazy&quot;,
      &quot;start_offset&quot; : 40,
      &quot;end_offset&quot; : 44,
      &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;,
      &quot;position&quot; : 8
    },
    {
      &quot;token&quot; : &quot;dog&#39;s&quot;,
      &quot;start_offset&quot; : 45,
      &quot;end_offset&quot; : 50,
      &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;,
      &quot;position&quot; : 9
    },
    {
      &quot;token&quot; : &quot;bone&quot;,
      &quot;start_offset&quot; : 51,
      &quot;end_offset&quot; : 55,
      &quot;type&quot; : &quot;&lt;ALPHANUM&gt;&quot;,
      &quot;position&quot; : 10
    }
  ]
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_1-å®‰è£…ikåˆ†è¯å™¨" tabindex="-1"><a class="header-anchor" href="#_1-å®‰è£…ikåˆ†è¯å™¨" aria-hidden="true">#</a> ï¼ˆ1ï¼‰å®‰è£…ikåˆ†è¯å™¨</h5><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200502182929583.png" alt="image-20200502182929583"></p><p>æ‰€æœ‰çš„è¯­è¨€åˆ†è¯ï¼Œé»˜è®¤ä½¿ç”¨çš„éƒ½æ˜¯â€œStandard Analyzerâ€ï¼Œä½†æ˜¯è¿™äº›åˆ†è¯å™¨é’ˆå¯¹äºä¸­æ–‡çš„åˆ†è¯ï¼Œå¹¶ä¸å‹å¥½ã€‚ä¸ºæ­¤éœ€è¦å®‰è£…ä¸­æ–‡çš„åˆ†è¯å™¨ã€‚</p><p>æ³¨æ„ï¼šä¸èƒ½ç”¨é»˜è®¤elasticsearch-plugin install xxx.zip è¿›è¡Œè‡ªåŠ¨å®‰è£… <a href="https://github.com/medcl/elasticsearch-analysis-ik/releases/download" target="_blank" rel="noopener noreferrer">https://github.com/medcl/elasticsearch-analysis-ik/releases/download<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> å¯¹åº”esç‰ˆæœ¬å®‰è£…</p><p>åœ¨å‰é¢å®‰è£…çš„elasticsearchæ—¶ï¼Œæˆ‘ä»¬å·²ç»å°†elasticsearchå®¹å™¨çš„â€œ/usr/share/elasticsearch/pluginsâ€ç›®å½•ï¼Œæ˜ å°„åˆ°å®¿ä¸»æœºçš„â€œ /mydata/elasticsearch/pluginsâ€ç›®å½•ä¸‹ï¼Œæ‰€ä»¥æ¯”è¾ƒæ–¹ä¾¿çš„åšæ³•å°±æ˜¯ä¸‹è½½â€œ/elasticsearch-analysis-ik-7.6.2.zipâ€æ–‡ä»¶ï¼Œç„¶åè§£å‹åˆ°è¯¥æ–‡ä»¶å¤¹ä¸‹å³å¯ã€‚å®‰è£…å®Œæ¯•åï¼Œéœ€è¦é‡å¯elasticsearchå®¹å™¨ã€‚</p><p>å¦‚æœä¸å«Œéº»çƒ¦ï¼Œè¿˜å¯ä»¥é‡‡ç”¨å¦‚ä¸‹çš„æ–¹å¼ã€‚</p><h6 id="_1-æŸ¥çœ‹elasticsearchç‰ˆæœ¬å·" tabindex="-1"><a class="header-anchor" href="#_1-æŸ¥çœ‹elasticsearchç‰ˆæœ¬å·" aria-hidden="true">#</a> ï¼ˆ1ï¼‰æŸ¥çœ‹elasticsearchç‰ˆæœ¬å·ï¼š</h6><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@hadoop-104 ~<span class="token punctuation">]</span><span class="token comment"># curl http://localhost:9200</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;0adeb7852e00&quot;</span>,
  <span class="token string">&quot;cluster_name&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;elasticsearch&quot;</span>,
  <span class="token string">&quot;cluster_uuid&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;9gglpP0HTfyOTRAaSe2rIg&quot;</span>,
  <span class="token string">&quot;version&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;number&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;7.6.2&quot;</span>,      <span class="token comment">#ç‰ˆæœ¬å·ä¸º7.6.2</span>
    <span class="token string">&quot;build_flavor&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;default&quot;</span>,
    <span class="token string">&quot;build_type&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;docker&quot;</span>,
    <span class="token string">&quot;build_hash&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;ef48eb35cf30adf4db14086e8aabd07ef6fb113f&quot;</span>,
    <span class="token string">&quot;build_date&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;2020-03-26T06:34:37.794943Z&quot;</span>,
    <span class="token string">&quot;build_snapshot&quot;</span> <span class="token builtin class-name">:</span> false,
    <span class="token string">&quot;lucene_version&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;8.4.0&quot;</span>,
    <span class="token string">&quot;minimum_wire_compatibility_version&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;6.8.0&quot;</span>,
    <span class="token string">&quot;minimum_index_compatibility_version&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;6.0.0-beta1&quot;</span>
  <span class="token punctuation">}</span>,
  <span class="token string">&quot;tagline&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;You Know, for Search&quot;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">[</span>root@hadoop-104 ~<span class="token punctuation">]</span><span class="token comment"># </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_2-è¿›å…¥eså®¹å™¨å†…éƒ¨pluginç›®å½•" tabindex="-1"><a class="header-anchor" href="#_2-è¿›å…¥eså®¹å™¨å†…éƒ¨pluginç›®å½•" aria-hidden="true">#</a> ï¼ˆ2ï¼‰è¿›å…¥eså®¹å™¨å†…éƒ¨pluginç›®å½•</h6><ul><li>docker exec -it å®¹å™¨id /bin/bash</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@hadoop-104 ~<span class="token punctuation">]</span><span class="token comment"># docker exec -it elasticsearch /bin/bash</span>
<span class="token punctuation">[</span>root@0adeb7852e00 elasticsearch<span class="token punctuation">]</span><span class="token comment"># </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>wget <a href="https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.6.2/elasticsearch-analysis-ik-7.6.2.zip" target="_blank" rel="noopener noreferrer">https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.6.2/elasticsearch-analysis-ik-7.6.2.zip<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@0adeb7852e00 elasticsearch<span class="token punctuation">]</span><span class="token comment"># pwd</span>
/usr/share/elasticsearch
<span class="token comment">#ä¸‹è½½ik7.6.2</span>
<span class="token punctuation">[</span>root@0adeb7852e00 elasticsearch<span class="token punctuation">]</span><span class="token comment"># wget https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.6.2/elasticsearch-analysis-ik-7.6.2.zip</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>unzip ä¸‹è½½çš„æ–‡ä»¶</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@0adeb7852e00 elasticsearch<span class="token punctuation">]</span><span class="token comment"># unzip elasticsearch-analysis-ik-7.6.2.zip -d ink</span>
Archive:  elasticsearch-analysis-ik-7.6.2.zip
   creating: ik/config/
  inflating: ik/config/main.dic      
  inflating: ik/config/quantifier.dic  
  inflating: ik/config/extra_single_word_full.dic  
  inflating: ik/config/IKAnalyzer.cfg.xml  
  inflating: ik/config/surname.dic   
  inflating: ik/config/suffix.dic    
  inflating: ik/config/stopword.dic  
  inflating: ik/config/extra_main.dic  
  inflating: ik/config/extra_stopword.dic  
  inflating: ik/config/preposition.dic  
  inflating: ik/config/extra_single_word_low_freq.dic  
  inflating: ik/config/extra_single_word.dic  
  inflating: ik/elasticsearch-analysis-ik-7.6.2.jar  
  inflating: ik/httpclient-4.5.2.jar  
  inflating: ik/httpcore-4.4.4.jar   
  inflating: ik/commons-logging-1.2.jar  
  inflating: ik/commons-codec-1.9.jar  
  inflating: ik/plugin-descriptor.properties  
  inflating: ik/plugin-security.policy  
<span class="token punctuation">[</span>root@0adeb7852e00 elasticsearch<span class="token punctuation">]</span><span class="token comment">#</span>
<span class="token comment">#ç§»åŠ¨åˆ°pluginsç›®å½•ä¸‹</span>
<span class="token punctuation">[</span>root@0adeb7852e00 elasticsearch<span class="token punctuation">]</span><span class="token comment"># mv ik plugins/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>rm -rf *.zip</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>[root@0adeb7852e00 elasticsearch]# rm -rf elasticsearch-analysis-ik-7.6.2.zip 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ç¡®è®¤æ˜¯å¦å®‰è£…å¥½äº†åˆ†è¯å™¨</p><h5 id="_2-æµ‹è¯•åˆ†è¯å™¨" tabindex="-1"><a class="header-anchor" href="#_2-æµ‹è¯•åˆ†è¯å™¨" aria-hidden="true">#</a> ï¼ˆ2ï¼‰æµ‹è¯•åˆ†è¯å™¨</h5><p>ä½¿ç”¨é»˜è®¤</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET my_index/_analyze
{
   &quot;text&quot;:&quot;æˆ‘æ˜¯ä¸­å›½äºº&quot;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯·è§‚å¯Ÿæ‰§è¡Œç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;tokens&quot; : [
    {
      &quot;token&quot; : &quot;æˆ‘&quot;,
      &quot;start_offset&quot; : 0,
      &quot;end_offset&quot; : 1,
      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,
      &quot;position&quot; : 0
    },
    {
      &quot;token&quot; : &quot;æ˜¯&quot;,
      &quot;start_offset&quot; : 1,
      &quot;end_offset&quot; : 2,
      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,
      &quot;position&quot; : 1
    },
    {
      &quot;token&quot; : &quot;ä¸­&quot;,
      &quot;start_offset&quot; : 2,
      &quot;end_offset&quot; : 3,
      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,
      &quot;position&quot; : 2
    },
    {
      &quot;token&quot; : &quot;å›½&quot;,
      &quot;start_offset&quot; : 3,
      &quot;end_offset&quot; : 4,
      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,
      &quot;position&quot; : 3
    },
    {
      &quot;token&quot; : &quot;äºº&quot;,
      &quot;start_offset&quot; : 4,
      &quot;end_offset&quot; : 5,
      &quot;type&quot; : &quot;&lt;IDEOGRAPHIC&gt;&quot;,
      &quot;position&quot; : 4
    }
  ]
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET my_index/_analyze
{
   &quot;analyzer&quot;: &quot;ik_smart&quot;, 
   &quot;text&quot;:&quot;æˆ‘æ˜¯ä¸­å›½äºº&quot;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;tokens&quot; : [
    {
      &quot;token&quot; : &quot;æˆ‘&quot;,
      &quot;start_offset&quot; : 0,
      &quot;end_offset&quot; : 1,
      &quot;type&quot; : &quot;CN_CHAR&quot;,
      &quot;position&quot; : 0
    },
    {
      &quot;token&quot; : &quot;æ˜¯&quot;,
      &quot;start_offset&quot; : 1,
      &quot;end_offset&quot; : 2,
      &quot;type&quot; : &quot;CN_CHAR&quot;,
      &quot;position&quot; : 1
    },
    {
      &quot;token&quot; : &quot;ä¸­å›½äºº&quot;,
      &quot;start_offset&quot; : 2,
      &quot;end_offset&quot; : 5,
      &quot;type&quot; : &quot;CN_WORD&quot;,
      &quot;position&quot; : 2
    }
  ]
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET my_index/_analyze
{
   &quot;analyzer&quot;: &quot;ik_max_word&quot;, 
   &quot;text&quot;:&quot;æˆ‘æ˜¯ä¸­å›½äºº&quot;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;tokens&quot; : [
    {
      &quot;token&quot; : &quot;æˆ‘&quot;,
      &quot;start_offset&quot; : 0,
      &quot;end_offset&quot; : 1,
      &quot;type&quot; : &quot;CN_CHAR&quot;,
      &quot;position&quot; : 0
    },
    {
      &quot;token&quot; : &quot;æ˜¯&quot;,
      &quot;start_offset&quot; : 1,
      &quot;end_offset&quot; : 2,
      &quot;type&quot; : &quot;CN_CHAR&quot;,
      &quot;position&quot; : 1
    },
    {
      &quot;token&quot; : &quot;ä¸­å›½äºº&quot;,
      &quot;start_offset&quot; : 2,
      &quot;end_offset&quot; : 5,
      &quot;type&quot; : &quot;CN_WORD&quot;,
      &quot;position&quot; : 2
    },
    {
      &quot;token&quot; : &quot;ä¸­å›½&quot;,
      &quot;start_offset&quot; : 2,
      &quot;end_offset&quot; : 4,
      &quot;type&quot; : &quot;CN_WORD&quot;,
      &quot;position&quot; : 3
    },
    {
      &quot;token&quot; : &quot;å›½äºº&quot;,
      &quot;start_offset&quot; : 3,
      &quot;end_offset&quot; : 5,
      &quot;type&quot; : &quot;CN_WORD&quot;,
      &quot;position&quot; : 4
    }
  ]
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-è‡ªå®šä¹‰è¯åº“" tabindex="-1"><a class="header-anchor" href="#_3-è‡ªå®šä¹‰è¯åº“" aria-hidden="true">#</a> ï¼ˆ3ï¼‰è‡ªå®šä¹‰è¯åº“</h5><ul><li>ä¿®æ”¹/usr/share/elasticsearch/plugins/ik/configä¸­çš„IKAnalyzer.cfg.xml /usr/share/elasticsearch/plugins/ik/config</li></ul><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">properties</span> <span class="token name">SYSTEM</span> <span class="token string">&quot;http://java.sun.com/dtd/properties.dtd&quot;</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>comment</span><span class="token punctuation">&gt;</span></span>IK Analyzer æ‰©å±•é…ç½®<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>comment</span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•å­—å…¸ --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ext_dict<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
	 <span class="token comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•åœæ­¢è¯å­—å…¸--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ext_stopwords<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•å­—å…¸ --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>remote_ext_dict<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>http://192.168.13.100/es/fenci.txt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span> 
	<span class="token comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•åœæ­¢è¯å­—å…¸--&gt;</span>
	<span class="token comment">&lt;!-- &lt;entry key=&quot;remote_ext_stopwords&quot;&gt;words_location&lt;/entry&gt; --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŸæ¥çš„xml</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">properties</span> <span class="token name">SYSTEM</span> <span class="token string">&quot;http://java.sun.com/dtd/properties.dtd&quot;</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>comment</span><span class="token punctuation">&gt;</span></span>IK Analyzer æ‰©å±•é…ç½®<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>comment</span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•å­—å…¸ --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ext_dict<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
	 <span class="token comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•åœæ­¢è¯å­—å…¸--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>entry</span> <span class="token attr-name">key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ext_stopwords<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>entry</span><span class="token punctuation">&gt;</span></span>
	<span class="token comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•å­—å…¸ --&gt;</span>
	<span class="token comment">&lt;!-- &lt;entry key=&quot;remote_ext_dict&quot;&gt;words_location&lt;/entry&gt; --&gt;</span>
	<span class="token comment">&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•åœæ­¢è¯å­—å…¸--&gt;</span>
	<span class="token comment">&lt;!-- &lt;entry key=&quot;remote_ext_stopwords&quot;&gt;words_location&lt;/entry&gt; --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¿®æ”¹å®Œæˆåï¼Œéœ€è¦é‡å¯elasticsearchå®¹å™¨ï¼Œå¦åˆ™ä¿®æ”¹ä¸ç”Ÿæ•ˆã€‚</p><p>æ›´æ–°å®Œæˆåï¼Œesåªä¼šå¯¹äºæ–°å¢çš„æ•°æ®ç”¨æ›´æ–°åˆ†è¯ã€‚å†å²æ•°æ®æ˜¯ä¸ä¼šé‡æ–°åˆ†è¯çš„ã€‚å¦‚æœæƒ³è¦å†å²æ•°æ®é‡æ–°åˆ†è¯ï¼Œéœ€è¦æ‰§è¡Œï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>POST my_index/_update_by_query?conflicts<span class="token operator">=</span>proceed
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><a href="http://192.168.13.101/es/fenci.txt%EF%BC%8C%E8%BF%99%E4%B8%AA%E6%98%AFnginx%E4%B8%8A%E8%B5%84%E6%BA%90%E7%9A%84%E8%AE%BF%E9%97%AE%E8%B7%AF%E5%BE%84" target="_blank" rel="noopener noreferrer">http://192.168.13.101/es/fenci.txtï¼Œè¿™ä¸ªæ˜¯nginxä¸Šèµ„æºçš„è®¿é—®è·¯å¾„<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>åœ¨è¿è¡Œä¸‹é¢å®ä¾‹ä¹‹å‰ï¼Œéœ€è¦å®‰è£…nginxï¼ˆå®‰è£…æ–¹æ³•è§å®‰è£…nginxï¼‰ï¼Œç„¶ååˆ›å»ºâ€œfenci.txtâ€æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;æ¨±æ¡ƒè¨å…¶é©¬ï¼Œå¸¦ä½ ç”œèœœå…¥å¤&quot;</span> <span class="token operator">&gt;</span> /mydata/nginx/html/fenci.txt 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æµ‹è¯•æ•ˆæœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET my_index/_analyze
{
   &quot;analyzer&quot;: &quot;ik_max_word&quot;, 
   &quot;text&quot;:&quot;æ¨±æ¡ƒè¨å…¶é©¬ï¼Œå¸¦ä½ ç”œèœœå…¥å¤&quot;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¾“å‡ºç»“æœï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>{
  &quot;tokens&quot; : [
    {
      &quot;token&quot; : &quot;æ¨±æ¡ƒ&quot;,
      &quot;start_offset&quot; : 0,
      &quot;end_offset&quot; : 2,
      &quot;type&quot; : &quot;CN_WORD&quot;,
      &quot;position&quot; : 0
    },
    {
      &quot;token&quot; : &quot;è¨å…¶é©¬&quot;,
      &quot;start_offset&quot; : 2,
      &quot;end_offset&quot; : 5,
      &quot;type&quot; : &quot;CN_WORD&quot;,
      &quot;position&quot; : 1
    },
    {
      &quot;token&quot; : &quot;å¸¦ä½ &quot;,
      &quot;start_offset&quot; : 6,
      &quot;end_offset&quot; : 8,
      &quot;type&quot; : &quot;CN_WORD&quot;,
      &quot;position&quot; : 2
    },
    {
      &quot;token&quot; : &quot;ç”œèœœ&quot;,
      &quot;start_offset&quot; : 8,
      &quot;end_offset&quot; : 10,
      &quot;type&quot; : &quot;CN_WORD&quot;,
      &quot;position&quot; : 3
    },
    {
      &quot;token&quot; : &quot;å…¥å¤&quot;,
      &quot;start_offset&quot; : 10,
      &quot;end_offset&quot; : 12,
      &quot;type&quot; : &quot;CN_WORD&quot;,
      &quot;position&quot; : 4
    }
  ]
}

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4ã€elasticsearch-rest-client" tabindex="-1"><a class="header-anchor" href="#_4ã€elasticsearch-rest-client" aria-hidden="true">#</a> 4ã€elasticsearch-Rest-Client</h3><h4 id="_1-9300-tcp" tabindex="-1"><a class="header-anchor" href="#_1-9300-tcp" aria-hidden="true">#</a> 1ï¼‰9300: TCP</h4><ul><li>spring-data-elasticsearch:transport-api.jar; <ul><li>springbootç‰ˆæœ¬ä¸åŒï¼Œransport-api.jarä¸åŒï¼Œä¸èƒ½é€‚é…esç‰ˆæœ¬</li><li>7.xå·²ç»ä¸å»ºè®®ä½¿ç”¨ï¼Œ8ä»¥åå°±è¦åºŸå¼ƒ</li></ul></li></ul><h4 id="_2-9200-http" tabindex="-1"><a class="header-anchor" href="#_2-9200-http" aria-hidden="true">#</a> 2ï¼‰9200: HTTP</h4><ul><li><p>jestClient: éå®˜æ–¹ï¼Œæ›´æ–°æ…¢ï¼›</p></li><li><p>RestTemplateï¼šæ¨¡æ‹ŸHTTPè¯·æ±‚ï¼ŒESå¾ˆå¤šæ“ä½œéœ€è¦è‡ªå·±å°è£…ï¼Œéº»çƒ¦ï¼›</p></li><li><p>HttpClientï¼šåŒä¸Šï¼›</p></li><li><p>Elasticsearch-Rest-Clientï¼šå®˜æ–¹RestClientï¼Œå°è£…äº†ESæ“ä½œï¼ŒAPIå±‚æ¬¡åˆ†æ˜ï¼Œä¸Šæ‰‹ç®€å•ï¼› æœ€ç»ˆé€‰æ‹©Elasticsearch-Rest-Clientï¼ˆelasticsearch-rest-high-level-clientï¼‰ï¼› <a href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li></ul><h3 id="_5ã€é™„å½•-å®‰è£…nginx" tabindex="-1"><a class="header-anchor" href="#_5ã€é™„å½•-å®‰è£…nginx" aria-hidden="true">#</a> 5ã€é™„å½•ï¼šå®‰è£…Nginx</h3><ul><li><p>éšä¾¿å¯åŠ¨ä¸€ä¸ªnginxå®ä¾‹ï¼Œåªæ˜¯ä¸ºäº†å¤åˆ¶å‡ºé…ç½®</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run -p <span class="token number">8081</span>:80 --name nginx -d nginx:1.10   
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>å°†å®¹å™¨å†…çš„é…ç½®æ–‡ä»¶æ‹·è´åˆ°/mydata/nginx/conf/ ä¸‹</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">mkdir</span> -p /mydata/nginx/html
<span class="token function">mkdir</span> -p /mydata/nginx/logs
<span class="token function">mkdir</span> -p /mydata/nginx/conf
<span class="token function">docker</span> container <span class="token function">cp</span> nginx:/etc/nginx <span class="token builtin class-name">.</span>  <span class="token comment">#æ‹·è´åˆ°å½“å‰æ–‡ä»¶å¤¹</span>
<span class="token comment">#ç”±äºæ‹·è´å®Œæˆåä¼šåœ¨configä¸­å­˜åœ¨ä¸€ä¸ªnginxæ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥éœ€è¦å°†å®ƒçš„å†…å®¹ç§»åŠ¨åˆ°confä¸­</span>
<span class="token function">mv</span> /mydata/nginx/conf/nginx/* /mydata/nginx/conf/
<span class="token function">rm</span> -rf /mydata/nginx/conf/nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ç»ˆæ­¢åŸå®¹å™¨ï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> stop nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>æ‰§è¡Œå‘½ä»¤åˆ é™¤åŸå®¹å™¨ï¼š</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> <span class="token function">rm</span> nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>åˆ›å»ºæ–°çš„Nginxï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">docker</span> run -p <span class="token number">80</span>:80 --name nginx <span class="token punctuation">\</span>
 -v /mydata/nginx/html:/usr/share/nginx/html <span class="token punctuation">\</span>
 -v /mydata/nginx/logs:/var/log/nginx <span class="token punctuation">\</span>
 -v /mydata/nginx/conf/:/etc/nginx <span class="token punctuation">\</span>
 -d nginx:1.10
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>è®¾ç½®å¼€æœºå¯åŠ¨nginx</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>docker update nginx --restart=always
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>åˆ›å»ºâ€œ/mydata/nginx/html/index.htmlâ€æ–‡ä»¶ï¼Œæµ‹è¯•æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸è®¿é—®</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>echo &#39;&lt;h2&gt;hello nginx!&lt;/h2&gt;&#39; &gt;/mydata/nginx/html/index.html
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è®¿é—®ï¼š<a href="http://xn--ngixIP-6y7ij32djrxcmle44b:80/index.html" target="_blank" rel="noopener noreferrer">http://ngixæ‰€åœ¨ä¸»æœºçš„IP:80/index.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li></ul><h2 id="_2-springbootæ•´åˆelasticsearch" tabindex="-1"><a class="header-anchor" href="#_2-springbootæ•´åˆelasticsearch" aria-hidden="true">#</a> 2.SpringBootæ•´åˆElasticSearch</h2><blockquote><p>åˆå§‹åŒ–ï¼š</p><p><a href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/7.6/java-rest-high-getting-started-initialization.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/elasticsearch/client/java-rest/7.6/java-rest-high-getting-started-initialization.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></blockquote><h3 id="_1ã€å¯¼å…¥ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#_1ã€å¯¼å…¥ä¾èµ–" aria-hidden="true">#</a> 1ã€å¯¼å…¥ä¾èµ–</h3><p>è¿™é‡Œçš„ç‰ˆæœ¬è¦å’Œæ‰€æŒ‰ç…§çš„ELKç‰ˆæœ¬åŒ¹é…ã€‚</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.elasticsearch.client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>elasticsearch-rest-high-level-client<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>7.6.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨spring-boot-dependenciesä¸­æ‰€ä¾èµ–çš„ELKç‰ˆæœ¬ä½6.8.7</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>elasticsearch.version</span><span class="token punctuation">&gt;</span></span>6.8.7<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>elasticsearch.version</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200511074437763.png" alt="image-20200511074437763"></p><p>éœ€è¦åœ¨é¡¹ç›®ä¸­å°†å®ƒæ”¹ä¸º7.6.2</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
    ...
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>elasticsearch.version</span><span class="token punctuation">&gt;</span></span>7.6.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>elasticsearch.version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> gulimall<span class="token punctuation">-</span>searcch
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">12000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯åŠ¨ç±»</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span><span class="token punctuation">(</span>exclude <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">DataSourceAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GulimallSearcchApplication</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">GulimallSearcchApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¼–å†™é…ç½®ç±»</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> hzz
 * <span class="token keyword">@create</span> 2022-07-14 15:18
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GulimallElasticSearchConfig</span> <span class="token punctuation">{</span>

    <span class="token comment">// æ‰€æœ‰è¯·æ±‚å…±äº«çš„é…ç½®</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">RequestOptions</span> COMMON_OPTIONS<span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token class-name">RequestOptions<span class="token punctuation">.</span>Builder</span> builder <span class="token operator">=</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">.</span><span class="token function">toBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// builder.addHeader(&quot;Authorization&quot;, &quot;Bearer &quot; + TOKEN);</span>
        <span class="token comment">// builder.setHttpAsyncResponseConsumerFactory(</span>
        <span class="token comment">//         new HttpAsyncResponseConsumerFactory</span>
        <span class="token comment">//                 .HeapBufferedResponseConsumerFactory(30 * 1024 * 1024 * 1024));</span>
        COMMON_OPTIONS <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// es å®¢æˆ·ç«¯</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RestHighLevelClient</span> <span class="token function">esRestClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestHighLevelClient</span><span class="token punctuation">(</span>
                <span class="token class-name">RestClient</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span>
                        <span class="token keyword">new</span> <span class="token class-name">HttpHost</span><span class="token punctuation">(</span><span class="token string">&quot;192.168.13.100&quot;</span><span class="token punctuation">,</span> <span class="token number">9200</span><span class="token punctuation">,</span> <span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2ã€ç¼–å†™æµ‹è¯•ç±»" tabindex="-1"><a class="header-anchor" href="#_2ã€ç¼–å†™æµ‹è¯•ç±»" aria-hidden="true">#</a> 2ã€ç¼–å†™æµ‹è¯•ç±»</h3><h4 id="_1-æµ‹è¯•ä¿å­˜æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_1-æµ‹è¯•ä¿å­˜æ•°æ®" aria-hidden="true">#</a> 1ï¼‰æµ‹è¯•ä¿å­˜æ•°æ®</h4><p><a href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high-document-index.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high-document-index.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">class</span> <span class="token class-name">GulimallSearcchApplicationTests</span> <span class="token punctuation">{</span>   
      
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RestHighLevelClient</span> client<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">indexData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">IndexRequest</span> indexRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IndexRequest</span> <span class="token punctuation">(</span><span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setUserName</span><span class="token punctuation">(</span><span class="token string">&quot;å¼ ä¸‰&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setGender</span><span class="token punctuation">(</span><span class="token string">&quot;ç”·&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> <span class="token class-name">String</span> <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®è¦ä¿å­˜çš„å†…å®¹</span>
        indexRequest<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">XContentType</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ‰§è¡Œåˆ›å»ºç´¢å¼•å’Œä¿å­˜æ•°æ®</span>
        <span class="token class-name">IndexResponse</span> index <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span>indexRequest<span class="token punctuation">,</span> <span class="token class-name">GulimallElasticSearchConfig</span><span class="token punctuation">.</span>COMMON_OPTIONS<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•å‰ï¼š</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200511111618183.png" alt="image-20200511111618183"></p><p>æµ‹è¯•åï¼š</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20200511112025327.png" alt="image-20200511112025327"></p><h4 id="_2-æµ‹è¯•è·å–æ•°æ®" tabindex="-1"><a class="header-anchor" href="#_2-æµ‹è¯•è·å–æ•°æ®" aria-hidden="true">#</a> 2ï¼‰æµ‹è¯•è·å–æ•°æ®</h4><p><a href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high-search.html" target="_blank" rel="noopener noreferrer">https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/java-rest-high-search.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">class</span> <span class="token class-name">GulimallSearcchApplicationTests</span> <span class="token punctuation">{</span>   
      
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RestHighLevelClient</span> client<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">GetRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GetRequest</span><span class="token punctuation">(</span><span class="token string">&quot;users&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        request<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">GetResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token class-name">GulimallElasticSearchConfig</span><span class="token punctuation">.</span>COMMON_OPTIONS<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æœç´¢addressä¸­åŒ…å«millçš„æ‰€æœ‰äººçš„å¹´é¾„åˆ†å¸ƒä»¥åŠå¹³å‡å¹´é¾„ï¼Œå¹³å‡è–ªèµ„</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>GET bank/_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;address&quot;: &quot;Mill&quot;
    }
  },
  &quot;aggs&quot;: {
    &quot;ageAgg&quot;: {
      &quot;terms&quot;: {
        &quot;field&quot;: &quot;age&quot;,
        &quot;size&quot;: 10
      }
    },
    &quot;ageAvg&quot;: {
      &quot;avg&quot;: {
        &quot;field&quot;: &quot;age&quot;
      }
    },
    &quot;balanceAvg&quot;: {
      &quot;avg&quot;: {
        &quot;field&quot;: &quot;balance&quot;
      }
    }
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>javaå®ç°</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">class</span> <span class="token class-name">GulimallSearcchApplicationTests</span> <span class="token punctuation">{</span>
    
     <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">RestHighLevelClient</span> client<span class="token punctuation">;</span>

	<span class="token doc-comment comment">/**
     * å¤æ‚æ£€ç´¢:åœ¨bankä¸­æœç´¢addressä¸­åŒ…å«millçš„æ‰€æœ‰äººçš„å¹´é¾„åˆ†å¸ƒä»¥åŠå¹³å‡å¹´é¾„ï¼Œå¹³å‡è–ªèµ„
     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">IOException</span></span>
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">searchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token comment">//1. åˆ›å»ºæ£€ç´¢è¯·æ±‚</span>
        <span class="token class-name">SearchRequest</span> searchRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//1.1ï¼‰æŒ‡å®šç´¢å¼•</span>
        searchRequest<span class="token punctuation">.</span><span class="token function">indices</span><span class="token punctuation">(</span><span class="token string">&quot;bank&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//1.2ï¼‰æ„é€ æ£€ç´¢æ¡ä»¶</span>
        <span class="token class-name">SearchSourceBuilder</span> sourceBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchSourceBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryBuilders</span><span class="token punctuation">.</span><span class="token function">matchQuery</span><span class="token punctuation">(</span><span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;Mill&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//1.2.1)æŒ‰ç…§å¹´é¾„åˆ†å¸ƒè¿›è¡Œèšåˆ</span>
        <span class="token class-name">TermsAggregationBuilder</span> ageAgg<span class="token operator">=</span><span class="token class-name">AggregationBuilders</span><span class="token punctuation">.</span><span class="token function">terms</span><span class="token punctuation">(</span><span class="token string">&quot;ageAgg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">aggregation</span><span class="token punctuation">(</span>ageAgg<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//1.2.2)è®¡ç®—å¹³å‡å¹´é¾„</span>
        <span class="token class-name">AvgAggregationBuilder</span> ageAvg <span class="token operator">=</span> <span class="token class-name">AggregationBuilders</span><span class="token punctuation">.</span><span class="token function">avg</span><span class="token punctuation">(</span><span class="token string">&quot;ageAvg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;age&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">aggregation</span><span class="token punctuation">(</span>ageAvg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//1.2.3)è®¡ç®—å¹³å‡è–ªèµ„</span>
        <span class="token class-name">AvgAggregationBuilder</span> balanceAvg <span class="token operator">=</span> <span class="token class-name">AggregationBuilders</span><span class="token punctuation">.</span><span class="token function">avg</span><span class="token punctuation">(</span><span class="token string">&quot;balanceAvg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">field</span><span class="token punctuation">(</span><span class="token string">&quot;balance&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sourceBuilder<span class="token punctuation">.</span><span class="token function">aggregation</span><span class="token punctuation">(</span>balanceAvg<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æ£€ç´¢æ¡ä»¶ï¼š&quot;</span><span class="token operator">+</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        searchRequest<span class="token punctuation">.</span><span class="token function">source</span><span class="token punctuation">(</span>sourceBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//2. æ‰§è¡Œæ£€ç´¢</span>
        <span class="token class-name">SearchResponse</span> searchResponse <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>searchRequest<span class="token punctuation">,</span> <span class="token class-name">RequestOptions</span><span class="token punctuation">.</span>DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æ£€ç´¢ç»“æœï¼š&quot;</span><span class="token operator">+</span>searchResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//3. å°†æ£€ç´¢ç»“æœå°è£…ä¸ºBean</span>
        <span class="token class-name">SearchHits</span> hits <span class="token operator">=</span> searchResponse<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SearchHit</span><span class="token punctuation">[</span><span class="token punctuation">]</span> searchHits <span class="token operator">=</span> hits<span class="token punctuation">.</span><span class="token function">getHits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchHit</span> searchHit <span class="token operator">:</span> searchHits<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> sourceAsString <span class="token operator">=</span> searchHit<span class="token punctuation">.</span><span class="token function">getSourceAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Account</span> account <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token function">parseObject</span><span class="token punctuation">(</span>sourceAsString<span class="token punctuation">,</span> <span class="token class-name">Account</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>account<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//4. è·å–èšåˆä¿¡æ¯</span>
        <span class="token class-name">Aggregations</span> aggregations <span class="token operator">=</span> searchResponse<span class="token punctuation">.</span><span class="token function">getAggregations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Terms</span> ageAgg1 <span class="token operator">=</span> aggregations<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;ageAgg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Terms<span class="token punctuation">.</span>Bucket</span> bucket <span class="token operator">:</span> ageAgg1<span class="token punctuation">.</span><span class="token function">getBuckets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> keyAsString <span class="token operator">=</span> bucket<span class="token punctuation">.</span><span class="token function">getKeyAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¹´é¾„ï¼š&quot;</span><span class="token operator">+</span>keyAsString<span class="token operator">+</span><span class="token string">&quot; ==&gt; &quot;</span><span class="token operator">+</span>bucket<span class="token punctuation">.</span><span class="token function">getDocCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">Avg</span> ageAvg1 <span class="token operator">=</span> aggregations<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;ageAvg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¹³å‡å¹´é¾„ï¼š&quot;</span><span class="token operator">+</span>ageAvg1<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Avg</span> balanceAvg1 <span class="token operator">=</span> aggregations<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;balanceAvg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å¹³å‡è–ªèµ„ï¼š&quot;</span><span class="token operator">+</span>balanceAvg1<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>  
	<span class="token annotation punctuation">@Data</span>
    <span class="token annotation punctuation">@ToString</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> accountNumber<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> balance<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> firstname<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> lastname<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> gender<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> address<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> employer<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> city<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">String</span> state<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯ä»¥å°è¯•å¯¹æ¯”æ‰“å°çš„æ¡ä»¶å’Œæ‰§è¡Œç»“æœï¼Œå’Œå‰é¢çš„ElasticSearchçš„æ£€ç´¢è¯­å¥å’Œæ£€ç´¢ç»“æœè¿›è¡Œæ¯”è¾ƒï¼›</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/tt110617/edit/main/demo/src/backend/high-performance/ElasticSearch.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="info">2022/8/17 10:42:03</span></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: 1253728268@qq.com">hzz</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/myblog/backend/high-performance/Docker.html" class="nav-link prev" aria-label="DockeråŸºç¡€ç¯‡"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><img class="icon" src="/myblog/icon/docker.png">DockeråŸºç¡€ç¯‡</div></a><!----></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"></div><div class="copyright">Copyright Â© 2022 åä¸€</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/myblog/assets/app.6a2d513d.js" defer></script>
  </body>
</html>
