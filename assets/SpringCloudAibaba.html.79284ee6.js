import{_ as e}from"./plugin-vue_export-helper.21dcd24c.js";import{o,c,a as n,b as t,d as p,e as s,r as l}from"./app.6a2d513d.js";const i={},u=p('<h1 id="springcloudalibaba" tabindex="-1"><a class="header-anchor" href="#springcloudalibaba" aria-hidden="true">#</a> SpringCloudAlibaba</h1><h2 id="_13-springcloud-alibaba-nacos\u670D\u52A1\u6CE8\u518C\u548C\u914D\u7F6E\u4E2D\u5FC3" tabindex="-1"><a class="header-anchor" href="#_13-springcloud-alibaba-nacos\u670D\u52A1\u6CE8\u518C\u548C\u914D\u7F6E\u4E2D\u5FC3" aria-hidden="true">#</a> 13.SpringCloud Alibaba Nacos\u670D\u52A1\u6CE8\u518C\u548C\u914D\u7F6E\u4E2D\u5FC3</h2><h3 id="springcloud-alibaba\u7B80\u4ECB" tabindex="-1"><a class="header-anchor" href="#springcloud-alibaba\u7B80\u4ECB" aria-hidden="true">#</a> SpringCloud Alibaba\u7B80\u4ECB</h3><h5 id="_1-\u4E3A\u4EC0\u4E48\u51FA\u73B0-springcloud-alibaba" tabindex="-1"><a class="header-anchor" href="#_1-\u4E3A\u4EC0\u4E48\u51FA\u73B0-springcloud-alibaba" aria-hidden="true">#</a> 1. \u4E3A\u4EC0\u4E48\u51FA\u73B0 SpringCloud Alibaba</h5><p>Spring Cloud Netflix\u9879\u76EE\u8FDB\u5165\u7EF4\u62A4\u6A21\u5F0F</p>',5),k={href:"https://spring.io/blog/2018/12/12/spring-cloud-greenwich-rc1-available-now",target:"_blank",rel:"noopener noreferrer"},r=s("https://spring.io/blog/2018/12/12/spring-cloud-greenwich-rc1-available-now"),d=n("p",null,"\u8FDB\u5165\u7EF4\u62A4\u6A21\u5F0F\u610F\u5473\u7740Spring Cloud Netflix \u5C06\u4E0D\u518D\u5F00\u53D1\u65B0\u7684\u7EC4\u4EF6",-1),m=n("p",null,"\u6211\u4EEC\u90FD\u77E5\u9053Spring Cloud \u7248\u672C\u8FED\u4EE3\u7B97\u662F\u6BD4\u8F83\u5FEB\u7684\uFF0C\u56E0\u800C\u51FA\u73B0\u4E86\u5F88\u591A\u91CD\u5927ISSUE\u90FD\u8FD8\u6765\u4E0D\u53CAFix\u5C31\u53C8\u63A8\u53E6\u4E00\u4E2ARelease\u4E86\u3002\u8FDB\u5165\u7EF4\u62A4\u6A21\u5F0F\u610F\u601D\u5C31\u662F\u76EE\u524D\u4E00\u76F4\u4EE5\u540E\u4E00\u6BB5\u65F6\u95F4Spring Cloud Netflix\u63D0\u4F9B\u7684\u670D\u52A1\u548C\u529F\u80FD\u5C31\u8FD9\u4E48\u591A\u4E86\uFF0C\u4E0D\u5728\u5F00\u53D1\u65B0\u7684\u7EC4\u4EF6\u548C\u529F\u80FD\u4E86\u3002\u4EE5\u540E\u5C06\u4EE5\u7EF4\u62A4\u548CMerge\u5206\u652FFull Request\u4E3A\u4E3B",-1),g=n("p",null,"\u65B0\u7EC4\u4EF6\u529F\u80FD\u5C06\u4EE5\u5176\u4ED6\u66FF\u4EE3\u5E73\u4EE3\u66FF\u7684\u65B9\u5F0F\u5B9E\u73B0",-1),v=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635599539964-2836bdaa-57a0-46ba-815f-34ee6bcc4f75.png",alt:"img"})],-1),b=n("h5",{id:"_2-springcloud-alibaba\u5E26\u6765\u4E86\u4EC0\u4E48",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_2-springcloud-alibaba\u5E26\u6765\u4E86\u4EC0\u4E48","aria-hidden":"true"},"#"),s(" 2. SpringCloud Alibaba\u5E26\u6765\u4E86\u4EC0\u4E48")],-1),h={href:"https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md",target:"_blank",rel:"noopener noreferrer"},y=s("\u5B98\u7F51"),f=p('<h6 id="_2-1-\u80FD\u5E72\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#_2-1-\u80FD\u5E72\u4EC0\u4E48" aria-hidden="true">#</a> 2.1 \u80FD\u5E72\u4EC0\u4E48</h6><p>\u670D\u52A1\u9650\u6D41\u964D\u7EA7\uFF1A\u9ED8\u8BA4\u652F\u6301 Servlet\u3001Feign\u3001RestTemplate\u3001Dubbo \u548C RocketMQ \u9650\u6D41\u964D\u7EA7\u529F\u80FD\u7684\u63A5\u5165\uFF0C\u53EF\u4EE5\u5728\u8FD0\u884C\u65F6\u901A\u8FC7\u63A7\u5236\u53F0\u5B9E\u65F6\u4FEE\u6539\u9650\u6D41\u964D\u7EA7\u89C4\u5219\uFF0C\u8FD8\u652F\u6301\u67E5\u770B\u9650\u6D41\u964D\u7EA7 Metrics \u76D1\u63A7\u3002</p><p>\u670D\u52A1\u6CE8\u518C\u4E0E\u53D1\u73B0\uFF1A\u9002\u914D Spring Cloud \u670D\u52A1\u6CE8\u518C\u4E0E\u53D1\u73B0\u6807\u51C6\uFF0C\u9ED8\u8BA4\u96C6\u6210\u4E86 Ribbon \u7684\u652F\u6301\u3002</p><p>\u5206\u5E03\u5F0F\u914D\u7F6E\u7BA1\u7406\uFF1A\u652F\u6301\u5206\u5E03\u5F0F\u7CFB\u7EDF\u4E2D\u7684\u5916\u90E8\u5316\u914D\u7F6E\uFF0C\u914D\u7F6E\u66F4\u6539\u65F6\u81EA\u52A8\u5237\u65B0\u3002</p><p>\u6D88\u606F\u9A71\u52A8\u80FD\u529B\uFF1A\u57FA\u4E8E Spring Cloud Stream \u4E3A\u5FAE\u670D\u52A1\u5E94\u7528\u6784\u5EFA\u6D88\u606F\u9A71\u52A8\u80FD\u529B\u3002</p><p>\u963F\u91CC\u4E91\u5BF9\u8C61\u5B58\u50A8\uFF1A\u963F\u91CC\u4E91\u63D0\u4F9B\u7684\u6D77\u91CF\u3001\u5B89\u5168\u3001\u4F4E\u6210\u672C\u3001\u9AD8\u53EF\u9760\u7684\u4E91\u5B58\u50A8\u670D\u52A1\u3002\u652F\u6301\u5728\u4EFB\u4F55\u5E94\u7528\u3001\u4EFB\u4F55\u65F6\u95F4\u3001\u4EFB\u4F55\u5730\u70B9\u5B58\u50A8\u548C\u8BBF\u95EE\u4EFB\u610F\u7C7B\u578B\u7684\u6570\u636E\u3002</p><p>\u5206\u5E03\u5F0F\u4EFB\u52A1\u8C03\u5EA6\uFF1A\u63D0\u4F9B\u79D2\u7EA7\u3001\u7CBE\u51C6\u3001\u9AD8\u53EF\u9760\u3001\u9AD8\u53EF\u7528\u7684\u5B9A\u65F6\uFF08\u57FA\u4E8E Cron \u8868\u8FBE\u5F0F\uFF09\u4EFB\u52A1\u8C03\u5EA6\u670D\u52A1\u3002\u540C\u65F6\u63D0\u4F9B\u5206\u5E03\u5F0F\u7684\u4EFB\u52A1\u6267\u884C\u6A21\u578B\uFF0C\u5982\u7F51\u683C\u4EFB\u52A1\u3002\u7F51\u683C\u4EFB\u52A1\u652F\u6301\u6D77\u91CF\u5B50\u4EFB\u52A1\u5747\u5300\u5206\u914D\u5230\u6240\u6709 Worker\uFF08schedulerx-client\uFF09\u4E0A\u6267\u884C\u3002</p><h6 id="_2-2-\u53BB\u54EA\u91CC\u4E0B\u8F7D" tabindex="-1"><a class="header-anchor" href="#_2-2-\u53BB\u54EA\u91CC\u4E0B\u8F7D" aria-hidden="true">#</a> 2.2 \u53BB\u54EA\u91CC\u4E0B\u8F7D</h6>',8),q={href:"https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md",target:"_blank",rel:"noopener noreferrer"},w=s("https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md"),_=p(`<p>\u4E4B\u524D\u5728\u7236\u5DE5\u7A0B\u7684pom\u6587\u4EF6\u4E2D\u5DF2\u7ECF\u5F15\u5165\u4E86alibaba\u7684\u4F9D\u8D56</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencyManagement</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-alibaba-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.1.0.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencyManagement</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_2-3-\u600E\u4E48\u73A9" tabindex="-1"><a class="header-anchor" href="#_2-3-\u600E\u4E48\u73A9" aria-hidden="true">#</a> 2.3 \u600E\u4E48\u73A9</h6><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635600464114-3215f873-7617-46ef-9850-503b8cff3a64.png" alt="img"></p><h5 id="_3-\u5B66\u4E60\u8D44\u6599\u7684\u83B7\u53D6" tabindex="-1"><a class="header-anchor" href="#_3-\u5B66\u4E60\u8D44\u6599\u7684\u83B7\u53D6" aria-hidden="true">#</a> 3. \u5B66\u4E60\u8D44\u6599\u7684\u83B7\u53D6</h5>`,5),x=s("\u5B98\u7F51\uFF1A"),I={href:"https://spring.io/projects/spring-cloud-alibaba##overview",target:"_blank",rel:"noopener noreferrer"},S=s("https://spring.io/projects/spring-cloud-alibaba##overview"),E=n("p",null,"\u82F1\u6587\uFF1A",-1),A={href:"https://github.com/alibaba/spring-cloud-alibaba",target:"_blank",rel:"noopener noreferrer"},C=s("https://github.com/alibaba/spring-cloud-alibaba"),T={href:"https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html",target:"_blank",rel:"noopener noreferrer"},R=s("https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html"),L=s("\u4E2D\u6587\uFF1A"),N={href:"https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md",target:"_blank",rel:"noopener noreferrer"},j=s("https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md"),D=p('<h3 id="springcloud-alibaba-nacos\u670D\u52A1\u6CE8\u518C\u548C\u914D\u7F6E\u4E2D\u5FC3" tabindex="-1"><a class="header-anchor" href="#springcloud-alibaba-nacos\u670D\u52A1\u6CE8\u518C\u548C\u914D\u7F6E\u4E2D\u5FC3" aria-hidden="true">#</a> SpringCloud Alibaba Nacos\u670D\u52A1\u6CE8\u518C\u548C\u914D\u7F6E\u4E2D\u5FC3</h3><p>\u5BF9\u5E94\u7740\u6211\u4EEC\u524D\u9762\u5B66\u7684\uFF1AEureka/Consul/Zookeeper\uFF08\u670D\u52A1\u6CE8\u518C\uFF09 Config+Bus\uFF08\u914D\u7F6E\u4E2D\u5FC3\uFF09</p><h5 id="\u4E00\u3001-nacos\u7B80\u4ECB" tabindex="-1"><a class="header-anchor" href="#\u4E00\u3001-nacos\u7B80\u4ECB" aria-hidden="true">#</a> \u4E00\u3001 Nacos\u7B80\u4ECB</h5><p>Nacos\u2014\u2014<strong>Na</strong>ming <strong>Co</strong>nfiguration <strong>S</strong>ervice</p><h6 id="_1-\u662F\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#_1-\u662F\u4EC0\u4E48" aria-hidden="true">#</a> 1 \u662F\u4EC0\u4E48</h6><ul><li>\u4E00\u4E2A\u66F4\u6613\u4E8E\u6784\u5EFA\u4E91\u539F\u751F\u5E94\u7528\u7684\u52A8\u6001\u670D\u52A1\u53D1\u73B0\u3001\u914D\u7F6E\u7BA1\u7406\u548C\u670D\u52A1\u7684\u7BA1\u7406\u5E73\u53F0\u3002</li><li>Nacos\uFF1ADynamic Naming and Configuration Service</li><li>Nacos\u5C31\u662F <code>\u6CE8\u518C\u4E2D\u5FC3 + \u914D\u7F6E\u4E2D\u5FC3\u7684\u7EC4\u5408</code> \uFF0C <strong>Nacos = Eureka + Config + Bus</strong></li></ul><h6 id="_2-\u80FD\u5E72\u4EC0\u4E48" tabindex="-1"><a class="header-anchor" href="#_2-\u80FD\u5E72\u4EC0\u4E48" aria-hidden="true">#</a> 2 \u80FD\u5E72\u4EC0\u4E48</h6><p>\u66FF\u4EE3Eureka\u505A\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3\uFF1B\u66FF\u4EE3Config\u505A\u670D\u52A1\u914D\u7F6E\u4E2D\u5FC3</p><h6 id="_3-\u4E0B\u8F7D\u5730\u5740" tabindex="-1"><a class="header-anchor" href="#_3-\u4E0B\u8F7D\u5730\u5740" aria-hidden="true">#</a> 3 \u4E0B\u8F7D\u5730\u5740</h6>',9),B={href:"https://github.com/alibaba/Nacos",target:"_blank",rel:"noopener noreferrer"},M=s("https://github.com/alibaba/Nacos"),P=s("\u5B98\u7F51\u6587\u6863\uFF1A"),O={href:"https://nacos.io/zh-cn/index.html",target:"_blank",rel:"noopener noreferrer"},F=s("https://nacos.io/zh-cn/index.html"),U={href:"https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html##_spring_cloud_alibaba_nacos_discovery",target:"_blank",rel:"noopener noreferrer"},H=s("https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html##_spring_cloud_alibaba_nacos_discovery"),G=p('<h6 id="_4-\u5404\u6CE8\u518C\u4E2D\u5FC3\u6BD4\u8F83" tabindex="-1"><a class="header-anchor" href="#_4-\u5404\u6CE8\u518C\u4E2D\u5FC3\u6BD4\u8F83" aria-hidden="true">#</a> 4 \u5404\u6CE8\u518C\u4E2D\u5FC3\u6BD4\u8F83</h6><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635603894076-3a5b9f04-9718-4e2c-b52b-cff0cce61967.png" alt="img"></p><h5 id="\u4E8C\u3001-\u5B89\u88C5\u5E76\u8FD0\u884Cnacos" tabindex="-1"><a class="header-anchor" href="#\u4E8C\u3001-\u5B89\u88C5\u5E76\u8FD0\u884Cnacos" aria-hidden="true">#</a> \u4E8C\u3001 \u5B89\u88C5\u5E76\u8FD0\u884CNacos</h5><p>\u672C\u5730\u9700\u8981\u51C6\u5907java8+maven\u73AF\u5883\u3002</p>',4),V=s("\u5B98\u7F51\u4E0B\u8F7D\uFF1A"),Q={href:"https://github.com/alibaba/nacos/releases",target:"_blank",rel:"noopener noreferrer"},z=s("https://github.com/alibaba/nacos/releases"),K=n("p",null,"\u8001\u5E08\u5B89\u88C5\u76841.1.4\uFF0C\u6211\u8FD9\u91CC\u4F7F\u7528\u7684\u6700\u65B0\u72482.0.3",-1),Y=n("p",null,"\u89E3\u538B\u5B89\u88C5\u5305\uFF0C\u8FD0\u884Cbin\u76EE\u5F55\u4E0B\u7684startup.cmd",-1),X=n("p",null,[s("\u9ED8\u8BA4\u7684\u662F"),n("strong",null,"\u96C6\u7FA4\u6A21\u5F0F"),s("\uFF0C\u6211\u4EEC\u9700\u8981"),n("strong",null,"\u5355\u673A\u542F\u52A8"),s("cmd\u4E2D\u8F93\u5165\uFF1A")],-1),W=n("p",null,[n("code",null,"startup.cmd -m standalone"),s(" \u5373\u53EF\u901A\u8FC7\u5355\u673A\u6A21\u5F0F\u542F\u52A8")],-1),$=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635660682220-9df0b752-6b72-4aa3-95ba-d7255e6a5aed.png",alt:"img"})],-1),J=s("\u547D\u4EE4\u8FD0\u884C\u6210\u529F\u540E\u76F4\u63A5\u8BBF\u95EE"),Z={href:"http://localhost:8848/nacos",target:"_blank",rel:"noopener noreferrer"},nn=s("http://localhost:8848/nacos"),sn=s(" \u9ED8\u8BA4\u8D26\u53F7\u5BC6\u7801\u90FD\u662Fnacos"),an=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635660841412-9cf6bb11-c111-47af-afa8-30726930fd00.png",alt:"img"})],-1),tn=n("p",null,"\u542F\u52A8\u6210\u529F\u3002",-1),pn=n("h5",{id:"\u4E09\u3001-nacos\u4F5C\u4E3A\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3\u6F14\u793A",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u4E09\u3001-nacos\u4F5C\u4E3A\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3\u6F14\u793A","aria-hidden":"true"},"#"),s(" \u4E09\u3001 Nacos\u4F5C\u4E3A\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3\u6F14\u793A")],-1),en={href:"https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html##_spring_cloud_alibaba_nacos_discovery",target:"_blank",rel:"noopener noreferrer"},on=s("\u5B98\u7F51\u624B\u518C"),cn=p(`<h6 id="_1-\u57FA\u4E8Enacos\u7684\u670D\u52A1\u63D0\u4F9B\u8005" tabindex="-1"><a class="header-anchor" href="#_1-\u57FA\u4E8Enacos\u7684\u670D\u52A1\u63D0\u4F9B\u8005" aria-hidden="true">#</a> 1 \u57FA\u4E8ENacos\u7684\u670D\u52A1\u63D0\u4F9B\u8005</h6><p>######## 1.1 \u5EFAmoudle</p><p>cloudalibaba-provider-payment9001</p><p>######## 1.2 pom</p><p>\u7236\u5DE5\u7A0B\u4E2D\u9700\u8981\u5F15\u5165alibaba\u7684\u4F9D\u8D56\uFF0C\u4E4B\u524D\u5DF2\u7ECF\u5F15\u5165\u8FC7\u4E86</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- \u7236\u5DE5\u7A0Bpom\u4E2D\u9700\u8981\u5F15\u5165alibaba --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencyManagement</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-alibaba-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.1.0.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencyManagement</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u672C\u6A21\u5757pom</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jdk8cloud2021<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>cloudalibaba-provider-payment9001<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--SpringCloud ailibaba nacos --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- SpringBoot\u6574\u5408Web\u7EC4\u4EF6 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--\u65E5\u5E38\u901A\u7528jar\u5305\u914D\u7F6E--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## 1.3 yml</p><p>\u6309\u7167\u5B98\u7F51\u4E0A\u7684\u8BF4\u660E\u914D\u7F6E\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635662280490-67a7615d-b304-447c-a8d5-870e9e5f67e7.png" alt="img"></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9001</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>provider
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span> <span class="token comment">#\u914D\u7F6ENacos\u5730\u5740\uFF0C\u6CE8\u518C\u5230Nacos</span>
<span class="token comment"># \u505A\u76D1\u63A7\u9700\u8981\u628A\u8FD9\u4E2A\u5168\u90E8\u66B4\u9732\u51FA\u6765</span>
<span class="token key atrule">management</span><span class="token punctuation">:</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">&#39;*&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## 1.4 \u4E3B\u542F\u52A8\u7C7B</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@EnableDiscoveryClient</span>  <span class="token comment">//\u8FD9\u91CC\u8DDF\u4EE5\u524D\u4E0D\u540C\u4E86\uFF0C\u4E0D\u518D\u662FEnableEurekaClient</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentMain9001</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">PaymentMain9001</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## 1.5 \u4E1A\u52A1\u7C7B</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;\${server.port}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> serverPort<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/payment/nacos/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPayment</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> id<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;nacos registry, serverPort: &quot;</span><span class="token operator">+</span> serverPort<span class="token operator">+</span><span class="token string">&quot;\\t id&quot;</span><span class="token operator">+</span>id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## 1.6 \u6D4B\u8BD5</p><p>\u8FD9\u91CC\u4E0D\u50CFeureka\u8FD8\u8981\u5199\u6CE8\u518C\u4E2D\u5FC3\u5FAE\u670D\u52A1\uFF0C\u76F4\u63A5\u5B89\u88C5\u6253\u5F00nacos\u5373\u53EF\u3002</p><p>\u542F\u52A89001\uFF0C\u67E5\u770Bnacos\u63A7\u5236\u53F0\uFF0C\u6CE8\u518C\u6210\u529F</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635662987849-8d3226c2-9554-4c40-9d38-b647820ce175.png" alt="img"></p>`,20),ln=s("\u8BBF\u95EE"),un={href:"http://localhost:9001/payment/nacos/1",target:"_blank",rel:"noopener noreferrer"},kn=s("http://localhost:9001/payment/nacos/1"),rn=p(`<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635663012705-77ca9ca4-ef3e-4651-9f38-51c9254000f8.png" alt="img"></p><p>nacos\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3+\u670D\u52A1\u63D0\u4F9B\u80059001\u90FDOK\u4E86</p><p>######## 1.7 \u76F8\u540C\u914D\u7F6E\u518D\u65B0\u5EFA\u4E00\u4E2Amodule 9002</p><p>\u6B65\u9AA4\u4E0E9001\u4E00\u81F4\uFF0C\u5C31\u662F\u7AEF\u53E3\u53F7\u6539\u62109002</p><p>\u8FD9\u91CC\u6709\u4E00\u4E2A\u7B80\u5355\u7684\u65B9\u6CD5\uFF0C\u865A\u62DF\u6620\u5C04\u4E00\u4E2A\u548C9001\u914D\u7F6E\u76F8\u540C\u76849011\u5FAE\u670D\u52A1\u6A21\u5757\uFF0C\u7AEF\u53E3\u53F7\u662F9011</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635663511339-6a6dbe02-65c6-468b-9528-25449f466a37.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635663647097-c62850c8-27dc-4a95-80bf-fa769eb2ed95.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635663662348-cbf1b8f5-f7e1-4ccb-8cd1-568a40ecbbe3.png" alt="img"></p><p>\u73B0\u5728\u6709\u4E24\u4E2A\u652F\u4ED8\u6A21\u5757\uFF0C9001\u548C\u865A\u62DF\u6620\u5C04\u76849011\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635663730838-4a170fcd-dc35-4b47-9810-a8fe105b52f6.png" alt="img"></p><h6 id="_2-\u57FA\u4E8Enacos\u7684\u670D\u52A1\u6D88\u8D39\u8005" tabindex="-1"><a class="header-anchor" href="#_2-\u57FA\u4E8Enacos\u7684\u670D\u52A1\u6D88\u8D39\u8005" aria-hidden="true">#</a> 2 \u57FA\u4E8ENacos\u7684\u670D\u52A1\u6D88\u8D39\u8005</h6><p>Nacos\u81EA\u5E26\u8D1F\u8F7D\u5747\u8861</p><p>######## 2.1 \u65B0\u5EFAmodule cloudalibaba-consumer-nacos-order83</p><p>######## 2.2 pom</p><p>nacos\u81EA\u5E26\u8D1F\u8F7D\u5747\u8861</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635664487366-5f26a5ef-6bc5-4e8e-a222-64b5f0047a5c.png" alt="img"></p><p>Ribbon\uFF1A\u652F\u6301\u8D1F\u8F7D\u5747\u8861\uFF0C\u81EA\u5E26RestTemplate</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jdk8cloud2021<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>cloudalibaba-consumer-nacos-order83<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--SpringCloud ailibaba nacos --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- \u5F15\u5165\u81EA\u5DF1\u5B9A\u4E49\u7684api\u901A\u7528\u5305\uFF0C\u53EF\u4EE5\u4F7F\u7528Payment\u652F\u4ED8Entity --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>cloud-api-commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- SpringBoot\u6574\u5408Web\u7EC4\u4EF6 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--\u65E5\u5E38\u901A\u7528jar\u5305\u914D\u7F6E--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## 2.3 yml</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">83</span>


<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>order<span class="token punctuation">-</span>consumer
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span>

<span class="token comment">#\u6D88\u8D39\u8005\u5C06\u8981\u53BB\u8BBF\u95EE\u7684\u5FAE\u670D\u52A1\u540D\u79F0(\u6CE8\u518C\u6210\u529F\u8FDBnacos\u7684\u5FAE\u670D\u52A1\u63D0\u4F9B\u8005)</span>
<span class="token key atrule">service-url</span><span class="token punctuation">:</span>
  <span class="token key atrule">nacos-user-service</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//nacos<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>provider
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## 2.4 \u4E3B\u542F\u52A8\u7C7B</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderNacosMain83</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">OrderNacosMain83</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6CE8\u5165 RestTemplate</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>loadbalancer<span class="token punctuation">.</span></span><span class="token class-name">LoadBalanced</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplate</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationContextBean</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@LoadBalanced</span> 
    <span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">getRestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## 2.5 \u4E1A\u52A1\u7C7B</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplate</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderNacosController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;\${service-url.nacos-user-service}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> serverURL<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/consumer/payment/nacos/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">paymentInfo</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> result <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>serverURL <span class="token operator">+</span> <span class="token string">&quot;/payment/nacos/&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635665889497-7b99643e-adcd-4b21-85f1-270838741d69.png" alt="img"></p><p>######## 2.6 \u6D4B\u8BD5</p><p>\u542F\u52A89001\u30019002\u300183</p><p>nacos\u63A7\u5236\u53F0</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635666371594-bd8ff811-3278-4098-9575-7983f07cb7e3.png" alt="img"></p>`,31),dn=s("\u6D4B\u8BD5\u94FE\u63A5\uFF1A"),mn={href:"http://localhost:83/consumer/payment/nacos/1",target:"_blank",rel:"noopener noreferrer"},gn=s("http://localhost:83/consumer/payment/nacos/1"),vn=n("p",null,"\u53D1\u73B09001\u4E0E9002\u4EA4\u66FF\u51FA\u73B0\uFF0C\u5373\u8F6E\u8BE2\u8D1F\u8F7D\u5747\u8861\u3002",-1),bn=n("p",null,[n("strong",null,"\u53EF\u80FD\u51FA\u73B0\u7684\u95EE\u9898"),s("\uFF1A")],-1),hn=s("\u5F53\u6D88\u8D39\u8005\u901A\u8FC7"),yn={href:"http://xn--nacos-payment-providerUnknowHostException-if92ef9krqn9r9kpe2ar76au6kmp2ot25j",target:"_blank",rel:"noopener noreferrer"},fn=s("http://nacos-payment-provider\u53BB\u8C03\u7528\u5FAE\u670D\u52A1\u65F6\u629B\u51FAUnknowHostException"),qn=s("\uFF1A\u672A\u77E5\u4E3B\u673A\u540D\u5F02\u5E38\u3002"),wn=p(`<p>\u8FD9\u662F\u56E0\u4E3Anacos-payment-provider\u5BF9\u5E94\u4E24\u4E2A\u5FAE\u670D\u52A1\u5B9E\u4F8B\uFF0C\u4ED6\u4E0D\u77E5\u9053\u7528\u54EA\u4E2A\u5FAE\u670D\u52A1\uFF0C\u6240\u4EE5\u62A5\u9519\u3002</p><p>\u89E3\u51B3\uFF1A\u52A0\u4E0A\u8D1F\u8F7D\u5747\u8861\u6CE8\u89E3 @LoadBalanced</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635666314847-e7408e10-067d-4b84-b308-dd4571aaaca3.png" alt="img"></p><h6 id="_3-\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3\u5BF9\u6BD4" tabindex="-1"><a class="header-anchor" href="#_3-\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3\u5BF9\u6BD4" aria-hidden="true">#</a> 3. \u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3\u5BF9\u6BD4</h6><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635667131341-de67d0df-0669-4c3c-9052-dfd9f4b6e4f9.png" alt="img"></p><p>######## 3.1 Nacos\u4E0ECAP</p><p>Nacos\u53EF\u4EE5\u5728CP\u4E0EAP\u4E4B\u95F4\u5207\u6362</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635666897448-5bdee4bc-0e24-4f3c-bdc2-3683e18799c7.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635666799095-c4a6d7c1-8b61-4edf-9af0-e6e94f8ecf3b.png" alt="img"></p><p>######## 3.2 CP\u4E0EAP\u7684\u5207\u6362</p><p>C\uFF08consistency\uFF09\uFF1A\u6240\u6709\u8282\u70B9\u5728\u540C\u4E00\u65F6\u95F4\u770B\u5230\u7684\u6570\u636E\u662F\u4E00\u81F4\u7684\uFF0C\u5F3A\u4E00\u81F4\u6027\uFF1B</p><p>A\uFF08availability\uFF09\uFF1A\u7684\u5B9A\u4E49\u662F\u6240\u6709\u7684\u8BF7\u6C42\u90FD\u4F1A\u6536\u5230\u54CD\u5E94\uFF0C\u6700\u8D77\u7801\u6709\u4E00\u4E2A\u515C\u5E95\u56DE\u590D\uFF0C\u9AD8\u53EF\u7528\u6027\u3002</p><p>######### \u4F55\u65F6\u9009\u62E9\u4F7F\u7528\u4F55\u79CD\u6A21\u5F0F\uFF1F</p><p><strong>AP:</strong></p><p>\u4E00\u822C\u6765\u8BF4\uFF0C\u5982\u679C\u4E0D\u9700\u8981\u5B58\u50A8\u670D\u52A1\u7EA7\u522B\u7684\u4FE1\u606F\u4E14\u670D\u52A1\u5B9E\u4F8B\u662F\u901A\u8FC7nacos-client\u6CE8\u518C\uFF0C\u5E76\u80FD\u591F\u4FDD\u6301\u5FC3\u8DF3\u4E0A\u62A5\uFF0C\u90A3\u4E48\u5C31\u53EF\u4EE5\u9009\u62E9AP\u6A21\u5F0F\u3002\u5F53\u524D\u4E3B\u6D41\u7684\u670D\u52A1\u5982 Spring cloud \u548C Dubbo \u670D\u52A1\uFF0C\u90FD\u9002\u7528\u4E8EAP\u6A21\u5F0F\uFF0CAP\u6A21\u5F0F\u4E3A\u4E86\u670D\u52A1\u7684\u53EF\u80FD\u6027\u800C\u51CF\u5F31\u4E86\u4E00\u81F4\u6027\uFF0C\u56E0\u6B64AP\u6A21\u5F0F\u4E0B\u53EA\u652F\u6301\u6CE8\u518C\u4E34\u65F6\u5B9E\u4F8B\u3002</p><p><strong>CP:</strong></p><p>\u5982\u679C\u9700\u8981\u5728\u670D\u52A1\u7EA7\u522B\u7F16\u8F91\u6216\u8005\u5B58\u50A8\u914D\u7F6E\u4FE1\u606F\uFF0C\u90A3\u4E48 CP \u662F\u5FC5\u987B\uFF0CK8S\u670D\u52A1\u548CDNS\u670D\u52A1\u5219\u9002\u7528\u4E8ECP\u6A21\u5F0F\u3002</p><p>CP\u6A21\u5F0F\u4E0B\u5219\u652F\u6301\u6CE8\u518C\u6301\u4E45\u5316\u5B9E\u4F8B\uFF0C\u6B64\u65F6\u5219\u662F\u4EE5 Raft \u534F\u8BAE\u4E3A\u96C6\u7FA4\u8FD0\u884C\u6A21\u5F0F\uFF0C\u8BE5\u6A21\u5F0F\u4E0B\u6CE8\u518C\u5B9E\u4F8B\u4E4B\u524D\u5FC5\u987B\u5148\u6CE8\u518C\u670D\u52A1\uFF0C\u5982\u679C\u670D\u52A1\u4E0D\u5B58\u5728\uFF0C\u5219\u4F1A\u8FD4\u56DE\u9519\u8BEF\u3002</p><p>######### \u600E\u4E48\u5207\u6362\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">curl</span> -X PUT <span class="token string">&#39;$NACOS_SERVER:8848/nacos/v1/ns/operator/switches?entry=serverMode&amp;value=CP&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="\u56DB\u3001-nacos\u4F5C\u4E3A\u670D\u52A1\u914D\u7F6E\u4E2D\u5FC3\u6F14\u793A" tabindex="-1"><a class="header-anchor" href="#\u56DB\u3001-nacos\u4F5C\u4E3A\u670D\u52A1\u914D\u7F6E\u4E2D\u5FC3\u6F14\u793A" aria-hidden="true">#</a> \u56DB\u3001 Nacos\u4F5C\u4E3A\u670D\u52A1\u914D\u7F6E\u4E2D\u5FC3\u6F14\u793A</h5><p>\u4EE5\u524D\u6211\u4EEC\u5C06\u6240\u6709\u7684\u914D\u7F6E\u4FE1\u606F\u5199\u5230\u4E86GitHub\u4E0A\uFF0C\u7528Config+Bus\u6765\u8FDB\u884C\u81EA\u52A8\u5237\u65B0\u548C\u52A8\u6001\u7684\u66F4\u65B0\u3002</p><p>\u73B0\u5728\u6211\u4EEC\u53EF\u4EE5\u76F4\u63A5\u628A\u914D\u7F6E\u6587\u4EF6\u5199\u8FDBNacos\uFF0C\u7136\u540E\u518D\u7528Nacos\u505A\u7C7B\u4F3C\u4E8Econfig\u8FD9\u6837\u7684\u529F\u80FD\uFF0C\u76F4\u63A5\u4ECENacos\u4E0A\u6293\u53D6\u6211\u4EEC\u7684\u914D\u7F6E\u4FE1\u606F\u3002</p><h6 id="_1-nacos\u4F5C\u4E3A\u914D\u7F6E\u4E2D\u5FC3\u2014\u2014\u57FA\u7840\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_1-nacos\u4F5C\u4E3A\u914D\u7F6E\u4E2D\u5FC3\u2014\u2014\u57FA\u7840\u914D\u7F6E" aria-hidden="true">#</a> 1. Nacos\u4F5C\u4E3A\u914D\u7F6E\u4E2D\u5FC3\u2014\u2014\u57FA\u7840\u914D\u7F6E</h6><p>\u4E3B\u8981\u662F\u6DFB\u52A0\u4E00\u4E2A\uFF1Anacos-config\u4F9D\u8D56</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--nacos-config--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>   
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## 1.1 \u5EFAmodule cloudalibaba-config-nacos-client3377</p><p>######## 1.2 pom</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jdk8cloud2021<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>cloudalibaba-config-nacos-client3377<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--nacos-config--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--nacos-discovery--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--web + actuator--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--\u4E00\u822C\u57FA\u7840\u914D\u7F6E--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## 1.3 yml</p><p>\u8FD9\u91CC\u9700\u8981\u914D\u7F6E\u4E24\u4E2A\uFF0C\u4E00\u4E2Abootstrap\u548C\u4E00\u4E2Aapplication\u3002</p><p>\u539F\u56E0\uFF1ANacos\u540Cspringcloud-config\u4E00\u6837\uFF0C\u5728\u9879\u76EE\u521D\u59CB\u5316\u65F6\uFF0C\u8981\u4FDD\u8BC1\u5148\u4ECE\u914D\u7F6E\u4E2D\u5FC3\u8FDB\u884C\u914D\u7F6E\u62C9\u53D6\uFF0C\u62C9\u53D6\u914D\u7F6E\u4E4B\u540E\uFF0C\u624D\u80FD\u4FDD\u8BC1\u9879\u76EE\u7684\u6B63\u5E38\u542F\u52A8\u3002</p><p>springboot\u4E2D\u914D\u7F6E\u6587\u4EF6\u7684\u52A0\u8F7D\u662F\u5B58\u5728\u4F18\u5148\u7EA7\u987A\u5E8F\u7684\uFF0C<strong>bootstrap\u4F18\u5148\u7EA7\u9AD8\u4E8Eapplication</strong>\u3002</p><p>\u5168\u5C40\u7684\u653E\u5728\uFF1Abootstrap.yml \u81EA\u5DF1\u7684\u653E\u5728\uFF1Aapplication.yml</p><p><strong>bootstrap\uFF1A</strong></p><p>\u5FAE\u670D\u52A1\u7AEF\u53E3\uFF1A3377\uFF0C\u670D\u52A1\u540Dnacos-config-client\uFF0C\u6CE8\u518C\u8FDBnacos\uFF1Alocalhost:8848 \u4F5C\u4E3A\u914D\u7F6E\u5BA2\u6237\u7AEF</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># nacos\u914D\u7F6E</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">3377</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>config<span class="token punctuation">-</span>client
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span> <span class="token comment">#Nacos\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3\u5730\u5740</span>
      <span class="token key atrule">config</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span> <span class="token comment">#Nacos\u4F5C\u4E3A\u914D\u7F6E\u4E2D\u5FC3\u5730\u5740</span>
        <span class="token key atrule">file-extension</span><span class="token punctuation">:</span> yaml <span class="token comment">#\u6307\u5B9Ayaml\u683C\u5F0F\u7684\u914D\u7F6E</span>

<span class="token comment"># \${spring.application.name}-\${spring.profile.active}.\${spring.cloud.nacos.config.file-extension}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>application\uFF1A</strong></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">profiles</span><span class="token punctuation">:</span>
    <span class="token key atrule">active</span><span class="token punctuation">:</span> dev <span class="token comment"># \u8868\u793A\u5F00\u53D1\u73AF\u5883</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>bootstrap + application \u5C31\u8868\u793A\u6211\u8981\u53BB\u914D\u7F6E\u4E2D\u5FC3\u627E\u540D\u4E3Adev.yaml\u7684\u6587\u4EF6\u3002</p><p>######## 1.4 \u4E3B\u542F\u52A8\u7C7B</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NacosConfigClientMain3377</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">NacosConfigClientMain3377</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## 1.5 \u4E1A\u52A1\u7C7B</p><p>\u901A\u8FC7Spring Cloud\u539F\u751F\u6CE8\u89E3**@RefreshScope** \u5B9E\u73B0\u914D\u7F6E\u81EA\u52A8\u66F4\u65B0</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>context<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RefreshScope</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RefreshScope</span> <span class="token comment">//\u5728\u63A7\u5236\u5668\u7C7B\u52A0\u5165@RefreshScope\u6CE8\u89E3\u4F7F\u5F53\u524D\u7C7B\u4E0B\u7684\u914D\u7F6E\u652F\u6301Nacos\u7684\u52A8\u6001\u5237\u65B0\u529F\u80FD\u3002</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigClientController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;\${config.info}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> configInfo<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/config/info&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getConfigInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> configInfo<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## 1.6 \u5728Nacos\u4E2D\u6DFB\u52A0\u914D\u7F6E\u4FE1\u606F</p><p>######## Nacos\u4E2D\u7684\u5339\u914D\u89C4\u5219</p><p>\u7406\u8BBA\uFF1A</p><ul><li>Nacos\u4E2D\u7684dataid\u7684\u7EC4\u6210\u683C\u5F0F\u4E0ESpringBoot\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684\u5339\u914D\u89C4\u5219</li></ul>`,49),_n=s("\u5B98\u7F51\uFF1A"),xn={href:"https://nacos.io/zh-cn/docs/quick-start-spring-cloud.html",target:"_blank",rel:"noopener noreferrer"},In=s("https://nacos.io/zh-cn/docs/quick-start-spring-cloud.html"),Sn=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635683360153-499516ca-fc68-40e3-9a8d-b57080c4890b.png",alt:"img"})],-1),En=n("p",null,"\u6CE8\u610Fnacos\u53EA\u8BC6\u522Byaml\uFF0C\u4E0D\u652F\u6301yml\u3002",-1),An=n("p",null,[s("\u6700\u7EC8\u516C\u5F0F\uFF1A"),n("span",{class:"katex"},[n("span",{class:"katex-mathml"},[n("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[n("semantics",null,[n("mrow",null,[n("mrow",null,[n("mo",null,"\u2217"),n("mo",null,"\u2217"),n("mi",null,"s"),n("mi",null,"p"),n("mi",null,"r"),n("mi",null,"i"),n("mi",null,"n"),n("mi",null,"g"),n("mi",{mathvariant:"normal"},"."),n("mi",null,"a"),n("mi",null,"p"),n("mi",null,"p"),n("mi",null,"l"),n("mi",null,"i"),n("mi",null,"c"),n("mi",null,"a"),n("mi",null,"t"),n("mi",null,"i"),n("mi",null,"o"),n("mi",null,"n"),n("mi",{mathvariant:"normal"},"."),n("mi",null,"n"),n("mi",null,"a"),n("mi",null,"m"),n("mi",null,"e"),n("mo",null,"\u2217"),n("mo",null,"\u2217")]),n("mo",null,"\u2212")]),n("annotation",{encoding:"application/x-tex"},"{**spring.application.name**}-")])])]),n("span",{class:"katex-html","aria-hidden":"true"},[n("span",{class:"base"},[n("span",{class:"strut",style:{height:"0.8889em","vertical-align":"-0.1944em"}}),n("span",{class:"mord"},[n("span",{class:"mord"},"\u2217"),n("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),n("span",{class:"mbin"},"\u2217"),n("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),n("span",{class:"mord mathnormal"},"s"),n("span",{class:"mord mathnormal"},"p"),n("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"r"),n("span",{class:"mord mathnormal"},"in"),n("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),n("span",{class:"mord"},"."),n("span",{class:"mord mathnormal"},"a"),n("span",{class:"mord mathnormal",style:{"margin-right":"0.01968em"}},"ppl"),n("span",{class:"mord mathnormal"},"i"),n("span",{class:"mord mathnormal"},"c"),n("span",{class:"mord mathnormal"},"a"),n("span",{class:"mord mathnormal"},"t"),n("span",{class:"mord mathnormal"},"i"),n("span",{class:"mord mathnormal"},"o"),n("span",{class:"mord mathnormal"},"n"),n("span",{class:"mord"},"."),n("span",{class:"mord mathnormal"},"nam"),n("span",{class:"mord mathnormal"},"e"),n("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),n("span",{class:"mbin"},"\u2217"),n("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),n("span",{class:"mord"},"\u2217")]),n("span",{class:"mord"},"\u2212")])])]),s("{"),n("strong",null,"spring.profiles.active"),s("}.${"),n("strong",null,"spring.cloud.nacos.config.file-extension"),s("}")],-1),Cn=n("p",null,"\u7ED3\u679C\uFF1A nacos-config-client-dev.yaml",-1),Tn=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635684258256-cda8e9fc-3b88-42cc-86cb-080698853a3c.png",alt:"img"})],-1),Rn=n("p",null,"######## \u5B9E\u64CD",-1),Ln=n("p",null,"\u914D\u7F6E\u65B0\u589E\uFF1A",-1),Nn=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635684133899-cb940e70-fed6-4893-9136-a1605f864ac6.png",alt:"img"})],-1),jn=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635683995494-e18c9f15-33c4-486a-ab85-a986c9810fd4.png",alt:"img"})],-1),Dn=n("p",null,"######## 1.7 \u6D4B\u8BD5",-1),Bn=n("p",null,"\u542F\u52A83377",-1),Mn=s("\u53D1\u9001\u8BF7\u6C42\uFF1A"),Pn={href:"http://localhost:3377/config/info",target:"_blank",rel:"noopener noreferrer"},On=s("http://localhost:3377/config/info"),Fn=p('<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635684417158-e8ca283d-c66e-4edd-8489-76e65673925e.png" alt="img">\u6D4B\u8BD5\u6210\u529F</p><p>\u81EA\u5E26\u52A8\u6001\u5237\u65B0\uFF1A\u4FEE\u6539nacos\u4E2D\u7684yaml\u914D\u7F6E\u6587\u4EF6\uFF0C\u518D\u6B21\u8C03\u7528\u67E5\u770B\u914D\u7F6E\uFF0C\u53D1\u73B0\u914D\u7F6E\u5237\u65B0\u4E86\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635684484023-62bb8360-f694-4ece-81c7-16bda7005a02.png" alt="img"></p><h6 id="_2-nacos\u4F5C\u4E3A\u914D\u7F6E\u4E2D\u5FC3\u2014\u2014\u5206\u7C7B\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_2-nacos\u4F5C\u4E3A\u914D\u7F6E\u4E2D\u5FC3\u2014\u2014\u5206\u7C7B\u914D\u7F6E" aria-hidden="true">#</a> 2. Nacos\u4F5C\u4E3A\u914D\u7F6E\u4E2D\u5FC3\u2014\u2014\u5206\u7C7B\u914D\u7F6E</h6><p>######## 2.1 \u5206\u5E03\u5F0F\u5F00\u53D1\u4E2D\u7684\u591A\u73AF\u5883\u591A\u9879\u76EE\u7BA1\u7406\u95EE\u9898</p><ul><li><strong>\u95EE\u98981\uFF1A</strong></li></ul><p>\u5B9E\u9645\u5F00\u53D1\u4E2D\uFF0C\u901A\u5E38\u4E00\u4E2A\u7CFB\u7EDF\u4F1A\u51C6\u5907</p><p>dev\u5F00\u53D1\u73AF\u5883</p><p>test\u6D4B\u8BD5\u73AF\u5883</p><p>prod\u751F\u4EA7\u73AF\u5883\u3002</p><p>\u5982\u4F55\u4FDD\u8BC1\u6307\u5B9A\u73AF\u5883\u542F\u52A8\u65F6\u670D\u52A1\u80FD\u6B63\u786E\u8BFB\u53D6\u5230Nacos\u4E0A\u76F8\u5E94\u73AF\u5883\u7684\u914D\u7F6E\u6587\u4EF6\u5462\uFF1F</p><ul><li><strong>\u95EE\u98982\uFF1A</strong></li></ul><p>\u4E00\u4E2A\u5927\u578B\u5206\u5E03\u5F0F\u5FAE\u670D\u52A1\u7CFB\u7EDF\u4F1A\u6709\u5F88\u591A\u5FAE\u670D\u52A1\u5B50\u9879\u76EE\uFF0C</p><p>\u6BCF\u4E2A\u5FAE\u670D\u52A1\u9879\u76EE\u53C8\u90FD\u4F1A\u6709\u76F8\u5E94\u7684\u5F00\u53D1\u73AF\u5883\u3001\u6D4B\u8BD5\u73AF\u5883\u3001\u9884\u53D1\u73AF\u5883\u3001\u6B63\u5F0F\u73AF\u5883......</p><p>\u90A3\u600E\u4E48\u5BF9\u8FD9\u4E9B\u5FAE\u670D\u52A1\u914D\u7F6E\u8FDB\u884C\u7BA1\u7406\u5462\uFF1F</p><p>######## 2.2 Nacos\u7684\u56FE\u5F62\u5316\u7BA1\u7406\u754C\u9762</p><p>\u914D\u7F6E\u7BA1\u7406\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635685284361-4572707d-d143-41be-8c13-c36d096ab04c.png" alt="img"></p><p>\u547D\u540D\u7A7A\u95F4\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635685319379-4ca4c0aa-f0b3-4c0a-821e-6516d5ff9fba.png" alt="img"></p><p>######## 2.3 Namespace+Group+Data ID\u4E09\u8005\u5173\u7CFB\uFF1F\u4E3A\u4EC0\u4E48\u8FD9\u4E48\u8BBE\u8BA1\uFF1F</p><p>\u7C7B\u4F3CJava\u91CC\u9762\u7684package\u540D\u548C\u7C7B\u540D\uFF0C\u6700\u5916\u5C42\u7684namespace\u662F\u53EF\u4EE5\u7528\u4E8E\u533A\u5206\u90E8\u7F72\u73AF\u5883\u7684\uFF0CGroup\u548CDataID\u903B\u8F91\u4E0A\u533A\u5206\u4E24\u4E2A\u76EE\u6807\u5BF9\u8C61\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635685398335-e647481f-d32d-4833-b7f9-4fcbfa6bf693.png" alt="img"></p><p><strong>\u9ED8\u8BA4\u60C5\u51B5\uFF1A</strong></p><p><strong>Namespace=public\uFF0CGroup=DEFAULT_GROUP, \u9ED8\u8BA4Cluster\u662FDEFAULT</strong></p><p>Nacos\u9ED8\u8BA4\u7684\u547D\u540D\u7A7A\u95F4\u662Fpublic\uFF0CNamespace\u4E3B\u8981\u7528\u6765\u5B9E\u73B0\u9694\u79BB\u3002</p><p>\u6BD4\u65B9\u8BF4\u6211\u4EEC\u73B0\u5728\u6709\u4E09\u4E2A\u73AF\u5883\uFF1A\u5F00\u53D1\u3001\u6D4B\u8BD5\u3001\u751F\u4EA7\u73AF\u5883\uFF0C\u6211\u4EEC\u5C31\u53EF\u4EE5\u521B\u5EFA\u4E09\u4E2ANamespace\uFF0C\u4E0D\u540C\u7684Namespace\u4E4B\u95F4\u662F\u9694\u79BB\u7684\u3002</p><p>Group\u9ED8\u8BA4\u662FDEFAULT_GROUP\uFF0CGroup\u53EF\u4EE5\u628A\u4E0D\u540C\u7684\u5FAE\u670D\u52A1\u5212\u5206\u5230\u540C\u4E00\u4E2A\u5206\u7EC4\u91CC\u9762\u53BB</p><p>Service\u5C31\u662F\u5FAE\u670D\u52A1\uFF1B\u4E00\u4E2AService\u53EF\u4EE5\u5305\u542B\u591A\u4E2ACluster\uFF08\u96C6\u7FA4\uFF09\uFF0CNacos\u9ED8\u8BA4Cluster\u662FDEFAULT\uFF0CCluster\u662F\u5BF9\u6307\u5B9A\u5FAE\u670D\u52A1\u7684\u4E00\u4E2A\u865A\u62DF\u5212\u5206\u3002</p><p>\u6BD4\u65B9\u8BF4\u4E3A\u4E86\u5BB9\u707E\uFF0C\u5C06Service\u5FAE\u670D\u52A1\u5206\u522B\u90E8\u7F72\u5728\u4E86\u676D\u5DDE\u673A\u623F\u548C\u5E7F\u5DDE\u673A\u623F\uFF0C\u8FD9\u65F6\u5C31\u53EF\u4EE5\u7ED9\u676D\u5DDE\u673A\u623F\u7684Service\u5FAE\u670D\u52A1\u8D77\u4E00\u4E2A\u96C6\u7FA4\u540D\u79F0\uFF08HZ\uFF09\uFF0C\u7ED9\u5E7F\u5DDE\u673A\u623F\u7684Service\u5FAE\u670D\u52A1\u8D77\u4E00\u4E2A\u96C6\u7FA4\u540D\u79F0\uFF08GZ\uFF09\uFF0C\u8FD8\u53EF\u4EE5\u5C3D\u91CF\u8BA9\u540C\u4E00\u4E2A\u673A\u623F\u7684\u5FAE\u670D\u52A1\u4E92\u76F8\u8C03\u7528\uFF0C\u4EE5\u63D0\u5347\u6027\u80FD\u3002</p><p>\u6700\u540E\u662FInstance\uFF0C\u5C31\u662F\u5FAE\u670D\u52A1\u7684\u5B9E\u4F8B\u3002</p><h6 id="_3-\u4E09\u79CD\u65B9\u6848\u52A0\u8F7D\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_3-\u4E09\u79CD\u65B9\u6848\u52A0\u8F7D\u914D\u7F6E" aria-hidden="true">#</a> 3. \u4E09\u79CD\u65B9\u6848\u52A0\u8F7D\u914D\u7F6E</h6><p>######## 3.1 DataID\u65B9\u6848</p><p>\u6307\u5B9Aspring.profile.active\u548C\u914D\u7F6E\u6587\u4EF6\u7684DataID\u6765\u4F7F\u4E0D\u540C\u73AF\u5883\u4E0B\u8BFB\u53D6\u4E0D\u540C\u7684\u914D\u7F6E</p><p>\u9ED8\u8BA4\u7A7A\u95F4+\u9ED8\u8BA4\u5206\u7EC4+\u65B0\u5EFAdev\u548Ctest\u4E24\u4E2ADataID</p><ul><li>dev\u914D\u7F6EDataID\uFF0C\u4E0A\u4E00\u8BB2\u914D\u7F6E\u8FC7</li><li>\u65B0\u5EFAtest\u914D\u7F6EDataID</li></ul><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635687085675-43bff20e-5d0f-4140-8356-41d5774614a2.png" alt="img"></p><p>\u8FD9\u91CC\u547D\u540D\u7A7A\u95F4\u662F\u9ED8\u8BA4\u7684public\uFF0CGroup\u4E5F\u662F\u9ED8\u8BA4\u7684\u3002</p><p>\u901A\u8FC7spring.profile.active\u5C5E\u6027\u5C31\u80FD\u8FDB\u884C\u591A\u73AF\u5883\u4E0B\u914D\u7F6E\u6587\u4EF6\u7684\u8BFB\u53D6</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635687246140-40f3010d-2e3c-4959-a537-42d5e0f21b2e.png" alt="img"></p>',40),Un=s("\u91CD\u542F3377 \u6D4B\u8BD5"),Hn={href:"http://localhost:3377/config/info%EF%BC%8C%E6%88%90%E5%8A%9F%E8%AF%BB%E5%8F%96%E5%88%B0test%E9%85%8D%E7%BD%AE%E4%B8%8B%E7%9A%84config.info",target:"_blank",rel:"noopener noreferrer"},Gn=s("http://localhost:3377/config/info\uFF0C\u6210\u529F\u8BFB\u53D6\u5230test\u914D\u7F6E\u4E0B\u7684config.info"),Vn=p('<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635687508172-571f6d42-9516-4ca1-a1a3-8d75bea9b912.png" alt="img"></p><p>######## 3.2 Group\u65B9\u6848</p><p>\u9ED8\u8BA4Group\u662FDEFAULT_GROUP\uFF0C\u73B0\u5728\u901A\u8FC7Group\u5B9E\u73B0\u73AF\u5883\u5206\u533A</p><ol><li>\u65B0\u5EFA\u4E00\u4E2A\u914D\u7F6E\u6587\u4EF6\uFF0C\u6DFB\u52A0\u5230DEV_GROUP\u5206\u7EC4</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635687829633-f170e566-7692-42cd-9524-eef3337aeffe.png" alt="img"></p><ol><li>\u65B0\u5EFA\u4E00\u4E2A\u914D\u7F6E\u6587\u4EF6\uFF0C\u6DFB\u52A0\u5230TEST_GROUP\u5206\u7EC4</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635687928881-aa121233-ef4d-4868-b2aa-3a12017af496.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635687983063-3062040c-8821-4fac-b868-f570612d6a36.png" alt="img"></p><ol><li>\u5728config\u4E0B\u589E\u52A0\u4E00\u6761group\u7684\u914D\u7F6E\u5373\u53EF\u3002\u53EF\u914D\u7F6E\u4E3ADEV_GROUP\u6216TEST_GROUP</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635688159372-2a81a5bd-4797-4e5c-a1fb-37fca2c56aee.png" alt="img"></p><ol><li>\u6D4B\u8BD5\uFF1A</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635688181202-bf3709c6-29f3-49fe-95a9-bc55925d375b.png" alt="img"></p><p>######## 3.3 namesapce\u65B9\u6848</p><ol><li>\u65B0\u5EFAdev/test\u7684Namesapce</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635688594593-dcfc88bc-b792-421a-a01f-0ac785be0650.png" alt="img"></p><ol><li>\u56DE\u5230\u670D\u52A1\u7BA1\u7406-\u670D\u52A1\u5217\u8868\u67E5\u770B</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635688736719-d5c116d7-f8b1-4637-8488-0174a8b463b6.png" alt="img"></p><ol><li>\u5728\u8FD9\u4E24\u4E2A\u65B0\u5EFA\u7684namespace\u4E2D\u5206\u522B\u65B0\u5EFA\u4E09\u4E2A\u4E0D\u540C\u5206\u7EC4\u7684\u914D\u7F6E\u6587\u4EF6</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635690723423-42a30b93-e4c1-42d2-b349-277dd6a068fd.png" alt="img"></p><ol><li>\u4FEE\u65393377\u7684yml\u6587\u4EF6</li></ol><p>bootstrap\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635689312883-38e75de9-0081-4b50-82bb-be5b057b7d41.png" alt="img"></p><p>application\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635689345327-7fb0d48a-aba1-4814-9c54-d1d1bfc6f7a0.png" alt="img"></p><ol><li>\u6D4B\u8BD5</li></ol><p>dev namesapce\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635690766323-8fe68084-ec12-4a06-a1fc-c5d5f5ed38c2.png" alt="img"></p><p>test namesapce\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635690996286-aff5fe00-8620-4648-8933-c18e1a770519.png" alt="img"></p><p>######## 3.4 \u603B\u7ED3</p><p>DataID\u65B9\u6848\u662F\u5728\u9ED8\u8BA4namesapce\u548C\u9ED8\u8BA4Group\u4E0B\uFF0C\u521B\u5EFA\u4E24\u4E2A\u4E0D\u540C\u7684DataID\u3002</p><p>Group\u65B9\u6848\u662F\u5728\u9ED8\u8BA4namespace\u4E0B\uFF0C\u65B0\u5EFA\u4E24\u4E2ADataID\u76F8\u540C\u7684\u914D\u7F6E\u6587\u4EF6\uFF0C\u901A\u8FC7\u6307\u5B9A\u4E0D\u540C\u7684\u5206\u7EC4\u6765\u8BFB\u53D6\u4E0D\u540C\u7684\u914D\u7F6E\u3002</p><p>Namespace\u65B9\u6848\uFF0C\u662F\u76F8\u540C\u7684Group\uFF0C\u76F8\u540C\u7684DataID\uFF0C\u521B\u5EFA\u5E76\u6307\u5B9A\u4E0D\u540C\u7684namespace\u6765\u8BFB\u53D6\u4E0D\u540C\u914D\u7F6E\u3002</p><h6 id="_4-nacos\u96C6\u7FA4\u548C\u6301\u4E45\u5316\u914D\u7F6E-\u91CD\u70B9" tabindex="-1"><a class="header-anchor" href="#_4-nacos\u96C6\u7FA4\u548C\u6301\u4E45\u5316\u914D\u7F6E-\u91CD\u70B9" aria-hidden="true">#</a> 4. Nacos\u96C6\u7FA4\u548C\u6301\u4E45\u5316\u914D\u7F6E\uFF08\u91CD\u70B9\uFF09</h6><p>\u6211\u4EEC\u4E4B\u524D\u5728\u5B66eureka\u7684\u65F6\u5019\uFF0C\u914D\u7F6E\u4E86\u4E24\u4E2Aeureka\u6CE8\u518C\u4E2D\u5FC3\u5FAE\u670D\u52A1\u3002\u5B66Nacos\u65F6\uFF0C\u4E0D\u7528\u6211\u4EEC\u5355\u72EC\u65B0\u5EFA\u6CE8\u518C\u4E2D\u5FC3\u5FAE\u670D\u52A1\u6A21\u5757\u4E86\uFF0C\u76F4\u63A5\u5B89\u88C5\u4F7F\u7528\u5373\u53EF\uFF0C\u5F88\u65B9\u4FBF\u3002</p><p>\u4F46\u662F\uFF1A\u5982\u679C\u8FD9\u4E2A\u6CE8\u518C\u4E2D\u5FC3\u6302\u4E86\u600E\u4E48\u529E\uFF1F\u6211\u4EEC\u76EE\u524D\u5C31\u5F00\u4E86\u4E00\u4E2ANacos\u7A0B\u5E8F\uFF0C\u4E5F\u6CA1\u6709\u914D\u7F6E\u96C6\u7FA4\u3002\u663E\u7136\uFF0C\u5B9E\u9645\u60C5\u51B5\u4E2D\u4E0D\u53EF\u80FD\u53EA\u6709\u4E00\u4E2ANacos\u6CE8\u518C\u4E2D\u5FC3\uFF0C\u56E0\u6B64\u9700\u8981\u7528\u5230nacos\u96C6\u7FA4\u3002</p>',36),Qn={href:"https://nacos.io/zh-cn/docs/cluster-mode-quick-start.html",target:"_blank",rel:"noopener noreferrer"},zn=s("\u96C6\u7FA4\u5B98\u7F51\u6587\u6863"),Kn=p(`<p>######## 4.1 \u5B98\u7F51\u8BF4\u660E</p><ol><li><strong>\u67B6\u6784\u56FE\uFF1A</strong></li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635774952980-508e21d6-48a1-4eb9-94b9-ac493e7ac4d4.png" alt="img"></p><p>\u8FD9\u91CCvip\u8868\u793Avirtual ip\uFF08\u865A\u62DFIP\uFF09</p><ol><li><strong>\u8981\u5C06\u914D\u7F6E\u6301\u4E45\u5316\u5230\u6570\u636E\u5E93\u4E2D\uFF1AMySQL</strong></li></ol><p>\u4E0D\u7528nacos\u5185\u5D4C\u7684\u6570\u636E\u5E93</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635775427756-97237fc3-1533-4f48-a906-98fc0102fda5.png" alt="img"></p><ol><li><strong>\u901A\u4FD7\u6613\u61C2\u7684Nacos\u96C6\u7FA4\u67B6\u6784\u56FE</strong></li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635775247554-92fa7cbf-573e-4385-9efd-1ad111ae0371.png" alt="img"></p><ol><li><strong>\u91CD\u70B9\u8BF4\u660E\uFF1A</strong></li></ol><p>\u9ED8\u8BA4Nacos\u4F7F\u7528\u5D4C\u5165\u5F0F\u6570\u636E\u5E93\u5B9E\u73B0\u6570\u636E\u7684\u5B58\u50A8\uFF0C\u6211\u4EEC\u91CD\u542FNacos\u540E\uFF0C\u4EE5\u524D\u7684\u914D\u7F6E\u6587\u4EF6\u4E0D\u4F1A\u6D88\u5931\u3002</p><p>\u4F46\u662F\uFF0C\u5982\u679C\u542F\u52A8\u591A\u4E2A\u9ED8\u8BA4\u914D\u7F6E\u4E0B\u7684Nacos\u8282\u70B9\uFF0C\u6570\u636E\u5B58\u50A8\u662F\u5B58\u5728\u4E00\u81F4\u6027\u95EE\u9898\u7684\u3002\u6BCF\u4E2Anacos\u90FD\u6709\u81EA\u5DF1\u72EC\u7ACB\u7684\u5D4C\u5165\u5F0F\u6570\u636E\u5E93\uFF0C\u5B58\u653E\u7684\u6570\u636E\u4E0D\u4E00\u81F4\u3002</p><p>\u4E3A\u4E86\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\uFF0CNacos\u91C7\u7528\u4E86\u96C6\u4E2D\u5F0F\u5B58\u50A8\u7684\u65B9\u5F0F\u6765\u652F\u6301\u96C6\u7FA4\u5316\u90E8\u7F72\uFF0C\u76EE\u524D\u53EA\u652F\u6301MySQL\u7684\u5B58\u50A8\u3002</p><p>nacos\u652F\u6301\u7684\u4E09\u79CD\u90E8\u7F72\u6A21\u5F0F\uFF1A</p><ul><li>\u5355\u673A\u6A21\u5F0F\uFF1A\u7528\u4E8E\u6D4B\u8BD5\u548C\u5355\u673A\u4F7F\u7528</li><li>\u96C6\u7FA4\u6A21\u5F0F\uFF1A\u7528\u4E8E\u751F\u4EA7\u73AF\u5883\uFF0C\u786E\u4FDD\u9AD8\u53EF\u7528</li><li>\u591A\u96C6\u7FA4\u6A21\u5F0F\uFF1A\u7528\u4E8E\u591A\u6570\u636E\u4E2D\u5FC3\u573A\u666F</li></ul><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635775664121-2c4d8a51-44d0-4ee0-90b5-3d6df0079932.png" alt="img"></p><p>######## 4.2 Nacos\u5D4C\u5165\u5F0F\u6570\u636E\u5E93derby\u5207\u6362\u5230mysql</p><p>Nacos\u9ED8\u8BA4\u81EA\u5E26\u7684\u662F\u5D4C\u5165\u5F0F\u6570\u636E\u5E93derby\uFF0C\u90A3\u4E48\u5982\u679C\u505A\u96C6\u7FA4\u65F6\u6BCF\u4E2Anacos\u90FD\u81EA\u5E26\u4E00\u4E2Aderby\uFF0C\u90A3\u4E48\u5C31\u6709\u4E09\u4E2A\u5B58\u50A8\u914D\u7F6E\u7A33\u5065\u7684\u6570\u636E\u5E93\uFF0C\u663E\u7136\u6570\u636E\u7684\u7EDF\u4E00\u6027\u5B58\u5728\u95EE\u9898\u3002</p><p>######### windows\u5355\u673A\u7248derby\u5230mysql\u5207\u6362\u6B65\u9AA4</p><ol><li>\u9996\u5148\u5728nacos\u5B89\u88C5\u76EE\u5F55\u7684conf\u76EE\u5F55\u4E0B\u627E\u5230\u4E00\u4E2A\u540D\u4E3A<strong>nacos-mysql.sql</strong>\u7684sql\u811A\u672C</li></ol><p>\u7136\u540E\u6267\u884Cnacos-mysql.sql\u811A\u672C</p><p>\u6CE8\u610F\uFF1A\u6570\u636E\u5E93nacos_config\u9700\u8981\u81EA\u5DF1\u521B\u5EFA</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">/* \u521B\u5EFAnacos_config\u6570\u636E\u5E93  */</span>
<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> nacos_config<span class="token punctuation">;</span>
<span class="token keyword">USE</span> nacos_config<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,23),Yn={href:"https://www.yuque.com/attachments/yuque/0/2021/sql/22423156/1635776971740-ab4fe82b-a375-4dbc-b8e0-348acb2b1003.sql",target:"_blank",rel:"noopener noreferrer"},Xn=s("\u{1F4CE}nacos-mysql.sql"),Wn=p(`<ol><li>\u5728conf\u76EE\u5F55\u4E0B\u627E\u5230application.properties</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635777806883-a979fbfc-91fa-4cd8-a967-810765af235c.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635777987285-f0947ebc-127d-4873-81a4-9851f777c15b.png" alt="img"></p><div class="language-plain ext-plain line-numbers-mode"><pre class="language-plain"><code>spring.datasource.platform=mysql
 
db.num=1
db.url.0=jdbc:mysql://127.0.0.1:3306/nacos_config?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true
db.user=\u6570\u636E\u5E93\u8D26\u53F7
db.password=\u6570\u636E\u5E93\u5BC6\u7801
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>\u91CD\u65B0\u542F\u52A8nacos\uFF0C\u53EF\u4EE5\u770B\u5230\u662F\u4E2A\u5168\u65B0\u7684\u7A7A\u8BB0\u5F55\u754C\u9762\uFF0C\u4EE5\u524D\u662F\u8BB0\u5F55\u8FDBderby</li></ol><p>\u5728bin\u76EE\u5F55\u4E0B\u7684cmd \u8F93\u5165 <code>startup.cmd -m standalone</code> \u6267\u884C\uFF0C\u8FD9\u91CC\u8FD8\u662F\u5355\u673A\u6A21\u5F0F\uFF0C\u53EA\u4E0D\u8FC7\u6570\u636E\u5E93\u4ECEderby\u8FC1\u79FB\u5230\u4E86mysql</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635778357485-54471c63-4653-4490-aafc-7e04f8f2f911.png" alt="img"></p><p>\u53EF\u4EE5\u770B\u5230\uFF0C\u91CD\u542F\u4E4B\u540E\u4E4B\u524D\u7684\u914D\u7F6E\u90FD\u6CA1\u4E86\uFF0C\u8BF4\u660E\u8FC1\u79FB\u6210\u529F\u3002</p><ol><li>\u5728naocs\u65B0\u5EFA\u914D\u7F6E\u65F6\uFF0C\u4F1A\u81EA\u52A8\u4FDD\u5B58\u5230mysql\u6570\u636E\u5E93\u4E2D</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635778640587-bac74307-033c-475e-a1a7-2aeba30c04bc.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1635778680246-a20e51f7-4fd9-4c94-8196-840cd3a33a3b.png" alt="img"></p><p>######## \uFF08\u8E29\u5751\uFF091.1.4\u7248\u672Cnacos\u4F7F\u7528\u5916\u90E8\u6570\u636E\u5E93Mysql8</p><p>\u540E\u9762Seata\u7AE0\u8282\u7531\u4E8ENacos\u3001sentinel\u3001seata\u5B58\u5728\u7248\u672C\u5BF9\u5E94\u5173\u7CFB\uFF0C\u56E0\u6B64\u9700\u8981\u5B89\u88C51.1.4\u7248\u672Cnacos\u3002</p><p>\u6211\u5728\u5B89\u88C5nacos1.1.4\u914D\u7F6EMYSQL8\u7684application.properties\u540E\uFF0C\u62A5\u9519\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636689711167-14daa147-53a0-4100-9997-89807bbb5551.png" alt="img"></p><p>\u5C1D\u8BD5\u4E86\u5982\u4E0B\u65B9\u6CD5\uFF1A</p><ol><li>\u5728nacos\\plugins\\mysql\uFF08\u81EA\u5DF1\u521B\u5EFA\uFF09\u6587\u4EF6\u5939\u4E0B\u653Emysql8\u5BF9\u5E94\u7248\u672C\u7684jar\u5305\uFF08\u4E0D\u7BA1\u7528\uFF09</li><li>\u4FEE\u6539application.properties\u6587\u4EF6\u540D\u4E3Abootstrap.properties\uFF1A\u53EF\u4EE5\u6B63\u5E38\u542F\u52A8nacos\uFF0C\u4F46\u662F\u6570\u636E\u5E93\u5E76\u6CA1\u6709\u4ECEderby\u5207\u6362\u4E3Amysql</li><li>\u6DFB\u52A0\u65F6\u533A\uFF1A<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636688994869-43048817-50a7-486e-90d9-c0a2d589e64e.png" alt="img"></li></ol><p>\u4E00\u822C\u6211\u5728\u4F7F\u7528mysql8\u7684\u65F6\u5019\u90FD\u4F1A\u6DFB\u52A0\u4E0A\u65F6\u533A\uFF0C\u4ECD\u7136\u4E0D\u7BA1\u7528\u3002</p><ol><li>\u4FEE\u6539nacos\u6E90\u7801\uFF08\u53EF\u884C\uFF09</li></ol><p>######### \u4FEE\u6539nacos\u6E90\u7801</p><p>\u4E0B\u8F7Dnacos1.1.4\u6E90\u7801\uFF0C\u4FEE\u6539\u7236\u5DE5\u7A0Bpom\u7684mysql-connector-java\u7684\u7248\u672C\uFF0C\u5C065.1.34\u6539\u6210\u81EA\u5DF1mysql\u5BF9\u5E94\u7684\u7248\u672C</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636692383529-991ca7a4-d60e-4df2-8b6f-e271e0e7f73a.png" alt="img"></p><p>\u8FD9\u91CC\u4E00\u6539\uFF0Cnaming\u6A21\u5757\u4E0B\u7684<strong>com.alibaba.nacos.naming.healthcheck.MysqlHealthCheckProcessor</strong>\u5C31\u4F1A\u62A5\u9519</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636692552809-fd63b51b-e355-43ec-88ed-0d424023bb40.png" alt="img"></p><p>\u628A<code>import com.mysql.jdbc.jdbc2.optional.MysqlDataSource;</code>\u6539\u4E3A<code>import com.mysql.cj.jdbc.MysqlDataSource;</code></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636692775087-5a140dbb-0f10-4329-aaa3-836daedc850c.png" alt="img"></p><p>\u8FD9\u91CC\u6211\u6CE8\u91CA\u7684\u4E00\u5B9A\u8981\u5220\u6389\uFF08\u8FD9\u91CC\u6211\u6CE8\u91CA\u6389\u4E3B\u8981\u662F\u4E3A\u4E86\u533A\u5206\uFF09\uFF0C\u4E0D\u7136\u4F1A\u62A5\u9519\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636694992341-b1680444-d9dc-47bb-9437-bbc14388c5ff.png" alt="img"></p><p>\u7136\u540E\u5728\u6E90\u7801\u6839\u76EE\u5F55\u4E0B\u6253\u5F00cmd\uFF0C\u4F7F\u7528maven\u6253\u5305</p><p>\u6267\u884C\uFF1A<code>mvn -Prelease-nacos -Dmaven.test.skip=true clean install -U</code></p><p>\u6253\u5305\u597D\u7684nacos\u5B58\u653E\u5728\u6839\u76EE\u5F55\\distribution\\target\u76EE\u5F55\u4E0B</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636699215820-994303ce-a905-4980-8356-4eba81cfe3df.png" alt="img"></p><p>\u8FD9\u4E2A\u538B\u7F29\u5305\u5C31\u76F8\u5F53\u4E8E\u6211\u4EEC\u4ECE\u5B98\u7F51\u4E0A\u4E0B\u7684\u3002\u7136\u540E\u590D\u5236\u5230\u4F60\u60F3\u89E3\u538B\u7684\u5730\u65B9\uFF0C\u89E3\u538B\u3002</p><p>\u968F\u540E\uFF0C\u914D\u7F6Econf\\application.properties\u91CC\u9762\u7684\u6570\u636E\u5E93\uFF1A</p><div class="language-plain ext-plain line-numbers-mode"><pre class="language-plain"><code>#******************  \u5355\u673A\u6A21\u5F0F\u652F\u6301mysql  *******************#
spring.datasource.platform=mysql
 
db.num=1
db.url.0=jdbc:mysql://127.0.0.1:3306/nacos_config?characterEncoding=utf8&amp;connectTimeout=10000&amp;socketTimeout=30000&amp;autoReconnect=true&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=UTC
db.user=\u6570\u636E\u5E93\u8D26\u53F7
db.password=\u6570\u636E\u5E93\u5BC6\u7801
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>serverTimezone=UTC</strong>\u4E0D\u8981\u5FD8\u8BB0\u4E86\u3002\uFF08\u6BCF\u6B21\u914D\u7F6Emysql8\uFF0C\u90FD\u8981\u5E26\u4E0A\u8FD9\u4E2A\u8BBE\u7F6E\uFF09</p><p>\u7136\u540E\u542F\u52A8nacos\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636699506385-b20079ed-0143-4f43-8791-baa2a05a7193.png" alt="img"></p><p>\u542F\u52A8\u6210\u529F\uFF0C\u6211\u4EEC\u8BD5\u4E00\u4E0B\uFF0C\u80FD\u4E0D\u80FD\u5B58\u5230\u6570\u636E\u5E93\u4E2D\uFF0C\u65B0\u5EFA\u4E00\u4E2A\u914D\u7F6E</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636699613637-8419ae67-dbae-47be-be53-014b96bb0d99.png" alt="img"></p><p>\u6210\u529F\u5B58\u5165\u6570\u636E\u5E93\uFF01</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636699673050-624c269c-e53c-4af6-bca4-79f2ada11586.png" alt="img"></p><p>######## 4.3 Linux\u7248Nacos+MySQL\u751F\u4EA7\u73AF\u5883\u914D\u7F6E</p><p>\u4E00\u5B9A\u8981\u5148\u628A\u73AF\u5883\u51C6\u5907\u597D\uFF01 centos7/Ubuntu/ + maven(3.2+)+mysql(5.6.5+)+JDK1.8</p><p>\u9884\u8BA1\u9700\u89811\u4E2ANginx+3\u4E2Anacos\u6CE8\u518C\u4E2D\u5FC3+1\u4E2Amysql</p><p>######### 4.3.1 Nacos \u4E0B\u8F7DLinux\u7248</p>`,46),$n=s("\u4E0B\u8F7Dnacos-linux\uFF1A"),Jn={href:"https://github.com/alibaba/nacos/releases/tag/2.0.3",target:"_blank",rel:"noopener noreferrer"},Zn=s("https://github.com/alibaba/nacos/releases/tag/2.0.3"),ns=s(" \u6211\u653E\u5728\u4E86/usr/local \u4E0B"),ss=p(`<p>\u89E3\u538B\uFF1A <code>tar -zxvf nacos-server-2.0.3.tar.gz</code></p><p><code>cp -r nacos /mynacos/</code> \u9012\u5F52\u62F7\u8D1Dnacos \u6587\u4EF6\u5939\u5230mynacos\u6587\u4EF6\u5939\u4E0B \uFF08\u6211\u8FD9\u91CC\u6CA1\u6709\u6267\u884C\u8FD9\u6B65\uFF09</p><p>######### 4.3.2 \u96C6\u7FA4\u914D\u7F6E\u6B65\u9AA4\uFF08\u91CD\u70B9\uFF09</p><p>(1) Linux\u670D\u52A1\u5668\u4E0Amysql\u6570\u636E\u5E93\u914D\u7F6E</p><p>\u8DDFwindows\u4E00\u6837\uFF0Clinxu\u7684nacos \u5728 /nacos/conf \u76EE\u5F55\u4E0B\u6709\u4E00\u4E2Anacos-mysql.sql\u7684sql\u811A\u672C</p><p>\u6211\u662F\u901A\u8FC7SQLyog\u5BA2\u6237\u7AEF\u8FDC\u7A0B\u8FDE\u63A5\uFF0C\u7136\u540E\u6267\u884C\u3002</p><p>(2) application.properties \u914D\u7F6E</p><p>/usr/local/nacos/conf \u4E0B\uFF0C\u4FEE\u6539\u5185\u5BB9\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">#******************  \u5355\u673A\u6A21\u5F0F\u652F\u6301mysql  *******************#</span>
spring.datasource.platform<span class="token operator">=</span>mysql
 
db.num<span class="token operator">=</span><span class="token number">1</span>
db.url.0<span class="token operator">=</span>jdbc:mysql://127.0.0.1:3306/nacos_config?characterEncoding<span class="token operator">=</span>utf8<span class="token operator">&amp;</span><span class="token assign-left variable">connectTimeout</span><span class="token operator">=</span><span class="token number">1000</span><span class="token operator">&amp;</span><span class="token assign-left variable">socketTimeout</span><span class="token operator">=</span><span class="token number">3000</span><span class="token operator">&amp;</span><span class="token assign-left variable">autoReconnect</span><span class="token operator">=</span>true<span class="token operator">&amp;</span><span class="token assign-left variable">useUnicode</span><span class="token operator">=</span>true<span class="token operator">&amp;</span><span class="token assign-left variable">useSSL</span><span class="token operator">=</span>false<span class="token operator">&amp;</span><span class="token assign-left variable">serverTimezone</span><span class="token operator">=</span>UTC
db.user<span class="token operator">=</span>\u6570\u636E\u5E93\u8D26\u53F7
db.password<span class="token operator">=</span>\u6570\u636E\u5E93\u5BC6\u7801
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>(3) Linux\u670D\u52A1\u5668\u4E0Anacos\u7684\u96C6\u7FA4\u914D\u7F6Ecluster.conf</p><p>\u68B3\u7406\u51FA3\u53F0nacos\u96C6\u5668\u7684\u4E0D\u540C\u670D\u52A1\u7AEF\u53E3\u53F7 3333 4444 5555</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636100427810-4462fb17-7381-42df-a034-8caf3b3aa211.png" alt="img"></p><p><strong>cp cluster.conf.example cluster.conf</strong></p><p><strong>vim cluster.conf</strong></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636100588057-959ee6c7-b84b-4a65-a5d8-0013380a8e46.png" alt="img"><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636100696082-247401dd-4c5f-4e9e-b9bf-bcbaa8108414.png" alt="img"></p>`,15),as=s("(4) "),ts={href:"http://xn--Nacosstartup-bh7t29nlt0guk9brp4avuh7v5e.sh",target:"_blank",rel:"noopener noreferrer"},ps=s("\u7F16\u8F91Nacos\u7684\u542F\u52A8\u811A\u672Cstartup.sh"),es=s("\uFF0C\u4F7F\u5B83\u80FD\u591F\u63A5\u53D7\u4E0D\u540C\u7684\u542F\u52A8\u7AEF\u53E3"),os=s("/usr/local/nacos/bin "),cs={href:"http://xn--startup-nw3k389jqdq043b.sh",target:"_blank",rel:"noopener noreferrer"},ls=s("\u76EE\u5F55\u4E0B\u6709startup.sh"),is=s("\uFF0C\u5E73\u65F6\u5355\u673A\u7248\u7684\u542F\u52A8\uFF0C\u90FD\u662F./startup.sh\u5373\u53EF\u3002"),us=p(`<p>\u96C6\u7FA4\u542F\u52A8\uFF0C\u6211\u4EEC\u5E0C\u671B\u53EF\u4EE5\u7C7B\u4F3C\u5176\u5B83\u8F6F\u4EF6\u7684shell\u547D\u4EE4\uFF0C\u4F20\u9012\u4E0D\u540C\u7684\u7AEF\u53E3\u53F7\u542F\u52A8\u4E0D\u540C\u7684nacos\u5B9E\u4F8B\u3002</p><p>\u547D\u4EE4\uFF1A./startup.sh <strong>-p 3333</strong> \u8868\u793A\u542F\u52A8\u7AEF\u53E3\u53F7\u4E3A3333\u7684nacos\u670D\u52A1\u5668\u5B9E\u4F8B\uFF0C\u548C\u4E0A\u4E00\u6B65\u7684cluster.conf\u914D\u7F6E\u7684\u4E00\u81F4\u3002</p><p><strong>\u6CE8\u610F\uFF1A2.0\u7248\u672C\u7684-p\u88AB\u5360\u7528\u4E86\uFF0C\u53EF\u4EE5\u7528\u5927\u5199P\u6216\u8005\u5176\u4ED6\u5B57\u6BCD\uFF0C\u521A\u6539\u5B8C\u6D4F\u89C8\u5668\u4F1A\u6709\u5EF6\u8FDF\uFF0C\u8FC7\u4E00\u4F1A\u624D\u4F1A\u597D\u3002</strong></p><ul><li>1.1.4 \u7248\u672C\u4FEE\u6539\u524D\u540E\u5BF9\u6BD4\u65B9\u5F0F\uFF1A</li></ul><table><thead><tr><th>\u4FEE\u6539\u524D</th><th>\u4FEE\u6539\u540E</th></tr></thead><tbody><tr><td><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636101801849-65e53edf-8bd0-4978-b51f-c60091601f11.png" alt="img"></td><td><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636101807905-b1e3a2be-09a2-45dc-8e84-c0b1eb58fc9e.png" alt="img"></td></tr><tr><td><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636101797900-5b7d1e70-9e92-47ba-81e2-c5b520334ec4.png" alt="img"></td><td><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636101791050-52f8abbf-3af1-498d-980e-c1d95dc27509.png" alt="img"></td></tr></tbody></table><ul><li>2.0.3\u7248\u672C\u4FEE\u6539\u524D\u540E\u5BF9\u6BD4</li></ul><table><thead><tr><th>\u4FEE\u6539\u524D</th><th>\u4FEE\u6539\u540E</th></tr></thead><tbody><tr><td><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636965100107-f81bce09-bfcf-4d91-ae4c-3f080d6bac4c.png" alt="img"></td><td><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636965136571-aea13396-dc5c-4316-be51-1cdd8a8d6155.png" alt="img"></td></tr><tr><td><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636965209533-e9e31b66-0621-4975-ae86-d99549bdeea1.png" alt="img"></td><td><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636965580222-2c12fd48-38f9-4ed7-aefe-acf1c2ef345f.png" alt="img"></td></tr></tbody></table><p>\u5982\u679C\u9632\u706B\u5899\u6CA1\u5173\uFF0C\u8BB0\u5F97\u5C063333,4444,5555\u7AEF\u53E3\u53F7\u8BBE\u7F6E\u53EF\u8BBF\u95EE</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>firewall-cmd --add-port<span class="token operator">=</span><span class="token number">3333</span>/tcp --permanent
firewall-cmd --add-port<span class="token operator">=</span><span class="token number">4444</span>/tcp --permanent
firewall-cmd --add-port<span class="token operator">=</span><span class="token number">5555</span>/tcp --permanent
firewall-cmd --reload
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6700\u7EC8\u53EA\u80FD\u542F\u52A8\u4E00\u4E2Anacos\uFF0C\u5C1D\u8BD5\u5404\u79CD\u529E\u6CD5\u672A\u89E3\u51B3\uFF0C\u66F4\u6362nacos1.1.4\u540E\u6CA1\u6709\u95EE\u9898\u3002</p><p>(\u756A\u5916)nacos linux\u8E29\u5751\u5FC5\u770B</p>`,11),ks=s("\u6700\u5F00\u59CB\u6211\u7528\u7684nacos2.0.3\uFF0C\u5230\u96C6\u7FA4\u90A3\u5C31\u51FA\u73B0\u4E86\u95EE\u9898\uFF0C\u53EA\u80FD\u5F00\u4E00\u4E2Anacos\uFF0C\u5269\u4E0B\u4E24\u4E2A\u5F00\u8D77\u6765\u5C31\u62A5\u9519\u3002\u62A5\u9519\u7684\u4FE1\u606F\uFF1A"),rs={href:"https://www.yuque.com/attachments/yuque/0/2021/txt/22423156/1636115364580-b52c91e1-48ef-4459-9182-388752447b2b.txt",target:"_blank",rel:"noopener noreferrer"},ds=s("\u{1F4CE}startout.txt"),ms=s(" \uFF08start.out\uFF09 \u65E5\u5FD7\uFF1A"),gs={href:"https://www.yuque.com/attachments/yuque/0/2021/txt/22423156/1636115522178-750173d8-70ad-43ba-98c1-52f1791ebf7f.txt",target:"_blank",rel:"noopener noreferrer"},vs=s("\u{1F4CE}nacos.log.txt"),bs=s(" (nacos.log)\u3002\u5C1D\u8BD5\u4E86\u5404\u79CD\u65B9\u6CD5\uFF0C\u6539JVM\u914D\u7F6E\u7B49\u7B49\uFF0C\u8FD8\u662F\u4E0D\u884C\u3002\u6700\u540E\u9009\u62E9\u4F7F\u7528\u8DDF\u89C6\u9891\u91CC\u9762\u4E00\u6837\u7684nacos\u7248\u672C1.1.4"),hs=p(`<p>\u4F7F\u75281.1.4\u7684\u65F6\u5019\u6570\u636E\u5E93\u7684\u914D\u7F6E <code>/usr/local/mynacos/nacos/conf/</code> (1.1.4\u7684\u5B89\u88C5\u8DEF\u5F84) application.properties \u6587\u4EF6\u4F7F\u7528mysql8+ \u9700\u8981\u52A0\u4E0A\u65F6\u533A 2.0.3 \u4E0D\u9700\u8981</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>#************************* \u914D\u7F6E\u6570\u636E\u5E93 ****************************#
spring.datasource.platform=mysql
 
db.num=1
db.url.0=jdbc:mysql://127.0.0.1:3306/nacos_config?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true&amp;serverTimezone=UTC
db.user=root
db.password=10086
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>cluster.conf \u8FD8\u662F\u8DDF\u4E4B\u524D\u4E00\u6837\u914D\u7F6E\uFF1B</p>`,3),ys={href:"http://startup.sh",target:"_blank",rel:"noopener noreferrer"},fs=s("startup.sh"),qs=s(" \u8DDF\u8001\u5E08\u4E00\u6837\u7684\u6539\u6CD5\uFF0C\u7136\u540E\u9700\u8981\u5C06JVM\u7684\u914D\u7F6E\u4FEE\u6539\uFF0C\u56E0\u4E3A\u6211\u7684\u865A\u62DF\u673A\u53EA\u67094G\u5185\u5B58\uFF0C\u6240\u4EE5\u6211\u628AJVM\u914D\u7F6E\u8C03\u6574\u4E3A\u5982\u4E0B\uFF1A"),ws=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636115846275-0f7eef6b-d977-47d6-92be-5f1e7be2737c.png",alt:"img"})],-1),_s=n("p",null,"\u7136\u540E\u5206\u522B\u6267\u884C\u5F00\u542F3333\u30014444\u30015555\u4E09\u4E2Anacos\uFF0C\u6210\u529F\u5F00\u542Fnacos\u96C6\u7FA4",-1),xs=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636115985623-1655b0e4-a749-4856-b287-b91167099866.png",alt:"img"})],-1),Is=s("\u4F7F\u7528nacos2+\u7684\u670B\u53CB\u53EF\u4EE5\u5C1D\u8BD5\u5F00\u4E09\u53F0\u865A\u62DF\u673A\uFF0C\u53C2\u8003\u5B98\u65B9\u624B\u518C\u914D\u7F6E\u96C6\u7FA4"),Ss={href:"https://nacos.io/zh-cn/docs/cluster-mode-quick-start.html",target:"_blank",rel:"noopener noreferrer"},Es=s("nacos\u5B98\u65B9\u624B\u518C"),As=s("\u6CE8\u610F\uFF1A\u7528nacos1.4\u4EE5\u4E0A\u7684\uFF0C\u8C8C\u4F3C\u5C31\u7528\u4E0D\u4E86\u8FD9\u4E2A\u6A21\u62DF\u96C6\u7FA4\u7684\u65B9\u6CD5\u4E86\uFF0C\u8001\u5B9E\u590D\u52363\u4E2Anacos\u6587\u4EF6\u5939\u518D\u9010\u4E2A\u8BBE\u7F6E\u7AEF\u53E3\u53F7\u542F\u52A8 "),Cs={href:"https://blog.csdn.net/qq1623803207/article/details/120277919?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1.no_search_link&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1.no_search_link",target:"_blank",rel:"noopener noreferrer"},Ts=s("\u540C\u4E00\u53F0\u673A\u542F\u52A8\u591A\u4E2Anacos\u7684\u95EE\u9898"),Rs=n("p",null,"(5) Nginx\u7684\u914D\u7F6E\uFF0C\u7531\u5B83\u4F5C\u4E3A\u8D1F\u8F7D\u5747\u8861\u5668",-1),Ls={href:"https://www.yuque.com/mrlinxi/pxvr4g/he0i9c",target:"_blank",rel:"noopener noreferrer"},Ns=s("Nginx\u57FA\u7840"),js=p(`<p>/usr/local/nginx/conf \u4E0Bnginx.conf\u6587\u4EF6\u4E3A\u9ED8\u8BA4\u914D\u7F6E\u6587\u4EF6 \u542F\u52A8nginx\u901A\u8FC7-c\u53EF\u4EE5\u6307\u5B9A\u914D\u7F6E\u6587\u4EF6\u542F\u52A8\u3002\u6211\u8FD9\u91CC\u5C06\u539F\u6765\u7684\u914D\u7F6E\u6587\u4EF6\u62F7\u8D1D\u4E3A<code>nginx_nacos.conf</code></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636118716205-76c7f6e2-a07a-4518-80e3-f23b875b373e.png" alt="img"></p><p>\u542F\u52A8nginx\uFF0Ccd\u5230/usr/local/nginx/sbin\u4E0B ,\u6267\u884C\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>./nginx -c /usr/local/nginx/conf/nginx_nacos.conf
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u522B\u5FD8\u4E86\u9632\u706B\u5899\u5F00\u542F1111\u7AEF\u53E3\u7684\u8BBF\u95EE\uFF1A</p><p><strong>firewall-cmd --add-port=1111/tcp --permanent</strong></p><p><strong>firewall-cmd --reload</strong></p><p>(6) \u6D4B\u8BD5</p><p>\u6D4B\u8BD5\u901A\u8FC7nginx\u8BBF\u95EEnacos\uFF0C\u6210\u529F\u767B\u9646</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636119394556-51964220-c6c9-4c5c-9311-004d20e669e9.png" alt="img"></p><p>\u7136\u540E\u6211\u4EEC\u65B0\u5EFA\u4E00\u4E2A\u914D\u7F6E\u6587\u4EF6\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636119472865-2b8373f1-6cab-4823-85c1-f91772c2cf37.png" alt="img"></p><p>\u6210\u529F\u5B58\u5230Linux\u7684\u6570\u636E\u5E93\u4E2D\uFF01</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636119509441-e9e33dc7-fd36-40e6-817f-2034a2cf1f11.png" alt="img"></p><p>######## 4.4 \u5FAE\u670D\u52A1cloudalibaba-provider-payment9002\u542F\u52A8\u6CE8\u518C\u8FDBnacos\u96C6\u7FA4</p><p>\u4FEE\u65399002\u7684application.yml\u6587\u4EF6\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636119919002-851f57c9-7ec7-4ef5-a531-28e7315627ac.png" alt="img"></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9002</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>provider
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
<span class="token comment">#        server-addr: localhost:8848 #\u914D\u7F6ENacos\u5730\u5740\uFF0C\u6CE8\u518C\u5230Nacos</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 192.168.190.134<span class="token punctuation">:</span><span class="token number">1111</span> <span class="token comment"># \u6CE8\u518C\u5230nacos\u96C6\u7FA4\uFF0C\u901A\u8FC7nginx\u4EE3\u7406</span>
<span class="token comment"># \u505A\u76D1\u63A7\u9700\u8981\u628A\u8FD9\u4E2A\u5168\u90E8\u66B4\u9732\u51FA\u6765</span>
<span class="token key atrule">management</span><span class="token punctuation">:</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">&#39;*&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u542F\u52A89002\uFF0C\u6CE8\u518C\u6210\u529F</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636120024459-af14247e-507b-4915-8b0c-42594be9faec.png" alt="img"></p><h2 id="_14-springcloud-alibaba-sentinel\u5B9E\u73B0\u7194\u65AD\u4E0E\u9650\u6D41" tabindex="-1"><a class="header-anchor" href="#_14-springcloud-alibaba-sentinel\u5B9E\u73B0\u7194\u65AD\u4E0E\u9650\u6D41" aria-hidden="true">#</a> 14.SpringCloud Alibaba Sentinel\u5B9E\u73B0\u7194\u65AD\u4E0E\u9650\u6D41</h2><h3 id="\u4E00\u3001sentinel" tabindex="-1"><a class="header-anchor" href="#\u4E00\u3001sentinel" aria-hidden="true">#</a> \u4E00\u3001Sentinel</h3>`,22),Ds={href:"https://github.com/alibaba/Sentinel",target:"_blank",rel:"noopener noreferrer"},Bs=s("https://github.com/alibaba/Sentinel"),Ms=s(),Ps={href:"https://github.com/alibaba/Sentinel/wiki/%E4%BB%8B%E7%BB%8D",target:"_blank",rel:"noopener noreferrer"},Os=s("\u4E2D\u6587"),Fs=n("p",null,"Sentinel \u662F\u8F7B\u91CF\u7EA7\u7684\u6D41\u91CF\u63A7\u5236\u3001\u7194\u65AD\u964D\u7EA7Java\u5E93\uFF1B\u529F\u80FD\u7C7B\u4F3C\u4E8EHystrix",-1),Us=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636121571580-6b6a7838-1def-4a6a-8780-9dced8b563e1.png",alt:"img"})],-1),Hs={href:"https://github.com/alibaba/Sentinel/releases",target:"_blank",rel:"noopener noreferrer"},Gs=s("\u4E0B\u8F7D\u5730\u5740"),Vs=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636120420628-55b29acd-23e4-4a77-8963-7e46ed37d7f2.png",alt:"img"})],-1),Qs=n("p",null,"\u600E\u4E48\u73A9\uFF1A",-1),zs={href:"https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html##_spring_cloud_alibaba_sentinel",target:"_blank",rel:"noopener noreferrer"},Ks=s("\u5165\u95E8\u6587\u6863"),Ys=p(`<p>\u670D\u52A1\u4F7F\u7528\u4E2D\u7684\u5404\u79CD\u95EE\u9898\uFF1A\u670D\u52A1\u96EA\u5D29\u3001\u670D\u52A1\u964D\u7EA7\u3001\u670D\u52A1\u7194\u65AD\u3001\u670D\u52A1\u9650\u6D41</p><h3 id="\u4E8C\u3001\u5B89\u88C5sentinel\u63A7\u5236\u53F0" tabindex="-1"><a class="header-anchor" href="#\u4E8C\u3001\u5B89\u88C5sentinel\u63A7\u5236\u53F0" aria-hidden="true">#</a> \u4E8C\u3001\u5B89\u88C5Sentinel\u63A7\u5236\u53F0</h3><p>Sentinel\u5206\u4E3A\u4E24\u4E2A\u90E8\u5206\uFF1A</p><ul><li>\u6838\u5FC3\u5E93\uFF08Java\u5BA2\u6237\u7AEF\uFF09\u4E0D\u4F9D\u8D56\u4EFB\u4F55\u6846\u67B6/\u5E93\uFF0C\u80FD\u591F\u4E91\u661F\u5B87\u6240\u6709Java\u8FD0\u884C\u65F6\u73AF\u5883\uFF0C\u540C\u65F6\u5BF9Dubbo/Spring Cloud\u7B49\u6846\u67B6\u4E5F\u6709\u8F83\u597D\u7684\u652F\u6301\u2014\u2014\u540E\u53F0\uFF1B</li><li>\u63A7\u5236\u53F0\uFF08Dashboard\uFF09\u57FA\u4E8ESpring Boot\u5F00\u53D1\uFF0C\u6253\u5305\u540E\u53EF\u4EE5\u76F4\u63A5\u8FD0\u884C\uFF0C\u4E0D\u9700\u8981\u989D\u5916\u7684Tomcat\u7B49\u5E94\u7528\u5BB9\u5668\u2014\u2014\u524D\u53F0 8080</li></ul><h5 id="\u5B89\u88C5\u6B65\u9AA4" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5\u6B65\u9AA4" aria-hidden="true">#</a> \u5B89\u88C5\u6B65\u9AA4</h5><p>\u4E0B\u8F7D\u5230\u672C\u5730sentinel-dashboard-1.8.2.jar</p><p>\u8FD0\u884C\u547D\u4EE4\uFF1A</p><p>\u524D\u63D0\u9700\u8981Java8\uFF0C\u4E148080\u7AEF\u53E3\u4E0D\u80FD\u88AB\u5360\u7528\uFF1B<code>java -jar sentinel-dashboard-1.8.2.jar</code></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636122488124-495f5f8f-b46a-48d3-b749-e1ee087ad7d4.png" alt="img"></p><p>\u8BBF\u95EE localhost:8080\uFF0C\u8D26\u53F7\u5BC6\u7801\u5747\u4E3Asentinel</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636122678696-1a939dde-0487-4767-85ca-a9f1da74cd59.png" alt="img"></p><h3 id="\u4E09\u3001\u521D\u59CB\u5316\u6F14\u793A\u5DE5\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u4E09\u3001\u521D\u59CB\u5316\u6F14\u793A\u5DE5\u7A0B" aria-hidden="true">#</a> \u4E09\u3001\u521D\u59CB\u5316\u6F14\u793A\u5DE5\u7A0B</h3><h5 id="_3-1-\u542F\u52A8nacos8848" tabindex="-1"><a class="header-anchor" href="#_3-1-\u542F\u52A8nacos8848" aria-hidden="true">#</a> 3.1 \u542F\u52A8Nacos8848</h5><h5 id="_3-2-\u65B0\u5EFAmodule-cloudalibaba-sentinel-service8401" tabindex="-1"><a class="header-anchor" href="#_3-2-\u65B0\u5EFAmodule-cloudalibaba-sentinel-service8401" aria-hidden="true">#</a> 3.2 \u65B0\u5EFAModule cloudalibaba-sentinel-service8401</h5><h6 id="_3-2-1-pom" tabindex="-1"><a class="header-anchor" href="#_3-2-1-pom" aria-hidden="true">#</a> 3.2.1 pom</h6><p>\u4EE5\u540E\u57FA\u672C\u4E0Anacos \u8DDFsentinel\u4E00\u8D77\u914D\u7F6E</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jdk8cloud2021<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>cloudalibaba-sentinel-service8401<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--SpringCloud ailibaba nacos --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--SpringCloud ailibaba sentinel-datasource-nacos \u540E\u7EED\u505A\u6301\u4E45\u5316\u7528\u5230--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.csp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sentinel-datasource-nacos<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--SpringCloud ailibaba sentinel --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-sentinel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--openfeign--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- SpringBoot\u6574\u5408Web\u7EC4\u4EF6+actuator --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--\u65E5\u5E38\u901A\u7528jar\u5305\u914D\u7F6E--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.hutool<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>hutool-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.6.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_3-2-2-yaml" tabindex="-1"><a class="header-anchor" href="#_3-2-2-yaml" aria-hidden="true">#</a> 3.2.2 yaml</h6><p>spring.cloud.sentinel.transport.port \u7AEF\u53E3\u914D\u7F6E\u4F1A\u5728\u5E94\u7528\u5BF9\u5E94\u7684\u673A\u5668\u4E0A\u542F\u52A8\u4E00\u4E2A Http Server\uFF0C\u8BE5 Server \u4F1A\u4E0E Sentinel \u63A7\u5236\u53F0\u505A\u4EA4\u4E92\u3002</p><p>\u6BD4\u5982 Sentinel \u63A7\u5236\u53F0\u6DFB\u52A0\u4E861\u4E2A\u9650\u6D41\u89C4\u5219\uFF0C\u4F1A\u628A\u89C4\u5219\u6570\u636Epush\u7ED9\u8FD9\u4E2AHttp Server\u63A5\u6536\uFF0CHttp Server\u518D\u5C06\u89C4\u5219\u6CE8\u518C\u5230Sentinel\u4E2D\u3002</p><p>spring.cloud.sentinel.transport.port\uFF1A\u6307\u5B9A\u4E0ESentinel\u63A7\u5236\u53F0\u4EA4\u4E92\u7684\u7AEF\u53E3\uFF0C\u5E94\u7528\u672C\u5730\u4F1A\u542F\u52A8\u4E00\u4E2A\u5360\u7528\u8BE5\u7AEF\u53E3\u7684Http Server</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8401</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> cloudalibaba<span class="token punctuation">-</span>sentinel<span class="token punctuation">-</span>service
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span> <span class="token comment">#Nacos\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3\u5730\u5740</span>
    <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
      <span class="token key atrule">transport</span><span class="token punctuation">:</span>
        <span class="token comment">#\u914D\u7F6ESentinel dashboard\u5730\u5740</span>
        <span class="token key atrule">dashboard</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8080</span>
        <span class="token comment">#\u9ED8\u8BA48719\u7AEF\u53E3\uFF0C\u5047\u5982\u88AB\u5360\u7528\u4F1A\u81EA\u52A8\u4ECE8719\u5F00\u59CB\u4F9D\u6B21+1\u626B\u63CF,\u76F4\u81F3\u627E\u5230\u672A\u88AB\u5360\u7528\u7684\u7AEF\u53E3</span>
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8719</span>
        
<span class="token key atrule">management</span><span class="token punctuation">:</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">&#39;*&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_3-2-3-\u4E3B\u542F\u52A8\u7C7B" tabindex="-1"><a class="header-anchor" href="#_3-2-3-\u4E3B\u542F\u52A8\u7C7B" aria-hidden="true">#</a> 3.2.3 \u4E3B\u542F\u52A8\u7C7B</h6><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SentinelMainApp8401</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">SentinelMainApp8401</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_3-2-4-\u4E1A\u52A1\u7C7B" tabindex="-1"><a class="header-anchor" href="#_3-2-4-\u4E1A\u52A1\u7C7B" aria-hidden="true">#</a> 3.2.4 \u4E1A\u52A1\u7C7B</h6><p>\u6D41\u91CF\u63A7\u5236controller\uFF1AFlowLimitController</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FlowLimitController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/testA&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">testA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;------testA&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/testB&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">testB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;------testB&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-3-\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#_3-3-\u6D4B\u8BD5" aria-hidden="true">#</a> 3.3 \u6D4B\u8BD5</h5><p>\u542F\u52A8Sentinel8080 <code>java -jar sentinel-dashboard-1.8.2.jar</code>\u3001\u542F\u52A8\u5FAE\u670D\u52A18401</p><p>\u67E5\u770BSentinel\u63A7\u5236\u53F0\uFF0C\u53D1\u73B0\u4EC0\u4E48\u4E5F\u6CA1\u6709\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636167613578-84824ab7-cec7-45bb-8a89-52c3f3619098.png" alt="img"></p><p>\u539F\u56E0\uFF1ASentinel\u91C7\u7528\u61D2\u52A0\u8F7D\u673A\u5236</p>`,32),Xs=s("\u6267\u884C\u4E00\u4E0B\uFF1A"),Ws={href:"http://localhost:8401/testA",target:"_blank",rel:"noopener noreferrer"},$s=s("http://localhost:8401/testA"),Js=p('<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636175140467-9975b3a8-255f-45da-89ff-791b5be271bb.png" alt="img"></p><p>sentinel8080\u6B63\u5728\u76D1\u63A7\u5FAE\u670D\u52A18401</p><h3 id="\u56DB\u3001\u6D41\u63A7\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#\u56DB\u3001\u6D41\u63A7\u89C4\u5219" aria-hidden="true">#</a> \u56DB\u3001\u6D41\u63A7\u89C4\u5219</h3><p>\u6D41\u91CF\u9650\u5236\u63A7\u5236\u89C4\u5219\uFF0C\u5206\u4E3A\uFF1A\u6D41\u63A7\u6A21\u5F0F\u548C\u6D41\u63A7\u6548\u679C</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636175547549-6c575fa5-1aef-405d-b939-a4d68029c825.png" alt="img"></p><p>\u5404\u9009\u9879\u542B\u4E49\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636175587333-c9adeac1-c4a0-48be-b5f8-b174b1a4051c.png" alt="img"></p><h5 id="_4-1-\u6D41\u63A7\u6A21\u5F0F" tabindex="-1"><a class="header-anchor" href="#_4-1-\u6D41\u63A7\u6A21\u5F0F" aria-hidden="true">#</a> 4.1 \u6D41\u63A7\u6A21\u5F0F</h5><p>\u6D41\u63A7\u6A21\u5F0F\u6709\u4E09\u79CD\uFF1A\u76F4\u63A5\u3001\u5173\u8054\u3001\u94FE\u8DEF</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636176700047-5a4c8c69-02ef-4ab9-a2a1-2f118d4b814b.png" alt="img"></p><h6 id="_4-1-1-\u76F4\u63A5-\u9ED8\u8BA4-\u5FEB\u901F\u5931\u8D25-\u9ED8\u8BA4" tabindex="-1"><a class="header-anchor" href="#_4-1-1-\u76F4\u63A5-\u9ED8\u8BA4-\u5FEB\u901F\u5931\u8D25-\u9ED8\u8BA4" aria-hidden="true">#</a> 4.1.1 \u76F4\u63A5\uFF08\u9ED8\u8BA4\uFF09+\u5FEB\u901F\u5931\u8D25\uFF08\u9ED8\u8BA4\uFF09</h6><p>######## (1) QPS\u76F4\u63A5\u5FEB\u901F\u5931\u8D25</p><p>QPS\uFF1Aquery per second\uFF0C\u6BCF\u79D2\u949F\u7684\u8BF7\u6C42\u6570\u91CF\uFF0C\u5F53\u8C03\u7528\u8BE5api\u7684QPS\u8FBE\u5230\u9608\u503C\u65F6\uFF0C\u8FDB\u884C\u9650\u6D41\u3002</p><p>\u4E0B\u9762\u8BBE\u7F6E\u8868\u793A1\u79D2\u949F\u5185\u67E5\u8BE2\u4E00\u6B21\u5C31\u662FOK\uFF0C\u82E5QPS&gt;1\uFF0C\u5C31\u76F4\u63A5-\u5FEB\u901F\u5931\u8D25\uFF0C\u62A5\u9ED8\u8BA4\u9519\u8BEF</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636176644611-c8d5c126-80b4-40ae-a6d2-fa3de2cd58e0.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636176782203-f7067740-667d-4eda-99df-8a6e1f9f9361.png" alt="img"></p><p>\u6D4B\u8BD5\u4E00\u4E0B\uFF0C\u5F53/testA\u7684\u8BBF\u95EE\u8D85\u8FC71\u6B21/s\u662F\uFF0C\u9875\u9762\u62A5\u9519\u3002\u88ABSentinel\u9650\u6D41\uFF0C\u8FD8\u80FD\u7EE7\u7EED\u8BF7\u6C42\u53EA\u8981QPS&lt;=1\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636177334549-a11fb3c2-1f91-4794-8e48-62b741305c6a.png" alt="img"></p><p>\u5C0F\u7ED3\uFF1A\u8868\u793A1\u79D2\u949F\u5185\u8BF7\u6C42\u6B21\u6570\u5927\u4E8E1\uFF0C\u5C31\u76F4\u63A5\u5FEB\u901F\u5931\u8D25\uFF0C\u62A5\u9ED8\u8BA4\u9519\u8BEF\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636177524780-585615e0-eae4-45d1-a9dc-b58088f0adf6.png" alt="img"></p><p>\u76F4\u63A5\u8C03\u7528\u9ED8\u8BA4\u7684\u62A5\u9519\u4FE1\u606F\u5728\u6280\u672F\u4E0A\u662FOK\u7684\uFF0C\u4F46\u662F\u662F\u5426\u5E94\u8BE5\u6709\u81EA\u5B9A\u4E49\u7684\u540E\u7EED\u5904\u7406\uFF1F\u5E94\u8BE5\u6709\u7C7B\u4F3CHystrix\u7684fallback\u7684\u515C\u5E95\u65B9\u6CD5\u3002</p><p>######## (2) \u7EBF\u7A0B\u6570\u76F4\u63A5\u5FEB\u901F\u5931\u8D25</p><p>\u5F53\u8C03\u7528\u8BE5api\u7684\u7EBF\u7A0B\u6570\u8FBE\u5230\u9608\u503C\u7684\u65F6\u5019\uFF0C\u8FDB\u884C\u9650\u6D41\u3002</p><p>\u4E0EQPS\u76F4\u63A5\u5FEB\u901F\u5931\u8D25\u4E0D\u540C\u7684\u662F\uFF0CQPS\u60C5\u51B5\u4E0B\u9650\u5236\u7684\u662F\u6D41\u91CF\uFF0C\u6BD4\u5982\u94F6\u884C\u7684\u4EBA\u6D41\u91CF\u53EA\u80FD\u662F1\u4EBA/s\uFF0C\u4E5F\u5C31\u662F\u8BF4\u6BCF\u6B21\u53EA\u80FD\u4E00\u4E2A\u4EBA\u8FDB\u5165\u94F6\u884C\u529E\u7406\u4E1A\u52A1\uFF1B\u800C\u7EBF\u7A0B\u6570\u5C31\u597D\u6BD4\u94F6\u884C\u53EA\u6709\u4E00\u4E2A\u7A97\u53E3\u5F00\u653E\uFF0C\u4E00\u7FA4\u4EBA\u90FD\u53EF\u4EE5\u8FDB\u5165\u94F6\u884C\uFF0C\u4F46\u662F\u6BCF\u6B21\u53EA\u80FD\u5904\u7406\u4E00\u4E2A\u4EBA\u7684\u4E1A\u52A1\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636178641049-10ce2a40-c119-496b-a555-f1d68ebf23cf.png" alt="img"></p><p>\u6F14\u793A\u6548\u679C\uFF1A</p><p>\u5148\u4FEE\u6539\u4E00\u4E0B8401\u7684\u4E1A\u52A1\u7C7B</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636181621634-2a4740b7-24a3-47dc-be31-b41231bf546f.png" alt="img"></p><p>\u7136\u540E\u91CD\u542F8401\uFF0C\u6D4B\u8BD5/testA\uFF0C\u6700\u597D\u7528\u4E24\u4E2A\u6D4F\u89C8\u5668\u8BBF\u95EE\uFF0C\u6548\u679C\u66F4\u660E\u663E</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636182093947-e60d26d5-6444-48e2-9031-404b805c86b1.png" alt="img"></p><h6 id="_4-1-2-\u5173\u8054" tabindex="-1"><a class="header-anchor" href="#_4-1-2-\u5173\u8054" aria-hidden="true">#</a> 4.1.2 \u5173\u8054</h6><p>\u5F53\u5173\u8054\u7684\u8D44\u6E90\u8FBE\u5230\u9608\u503C\u65F6\uFF0C\u5C31\u9650\u6D41\u81EA\u5DF1\u3002\u6BD4\u5982\u5F53\u4E0EA\u5173\u8054\u7684\u8D44\u6E90B\u8FBE\u5230\u9608\u503C\u540E\uFF0C\u5C31\u9650\u6D41A\u81EA\u5DF1\u3002</p><p>\u652F\u4ED8\u63A5\u53E3\u8FBE\u5230\u9608\u503C\uFF0C\u9650\u6D41\u4E0B\u8BA2\u5355\u7684\u63A5\u53E3\u3002</p><p>######## 1. \u914D\u7F6E</p><p>\u8BBE\u7F6E\u6548\u679C\uFF1A\u5F53\u5173\u8054\u8D44\u6E90/testB\u7684qps\u9600\u503C\u8D85\u8FC71\u65F6\uFF0C\u5C31\u9650\u6D41/testA\u7684Rest\u8BBF\u95EE\u5730\u5740\uFF0C\u5F53\u5173\u8054\u8D44\u6E90\u5230\u9608\u503C\u540E\u9650\u5236\u914D\u7F6E\u597D\u7684\u8D44\u6E90\u540D</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636185529204-c4973c0a-7ca9-4fe9-857c-ed28a602c17d.png" alt="img"></p><p>######## 2. \u6D4B\u8BD5</p><p>\u5355\u72EC\u8BBF\u95EEtestB\u6210\u529F\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636185759699-dbad4fbb-7c9e-4e3f-9990-4a21f12f34ae.png" alt="img"></p><p>postman\u6A21\u62DF\u5E76\u53D1\u5BC6\u96C6\u8BBF\u95EEtestB</p><p>\u5148\u521B\u5EFA\u4E00\u4E2A\u96C6\u5408\uFF0C\u540D\u5B57\u81EA\u5DF1\u968F\u4FBF\u53D6\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636186406791-1d909ef7-5650-4260-b198-56ad5bd4adef.png" alt="img"></p><p>\u7136\u540E\u5C06\u521B\u5EFA\u7684\u8BBF\u95EE/testB\u7684\u8BF7\u6C42\u4FDD\u5B58\u5728\u521B\u5EFA\u7684\u96C6\u5408\u4E2D</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636186397189-6b78e38a-d267-4eb1-9090-f62e50bb003e.png" alt="img"></p><p>\u8BBE\u5B9A\u96C6\u5408\u8FD0\u884C\u53C2\u6570\uFF0C20\u4E2A\u7EBF\u7A0B\uFF0C\u6BCF\u6B21\u95F4\u96940.3s\u8BBF\u95EE\u4E00\u6B21\uFF08QPS&gt;1\uFF09\uFF0C\u6267\u884C\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636186554384-4d416f2c-da41-4642-b726-f4852ebb648c.png" alt="img"></p><p>\u7136\u540E\u518D\u8BBF\u95EE/testA\uFF0C\u53D1\u73B0\u88AB\u9650\u6D41\uFF0C\u7B49postman\u6267\u884C\u5B8C\u6BD5\uFF0CtestA\u53C8\u53EF\u4EE5\u8BBF\u95EE\u4E86</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636186747122-a0428fb4-34f8-4336-a04b-784b3eb9cb9f.png" alt="img"></p><h6 id="_4-1-3-\u94FE\u8DEF" tabindex="-1"><a class="header-anchor" href="#_4-1-3-\u94FE\u8DEF" aria-hidden="true">#</a> 4.1.3 \u94FE\u8DEF</h6><p>\u9700\u8981\u6D4B\u8BD5\u94FE\u8DEF\u7684\u8BDD\uFF0Cspringcloud \u963F\u91CC\u5DF4\u5DF4\u7248\u672C\u9700\u89812.1.1.RELEASE\u4EE5\u4E0A\uFF0C\u5728\u7236\u5DE5\u7A0B\u7684pom\u4E2D\u4FEE\u6539\uFF0C\u4E0D\u8981\u76F4\u63A5\u5728\u5B50module\u7684pom\u4E2D\u4FEE\u6539\uFF0C\u7248\u672C\u6709\u5BF9\u5E94\u5173\u7CFB\uFF0C\u4E0D\u7136\u62A5\u9519\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636198092134-626f793b-2f04-47ae-a4df-5f771fadd13a.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636198752208-50584f8f-ed1b-4a84-910e-7dfed9a0d1f4.png" alt="img"></p><ul><li>Sentinel\u4ECE1.6.3\u7248\u672C\u5F00\u59CB\uFF0CSentinel Web Filter \u9ED8\u8BA4\u6536\u655B\u6240\u6709\u7684URL\u5165\u53E3\u7684Context\uFF0C\u56E0\u6B64\u94FE\u8DEF\u9650\u6D41\u4E0D\u751F\u6548</li><li>1.7.0\u7248\u672C\u5F00\u59CB\uFF0C\u5B98\u65B9\u5728CommomFilter\u4E2D\u5F15\u5165\u4E86<code>WEB_CONTEXT_UNIFY</code>\u8FD9\u4E2Ainit parameter\uFF0C\u7528\u4E8E\u63A7\u5236\u662F\u5426\u6536\u655Bcontext\uFF0C\u5C06\u5176\u914D\u7F6E\u4E3A<code>false</code>\u5373\u53EF\u6839\u636E\u4E0D\u540C\u7684URL\u8FDB\u884C\u94FE\u8DEF\u9650\u6D41</li><li>Spring Cloud Alibaba \u57282.1.1.RELEASE\u7248\u672C\u540E\uFF0C\u53EF\u4EE5\u901A\u8FC7\u914D\u7F6Espring.cloud.sentinel.web-context-unify=false\u5173\u95ED</li></ul><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636198422479-133556df-4fbf-4a93-841a-6399ebe4142b.png" alt="img"></p>',54),Zs={href:"https://github.com/alibaba/Sentinel/issues/1313",target:"_blank",rel:"noopener noreferrer"},na=s("https://github.com/alibaba/Sentinel/issues/1313"),sa=n("p",null,"######## \u6D4B\u8BD5",-1),aa=n("p",null,"\u542F\u52A88401\uFF0C\u7ED9/testA\u8BBE\u7F6E\u94FE\u8DEF+\u5FEB\u901F\u5931\u8D25\u6D41\u63A7\u89C4\u5219\uFF1A",-1),ta=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636198858162-237cfa39-c6b3-4d95-8211-c73c44e4ad49.png",alt:"img"})],-1),pa=n("p",null,"\u8FD9\u91CC\u5165\u53E3\u8D44\u6E90\u5C31\u662F\u7C07\u70B9\u94FE\u8DEF\u4E2D\uFF0C\u8D44\u6E90\u540D\u79F0\u7684\u4E0A\u4E00\u7EA7\u3002",-1),ea=s("\u8BBF\u95EE"),oa={href:"http://localhost:8401/linktestA",target:"_blank",rel:"noopener noreferrer"},ca=s("http://localhost:8401/linktestA"),la=s(" \uFF0C\u591A\u6B21\u5237\u65B0\u51FA\u73B0\u9650\u6D41"),ia=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636201194747-227fde3b-a8a4-4935-b5a5-3556bc1a6008.png",alt:"img"}),s("\uFF0C\u4F46\u662F\u8FD9\u79CD\u60C5\u51B5\u6211\u4E2A\u4EBA\u89C9\u5F97\u8DDF\u76F4\u63A5\u5FEB\u901F\u5931\u8D25\u533A\u522B\u4E0D\u5927\uFF0C\u53EA\u76F4\u63A5\u662F\u76D1\u63A7/testA\u8D44\u6E90\uFF0C\u800C\u94FE\u8DEF\u662F\u76D1\u63A7/testA\u7684\u8D44\u6E90\u5165\u53E3sentinel_web_servlet_context\u3002")],-1),ua=s("\u7136\u540E\u6211\u53C8\u53C2\u770B\u4E86\u5176\u4ED6\u535A\u5BA2\uFF0C"),ka={href:"https://blog.csdn.net/qq_29064815/article/details/107102060?utm_term=sentinel%E6%B5%81%E6%8E%A7%E6%A8%A1%E5%BC%8F%E7%9A%84%E9%93%BE%E8%B7%AF&utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~all~sobaiduweb~default-0-107102060&spm=3001.4430",target:"_blank",rel:"noopener noreferrer"},ra=s("\u6D41\u63A7\u6A21\u5F0F\u2014\u2014\u94FE\u8DEF"),da=s("\u3002\u589E\u52A0\u4E86FlowLimitService \u4FEE\u6539\u4E86controller"),ma=p(`<div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">SentinelResource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FlowLimitService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">FlowLimitService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>concurrent<span class="token punctuation">.</span></span><span class="token class-name">TimeUnit</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FlowLimitController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">FlowLimitService</span> flowLimitService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/testA&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">testA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u6682\u505C0.8\u79D2</span>
<span class="token comment">//        try {</span>
<span class="token comment">//            TimeUnit.MILLISECONDS.sleep(800);</span>
<span class="token comment">//        } catch (InterruptedException e) {</span>
<span class="token comment">//            e.printStackTrace();</span>
<span class="token comment">//        }</span>

        <span class="token keyword">return</span> <span class="token string">&quot;------testA&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/testB&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">testB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;------testB&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
	
    <span class="token comment">//   \u94FE\u8DEF\u6D4B\u8BD5</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/linktestA&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">linktestA</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> flowLimitService<span class="token punctuation">.</span><span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/linktestB&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">linktestB</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> flowLimitService<span class="token punctuation">.</span><span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5206\u522B\u901A\u8FC7/linktetA \u548C /linktestB\u90FD\u662Fmessage\u7684\u5165\u53E3\uFF0C\u7136\u540E\u8BBE\u7F6E/linktestA\u5165\u53E3\u7684\u6D41\u91CF\u9650\u5236\uFF0C\u53D1\u73B0\u4E0D\u8D77\u4F5C\u7528\u3002\u3002\u3002</p><h5 id="_4-2-\u6D41\u63A7\u6548\u679C" tabindex="-1"><a class="header-anchor" href="#_4-2-\u6D41\u63A7\u6548\u679C" aria-hidden="true">#</a> 4.2 \u6D41\u63A7\u6548\u679C</h5><p><strong>\u5FEB\u901F\u5931\u8D25</strong>\u5728\u4E0A\u9762\u7684\u6D41\u63A7\u6A21\u5F0F\u6F14\u793A\u8FC7\u4E86\uFF0C\u4ED6\u662F\u9ED8\u8BA4\u7684\u6D41\u63A7\u6548\u679C\uFF0C\u76F4\u63A5\u5931\u8D25\uFF0C\u629B\u51FA\u5F02\u5E38\u3002\u6E90\u7801\uFF1Acom.alibaba.csp.sentinel.slots.block.flow.controller.DefaultController</p><h6 id="_4-2-1-warm-up-\u9884\u70ED" tabindex="-1"><a class="header-anchor" href="#_4-2-1-warm-up-\u9884\u70ED" aria-hidden="true">#</a> 4.2.1 warm up \u9884\u70ED</h6>`,5),ga={href:"https://github.com/alibaba/Sentinel/wiki/%E9%99%90%E6%B5%81---%E5%86%B7%E5%90%AF%E5%8A%A8",target:"_blank",rel:"noopener noreferrer"},va=s("\u5B98\u7F51"),ba=s(" \u6E90\u7801\uFF1Acom.alibaba.csp.sentinel.slots.block.flow.controller.WarmUpController"),ha=p('<p>\u516C\u5F0F\uFF1A\u9608\u503C\u9664\u4EE5coldFactor(\u9ED8\u8BA4\u503C\u4E3A3),\u7ECF\u8FC7\u9884\u70ED\u65F6\u957F\u540E\u624D\u4F1A\u8FBE\u5230\u9608\u503C</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636204182838-32d2e249-f24f-4837-a0f0-3c4be43a5b8c.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636204711029-22aea67e-cc6b-4cfd-994c-dd51bb5fd0b6.png" alt="img"></p><p>######## \u6D4B\u8BD5</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636204985038-e380529f-cc06-4fd7-9d61-ca191748bf9c.png" alt="img"></p><p>\u72C2\u70B9\u8BF7\u6C42\uFF0C\u53EF\u4EE5\u770B\u901A\u8FC7\u7684QPS\u9010\u6E10\u589E\u52A0\uFF0C\u6700\u5F00\u59CB\u4F1A\u62A5\u9519\u9650\u6D41\uFF0C\u4E4B\u540E\u5C31\u53EF\u4EE5\u6297\u4F4F10/s\u7684QPS\u4E86</p><p>\u5E94\u7528\u573A\u666F\uFF1A\u79D2\u6740\u7CFB\u7EDF\u5728\u5F00\u542F\u7684\u77AC\u95F4\uFF0C\u4F1A\u6709\u5F88\u591A\u6D41\u91CF\u4E0A\u6765\uFF0C\u5F88\u6709\u53EF\u80FD\u628A\u7CFB\u7EDF\u6253\u6B7B\uFF0C\u9884\u70ED\u65B9\u5F0F\u5C31\u662F\u628A\u4E3A\u4E86\u4FDD\u62A4\u7CFB\u7EDF\uFF0C\u53EF\u6162\u6162\u7684\u628A\u6D41\u91CF\u653E\u8FDB\u6765\uFF0C\u6162\u6162\u7684\u628A\u9600\u503C\u589E\u957F\u5230\u8BBE\u7F6E\u7684\u9600\u503C\u3002</p><h6 id="_4-2-2-\u6392\u961F\u7B49\u5F85" tabindex="-1"><a class="header-anchor" href="#_4-2-2-\u6392\u961F\u7B49\u5F85" aria-hidden="true">#</a> 4.2.2 \u6392\u961F\u7B49\u5F85</h6>',8),ya={href:"https://github.com/alibaba/Sentinel/wiki/%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6",target:"_blank",rel:"noopener noreferrer"},fa=s("\u5B98\u7F51"),qa=s(" \u6E90\u7801\uFF1Acom.alibaba.csp.sentinel.slots.block.flow.controller.RateLimiterController"),wa=p('<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636205316214-62574c1a-6bb6-47d6-915f-b02211bf4281.png" alt="img"></p><p>\u5300\u901F\u6392\u961F\uFF0C\u8BA9\u8BF7\u6C42\u4EE5\u5747\u5300\u7684\u901F\u5EA6\u901A\u8FC7\uFF0C\u9600\u503C\u7C7B\u578B\u5FC5\u987B\u8BBE\u6210QPS\uFF0C\u5426\u5219\u65E0\u6548\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636205407842-08de7a67-8015-421a-9181-e3fa123cf8be.png" alt="img"></p><p>/testA\u7684QPS\u6700\u5927\u4E3A1\uFF0C\u8D85\u8FC7\u7684\u8BDD\u5C31\u6392\u961F\u7B49\u5F85\uFF0C\u7B49\u5F85\u7684\u8D85\u65F6\u65F6\u95F4\u4E3A20000ms\u3002</p><p>\u4FEE\u6539\u4E00\u4E0B\u4E1A\u52A1\u4EE3\u7801\uFF0C\u628A\u7EBF\u7A0B\u540D\u6253\u5370\u51FA\u6765\u4EE5\u9A8C\u8BC1\u662F\u5426\u6392\u961F\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636205738814-e13e3122-ad11-4423-8152-b4bbc6e88744.png" alt="img"></p><p>######## \u6D4B\u8BD5</p><p>postman\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636205861798-1d6022d2-1cfc-4e83-a31f-9b05bcc6f293.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636206130850-dd47f017-0e97-4fbc-b825-b9e5ea590c12.png" alt="img"></p><p>\u53EF\u4EE5\u770B\u5230\u521A\u597D\u6EE1\u8DB31s\u4E00\u4E2A\u8BF7\u6C42\uFF0C\u8BF4\u660E\u8BF7\u6C42\u7684\u6267\u884C\u8FDB\u884C\u4E86\u6392\u961F\u3002</p><h3 id="\u4E94\u3001\u964D\u7EA7\u89C4\u5219-\u7194\u65AD\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#\u4E94\u3001\u964D\u7EA7\u89C4\u5219-\u7194\u65AD\u89C4\u5219" aria-hidden="true">#</a> \u4E94\u3001\u964D\u7EA7\u89C4\u5219\uFF08\u7194\u65AD\u89C4\u5219\uFF09</h3>',12),_a={href:"https://github.com/alibaba/Sentinel/wiki/%E7%86%94%E6%96%AD%E9%99%8D%E7%BA%A7",target:"_blank",rel:"noopener noreferrer"},xa=s("\u5B98\u7F51"),Ia=p(`<p>\u8001\u7248\u672C\u7684Sentinel\u7684\u65AD\u8DEF\u5668\u662F\u6CA1\u6709\u534A\u5F00\u72B6\u6001\u7684\uFF0C\u534A\u5F00\u7684\u72B6\u6001\u7CFB\u7EDF\u81EA\u52A8\u53BB\u68C0\u6D4B\u662F\u5426\u8BF7\u6C42\u6709\u5F02\u5E38\uFF0C\u6CA1\u6709\u5F02\u5E38\u5C31\u5173\u95ED\u65AD\u8DEF\u5668\u6062\u590D\u4F7F\u7528\uFF0C\u6709\u5F02\u5E38\u5219\u7EE7\u7EED\u6253\u5F00\u65AD\u8DEF\u5668\u4E0D\u53EF\u7528\u3002\u5177\u4F53\u53EF\u4EE5\u53C2\u8003Hystrix\u3002\uFF08\u5728Hystrix\u4E2D \u5FEB\u7167\u65F6\u95F4\u7A97\u53E3\u662F\u503C \u9608\u503C\u68C0\u6D4B\u65F6\u95F4 \uFF0C\u800C\u4F11\u7720\u65F6\u95F4\u7A97\u53E3\u662F\u6307 \u65AD\u8DEF\u5668\u4ECE\u5F00\u542F\u5230\u534A\u5F00\u72B6\u6001\u95F4\u9694\u7684\u65F6\u95F4\uFF09</p><p><strong>\u65B0\u7248\u672C\u7684Sentinel\u52A0\u5165\u4E86\u534A\u5F00\u72B6\u6001</strong>\uFF01</p><h5 id="_5-1-\u964D\u7EA7\u7B56\u7565" tabindex="-1"><a class="header-anchor" href="#_5-1-\u964D\u7EA7\u7B56\u7565" aria-hidden="true">#</a> 5.1 \u964D\u7EA7\u7B56\u7565</h5><p>Sentinel \u7194\u65AD\u964D\u7EA7\u4F1A\u5728\u8C03\u7528\u94FE\u8DEF\u4E2D\u67D0\u4E2A\u8D44\u6E90\u51FA\u73B0\u4E0D\u7A33\u5B9A\u72B6\u6001\u65F6\uFF08\u4F8B\u5982\u8C03\u7528\u8D85\u65F6\u6216\u5F02\u5E38\u6BD4\u4F8B\u5347\u9AD8\uFF09\uFF0C\u5BF9\u8FD9\u4E2A\u8D44\u6E90\u7684\u8C03\u7528\u8FDB\u884C\u9650\u5236\uFF0C\u8BA9\u8BF7\u6C42\u5FEB\u901F\u5931\u8D25\uFF0C\u907F\u514D\u5F71\u54CD\u5230\u5176\u5B83\u7684\u8D44\u6E90\u800C\u5BFC\u81F4\u7EA7\u8054\u9519\u8BEF\u3002</p><p>\u5F53\u8D44\u6E90\u88AB\u964D\u7EA7\u540E\uFF0C\u5728\u63A5\u4E0B\u6765\u7684\u964D\u7EA7\u65F6\u95F4\u7A97\u53E3\u4E4B\u5185\uFF0C\u5BF9\u8BE5\u8D44\u6E90\u7684\u8C03\u7528\u90FD\u81EA\u52A8\u7194\u65AD\uFF08\u9ED8\u8BA4\u884C\u4E3A\u662F\u629B\u51FA DegradeException\uFF09\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636207003638-9f6107f8-025c-47c5-89d5-d59a24051703.png" alt="img"></p><h6 id="_5-1-1-\u6162\u8C03\u7528\u6BD4\u4F8B-rt-\u5E73\u5747\u54CD\u5E94\u65F6\u95F4-\u79D2\u7EA7" tabindex="-1"><a class="header-anchor" href="#_5-1-1-\u6162\u8C03\u7528\u6BD4\u4F8B-rt-\u5E73\u5747\u54CD\u5E94\u65F6\u95F4-\u79D2\u7EA7" aria-hidden="true">#</a> 5.1.1 \u6162\u8C03\u7528\u6BD4\u4F8B\uFF0CRT\uFF08\u5E73\u5747\u54CD\u5E94\u65F6\u95F4\uFF0C\u79D2\u7EA7\uFF09</h6><p>\u8001\u7248\u672C\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636378468415-d870b7ac-5a40-47c1-b6ca-13ae193bd2b4.png" alt="img"></p><p>\u65B0\u7248\u672C\uFF1A</p><ul><li>\u6162\u8C03\u7528\u6BD4\u4F8B (SLOW_REQUEST_RATIO)\uFF1A\u9009\u62E9\u4EE5\u6162\u8C03\u7528\u6BD4\u4F8B\u4F5C\u4E3A\u9608\u503C\uFF0C\u9700\u8981\u8BBE\u7F6E\u5141\u8BB8\u7684\u6162\u8C03\u7528 RT\uFF08\u5373\u6700\u5927\u7684\u54CD\u5E94\u65F6\u95F4\uFF09\uFF0C\u8BF7\u6C42\u7684\u54CD\u5E94\u65F6\u95F4\u5927\u4E8E\u8BE5\u503C\u5219\u7EDF\u8BA1\u4E3A\u6162\u8C03\u7528\u3002\u5F53\u5355\u4F4D\u7EDF\u8BA1\u65F6\u957F\uFF08statIntervalMs\uFF09\u5185\u8BF7\u6C42\u6570\u76EE\u5927\u4E8E\u8BBE\u7F6E\u7684\u6700\u5C0F\u8BF7\u6C42\u6570\u76EE\uFF0C<strong>\u5E76\u4E14</strong>\u6162\u8C03\u7528\u7684\u6BD4\u4F8B\u5927\u4E8E\u9608\u503C\uFF0C\u5219\u63A5\u4E0B\u6765\u7684\u7194\u65AD\u65F6\u957F\u5185\u8BF7\u6C42\u4F1A\u81EA\u52A8\u88AB\u7194\u65AD\u3002\u7ECF\u8FC7\u7194\u65AD\u65F6\u957F\u540E\u7194\u65AD\u5668\u4F1A\u8FDB\u5165\u63A2\u6D4B\u6062\u590D\u72B6\u6001\uFF08HALF-OPEN \u72B6\u6001\uFF09\uFF0C\u82E5\u63A5\u4E0B\u6765\u7684\u4E00\u4E2A\u8BF7\u6C42\u54CD\u5E94\u65F6\u95F4\u5C0F\u4E8E\u8BBE\u7F6E\u7684\u6162\u8C03\u7528 RT \u5219\u7ED3\u675F\u7194\u65AD\uFF0C\u82E5\u5927\u4E8E\u8BBE\u7F6E\u7684\u6162\u8C03\u7528 RT \u5219\u4F1A\u518D\u6B21\u88AB\u7194\u65AD\u3002\uFF08\u8DDF\u8C6A\u732A\u79D1\u7C7B\u4F3C\uFF09</li></ul><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636207429643-4edd50c3-d110-4666-ad70-831e744bbfb9.png" alt="img"></p><p>######## \u5B9E\u6218\u6D4B\u8BD5</p><p><strong>\u4E1A\u52A1\u7C7B\u4E2D\u52A0\u4E00\u4E2Arest \u63A5\u53E3\uFF0C\u4EE5\u7528\u4E8E\u6D4B\u8BD5\uFF1A</strong></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/testD&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">testD</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//\u6682\u505C1\u79D2</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;testD  \u6D4B\u8BD5\u6162\u8C03\u7528\u6BD4\u4F8B RT&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;------tedtD&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636266326957-7c5e050b-cf3b-41b9-9d5f-25708ff0a496.png" alt="img"> \u8BBF\u95EE\u6CA1\u6709\u95EE\u9898</p><p><strong>\u7F16\u8F91\u7194\u65AD\u89C4\u5219\uFF1A</strong></p><p>\u57281000ms\u7684\u7EDF\u8BA1\u65F6\u95F4\u5185\uFF0C\u603B\u8BF7\u6C42\u6570\uFF08\u8D85\u8FC75\u6B21\uFF09\u4E2D\u670980%\u7684\u8BF7\u6C42\u6700\u5927RT\u8D85\u8FC7\u4E86200ms\uFF0C\u90A3\u4E48\u89E6\u53D1\u7194\u65AD\u673A\u5236\uFF0C\u7194\u65AD2s\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636265807427-1198f086-d189-442c-975d-e971611c0e16.png" alt="img"></p><p><strong>jmeter\u538B\u6D4B\uFF1A</strong></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636266473500-f055ba07-c8ca-48cf-86da-9333b7f55128.png" alt="img"></p><p>\u6C38\u8FDC\u4E00\u79D2\u949F\u6253\u8FDB\u676510\u4E2A\u7EBF\u7A0B\uFF08\u5927\u4E8E5\u4E2A\u4E86\uFF09\u8C03\u7528testD\uFF0C\u6211\u4EEC\u5E0C\u671B200\u6BEB\u79D2\u5904\u7406\u5B8C\u672C\u6B21\u4EFB\u52A1\uFF0C\u5982\u679C\u8D85\u8FC7200\u6BEB\u79D2\u8FD8\u6CA1\u5904\u7406\u5B8C\uFF0C\u5728\u672A\u6765s\u79D2\u949F\u7684\u65F6\u95F4\u5185\uFF0C\u65AD\u8DEF\u5668\u6253\u5F00(\u4FDD\u9669\u4E1D\u8DF3\u95F8)\u5FAE\u670D\u52A1\u4E0D\u53EF\u7528\uFF0C\u4FDD\u9669\u4E1D\u8DF3\u95F8\u65AD\u7535\u4E86\u3002</p><p>testD\u88AB\u7194\u65AD\u4E86</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636266522552-1fe03a0c-6140-4994-9717-6e42c25f60e9.png" alt="img"></p><p>\u4ECE\u5B9E\u65F6\u76D1\u63A7\u4E5F\u53EF\u4EE5\u770B\u5230\uFF0C\u572809\u7684\u65F6\u5019\u5F00\u59CB\u7194\u65AD\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636266606192-df29ca4b-f481-40da-af03-be7b19566893.png" alt="img"></p><p>\u540E\u7EED\u6211\u505C\u6B62jmeter\uFF0C\u6CA1\u6709\u8FD9\u4E48\u5927\u7684\u8BBF\u95EE\u91CF\u4E86\uFF0C\u65AD\u8DEF\u5668\u534A\u5F00\u5230\u5173\u95ED(\u4FDD\u9669\u4E1D\u6062\u590D)\uFF0C\u5FAE\u670D\u52A1\u6062\u590DOK\u3002</p><h6 id="_5-1-2-\u5F02\u5E38\u6BD4\u4F8B" tabindex="-1"><a class="header-anchor" href="#_5-1-2-\u5F02\u5E38\u6BD4\u4F8B" aria-hidden="true">#</a> 5.1.2 \u5F02\u5E38\u6BD4\u4F8B</h6><p>\u8001\u7248\u672C\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636378442709-b1dd34e0-96d1-4be1-bbfd-26f9986b2a07.png" alt="img"></p><p>\u65B0\u7248\u672C\uFF1A</p><ul><li>\u5F02\u5E38\u6BD4\u4F8B (ERROR_RATIO)\uFF1A\u5F53\u5355\u4F4D\u7EDF\u8BA1\u65F6\u957F\uFF08statIntervalMs\uFF09\u5185\u8BF7\u6C42\u6570\u76EE\u5927\u4E8E\u8BBE\u7F6E\u7684\u6700\u5C0F\u8BF7\u6C42\u6570\u76EE\uFF0C\u5E76\u4E14\u5F02\u5E38\u7684\u6BD4\u4F8B\u5927\u4E8E\u9608\u503C\uFF0C\u5219\u63A5\u4E0B\u6765\u7684\u7194\u65AD\u65F6\u957F\u5185\u8BF7\u6C42\u4F1A\u81EA\u52A8\u88AB\u7194\u65AD\u3002\u7ECF\u8FC7\u7194\u65AD\u65F6\u957F\u540E\u7194\u65AD\u5668\u4F1A\u8FDB\u5165\u63A2\u6D4B\u6062\u590D\u72B6\u6001\uFF08HALF-OPEN \u72B6\u6001\uFF09\uFF0C\u82E5\u63A5\u4E0B\u6765\u7684\u4E00\u4E2A\u8BF7\u6C42\u6210\u529F\u5B8C\u6210\uFF08\u6CA1\u6709\u9519\u8BEF\uFF09\u5219\u7ED3\u675F\u7194\u65AD\uFF0C\u5426\u5219\u4F1A\u518D\u6B21\u88AB\u7194\u65AD\u3002\u5F02\u5E38\u6BD4\u7387\u7684\u9608\u503C\u8303\u56F4\u662F [0.0, 1.0]\uFF0C\u4EE3\u8868 0% - 100%\u3002</li></ul><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636207879946-e9294f3f-9dff-469f-9ff9-29fe9298f491.png" alt="img"></p><p>######## \u5B9E\u6218\u6D4B\u8BD5</p><p><strong>\u4FEE\u6539\u4E1A\u52A1\u7C7B\uFF1A</strong></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636267293236-37a974f2-db79-4a0d-99e2-18aa1f0141c9.png" alt="img"></p><p><strong>\u7F16\u8F91\u7194\u65AD\u89C4\u5219\uFF1A</strong></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636267653333-5d7543f3-6415-46f0-aa37-5e7438583c52.png" alt="img"></p><p>1000ms\u7EDF\u8BA1\u65F6\u957F\u5185\uFF0C\u5927\u4E8E5\u6B21\u7684\u8BF7\u6C42\u4E2D\u8D85\u8FC780%\u7684\u8BF7\u6C42\u51FA\u73B0\u5F02\u5E38\uFF0C\u5219\u7194\u65AD2s\u3002</p><p><strong>jmeter\u538B\u6D4B\uFF1A</strong></p><p>\u5355\u72EC\u8BBF\u95EE\u4E00\u6B21\uFF0C\u5FC5\u7136\u6765\u4E00\u6B21\u62A5\u9519\u4E00\u6B21(int age = 10/0)\uFF0C\u8C03\u4E00\u6B21\u9519\u4E00\u6B21\uFF1B\u5F00\u542Fjmeter\u540E\uFF0C\u76F4\u63A5\u9AD8\u5E76\u53D1\u53D1\u9001\u8BF7\u6C42\uFF0C\u591A\u6B21\u8C03\u7528\u8FBE\u5230\u6211\u4EEC\u7684\u914D\u7F6E\u6761\u4EF6\u4E86\u3002\u65AD\u8DEF\u5668\u5F00\u542F(\u4FDD\u9669\u4E1D\u8DF3\u95F8)\uFF0C\u5FAE\u670D\u52A1\u4E0D\u53EF\u7528\u4E86\uFF0C\u4E0D\u518D\u62A5\u9519error\u800C\u662F\u670D\u52A1\u964D\u7EA7\u4E86\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636268158534-04e8bef7-faae-4252-b62d-4b6a99268aff.png" alt="img">testD\u88AB\u7194\u65AD\u3002</p><p>\u505C\u6389jemeter\u540E\u8FC72s\u3002\u62A5/zero\u9519\u8BEF\uFF0C\u56E0\u4E3A\u4E1A\u52A1\u7C7B\u4E2D\u6709\u4E2A10/0\u3002</p><h6 id="_5-1-3-\u5F02\u5E38\u6570" tabindex="-1"><a class="header-anchor" href="#_5-1-3-\u5F02\u5E38\u6570" aria-hidden="true">#</a> 5.1.3 \u5F02\u5E38\u6570</h6><p>\u8001\u7248\u672C\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636378394872-1cfc747b-422a-4df5-a551-e21137e49095.png" alt="img"></p><p>\u65F6\u95F4\u7A97\u53E3\u4E00\u5B9A\u8981\u5927\u4E8E\u7B49\u4E8E60\u79D2\u3002</p><p>\u65B0\u7248\u672C</p><ul><li>\u5F02\u5E38\u6570 (ERROR_COUNT)\uFF1A\u5F53\u5355\u4F4D\u7EDF\u8BA1\u65F6\u957F\u5185\u7684\u5F02\u5E38\u6570\u76EE\u8D85\u8FC7\u9608\u503C\u4E4B\u540E\u4F1A\u81EA\u52A8\u8FDB\u884C\u7194\u65AD\u3002\u7ECF\u8FC7\u7194\u65AD\u65F6\u957F\u540E\u7194\u65AD\u5668\u4F1A\u8FDB\u5165\u63A2\u6D4B\u6062\u590D\u72B6\u6001\uFF08HALF-OPEN \u72B6\u6001\uFF09\uFF0C\u82E5\u63A5\u4E0B\u6765\u7684\u4E00\u4E2A\u8BF7\u6C42\u6210\u529F\u5B8C\u6210\uFF08\u6CA1\u6709\u9519\u8BEF\uFF09\u5219\u7ED3\u675F\u7194\u65AD\uFF0C\u5426\u5219\u4F1A\u518D\u6B21\u88AB\u7194\u65AD\u3002</li></ul><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636207898160-37b7b016-4d79-4b44-a455-a072fae85cf2.png" alt="img"></p><p>######## \u5B9E\u6218\u6D4B\u8BD5</p><p><strong>\u4FEE\u6539\u4E1A\u52A1\u7C7B\uFF1A</strong></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636268914525-f0a66727-3263-4f54-8dca-7a94f8a4f812.png" alt="img"></p><p><strong>\u7F16\u8F91\u7194\u65AD\u89C4\u5219\uFF1A</strong></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636268891084-07a17150-d76a-46b3-a166-71240d074b60.png" alt="img"></p><p><strong>\u624B\u52A8\u6D4B\u8BD5\uFF1A</strong></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636269346017-b329de29-198b-436c-9975-4135956f2d29.png" alt="img"></p><p>\u8FD9\u91CC\u6211\u6D4B\u8BD5\u6709bug\uFF0C\u867D\u7136\u7194\u65AD\u4E86\u4F46\u662F\u7194\u65AD\u65F6\u957F\u4E0D\u662F\u6211\u914D\u7F6E\u76845s\uFF0C\u5927\u7EA6\u662F\u4E00\u5206\u949F\uFF0C\u7EDF\u8BA1\u65F6\u957F\u4E5F\u4E0D\u662F1s\uFF0C\u597D\u50CF\u4E5F\u662F\u4E00\u5206\u949F\uFF0C\u540C\u65F6\u6CA1\u8FBE\u5230\u6700\u5C0F\u8BF7\u6C42\u6570\uFF0C\u53EA\u8FBE\u52303\u6B21\u5F02\u5E38\u5C31\u76F4\u63A5\u7194\u65AD\u4E86\u3002\u867D\u7136\u6211\u7528\u7684\u65B0\u7248\u672C\uFF0C\u4F46\u662F\u903B\u8F91\u597D\u50CF\u8DDF\u8001\u7248\u672C\u7684\u4E00\u6837\uFF1F</p><h3 id="\u516D\u3001\u70ED\u70B9key\u9650\u6D41" tabindex="-1"><a class="header-anchor" href="#\u516D\u3001\u70ED\u70B9key\u9650\u6D41" aria-hidden="true">#</a> \u516D\u3001\u70ED\u70B9key\u9650\u6D41</h3><h5 id="_6-1-\u57FA\u672C\u4ECB\u7ECD" tabindex="-1"><a class="header-anchor" href="#_6-1-\u57FA\u672C\u4ECB\u7ECD" aria-hidden="true">#</a> 6.1 \u57FA\u672C\u4ECB\u7ECD</h5>`,60),Sa={href:"https://github.com/alibaba/Sentinel/wiki/%E7%83%AD%E7%82%B9%E5%8F%82%E6%95%B0%E9%99%90%E6%B5%81",target:"_blank",rel:"noopener noreferrer"},Ea=s("\u5B98\u7F51"),Aa=p(`<p>\u4F55\u4E3A\u70ED\u70B9\uFF1A\u70ED\u70B9\u5373\u7ECF\u5E38\u8BBF\u95EE\u7684\u6570\u636E\uFF0C\u5F88\u591A\u65F6\u5019\u6211\u4EEC\u5E0C\u671B\u7EDF\u8BA1\u6216\u8005\u9650\u5236\u67D0\u4E2A\u70ED\u70B9\u6570\u636E\u4E2D\u8BBF\u95EE\u9891\u6B21\u6700\u9AD8\u7684TopN\u6570\u636E\uFF0C\u5E76\u5BF9\u5176\u8BBF\u95EE\u8FDB\u884C\u9650\u6D41\u6216\u8005\u5176\u5B83\u64CD\u4F5C\u3002\u6BD4\u5982\uFF1A</p><ul><li>\u5546\u54C1 ID \u4E3A\u53C2\u6570\uFF0C\u7EDF\u8BA1\u4E00\u6BB5\u65F6\u95F4\u5185\u6700\u5E38\u8D2D\u4E70\u7684\u5546\u54C1 ID \u5E76\u8FDB\u884C\u9650\u5236</li><li>\u7528\u6237 ID \u4E3A\u53C2\u6570\uFF0C\u9488\u5BF9\u4E00\u6BB5\u65F6\u95F4\u5185\u9891\u7E41\u8BBF\u95EE\u7684\u7528\u6237 ID \u8FDB\u884C\u9650\u5236</li></ul><p>\u70ED\u70B9\u53C2\u6570\u9650\u5236\u4F1A\u7EDF\u8BA1\u4F20\u5165\u53C2\u6570\u4E2D\u7684\u70ED\u70B9\u53C2\u6570\uFF0C\u5E76\u6839\u636E\u914D\u7F6E\u7684\u9650\u6D41\u9608\u503C\u4E0E\u6A21\u5F0F\uFF0C\u5BF9\u5305\u542B\u70ED\u70B9\u53C2\u6570\u7684\u8D44\u6E90\u8C03\u7528\u8FDB\u884C\u9650\u5236\u3002\u70ED\u70B9\u53C2\u6570\u9650\u6D41\u53EF\u4EE5\u770B\u4F5C\u662F\u4E00\u79CD\u7279\u6B8A\u7684\u6D41\u91CF\u63A7\u5236\uFF0C\u4EC5\u5BF9\u5305\u542B\u70ED\u70B9\u53C2\u6570\u7684\u8D44\u6E90\u8C03\u7528\u751F\u6548\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636271319999-dd06109b-159d-417c-ab3a-8ff219009af4.png" alt="img"></p><p>Sentinel\u5229\u7528LRU\u7B56\u7565\u7EDF\u8BA1\u6700\u8FD1\u6700\u5E38\u8BBF\u95EE\u7684\u70ED\u7535\u53C2\u6570\uFF0C\u7ED3\u5408\u4EE4\u724C\u6876\u7B97\u6CD5\u6765\u8FDB\u884C\u53C2\u6570\u7EA7\u522B\u7684\u6D41\u63A7\u3002\u70ED\u70B9\u53C2\u6570\u9650\u6D41\u652F\u6301\u96C6\u7FA4\u6A21\u5F0F\u3002</p><h5 id="_6-2-\u57FA\u672C\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#_6-2-\u57FA\u672C\u4F7F\u7528" aria-hidden="true">#</a> 6.2 \u57FA\u672C\u4F7F\u7528</h5><p>\u515C\u5E95\u9632\u8303\u5206\u4E3A\u7CFB\u7EDF\u9ED8\u8BA4\u548C\u5BA2\u6237\u81EA\u5B9A\u4E49\uFF1B\u4E24\u79CD\uFF0C\u6839\u636E\u4E4B\u524D\u7684case\uFF0C\u90FD\u662F\u4F7F\u7528sentinel\u7CFB\u7EDF\u9ED8\u8BA4\u7684\u63D0\u793A\uFF1ABlocked by Sentinel (flow limiting)\u3002\u90A3\u6211\u4EEC\u80FD\u4E0D\u80FD\u81EA\u5B9A\u4E49\u515C\u5E95\u65B9\u6CD5\u5462\uFF1F\u7C7B\u4F3Chystrix\uFF0C\u67D0\u4E2A\u65B9\u6CD5\u51FA\u95EE\u9898\u4E86\uFF0C\u5C31\u627E\u5BF9\u5E94\u7684\u515C\u5E95\u964D\u7EA7\u65B9\u6CD5\uFF1F</p><p>\u7C7B\u4F3C\u4E8E**@HystrixCommand\uFF0C** \u5F15\u5165**@SentinelResource**\u6CE8\u89E3\u3002</p><p>\u70ED\u70B9\u89C4\u5219\u5171\u6709\u8D44\u6E90\u540D\u3001\u9650\u6D41\u6A21\u5F0F\uFF08\u53EA\u652F\u6301QPS\u6A21\u5F0F\uFF09\u3001\u53C2\u6570\u7D22\u5F15\u3001\u5355\u673A\u9608\u503C\u3001\u7EDF\u8BA1\u7A97\u53E3\u65F6\u957F\u3001\u662F\u5426\u96C6\u7FA46\u79CD\u53C2\u6570\uFF0C\u8FD8\u6709\u4E00\u4E9B\u9AD8\u7EA7\u9009\u9879\uFF0C\u7528\u5230\u65F6\u4F1A\u8BE6\u7EC6\u4ECB\u7ECD\u3002\u8FD9\u91CC\u4F1A\u7528\u5230\u6CE8\u89E3\u4E2D\u7684value\u4F5C\u4E3A\u8D44\u6E90\u540D\uFF0C\u515C\u5E95\u65B9\u6CD5\u4F1A\u5728\u540E\u9762\u8BE6\u7EC6\u4ECB\u7ECD<a href="##HQt8b">@SentinelResource\u6CE8\u89E3\u8BE6\u89E3</a></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636426167642-e877c00d-bcc0-4fdf-9b3d-a67bb51fd640.png" alt="img"></p><p>\u6CE8\u610F\uFF1A</p><p><strong>\u8D44\u6E90\u540D</strong>\uFF1A**\u552F\u4E00\u8DEF\u5F84\uFF0C\u9ED8\u8BA4\u4E3A\u8BF7\u6C42\u8DEF\u5F84\u3002**\u6B64\u5904\u5FC5\u987B\u662F @SentinelResource \u6CE8\u89E3\u7684 value \u5C5E\u6027\u503C\uFF0C\u914D\u7F6E@GetMapping \u7684\u8BF7\u6C42\u8DEF\u5F84\u65E0\u6548\uFF09</p><h6 id="_6-2-1-\u6D4B\u8BD5\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#_6-2-1-\u6D4B\u8BD5\u65B9\u6CD5" aria-hidden="true">#</a> 6.2.1 \u6D4B\u8BD5\u65B9\u6CD5</h6><p>\u8FD8\u662F\u57288401\u7684controller\u4E2D\uFF0C\u52A0\u5165\u70ED\u70B9\u6D4B\u8BD5\u65B9\u6CD5\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/testHotKey&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;testHotKey&quot;</span><span class="token punctuation">,</span> blockHandler <span class="token operator">=</span> <span class="token string">&quot;del_testHotKey&quot;</span><span class="token punctuation">)</span>   <span class="token comment">//\u8FD9\u91CC\u7684\u540D\u79F0\u53EF\u4EE5\u968F\u4FBF\u5199\uFF0C\u4F46\u662F\u4E00\u822C\u8DDFrest\u5730\u5740\u4E00\u6837</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">testHotkey</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;p1&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token class-name">String</span> p1<span class="token punctuation">,</span>
                         <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;p1&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token class-name">String</span> p2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;------testHotkey&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//\u8FD9\u91CC\u662F\u6211\u4EEC\u81EA\u5B9A\u4E49\u7684\u515C\u5E95\u65B9\u6CD5\uFF0CBlockException\u4E0D\u8981\u6253\u6210\u4E86BlockedException</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">del_testHotKey</span><span class="token punctuation">(</span><span class="token class-name">String</span> p1<span class="token punctuation">,</span> <span class="token class-name">String</span> p2<span class="token punctuation">,</span> <span class="token class-name">BlockException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;\u8FD9\u6B21\u4E0D\u7528\u9ED8\u8BA4\u7684\u515C\u5E95\u63D0\u793ABlocked by Sentinel(flow limiting)\uFF0C\u81EA\u5B9A\u4E49\u63D0\u793A\uFF1Adel_testHotKeyo(\u2565\uFE4F\u2565)o...&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6CE8\u89E3@SentinelResource(value = &quot;testHotKey&quot;, blockHandler = &quot;del_testHotKey&quot;)</p><p><strong>\u5206\u6790\uFF1A</strong></p><ul><li>\u5176\u4E2D value = &quot;testHotKey&quot; \u662F\u4E00\u4E2A\u6807\u8BC6\uFF08Sentinel\u8D44\u6E90\u540D\uFF09\uFF0C\u4E0Erest\u7684<code>/testHotKey</code>\u5BF9\u5E94\uFF0C\u8FD9\u91CCvalue\u7684\u503C\u53EF\u4EE5\u4EFB\u610F\u5199\uFF0C\u4F46\u662F\u6211\u4EEC\u7EA6\u5B9A\u4E0Erest\u5730\u5740\u4E00\u81F4\uFF0C\u552F\u4E00\u533A\u522B\u662F\u6CA1\u6709<code>/</code>\u3002</li><li>blockHandler = &quot;del_testHotKey&quot; \u5219\u8868\u793A\u5982\u679C\u8FDD\u80CC\u4E86Sentinel\u4E2D\u914D\u7F6E\u7684\u6D41\u63A7\u89C4\u5219\uFF0C\u5C31\u4F1A\u8C03\u7528\u6211\u4EEC\u81EA\u5DF1\u7684\u515C\u5E95\u65B9\u6CD5del_testHotKey</li></ul><h6 id="_6-2-2-\u914D\u7F6E\u70ED\u70B9key\u9650\u6D41\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#_6-2-2-\u914D\u7F6E\u70ED\u70B9key\u9650\u6D41\u89C4\u5219" aria-hidden="true">#</a> 6.2.2 \u914D\u7F6E\u70ED\u70B9key\u9650\u6D41\u89C4\u5219</h6><p>\u7ED1\u5B9AtestHotKey\u8D44\u6E90\uFF0C\u628AtestHotKey\u5BF9\u5E94\u7684\u7B2C\u4E00\u4E2A\u53C2\u6570\u4F5C\u4E3A\u70ED\u70B9key\u8FDB\u884C\u76D1\u63A7\u3002\u8BBE\u5B9A\u70ED\u70B9\u9650\u6D41\u89C4\u5219\uFF1A\u5F53\u8BE5\u8D44\u6E90\u7684\u8BBF\u95EEQPS\u8D85\u8FC71\u6B21/s\u7684\u65F6\u5019\uFF0C\u4EA7\u751F\u9650\u6D41\u5E76\u6267\u884C\u81EA\u5B9A\u4E49\u7684del_testHotKey\u515C\u5E95\u65B9\u6CD5\u3002</p><p>\u7B80\u800C\u8A00\u4E4B\uFF1A\u65B9\u6CD5testHotKey\u91CC\u9762\u7B2C\u4E00\u4E2A\u53C2\u6570\u53EA\u8981QPS\u8D85\u8FC7\u6BCF\u79D21\u6B21\uFF0C\u9A6C\u4E0A\u964D\u7EA7\u5904\u7406\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636425843025-86f932d2-ce64-4c9a-baa1-b67ed8db5eec.png" alt="img"></p><h6 id="_6-2-3-\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#_6-2-3-\u6D4B\u8BD5" aria-hidden="true">#</a> 6.2.3 \u6D4B\u8BD5</h6>`,23),Ca=s("\u8BBF\u95EE"),Ta={href:"http://localhost:8401/testHotKey?p1=a&p2=b",target:"_blank",rel:"noopener noreferrer"},Ra=s("http://localhost:8401/testHotKey?p1=a&p2=b"),La=n("p",null,"1\u6B21/s\u6B63\u5E38\u663E\u793A\uFF0C\u8FC5\u901F\u70B9\u51FB\u4E24\u6B21\uFF0C\u89E6\u53D1\u70ED\u70B9\u9650\u6D41\uFF0C\u6267\u884C\u81EA\u5B9A\u4E49\u515C\u5E95\u65B9\u6CD5\uFF1A",-1),Na=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636275834807-7920316a-2d72-40fd-a595-60140e381d43.png",alt:"img"})],-1),ja=s("\u4EC5\u4F20\u5165\u53C2\u6570p2\u6CA1\u6709\u4EFB\u4F55\u5F71\u54CD\uFF1A "),Da={href:"http://localhost:8401/testHotKey?p2=b",target:"_blank",rel:"noopener noreferrer"},Ba=s("http://localhost:8401/testHotKey?p2=b"),Ma=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636275869802-3bdd8cb1-e801-45df-9953-c5a5969e1c5f.png",alt:"img"})],-1),Pa=s("\u73B0\u5728\u5F00\u4E24\u4E2A\u8BBF\u95EE\uFF0C\u4E00\u4E2A\u901A\u8FC7jmeter\u538B\u6D4B"),Oa={href:"http://localhost:8401/testHotKey?p1=a&p2=b%EF%BC%8C%E5%8F%A6%E5%A4%96%E5%86%8D%E5%8D%95%E7%8B%AC%E4%BD%BF%E7%94%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E8%AE%BF%E9%97%AEhttp://localhost:8401/testHotKey?p2=b%EF%BC%8C%E5%8F%91%E7%8E%B0%E5%8F%AA%E5%B8%A6%E5%8F%82%E6%95%B0p2%E8%AE%BF%E9%97%AE%E6%B2%A1%E6%9C%89%E4%BB%BB%E4%BD%95%E5%BD%B1%E5%93%8D%E3%80%82",target:"_blank",rel:"noopener noreferrer"},Fa=s("http://localhost:8401/testHotKey?p1=a&p2=b\uFF0C\u53E6\u5916\u518D\u5355\u72EC\u4F7F\u7528\u6D4F\u89C8\u5668\u8BBF\u95EEhttp://localhost:8401/testHotKey?p2=b\uFF0C\u53D1\u73B0\u53EA\u5E26\u53C2\u6570p2\u8BBF\u95EE\u6CA1\u6709\u4EFB\u4F55\u5F71\u54CD\u3002"),Ua=p('<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636276162514-571b00d8-1487-4190-9988-2a8c0e648b13.png" alt="img"></p><ol><li>\u4E0D\u914D\u7F6EblockeHandler\uFF08\u515C\u5E95\u65B9\u6CD5\uFF09</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636276470239-1a76b8b7-d7bb-4aa3-8fea-0d0634e9c479.png" alt="img"></p><p>\u89E6\u53D1\u70ED\u70B9\u9650\u6D41\u964D\u7EA7\u4F1A\u51FA\u73B0error page\uFF0C\u5BF9\u7528\u6237\u4E0D\u53CB\u597D\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636276517119-596fd456-81dc-4164-9c2b-5b8f6a8404bc.png" alt="img"></p><h5 id="_6-3-\u53C2\u6570\u4F8B\u5916\u9879" tabindex="-1"><a class="header-anchor" href="#_6-3-\u53C2\u6570\u4F8B\u5916\u9879" aria-hidden="true">#</a> 6.3 \u53C2\u6570\u4F8B\u5916\u9879</h5><p>\u4E0A\u8FF0\u6848\u4F8B\u6F14\u793A\u4E86\u7B2C\u4E00\u4E2A\u53C2\u6570p1\uFF0C\u5F53QPS\u8D85\u8FC71\u79D21\u6B21\u70B9\u51FB\u540E\u9A6C\u4E0A\u88AB\u9650\u6D41</p><p>\u7279\u4F8B\u60C5\u51B5\uFF1A\u6211\u4EEC\u671F\u671Bp1\u53C2\u6570\u5F53\u5B83\u662F\u67D0\u4E2A\u7279\u6B8A\u503C\u65F6\uFF0C\u5B83\u7684\u9650\u6D41\u503C\u548C\u5E73\u65F6\u4E0D\u4E00\u6837\uFF0C\u6BD4\u5982\u5F53p1\u7684\u503C\u7B49\u4E8E5\u65F6\uFF0C\u5B83\u7684\u9608\u503C\u53EF\u4EE5\u8FBE\u5230200\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636276820213-7a189398-d408-4696-9175-bddfbf2345a1.png" alt="img"></p><p>\u6D4B\u8BD5</p>',10),Ha=s("\u72C2\u70B9"),Ga={href:"http://localhost:8401/testHotKey?p1=5&p2=b",target:"_blank",rel:"noopener noreferrer"},Va=s("http://localhost:8401/testHotKey?p1=5&p2=b"),Qa=s(" \u6CA1\u6709\u9650\u6D41"),za=p('<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636283340923-8390dc9b-5578-4b43-950f-38c18929da74.png" alt="img"></p><h5 id="_6-4-\u5176\u4ED6" tabindex="-1"><a class="header-anchor" href="#_6-4-\u5176\u4ED6" aria-hidden="true">#</a> 6.4 \u5176\u4ED6</h5><p>\u624B\u52A8\u6DFB\u52A0\u4E00\u4E2A\u5F02\u5E38\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636283487769-27477123-c4db-4bb0-870d-86d588b5a972.png" alt="img"></p><p>\u6D4B\u8BD5\u76F4\u63A5\u9519\u8BEF\u9875\u9762\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636283506208-a3983356-e6a2-44b4-85d5-f76bd33b08e3.png" alt="img"></p><p>\u8981\u6CE8\u610F\uFF1A Sentinel\u5B83\u53EA\u7BA1\u4F60\u6709\u6CA1\u6709\u89E6\u53D1\u5B83\u7684\u9650\u6D41\u89C4\u5219\uFF0C\u4E5F\u53EF\u4EE5\u8BF4\u53EA\u7BA1\u8FD9\u4E2Aweb\u4EA4\u4E92\u9875\u9762\uFF08\u63A7\u5236\u53F0\uFF09\u91CC\u9762\u7684\u4E1C\u897F\u3002 \u914D\u7F6E\u7C7B\u7684\u4E1C\u897FSentinel\u53EF\u4EE5\u7BA1\uFF0Cjava\u5F02\u5E38\u7684\u9519\u8BEF\u6211\u4E0D\u7BA1\u3002</p><p><strong>@SentinelResource</strong></p><p>\u5904\u7406\u7684\u662FSentinel\u63A7\u5236\u53F0\u914D\u7F6E\u7684\u8FDD\u89C4\u60C5\u51B5\uFF0C\u6709blockHandler\u65B9\u6CD5\u914D\u7F6E\u7684\u515C\u5E95\u5904\u7406\uFF1B</p><p>RuntimeException</p><p>int age = 10/0,\u8FD9\u4E2A\u662Fjava\u8FD0\u884C\u65F6\u62A5\u51FA\u7684\u8FD0\u884C\u65F6\u5F02\u5E38RunTimeException\uFF0C@SentinelResource\u4E0D\u7BA1</p><p><strong>\u603B\u7ED3\uFF1A</strong></p><p>@SentinelResource\u4E3B\u7BA1\u914D\u7F6E\u51FA\u9519\uFF0C\u8FD0\u884C\u51FA\u9519\u8BE5\u8D70\u5F02\u5E38\u8D70\u5F02\u5E38</p><h3 id="\u4E03\u3001\u7CFB\u7EDF\u89C4\u5219-\u7CFB\u7EDF\u81EA\u9002\u5E94\u9650\u6D41" tabindex="-1"><a class="header-anchor" href="#\u4E03\u3001\u7CFB\u7EDF\u89C4\u5219-\u7CFB\u7EDF\u81EA\u9002\u5E94\u9650\u6D41" aria-hidden="true">#</a> \u4E03\u3001\u7CFB\u7EDF\u89C4\u5219\uFF08\u7CFB\u7EDF\u81EA\u9002\u5E94\u9650\u6D41\uFF09</h3>',14),Ka={href:"https://github.com/alibaba/Sentinel/wiki/%E7%B3%BB%E7%BB%9F%E8%87%AA%E9%80%82%E5%BA%94%E9%99%90%E6%B5%81",target:"_blank",rel:"noopener noreferrer"},Ya=s("\u5B98\u7F51"),Xa=n("p",null,"Sentinel \u7CFB\u7EDF\u81EA\u9002\u5E94\u9650\u6D41\u4ECE\u6574\u4F53\u7EF4\u5EA6\u5BF9\u5E94\u7528\u5165\u53E3\u6D41\u91CF\u8FDB\u884C\u63A7\u5236\uFF0C\u7ED3\u5408\u5E94\u7528\u7684 Load\u3001CPU \u4F7F\u7528\u7387\u3001\u603B\u4F53\u5E73\u5747 RT\u3001\u5165\u53E3 QPS \u548C\u5E76\u53D1\u7EBF\u7A0B\u6570\u7B49\u51E0\u4E2A\u7EF4\u5EA6\u7684\u76D1\u63A7\u6307\u6807\uFF0C\u901A\u8FC7\u81EA\u9002\u5E94\u7684\u6D41\u63A7\u7B56\u7565\uFF0C\u8BA9\u7CFB\u7EDF\u7684\u5165\u53E3\u6D41\u91CF\u548C\u7CFB\u7EDF\u7684\u8D1F\u8F7D\u8FBE\u5230\u4E00\u4E2A\u5E73\u8861\uFF0C\u8BA9\u7CFB\u7EDF\u5C3D\u53EF\u80FD\u8DD1\u5728\u6700\u5927\u541E\u5410\u91CF\u7684\u540C\u65F6\u4FDD\u8BC1\u7CFB\u7EDF\u6574\u4F53\u7684\u7A33\u5B9A\u6027\u3002",-1),Wa=s("\u7CFB\u7EDF\u4FDD\u62A4\u89C4\u5219\u662F\u5E94\u7528\u6574\u4F53\u7EF4\u5EA6\u7684\uFF0C\u800C\u4E0D\u662F\u8D44\u6E90\u7EF4\u5EA6\u7684\uFF0C\u5E76\u4E14"),$a=n("strong",null,"\u4EC5\u5BF9\u5165\u53E3\u6D41\u91CF\u751F\u6548",-1),Ja=s("\u3002\u5165\u53E3\u6D41\u91CF\u6307\u7684\u662F\u8FDB\u5165\u5E94\u7528\u7684\u6D41\u91CF\uFF08"),Za={href:"http://EntryType.IN",target:"_blank",rel:"noopener noreferrer"},nt=s("EntryType.IN"),st=s("\uFF09\uFF0C\u6BD4\u5982 Web \u670D\u52A1\u6216 Dubbo \u670D\u52A1\u7AEF\u63A5\u6536\u7684\u8BF7\u6C42\uFF0C\u90FD\u5C5E\u4E8E\u5165\u53E3\u6D41\u91CF\u3002"),at=p(`<p>\u7CFB\u7EDF\u89C4\u5219\u652F\u6301\u4EE5\u4E0B\u7684\u6A21\u5F0F\uFF1A</p><ul><li><strong>Load \u81EA\u9002\u5E94</strong>\uFF08\u4EC5\u5BF9 Linux/Unix-like \u673A\u5668\u751F\u6548\uFF09\uFF1A\u7CFB\u7EDF\u7684 load1 \u4F5C\u4E3A\u542F\u53D1\u6307\u6807\uFF0C\u8FDB\u884C\u81EA\u9002\u5E94\u7CFB\u7EDF\u4FDD\u62A4\u3002\u5F53\u7CFB\u7EDF load1 \u8D85\u8FC7\u8BBE\u5B9A\u7684\u542F\u53D1\u503C\uFF0C\u4E14\u7CFB\u7EDF\u5F53\u524D\u7684\u5E76\u53D1\u7EBF\u7A0B\u6570\u8D85\u8FC7\u4F30\u7B97\u7684\u7CFB\u7EDF\u5BB9\u91CF\u65F6\u624D\u4F1A\u89E6\u53D1\u7CFB\u7EDF\u4FDD\u62A4\uFF08BBR \u9636\u6BB5\uFF09\u3002\u7CFB\u7EDF\u5BB9\u91CF\u7531\u7CFB\u7EDF\u7684 maxQps * minRt \u4F30\u7B97\u5F97\u51FA\u3002\u8BBE\u5B9A\u53C2\u8003\u503C\u4E00\u822C\u662F CPU cores * 2.5\u3002</li><li><strong>CPU usage</strong>\uFF081.5.0+ \u7248\u672C\uFF09\uFF1A\u5F53\u7CFB\u7EDF CPU \u4F7F\u7528\u7387\u8D85\u8FC7\u9608\u503C\u5373\u89E6\u53D1\u7CFB\u7EDF\u4FDD\u62A4\uFF08\u53D6\u503C\u8303\u56F4 0.0-1.0\uFF09\uFF0C\u6BD4\u8F83\u7075\u654F\u3002</li><li><strong>\u5E73\u5747 RT</strong>\uFF1A\u5F53\u5355\u53F0\u673A\u5668\u4E0A\u6240\u6709\u5165\u53E3\u6D41\u91CF\u7684\u5E73\u5747 RT \u8FBE\u5230\u9608\u503C\u5373\u89E6\u53D1\u7CFB\u7EDF\u4FDD\u62A4\uFF0C\u5355\u4F4D\u662F\u6BEB\u79D2\u3002</li><li><strong>\u5E76\u53D1\u7EBF\u7A0B\u6570</strong>\uFF1A\u5F53\u5355\u53F0\u673A\u5668\u4E0A\u6240\u6709\u5165\u53E3\u6D41\u91CF\u7684\u5E76\u53D1\u7EBF\u7A0B\u6570\u8FBE\u5230\u9608\u503C\u5373\u89E6\u53D1\u7CFB\u7EDF\u4FDD\u62A4\u3002</li><li><strong>\u5165\u53E3 QPS</strong>\uFF1A\u5F53\u5355\u53F0\u673A\u5668\u4E0A\u6240\u6709\u5165\u53E3\u6D41\u91CF\u7684 QPS \u8FBE\u5230\u9608\u503C\u5373\u89E6\u53D1\u7CFB\u7EDF\u4FDD\u62A4\u3002</li></ul><h5 id="\u6848\u4F8B\u2014\u2014\u914D\u7F6E\u5168\u5C40qps" tabindex="-1"><a class="header-anchor" href="#\u6848\u4F8B\u2014\u2014\u914D\u7F6E\u5168\u5C40qps" aria-hidden="true">#</a> \u6848\u4F8B\u2014\u2014\u914D\u7F6E\u5168\u5C40QPS</h5><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636283979732-9ec624d5-b538-4e97-b131-800c32624945.png" alt="img"></p><p>\u4E0D\u7BA1\u662F/testA\u8FD8\u662F/testB \u53EA\u8981QPS &gt; 1 \u6574\u4E2A\u7CFB\u7EDF\u5C31\u4E0D\u80FD\u7528\u3002</p><p>\u8FD9\u4E2A\u7C92\u5EA6\u592A\u7C97\uFF0C\u5C31\u76F8\u5F53\u4E8E\u4E00\u4E2A\u7A97\u53E3\u4EBA\u5F88\u591A\uFF0C\u6574\u4E2A\u94F6\u884C\u5C31\u4E0D\u63A5\u5F85\u4EBA\u4E86\uFF0C\u4E0D\u592A\u5EFA\u8BAE\u4F7F\u7528\u3002</p><h3 id="\u516B\u3001-sentinelresource-\u6CE8\u89E3\u8BE6\u89E3" tabindex="-1"><a class="header-anchor" href="#\u516B\u3001-sentinelresource-\u6CE8\u89E3\u8BE6\u89E3" aria-hidden="true">#</a> \u516B\u3001@SentinelResource \u6CE8\u89E3\u8BE6\u89E3</h3><h5 id="_8-1-\u6309\u8D44\u6E90\u540D\u79F0\u9650\u6D41-\u540E\u7EED\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#_8-1-\u6309\u8D44\u6E90\u540D\u79F0\u9650\u6D41-\u540E\u7EED\u5904\u7406" aria-hidden="true">#</a> 8.1 \u6309\u8D44\u6E90\u540D\u79F0\u9650\u6D41+\u540E\u7EED\u5904\u7406</h5><p>\u542F\u52A8nacos+sentinel</p><h6 id="_8-1-1-\u4FEE\u65398401" tabindex="-1"><a class="header-anchor" href="#_8-1-1-\u4FEE\u65398401" aria-hidden="true">#</a> 8.1.1 \u4FEE\u65398401</h6><h6 id="_1-pom" tabindex="-1"><a class="header-anchor" href="#_1-pom" aria-hidden="true">#</a> (1) pom</h6><p>\u5F15\u5165\u6211\u4EEC\u81EA\u5B9A\u4E49\u7684\u516C\u5171api jar\u5305</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!-- \u5F15\u5165\u81EA\u5DF1\u5B9A\u4E49\u7684api\u901A\u7528\u5305\uFF0C\u53EF\u4EE5\u4F7F\u7528Payment\u652F\u4ED8Entity --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>cloud-api-commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_2-\u4E1A\u52A1\u7C7B" tabindex="-1"><a class="header-anchor" href="#_2-\u4E1A\u52A1\u7C7B" aria-hidden="true">#</a> (2) \u4E1A\u52A1\u7C7B</h6><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">SentinelResource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>slots<span class="token punctuation">.</span>block<span class="token punctuation">.</span></span><span class="token class-name">BlockException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">Payment</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RateLimitController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/byResource&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;byResource&quot;</span><span class="token punctuation">,</span> blockHandler <span class="token operator">=</span> <span class="token string">&quot;handleException&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">byResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">&quot;\u6309\u8D44\u6E90\u540D\u79F0\u9650\u6D41\u6D4B\u8BD5OK&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">2020L</span><span class="token punctuation">,</span> <span class="token string">&quot;serial001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">handleException</span><span class="token punctuation">(</span><span class="token class-name">BlockException</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">444</span><span class="token punctuation">,</span> exception<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCanonicalName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\\t \u670D\u52A1\u4E0D\u53EF\u7528&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## 8.1.2 \u914D\u7F6E\u6D41\u63A7\u89C4\u5219\u2014\u2014\u6309\u8D44\u6E90\u540D\u79F0\u6DFB\u52A0\u6D41\u63A7\u89C4\u5219</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636285393933-ddc0a9ee-ed0e-440f-bc83-48cd579dcc76.png" alt="img"></p><p>######## 8.1.3 \u6D4B\u8BD5</p><p>\u81EA\u6D4B\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636285275609-5ad7070a-105e-4aec-8237-202601cd4b82.png" alt="img"></p><p>\u89E6\u53D1\u6D41\u63A7\u89C4\u5219\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636285458697-f546d3c3-34da-491e-a379-b0ccfcf2cc9e.png" alt="img"></p><p>######## 8.1.4 \u95EE\u9898</p><p>\u5982\u679C\u6211\u4EEC\u91CD\u542F8401\u4F1A\u53D1\u73B0\u4E4B\u524D\u914D\u7F6E\u7684\u4E00\u4E9B\u89C4\u5219\u90FD\u6CA1\u6709\u4E86\u3002\u96BE\u9053\u6BCF\u6B21\u91CD\u542F\u670D\u52A1\u5668\u90FD\u8981\u91CD\u65B0\u914D\u7F6E\u4E00\u904D\u89C4\u5219\u5417\uFF1F\u89C4\u5219\u5982\u4F55\u8FDB\u884C\u6301\u4E45\u5316\uFF1F</p><h5 id="_8-2-\u6309\u7167url\u5730\u5740\u9650\u6D41-\u540E\u7EED\u5904\u7406" tabindex="-1"><a class="header-anchor" href="#_8-2-\u6309\u7167url\u5730\u5740\u9650\u6D41-\u540E\u7EED\u5904\u7406" aria-hidden="true">#</a> 8.2 \u6309\u7167Url\u5730\u5740\u9650\u6D41+\u540E\u7EED\u5904\u7406</h5><p>\u901A\u8FC7\u8BBF\u95EE\u7684URL\u6765\u9650\u6D41\uFF0C\u4F1A\u8FD4\u56DESentinel\u81EA\u5E26\u9ED8\u8BA4\u7684\u9650\u6D41\u5904\u7406\u4FE1\u606F</p><p>######## 8.2.1 \u4FEE\u6539controller</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/rateLimit/byUrl&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;byUrl&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">byUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token string">&quot;\u6309url\u9650\u6D41\u6D4B\u8BD5OK&quot;</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">2020L</span><span class="token punctuation">,</span><span class="token string">&quot;serial002&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## 8.2.2 \u8BBE\u7F6E\u6D41\u63A7\u89C4\u5219\u53CA\u6D4B\u8BD5</p><p>\u5148\u81EA\u6D4B\uFF0C\u6CA1\u6709\u95EE\u9898\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636285855107-0bf3e784-1753-46cc-a91a-09056010b7a0.png" alt="img"></p><p>\u6309rest URI\u8BBE\u7F6E\u6D41\u63A7\u89C4\u5219</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636285921229-af984a98-bdca-4013-ba83-a43c63fdfe1a.png" alt="img"></p><p>\u89E6\u53D1\u6D41\u63A7\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636285937287-c80bb686-053d-49d1-871f-9014b13e3962.png" alt="img"></p><p>\u8FD9\u4E2A\u6CA1\u6709\u81EA\u5B9A\u4E49\u7684\u515C\u5E95\u7684\u65B9\u6CD5\uFF0C\u8FD4\u56DESentinel\u81EA\u5E26\u7684\u9650\u6D41\u5904\u7406\u7ED3\u679C\u3002</p><h5 id="_8-3-\u603B\u7ED3\u4EE5\u53CA\u9762\u4E34\u7684\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#_8-3-\u603B\u7ED3\u4EE5\u53CA\u9762\u4E34\u7684\u95EE\u9898" aria-hidden="true">#</a> 8.3 \u603B\u7ED3\u4EE5\u53CA\u9762\u4E34\u7684\u95EE\u9898</h5><p>\u4E0D\u7BA1\u662F@GetMapping(rest url)\u8FD8\u662F @SentinelResource\uFF0C\u53EA\u8981\u662F\u552F\u4E00\u7684\uFF0C\u5C31\u53EF\u4EE5\u4F5C\u4E3A\u6D41\u63A7\u89C4\u5219\u7684\u8D44\u6E90\u540D\u79F0\u3002\u5982\u679C\u6CA1\u6709\u81EA\u5B9A\u4E49\u81EA\u5DF1\u7684\u515C\u5E95\u65B9\u6CD5\uFF0C\u90A3\u4E48\u5C31\u4F7F\u7528\u7CFB\u7EDF\u81EA\u5E26\u7684\u3002</p><p>\u95EE\u9898\uFF1A</p><ul><li>\u4F9D\u7167\u73B0\u6709\u6761\u4EF6\uFF0C\u6211\u4EEC\u81EA\u5B9A\u4E49\u7684\u5904\u7406\u65B9\u6CD5\u53C8\u548C\u4E1A\u52A1\u4EE3\u7801\u8026\u5408\u5728\u4E00\u5757\uFF0C\u4E0D\u76F4\u89C2\u3002\u5982\u679C\u90FD\u7528\u7CFB\u7EDF\u9ED8\u8BA4\u7684\uFF0C\u5C31\u6CA1\u6709\u4F53\u73B0\u6211\u4EEC\u81EA\u5DF1\u7684\u4E1A\u52A1\u8981\u6C42\u3002</li><li>\u5982\u679C\u6BCF\u4E2A\u4E1A\u52A1\u65B9\u6CD5/API\u63A5\u53E3\u90FD\u6DFB\u52A0\u4E00\u4E2A\u515C\u5E95\u7684\uFF0C\u90A3\u4EE3\u7801\u81A8\u80C0\u52A0\u5267\u3002</li><li>\u5168\u5C40\u7EDF\u4E00\u7684\u5904\u7406\u65B9\u6CD5\u6CA1\u6709\u4F53\u73B0\u3002</li></ul><h5 id="_8-4-\u5BA2\u6237\u81EA\u5B9A\u4E49\u9650\u6D41\u5904\u7406\u903B\u8F91" tabindex="-1"><a class="header-anchor" href="#_8-4-\u5BA2\u6237\u81EA\u5B9A\u4E49\u9650\u6D41\u5904\u7406\u903B\u8F91" aria-hidden="true">#</a> 8.4 \u5BA2\u6237\u81EA\u5B9A\u4E49\u9650\u6D41\u5904\u7406\u903B\u8F91</h5><p>\u4E3A\u4E86\u89E3\u51B3\u4EE3\u7801\u8026\u5408\u4E0E\u81A8\u80C0\u7684\u95EE\u9898</p><h6 id="_8-4-1-\u521B\u5EFAcustomerblockhandler\u7C7B\u7528\u4E8E\u81EA\u5B9A\u4E49\u9650\u6D41\u5904\u7406\u903B\u8F91" tabindex="-1"><a class="header-anchor" href="#_8-4-1-\u521B\u5EFAcustomerblockhandler\u7C7B\u7528\u4E8E\u81EA\u5B9A\u4E49\u9650\u6D41\u5904\u7406\u903B\u8F91" aria-hidden="true">#</a> 8.4.1 \u521B\u5EFACustomerBlockHandler\u7C7B\u7528\u4E8E\u81EA\u5B9A\u4E49\u9650\u6D41\u5904\u7406\u903B\u8F91</h6><p>\u5728CustomerBlockHandler\u7C7B\u4E2D\u7EDF\u4E00\u7684\u5904\u7406\u9650\u6D41\u63D0\u793A\u3001\u670D\u52A1\u964D\u7EA7\u7684\u8BF4\u660E\u7B49\u7B49\u3002\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>myhandler</span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>slots<span class="token punctuation">.</span>block<span class="token punctuation">.</span></span><span class="token class-name">BlockException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">Payment</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomerBlockHandler</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">handlerException</span><span class="token punctuation">(</span><span class="token class-name">BlockException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">4444</span><span class="token punctuation">,</span> <span class="token string">&quot;\u6309\u5BA2\u6237\u81EA\u5B9A\u4E49, global handlerException----1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">handlerException2</span><span class="token punctuation">(</span><span class="token class-name">BlockException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">4444</span><span class="token punctuation">,</span> <span class="token string">&quot;\u6309\u5BA2\u6237\u81EA\u5B9A\u4E49, global handlerException----2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## 8.4.2 \u4FEE\u6539RateLimitController\uFF0C\u4F7F\u7528\u81EA\u5B9A\u4E49\u5904\u7406\u903B\u8F91\u7C7B</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">SentinelResource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>slots<span class="token punctuation">.</span>block<span class="token punctuation">.</span></span><span class="token class-name">BlockException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>myhandler<span class="token punctuation">.</span></span><span class="token class-name">CustomerBlockHandler</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">Payment</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RateLimitController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/byResource&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;byResource&quot;</span><span class="token punctuation">,</span> blockHandler <span class="token operator">=</span> <span class="token string">&quot;handleException&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">byResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">&quot;\u6309\u8D44\u6E90\u540D\u79F0\u9650\u6D41\u6D4B\u8BD5OK&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">2020L</span><span class="token punctuation">,</span> <span class="token string">&quot;serial001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">handleException</span><span class="token punctuation">(</span><span class="token class-name">BlockException</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">444</span><span class="token punctuation">,</span> exception<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCanonicalName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\\t \u670D\u52A1\u4E0D\u53EF\u7528&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/rateLimit/byUrl&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;byUrl&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">byUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">&quot;\u6309url\u9650\u6D41\u6D4B\u8BD5OK&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">2020L</span><span class="token punctuation">,</span> <span class="token string">&quot;serial002&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//CustomerBlockHandler\u81EA\u5B9A\u4E49\u7C7B,\u6765\u5904\u7406\u670D\u52A1\u964D\u7EA7\u3001\u9650\u6D41\u63D0\u793A.....</span>
    <span class="token doc-comment comment">/**
     * \u81EA\u5B9A\u4E49\u901A\u7528\u7684\u9650\u6D41\u5904\u7406\u903B\u8F91\uFF0C
     * blockHandlerClass = CustomerBlockHandler.class
     * blockHandler = handleException2
     * \u4E0A\u8FF0\u914D\u7F6E\uFF1A\u627ECustomerBlockHandler\u7C7B\u91CC\u7684handleException2\u65B9\u6CD5\u8FDB\u884C\u515C\u5E95\u5904\u7406
     */</span>
    <span class="token comment">//\u81EA\u5B9A\u4E49\u901A\u7528\u7684\u9650\u6D41\u5904\u7406\u903B\u8F91</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/rateLimit/customerBlockHandler&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;customerBlockHandler&quot;</span><span class="token punctuation">,</span>
            blockHandlerClass <span class="token operator">=</span> <span class="token class-name">CustomerBlockHandler</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>
            blockHandler <span class="token operator">=</span> <span class="token string">&quot;handlerException2&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">customerBlockHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">&quot;\u6309\u5BA2\u6237\u81EA\u5B9A\u4E49&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">2020L</span><span class="token punctuation">,</span> <span class="token string">&quot;serial003&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## 8.4.3 \u6D4B\u8BD5</p>`,48),tt=s("\u542F\u52A88401\uFF0C\u5148\u6D4B\u8BD5\u4E00\u6B21"),pt={href:"http://localhost:8401/rateLimit/customerBlockHandler",target:"_blank",rel:"noopener noreferrer"},et=s("http://localhost:8401/rateLimit/customerBlockHandler"),ot=p('<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636287580303-28b3cfb9-1b59-45f3-a285-490cdadfcc6c.png" alt="img"></p><p>\u8BBE\u7F6E\u6D41\u63A7\u89C4\u5219\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636287621476-3a3eaf6f-4507-468f-bde2-decdc7f78973.png" alt="img"></p><p>\u89E6\u53D1\u6D41\u63A7\uFF0C\u770B\u662F\u5426\u662F\u6211\u4EEC\u81EA\u5B9A\u4E49\u63D0\u793A\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636287665130-41bc38f3-b6cd-483a-b3f4-7fbe7462cb0a.png" alt="img"></p><p>\u81EA\u5B9A\u4E49\u63D0\u793A\u51FA\u6765\u4E86\uFF01</p><p>######## 8.4.4 \u7ED3\u6784\u8BF4\u660E</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636287798408-543e1ede-a827-49c3-92f0-5c0b13725223.png" alt="img"></p><p>\u8FD9\u6837\u5C31\u5B9E\u73B0\u4E86\u515C\u5E95\u65B9\u6CD5\u4E0E\u4E1A\u52A1\u65B9\u6CD5\u7684\u89E3\u8026\u3002</p><p>######## 8.5 \u66F4\u591A\u5C5E\u6027\u8BF4\u660E</p>',10),ct={href:"https://github.com/alibaba/Sentinel/wiki/%E6%B3%A8%E8%A7%A3%E6%94%AF%E6%8C%81",target:"_blank",rel:"noopener noreferrer"},lt=s("\u6CE8\u89E3\u652F\u6301\u6587\u6863"),it=p(`<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636289727930-10fdb9a1-5ddf-47a5-bd1a-8c62f33357ed.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636289848511-939d2aa2-1c45-4d66-922c-56a2da957cac.png" alt="img"></p><h3 id="\u4E5D\u3001\u670D\u52A1\u7194\u65AD" tabindex="-1"><a class="header-anchor" href="#\u4E5D\u3001\u670D\u52A1\u7194\u65AD" aria-hidden="true">#</a> \u4E5D\u3001\u670D\u52A1\u7194\u65AD</h3><p>\u4E3B\u8981\u5185\u5BB9\uFF1A</p><ul><li>sentinel\u5206\u522B\u6574\u5408ribbon+openFeign\u4EE5\u53CA\u8BBE\u7F6Efallback</li><li>\u7194\u65AD\u6846\u67B6\u6BD4\u8F83</li></ul><h5 id="_9-1-ribbon\u7CFB\u5217" tabindex="-1"><a class="header-anchor" href="#_9-1-ribbon\u7CFB\u5217" aria-hidden="true">#</a> 9.1 Ribbon\u7CFB\u5217</h5><p>nacos\u4E2D\u6574\u5408\u4E86Ribbon\uFF0C\u6240\u4EE5\u76F4\u63A5\u4F7F\u7528nacos\u5C31\u884C\u3002\u542F\u52A8nacos\u548CSentinel\u3002</p><h6 id="_9-1-1-\u670D\u52A1\u63D0\u4F9B\u80059003-9004" tabindex="-1"><a class="header-anchor" href="#_9-1-1-\u670D\u52A1\u63D0\u4F9B\u80059003-9004" aria-hidden="true">#</a> 9.1.1 \u670D\u52A1\u63D0\u4F9B\u80059003/9004</h6><p>\u65B0\u5EFAcloudalibaba-provider-payment9003/9004\u4E24\u4E2A\u4E00\u6837\u7684\u505A\u6CD5</p><p>######## (1) pom</p><p>2020\u7248\u548Cspringcloud\u548Cnacos\u8BB0\u5F97\u5F15\u5165spring-cloud-starter-loadbalancer\u4F9D\u8D56</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jdk8cloud2021<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>cloudalibaba-provider-payment9003<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--SpringCloud ailibaba nacos --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span><span class="token comment">&lt;!-- \u5F15\u5165\u81EA\u5DF1\u5B9A\u4E49\u7684api\u901A\u7528\u5305\uFF0C\u53EF\u4EE5\u4F7F\u7528Payment\u652F\u4ED8Entity --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>cloud-api-commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- SpringBoot\u6574\u5408Web\u7EC4\u4EF6 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--\u65E5\u5E38\u901A\u7528jar\u5305\u914D\u7F6E--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## (2) yml</p><p>9004 \u522B\u5FD8\u4E86\u6539\u7AEF\u53E3\u53F7</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9003</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>provider
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span> <span class="token comment">#\u914D\u7F6ENacos\u5730\u5740</span>

<span class="token key atrule">management</span><span class="token punctuation">:</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">&#39;*&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## (3) \u4E3B\u542F\u52A8\u7C7B</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentMain9003</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">PaymentMain9003</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## (4) \u4E1A\u52A1\u7C7B</p><p>\u8FD9\u91CC\u56FE\u65B9\u4FBF\uFF0C\u5C31\u6CA1\u6709\u8FDE\u63A5\u6570\u636E\u5E93\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">Payment</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;\${server.port}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> serverPort<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">,</span> <span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> hashMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">,</span> <span class="token string">&quot;28a8c1e3bc2742d8848569891fb42181&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">2L</span><span class="token punctuation">,</span> <span class="token string">&quot;bba8c1e3bc2742d8848569891ac32182&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token number">3L</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span><span class="token number">3L</span><span class="token punctuation">,</span> <span class="token string">&quot;6ua8c1e3bc2742d8848569891xt92183&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/paymentSQL/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> <span class="token function">paymentSQL</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Payment</span> payment <span class="token operator">=</span> hashMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">&quot;from mysql,serverPort:  &quot;</span> <span class="token operator">+</span> serverPort<span class="token punctuation">,</span> payment<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## (5) \u6D4B\u8BD5</p>`,21),ut={href:"http://localhost:9003/paymentSQL/1",target:"_blank",rel:"noopener noreferrer"},kt=s("http://localhost:9003/paymentSQL/1"),rt=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636295326201-3cba78d6-90d2-446d-a2d8-a94fc8e5691a.png",alt:"img"})],-1),dt={href:"http://localhost:9004/paymentSQL/1",target:"_blank",rel:"noopener noreferrer"},mt=s("http://localhost:9004/paymentSQL/1"),gt=p(`<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636295338547-274e5857-8816-4723-a2e7-de4cc0c9ef4f.png" alt="img"></p><h6 id="_9-1-2-\u670D\u52A1\u6D88\u8D39\u800584" tabindex="-1"><a class="header-anchor" href="#_9-1-2-\u670D\u52A1\u6D88\u8D39\u800584" aria-hidden="true">#</a> 9.1.2 \u670D\u52A1\u6D88\u8D39\u800584</h6><p>\u65B0\u5EFAcloudalibaba-consumer-nacos-order84</p><p>######## (1) pom</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jdk8cloud2021<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>cloudalibaba-consumer-nacos-order84<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--SpringCloud ailibaba nacos --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--SpringCloud ailibaba sentinel --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-sentinel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- \u5F15\u5165\u81EA\u5DF1\u5B9A\u4E49\u7684api\u901A\u7528\u5305\uFF0C\u53EF\u4EE5\u4F7F\u7528Payment\u652F\u4ED8Entity --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>cloud-api-commons<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${project.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- SpringBoot\u6574\u5408Web\u7EC4\u4EF6 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--\u65E5\u5E38\u901A\u7528jar\u5305\u914D\u7F6E--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## (2) yml</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">84</span>


<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> nacos<span class="token punctuation">-</span>order<span class="token punctuation">-</span>consumer
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span>
    <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
      <span class="token key atrule">transport</span><span class="token punctuation">:</span>
        <span class="token comment">#\u914D\u7F6ESentinel dashboard\u5730\u5740</span>
        <span class="token key atrule">dashboard</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8080</span>
        <span class="token comment">#\u9ED8\u8BA48719\u7AEF\u53E3\uFF0C\u5047\u5982\u88AB\u5360\u7528\u4F1A\u81EA\u52A8\u4ECE8719\u5F00\u59CB\u4F9D\u6B21+1\u626B\u63CF,\u76F4\u81F3\u627E\u5230\u672A\u88AB\u5360\u7528\u7684\u7AEF\u53E3</span>
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8719</span>


<span class="token comment">#\u6D88\u8D39\u8005\u5C06\u8981\u53BB\u8BBF\u95EE\u7684\u5FAE\u670D\u52A1\u540D\u79F0(\u6CE8\u518C\u6210\u529F\u8FDBnacos\u7684\u5FAE\u670D\u52A1\u63D0\u4F9B\u8005)</span>
<span class="token comment">#\u65B9\u4FBFcontroller\u7684@value\u83B7\u53D6</span>
<span class="token key atrule">service-url</span><span class="token punctuation">:</span>
  <span class="token key atrule">nacos-user-service</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//nacos<span class="token punctuation">-</span>payment<span class="token punctuation">-</span>provider
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## (3) \u4E3B\u542F\u52A8\u7C7B</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderNacosMain84</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">OrderNacosMain84</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## (4) \u4E1A\u52A1\u7C7B</p><p>\u56E0\u4E3A\u7528\u7684Ribbon\uFF0C\u9700\u8981\u4F7F\u7528\u5176\u63D0\u4F9B\u7684RestTemplate</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>loadbalancer<span class="token punctuation">.</span></span><span class="token class-name">LoadBalanced</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplate</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationContextConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@LoadBalanced</span>  <span class="token comment">//\u4E0D\u8981\u5FD8\u4E86</span>
    <span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">getRestemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>csp<span class="token punctuation">.</span>sentinel<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">SentinelResource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">Payment</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">RestTemplate</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CircleBreakerController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;\${service-url.nacos-user-service}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> SERVICE_URL<span class="token punctuation">;</span>
    <span class="token comment">//public static final String SERVICE_URL = &quot;http://nacos-payment-provider&quot;;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/consumer/fallback/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;fallback&quot;</span><span class="token punctuation">)</span>  <span class="token comment">//\u6CA1\u6709\u914D\u7F6E</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>SERVICE_URL <span class="token operator">+</span> <span class="token string">&quot;/paymentSQL/&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">,</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;IllegalArgumentException,\u975E\u6CD5\u53C2\u6570\u5F02\u5E38....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token string">&quot;NullPointerException,\u8BE5ID\u6CA1\u6709\u5BF9\u5E94\u8BB0\u5F55,\u7A7A\u6307\u9488\u5F02\u5E38&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## (5) \u6D4B\u8BD5</p><p>\u8D1F\u8F7D\u5747\u8861\u5B9E\u73B0\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636295900018-2e6c309b-8454-4cab-a0e8-d00d83fba367.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636295908562-9d50031c-7b65-437b-9494-d3f4454f0ddd.png" alt="img"></p><h6 id="_9-1-3-fallback-\u548C-blockhandler" tabindex="-1"><a class="header-anchor" href="#_9-1-3-fallback-\u548C-blockhandler" aria-hidden="true">#</a> 9.1.3 fallback \u548C blockHandler</h6><p>\u52A0\u6DF1@SentinelResource(value = &quot;xxx&quot;, fallback = &quot;fffff&quot;, blockHandler = &quot;bbbbbb&quot;)\u6CE8\u89E3\u7406\u89E3\uFF1A</p><p><strong>fallback\u7BA1\u8FD0\u884C\u5F02\u5E38\uFF0CblockHandler\u7BA1\u914D\u7F6E\u8FDD\u89C4\u3002</strong></p><p>fallback\u5BF9\u5E94\u670D\u52A1\u964D\u7EA7\uFF0C\u5C31\u662F\u670D\u52A1\u51FA\u9519\u4E86\u5E94\u8BE5\u600E\u4E48\u529E\uFF08\u9700\u8981\u6709\u4E2A\u515C\u5E95\u65B9\u6CD5\uFF09\uFF1B</p><p>blockHandler\u5BF9\u5E94\u670D\u52A1\u7194\u65AD\uFF0C\u5C31\u662F\u6211\u73B0\u5728\u670D\u52A1\u4E0D\u53EF\u7528\uFF0C\u6211\u5E94\u8BE5\u600E\u4E48\u529E\uFF0C\u600E\u4E48\u7ED9\u5BA2\u6237\u4E00\u4E2A\u6237\u63D0\u793A\uFF08\u540C\u6837\u9700\u8981\u4E00\u4E2A\u515C\u5E95\u65B9\u6CD5\uFF09</p><h6 id="_9-1-4-\u5DEE\u5F02\u5316\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_9-1-4-\u5DEE\u5F02\u5316\u914D\u7F6E" aria-hidden="true">#</a> 9.1.4 \u5DEE\u5F02\u5316\u914D\u7F6E</h6><p><strong>\u8FD9\u91CC\u6539\u7684\u4E1A\u52A1\u7C7B\u4EE3\u7801\u5747\u662F\u6D88\u8D39\u800584\u7AEF\u7684\u4E1A\u52A1\u7C7B\u4EE3\u7801\uFF0C\u4E0D\u8981\u641E\u9519\u4E86\u3002</strong></p><p>\u964D\u7EA7\u662F\u670D\u52A1\u4E1A\u52A1\u4EE3\u7801\u51FA\u73B0\u9519\u8BEF\u7684\u515C\u5E95\uFF0C\u7194\u65AD\u662F\u670D\u52A1\u4E0D\u53EF\u7528\u3002\u964D\u7EA7\u662F\u515C\u5E95\u65B9\u6CD5,\u7194\u65AD\u662F\u5BF9\u670D\u52A1\u4FDD\u62A4\u65F6\u95F4\u7A97\u53E3\u671F\u670D\u52A1\u4E0D\u53EF\u7528\u3002</p><p>######## (1) \u6CA1\u6709\u4EFB\u4F55\u914D\u7F6E</p>`,25),vt=s("\u524D\u9762\u6211\u4EEC\u768484\u6D88\u8D39\u7AEF\uFF0C@SentinelResource\u91CC\u9762\u53EA\u914D\u7F6E\u4E86value\uFF0Cfallback\u548CblockHandler\u90FD\u6CA1\u6709\u914D\u7F6E\uFF0C\u8BE5\u60C5\u51B5\u4E0B\u6211\u4EEC\u6D4B\u8BD5\u4E00\u4E0B"),bt={href:"http://localhost:84/consumer/fallback/4",target:"_blank",rel:"noopener noreferrer"},ht=s("http://localhost:84/consumer/fallback/4"),yt=p(`<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636296443903-85032cef-0249-47a7-9422-5b2626522837.png" alt="img"></p><p>\u51FA\u73B0\u4E86\u9519\u8BEF\u9875\u9762\uFF0Cerror page\u5BF9\u5BA2\u6237\u4E0D\u53CB\u597D\uFF0C\u6240\u4EE5\u6211\u4EEC\u9700\u8981\u6709\u515C\u5E95\u65B9\u6CD5\u3002</p><p>######## (2) \u53EA\u914D\u7F6Efallback</p><p>fallback\u5BF9\u5E94\u670D\u52A1\u964D\u7EA7\uFF0C\u5C31\u662F\u670D\u52A1\u53EF\u4EE5\u6B63\u5E38\u8BBF\u95EE\uFF0C\u4F46\u662F\u4E1A\u52A1\u903B\u8F91\u51FA\u73B0\u9519\u8BEF\uFF0C\u9700\u8981\u964D\u7EA7\u515C\u5E95\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/consumer/fallback/{id}&quot;</span><span class="token punctuation">)</span>
<span class="token comment">//@SentinelResource(value = &quot;fallback&quot;) //\u6CA1\u6709\u914D\u7F6E</span>
<span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;fallback&quot;</span><span class="token punctuation">,</span> fallback <span class="token operator">=</span> <span class="token string">&quot;handlerFallback&quot;</span><span class="token punctuation">)</span> <span class="token comment">//fallback\u8D1F\u8D23\u4E1A\u52A1\u5F02\u5E38</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>SERVICE_URL <span class="token operator">+</span> <span class="token string">&quot;/paymentSQL/&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">,</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;IllegalArgumentException,\u975E\u6CD5\u53C2\u6570\u5F02\u5E38....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token string">&quot;NullPointerException,\u8BE5ID\u6CA1\u6709\u5BF9\u5E94\u8BB0\u5F55,\u7A7A\u6307\u9488\u5F02\u5E38&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">handlerFallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span>  <span class="token class-name">Long</span> id<span class="token punctuation">,</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Payment</span> payment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">&quot;null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">444</span><span class="token punctuation">,</span><span class="token string">&quot;\u515C\u5E95\u5F02\u5E38handlerFallback,exception\u5185\u5BB9  &quot;</span><span class="token operator">+</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636296874173-d549dc01-eea9-4008-8970-530ddd329d87.png" alt="img"></p>`,6),ft=s("\u8BBF\u95EE"),qt={href:"http://localhost:84/consumer/fallback/4%EF%BC%8C%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E4%B8%9A%E5%8A%A1%E5%BC%82%E5%B8%B8",target:"_blank",rel:"noopener noreferrer"},wt=s("http://localhost:84/consumer/fallback/4\uFF0C\u53EF\u4EE5\u770B\u5230\u4E1A\u52A1\u5F02\u5E38"),_t=p(`<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636296836332-e0231afe-55ae-4999-a4a6-02c656f443d7.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636376600977-3e77373a-45cd-4f57-b09c-ef7b84ad1440.png" alt="img"></p><p>######## (3) \u53EA\u914D\u7F6EblockHandler</p><p>blockHandler\u5BF9\u5E94\u670D\u52A1\u7194\u65AD\uFF0C\u5F53\u524Dsentinel\u914D\u7F6E\u5DF2\u7ECF\u8FDD\u89C4\uFF08RT\u6570\u8FC7\u591A\u3001\u5F02\u5E38\u8FC7\u591A\uFF09\uFF0C\u670D\u52A1\u7194\u65AD\u540E\u4E0D\u53EF\u7528\uFF0C\u9700\u8981\u7ED9\u5BA2\u6237\u63D0\u793A\uFF0C\u8FDB\u884C\u4E00\u4E2A\u7194\u65AD\u7684\u515C\u5E95\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/consumer/fallback/{id}&quot;</span><span class="token punctuation">)</span>
<span class="token comment">//@SentinelResource(value = &quot;fallback&quot;) //\u6CA1\u6709\u914D\u7F6E</span>
<span class="token comment">//@SentinelResource(value = &quot;fallback&quot;, fallback = &quot;handlerFallback&quot;) //fallback\u8D1F\u8D23\u4E1A\u52A1\u5F02\u5E38,\u5BF9\u5E94\u670D\u52A1\u964D\u7EA7</span>
<span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;fallback&quot;</span><span class="token punctuation">,</span> blockHandler <span class="token operator">=</span> <span class="token string">&quot;blockHandler&quot;</span><span class="token punctuation">)</span>  <span class="token comment">//blockHandler\u53EA\u8D1F\u8D23sentinel\u63A7\u5236\u53F0\u914D\u7F6E\u8FDD\u89C4,\u5BF9\u5E94\u670D\u52A1\u7194\u65AD</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>SERVICE_URL <span class="token operator">+</span> <span class="token string">&quot;/paymentSQL/&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">,</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;IllegalArgumentException,\u975E\u6CD5\u53C2\u6570\u5F02\u5E38....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token string">&quot;NullPointerException,\u8BE5ID\u6CA1\u6709\u5BF9\u5E94\u8BB0\u5F55,\u7A7A\u6307\u9488\u5F02\u5E38&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//\u672C\u4F8B\u662Ffallback</span>
<span class="token comment">//    public CommonResult handlerFallback(@PathVariable  Long id,Throwable e) {</span>
<span class="token comment">//        Payment payment = new Payment(id,&quot;null&quot;);</span>
<span class="token comment">//        return new CommonResult&lt;&gt;(444,&quot;\u515C\u5E95\u5F02\u5E38handlerFallback,exception\u5185\u5BB9  &quot;+e.getMessage(),payment);</span>
<span class="token comment">//    }</span>

<span class="token comment">//\u672C\u4F8B\u662FblockHandler</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">blockHandler</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span>  <span class="token class-name">Long</span> id<span class="token punctuation">,</span> <span class="token class-name">BlockException</span> blockException<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Payment</span> payment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">&quot;null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">445</span><span class="token punctuation">,</span><span class="token string">&quot;blockHandler-sentinel\u9650\u6D41,\u65E0\u6B64\u6D41\u6C34: blockException  &quot;</span>
                              <span class="token operator">+</span> blockException<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636377488633-9fbf083a-c1b7-4b8f-b0fb-780cc3149cd9.png" alt="img"></p><p>\u914D\u7F6Esentinel</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636378236102-092d5db5-1b25-448f-ab7b-90e1005941a9.png" alt="img"></p>`,8),xt=s("\u8BBF\u95EE\uFF1A"),It={href:"http://localhost:84/consumer/fallback/5",target:"_blank",rel:"noopener noreferrer"},St=s("http://localhost:84/consumer/fallback/5"),Et=p(`<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636378622776-6814a21d-f639-4916-88c3-a02a09ca9ea5.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636378646427-5916609c-ee75-4561-b82b-a5305ca1ad2d.png" alt="img"></p><p>\u8FD9\u91CC\u8FD8\u662F\u8DDF\u4E4B\u524D\u4E00\u6837\u7684bug\uFF0C\u5F88\u8FF7\u3002</p><p>######## (4) fallback\u548CblockHandler\u90FD\u914D\u7F6E</p><p>\u540C\u65F6\u6709\u964D\u7EA7\u8DDF\u7194\u65AD\u7684\u515C\u5E95\u65B9\u6CD5\uFF0C\u5F53\u964D\u7EA7\u8FBE\u5230sentinel\u914D\u7F6E\u89C4\u5219\u540E\uFF0C\u89E6\u53D1\u7194\u65AD\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/consumer/fallback/{id}&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;fallback&quot;</span><span class="token punctuation">,</span> fallback <span class="token operator">=</span> <span class="token string">&quot;handlerFallback&quot;</span><span class="token punctuation">,</span> blockHandler <span class="token operator">=</span> <span class="token string">&quot;blockHandler&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>SERVICE_URL <span class="token operator">+</span> <span class="token string">&quot;/paymentSQL/&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">,</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;IllegalArgumentException,\u975E\u6CD5\u53C2\u6570\u5F02\u5E38....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token string">&quot;NullPointerException,\u8BE5ID\u6CA1\u6709\u5BF9\u5E94\u8BB0\u5F55,\u7A7A\u6307\u9488\u5F02\u5E38&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//\u672C\u4F8B\u662Ffallback</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">handlerFallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span>  <span class="token class-name">Long</span> id<span class="token punctuation">,</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Payment</span> payment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">&quot;null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">444</span><span class="token punctuation">,</span><span class="token string">&quot;\u515C\u5E95\u5F02\u5E38handlerFallback,exception\u5185\u5BB9  &quot;</span><span class="token operator">+</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//\u672C\u4F8B\u662FblockHandler</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">blockHandler</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span>  <span class="token class-name">Long</span> id<span class="token punctuation">,</span> <span class="token class-name">BlockException</span> blockException<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Payment</span> payment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">&quot;null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">445</span><span class="token punctuation">,</span><span class="token string">&quot;blockHandler-sentinel\u9650\u6D41,\u65E0\u6B64\u6D41\u6C34: blockException  &quot;</span>
                              <span class="token operator">+</span> blockException<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636379028565-b0a58044-6568-40c7-a127-893179509f17.png" alt="img"></p><p>\u914D\u7F6Esentinel</p><p>\u5220\u9664\u4E4B\u524D\u7684\u7194\u65AD\u89C4\u5219\uFF0C\u914D\u7F6E\u6D41\u63A7\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636379267539-ae4d7c97-3a11-4365-8a08-45fa444b7334.png" alt="img"></p><p>\u9650\u6D41\u6548\u679C\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636381019917-19556a7d-37e6-47ae-964f-72f43a7db72c.png" alt="img"></p>`,12),At=s("\u6CA1\u6709\u89E6\u53D1\u9650\u6D41\u65F6\uFF0C\u6211\u4EEC\u89E6\u53D1\u4E1A\u52A1\u5F02\u5E38"),Ct={href:"http://localhost:84/consumer/fallback/4%EF%BC%8C%E4%BC%9A%E8%A2%AB%E9%99%8D%E7%BA%A7%E6%96%B9%E6%B3%95fallback%E5%85%9C%E5%BA%95%EF%BC%9A",target:"_blank",rel:"noopener noreferrer"},Tt=s("http://localhost:84/consumer/fallback/4\uFF0C\u4F1A\u88AB\u964D\u7EA7\u65B9\u6CD5fallback\u515C\u5E95\uFF1A"),Rt=p(`<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636381545549-1837da35-4d9a-4fe2-9703-af4577a55fa5.png" alt="img"></p><p>\u89E6\u53D1\u9650\u6D41\u65F6\uFF0C\u6211\u4EEC\u4ECD\u7136\u8BBF\u95EE\u53EF\u4EE5\u89E6\u53D1\u4E1A\u52A1\u5F02\u5E38\u7684\u8FDE\u63A5\uFF0C\u6B64\u65F6\u670D\u52A1\u5DF2\u7ECF\u88AB\u9650\u6D41\uFF08\u53EF\u4EE5\u7406\u89E3\u4E3A\u670D\u52A1\u4E0D\u53EF\u7528\u5373\u7194\u65AD\uFF09\uFF0C\u6B64\u65F6\u89E6\u53D1\u7684\u662F\u9650\u6D41\uFF08\u7194\u65ADblockHandler\uFF09\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636381657535-9cb4112c-8d99-4cbe-b6a3-435fed6479cb.png" alt="img"></p><p>\u4E5F\u5C31\u662F\u8BF4\uFF0C\u540C\u65F6\u914D\u7F6Efallback\uFF1A\u5904\u7406\u4E1A\u52A1\u5F02\u5E38\uFF08\u5FAE\u670D\u52A1\u81EA\u8EAB\u5F02\u5E38\uFF0C\u670D\u52A1\u964D\u7EA7\uFF09\u548CblockHandler\uFF1A\u5904\u7406\u89E6\u53D1sentinel\u914D\u7F6E\uFF08\u5FAE\u670D\u52A1\u4E0D\u53EF\u7528\uFF0C\u670D\u52A1\u7194\u65AD\uFF09\u65F6\u3002\u5728\u6CA1\u6709\u8FDD\u53CDsentinel\u89C4\u5219\u65F6\uFF0C\u51FA\u73B0\u4E1A\u52A1\u5F02\u5E38\uFF08\u964D\u7EA7\uFF09\u8D70fallback\u65B9\u6CD5\uFF1B\u8FDD\u53CD\u4E86sentinel\u89C4\u5219\u65F6\uFF0C\u76F4\u63A5\u5FAE\u670D\u52A1\u4E0D\u53EF\u7528\uFF08\u7194\u65AD\uFF09\uFF0C\u8D70blockHandler\u6307\u5B9A\u7684\u81EA\u5B9A\u4E49\u65B9\u6CD5\u3002</p><p>######## (5) \u5F02\u5E38\u5FFD\u7565\u5C5E\u6027</p><p>\u53EF\u4EE5\u9009\u62E9\u6027\u7684\u914D\u7F6E\u5F53\u67D0\u4E9B\u5F02\u5E38\u53D1\u751F\u65F6\uFF0C\u4E0D\u89E6\u53D1fallback\u7684\u515C\u5E95\u65B9\u6CD5\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/consumer/fallback/{id}&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SentinelResource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;fallback&quot;</span><span class="token punctuation">,</span> fallback <span class="token operator">=</span> <span class="token string">&quot;handlerFallback&quot;</span><span class="token punctuation">,</span> blockHandler <span class="token operator">=</span> <span class="token string">&quot;blockHandler&quot;</span><span class="token punctuation">,</span>
                  exceptionsToIgnore <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">IllegalArgumentException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> <span class="token function">fallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span>SERVICE_URL <span class="token operator">+</span> <span class="token string">&quot;/paymentSQL/&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">,</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">&quot;IllegalArgumentException,\u975E\u6CD5\u53C2\u6570\u5F02\u5E38....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token string">&quot;NullPointerException,\u8BE5ID\u6CA1\u6709\u5BF9\u5E94\u8BB0\u5F55,\u7A7A\u6307\u9488\u5F02\u5E38&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//\u672C\u4F8B\u662Ffallback</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">handlerFallback</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span>  <span class="token class-name">Long</span> id<span class="token punctuation">,</span><span class="token class-name">Throwable</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Payment</span> payment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">&quot;null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">444</span><span class="token punctuation">,</span><span class="token string">&quot;\u515C\u5E95\u5F02\u5E38handlerFallback,exception\u5185\u5BB9  &quot;</span><span class="token operator">+</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//\u672C\u4F8B\u662FblockHandler</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">blockHandler</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span>  <span class="token class-name">Long</span> id<span class="token punctuation">,</span> <span class="token class-name">BlockException</span> blockException<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Payment</span> payment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span><span class="token string">&quot;null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">445</span><span class="token punctuation">,</span><span class="token string">&quot;blockHandler-sentinel\u9650\u6D41,\u65E0\u6B64\u6D41\u6C34: blockException  &quot;</span>
                              <span class="token operator">+</span> blockException<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>payment<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636382629691-ae5cd6c6-3222-41fc-b194-f604cbe6ca2b.png" alt="img"></p>`,8),Lt=s("\u6D4B\u8BD5\u4E00\u4E0B\uFF0C\u8BBF\u95EE\uFF1A"),Nt={href:"http://localhost:84/consumer/fallback/4",target:"_blank",rel:"noopener noreferrer"},jt=s("http://localhost:84/consumer/fallback/4"),Dt=p(`<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636382674753-3fb1691e-a2bf-4fbf-acdb-33bdf00f971e.png" alt="img"></p><p>\u76F4\u63A5\u62A5\u9519\u8BEF\u9875\u9762\uFF0C\u6CA1\u6709\u4E86\u964D\u7EA7\u515C\u5E95\u65B9\u6CD5\u3002</p><p>\u5176\u4ED6\u5F02\u5E38\u4E0D\u53D7\u5F71\u54CD\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636383051275-12b54175-7254-40da-82fe-2b553361b4a6.png" alt="img"></p><p>\u5F53\u7136\uFF0C\u89E6\u53D1\u6D41\u63A7\u4E4B\u540E\uFF0C\u4ECD\u7136\u901A\u8FC7blockHandler\u6307\u5B9A\u7684\u65B9\u6CD5\u8FDB\u884C\u7194\u65AD\u515C\u5E95\u3002</p><h5 id="_9-2-feign\u7CFB\u5217" tabindex="-1"><a class="header-anchor" href="#_9-2-feign\u7CFB\u5217" aria-hidden="true">#</a> 9.2 Feign\u7CFB\u5217</h5><h6 id="_9-2-1-\u4FEE\u653984\u6A21\u5757" tabindex="-1"><a class="header-anchor" href="#_9-2-1-\u4FEE\u653984\u6A21\u5757" aria-hidden="true">#</a> 9.2.1 \u4FEE\u653984\u6A21\u5757</h6><p>\u4FEE\u653984\u6A21\u5757\uFF0CFeign\u7EC4\u4EF6\u4E00\u822C\u662F\u5728\u6D88\u8D39\u4FA7\u3002</p><p>######## (1) pom</p><p>pom \u52A0\u5165feign\u7684\u4F9D\u8D56</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--SpringCloud openfeign --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## (2) yml</p><p>\u6FC0\u6D3BSentinel\u5BF9Feign\u7684\u652F\u6301</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment"># \u6FC0\u6D3BSentinel\u5BF9Feign\u7684\u652F\u6301</span>
<span class="token key atrule">feign</span><span class="token punctuation">:</span>
  <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## (3) \u4E1A\u52A1\u7C7B</p><p>\u540E\u7EED84\u7684controller\u4E0D\u627ErestTemplate\uFF08Ribbon\uFF09\uFF0C\u4E0D\u662FrestTemplate\u53BB\u8C03\u7528payment\u5FAE\u670D\u52A1\u4E2D\u7684\u63A5\u53E3\u3002\u800C\u662F\u901A\u8FC7\u8C03\u7528PaymentFeignService\uFF0Cservice\u518D\u53BB\u8C03\u7528payment\u5FAE\u670D\u52A1\u4E2D\u7684\u7AEF\u53E3\u3002</p><p>Feign\u9700\u8981\u5B9A\u4E49\u4E00\u4E2A\u4E1A\u52A1\u903B\u8F91\uFF08service\uFF09\u63A5\u53E3+ @FeignClient\u6CE8\u89E3\u4EE5\u8C03\u7528\u670D\u52A1\u63D0\u4F9B\u8005\u3002</p><p>\u65B0\u5EFAPaymentFeignService interface\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">Payment</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>openfeign<span class="token punctuation">.</span></span><span class="token class-name">FeignClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PathVariable</span></span><span class="token punctuation">;</span>

<span class="token comment">// \u6307\u660E\u8C03\u7528\u5931\u8D25\u7684\u515C\u5E95\u65B9\u6CD5\u5728PaymentFallbackService</span>
<span class="token comment">// \u4F7F\u7528 fallback \u65B9\u5F0F\u662F\u65E0\u6CD5\u83B7\u53D6\u5F02\u5E38\u4FE1\u606F\u7684\uFF0C</span>
<span class="token comment">// \u5982\u679C\u60F3\u8981\u83B7\u53D6\u5F02\u5E38\u4FE1\u606F\uFF0C\u53EF\u4EE5\u4F7F\u7528 fallbackFactory\u53C2\u6570</span>
<span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;nacos-payment-provider&quot;</span><span class="token punctuation">,</span> fallback <span class="token operator">=</span> <span class="token class-name">PaymentFallbackService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PaymentFeignService</span> <span class="token punctuation">{</span>
    <span class="token comment">//\u53BBnacos-payment-provider\u670D\u52A1\u4E2D\u627E\u76F8\u5E94\u7684\u63A5\u53E3</span>
    <span class="token comment">// \u65B9\u6CD5\u7B7E\u540D\u4E00\u5B9A\u8981\u548Cnacos-payment-provider\u4E2Dcontroller\u7684\u4E00\u81F4</span>
    <span class="token comment">// \u5BF9\u5E949003\u30019004\u4E2D\u7684\u65B9\u6CD5</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/paymentSQL/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> <span class="token function">paymentSQL</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8C03\u7528\u5931\u8D25\u7684\u515C\u5E95\u65B9\u6CD5\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>springcloud<span class="token punctuation">.</span>entities<span class="token punctuation">.</span></span><span class="token class-name">Payment</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Component</span>   <span class="token comment">//\u4E0D\u8981\u5FD8\u8BB0\u4E86</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PaymentFallbackService</span> <span class="token keyword">implements</span> <span class="token class-name">PaymentFeignService</span> <span class="token punctuation">{</span>
    <span class="token comment">//\u5982\u679Cnacos-payment-consumer\u670D\u52A1\u4E2D\u7684\u76F8\u5E94\u63A5\u53E3\u51FA\u4E8B\u4E86\uFF0C\u6211\u6765\u515C\u5E95</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> <span class="token function">paymentSQL</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">444</span><span class="token punctuation">,</span><span class="token string">&quot;\u670D\u52A1\u964D\u7EA7\u8FD4\u56DE,\u6CA1\u6709\u8BE5\u6D41\u6C34\u4FE1\u606F-------PaymentFallbackService&quot;</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Payment</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token string">&quot;errorSerial......&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>84\u7AEF\u53E3controller\u52A0\u5165openFeign\u7684\u63A5\u53E3\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//==================OpenFeign</span>
<span class="token annotation punctuation">@Resource</span>
<span class="token keyword">private</span> <span class="token class-name">PaymentFeignService</span> paymentFeignService<span class="token punctuation">;</span>

<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/consumer/paymentSQL/{id}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Payment</span><span class="token punctuation">&gt;</span></span> <span class="token function">paymentSQL</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;\u6CA1\u6709\u8BE5id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> paymentFeignService<span class="token punctuation">.</span><span class="token function">paymentSQL</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## (4) \u4E3B\u542F\u52A8\u7C7B</p><p>\u52A0\u4E0A**@EnableFeignClient**\u6CE8\u89E3\u5F00\u542FOpenFeign</p><p>######## (5) \u6D4B\u8BD5</p><p>\u542F\u52A89003\u30019004\u300184</p>`,27),Bt=s("\u8BBF\u95EE\uFF1A"),Mt={href:"http://localhost:84/consumer/paymentSQL/1",target:"_blank",rel:"noopener noreferrer"},Pt=s("http://localhost:84/consumer/paymentSQL/1"),Ot=p(`<p>9003\u30019004\u8D1F\u8F7D\u5747\u8861</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636439455803-e9c03675-1a11-4dec-be5e-bf92f0ab37ee.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636439472093-4b41f770-ccfe-4779-b73a-778290855c33.png" alt="img"></p><p>\u5173\u95ED9003\u30019004\u5FAE\u670D\u52A1\u63D0\u4F9B\u8005\uFF0C\u770B\u523084\u6D88\u8D39\u8005\u81EA\u52A8\u6267\u884C\u964D\u7EA7\u515C\u5E95\u65B9\u6CD5\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636440219538-a4cad0f5-3108-46a5-9de7-22dd3d2003dc.png" alt="img"></p><p>\u5982\u679Cyaml\u6CA1\u6709\u914D\u7F6ESentinel\u5BF9Feign\u7684\u652F\u6301\uFF0C\u5C31\u4E0D\u4F1A\u6267\u884C\u964D\u7EA7\u65B9\u6CD5\uFF0C\u800C\u662F\u76F4\u63A5\u62A5\u9519\u8BEF\u9875\u9762\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636440204489-cef2429a-b054-4fa3-9fda-8723526b59a0.png" alt="img"></p><h5 id="_9-3-\u7194\u65AD\u6846\u67B6\u6BD4\u8F83" tabindex="-1"><a class="header-anchor" href="#_9-3-\u7194\u65AD\u6846\u67B6\u6BD4\u8F83" aria-hidden="true">#</a> 9.3 \u7194\u65AD\u6846\u67B6\u6BD4\u8F83</h5><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636440701197-692a61f8-63d8-494d-8ead-f44acefab3df.png" alt="img"></p><h3 id="\u5341\u3001\u6301\u4E45\u5316\u89C4\u5219" tabindex="-1"><a class="header-anchor" href="#\u5341\u3001\u6301\u4E45\u5316\u89C4\u5219" aria-hidden="true">#</a> \u5341\u3001\u6301\u4E45\u5316\u89C4\u5219</h3><p>\u524D\u9762\u6211\u4EEC\u5FAE\u670D\u52A1\u65B0\u589E\u7684\u9650\u6D41\u89C4\u5219\u540E\uFF0C\u5FAE\u670D\u52A1\u5173\u95ED\u540E\u5C31\u4F1A\u4E22\u5931\uFF0C\u5F53\u65F6\u914D\u7F6E\u90FD\u9650\u6D41\u89C4\u5219\u90FD\u662F\u4E34\u65F6\u7684\u3002 \u5C06\u9650\u6D41\u914D\u7F6E\u89C4\u5219\u6301\u4E45\u5316\u8FDBNacos\u4FDD\u5B58\uFF0C\u53EA\u8981\u5237\u65B08401\u67D0\u4E2Arest\u5730\u5740\uFF0Csentinel\u63A7\u5236\u53F0\u7684\u6D41\u63A7\u89C4\u5219 \u5C31\u80FD\u770B\u5230\u3002\u53EA\u8981nacos\u91CC\u9762\u7684\u914D\u7F6E\u4E0D\u5220\u9664\uFF0C\u9488\u5BF98401\u4E0A\u7684sentinel\u4E0A\u7684\u6D41\u63A7\u89C4\u5219\u5C31\u6301\u7EED\u5B58\u5728\u3002 \uFF08\u4E5F\u53EF\u4EE5\u6301\u4E45\u5316\u5230\u6587\u4EF6\uFF0Credis\uFF0C\u6570\u636E\u5E93\u7B49\uFF09</p><h5 id="\u6848\u4F8B\u2014\u2014\u4FEE\u65398401\u5DF2\u5B8C\u6210\u6301\u4E45\u5316\u8BBE\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u6848\u4F8B\u2014\u2014\u4FEE\u65398401\u5DF2\u5B8C\u6210\u6301\u4E45\u5316\u8BBE\u7F6E" aria-hidden="true">#</a> \u6848\u4F8B\u2014\u2014\u4FEE\u65398401\u5DF2\u5B8C\u6210\u6301\u4E45\u5316\u8BBE\u7F6E</h5><h6 id="_1-pom-1" tabindex="-1"><a class="header-anchor" href="#_1-pom-1" aria-hidden="true">#</a> (1) pom</h6><p>\u5BFC\u5165\u6301\u4E45\u5316\u6240\u9700\u4F9D\u8D56</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--SpringCloud ailibaba sentinel-datasource-nacos \u6301\u4E45\u5316--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.csp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>sentinel-datasource-nacos<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_2-yaml" tabindex="-1"><a class="header-anchor" href="#_2-yaml" aria-hidden="true">#</a> (2) yaml</h6><p>\u6DFB\u52A0nacos\u6570\u636E\u6E90\u914D\u7F6E</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8401</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> cloudalibaba<span class="token punctuation">-</span>sentinel<span class="token punctuation">-</span>service
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span> <span class="token comment">#Nacos\u670D\u52A1\u6CE8\u518C\u4E2D\u5FC3\u5730\u5740</span>
    <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
      <span class="token key atrule">transport</span><span class="token punctuation">:</span>
        <span class="token comment">#\u914D\u7F6ESentinel dashboard\u5730\u5740</span>
        <span class="token key atrule">dashboard</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8080</span>
        <span class="token comment">#\u9ED8\u8BA48719\u7AEF\u53E3\uFF0C\u5047\u5982\u88AB\u5360\u7528\u4F1A\u81EA\u52A8\u4ECE8719\u5F00\u59CB\u4F9D\u6B21+1\u626B\u63CF,\u76F4\u81F3\u627E\u5230\u672A\u88AB\u5360\u7528\u7684\u7AEF\u53E3</span>
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8719</span>
      <span class="token comment"># \u5173\u95ED\u9ED8\u8BA4\u6536\u655B\u6240\u6709URL\u7684\u5165\u53E3context\uFF0C\u4E0D\u7136\u94FE\u8DEF\u9650\u6D41\u4E0D\u751F\u6548</span>
      <span class="token comment"># Spring Cloud Alibaba \u9700\u89812.1.1.RELEASE\u4EE5\u4E0A\u7248\u672C</span>
      <span class="token key atrule">web-context-unify</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
<span class="token comment">#      filter:</span>
<span class="token comment">#        enabled: false  # \u5173\u95ED\u81EA\u52A8\u6536\u655B</span>

      <span class="token comment">#\u6301\u4E45\u5316\u914D\u7F6E</span>
      <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
        <span class="token key atrule">ds1</span><span class="token punctuation">:</span>
          <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
            <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span>
            <span class="token key atrule">dataId</span><span class="token punctuation">:</span> cloudalibaba<span class="token punctuation">-</span>sentinel<span class="token punctuation">-</span>service
            <span class="token key atrule">groupId</span><span class="token punctuation">:</span> DEFAULT_GROUP
            <span class="token key atrule">data-type</span><span class="token punctuation">:</span> json
            <span class="token key atrule">rule-type</span><span class="token punctuation">:</span> flow

<span class="token key atrule">management</span><span class="token punctuation">:</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">&#39;*&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_3-\u6DFB\u52A0nacos\u4E1A\u52A1\u89C4\u5219\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_3-\u6DFB\u52A0nacos\u4E1A\u52A1\u89C4\u5219\u914D\u7F6E" aria-hidden="true">#</a> (3) \u6DFB\u52A0nacos\u4E1A\u52A1\u89C4\u5219\u914D\u7F6E</h6><p>\u6211\u4EEC\u5C06sentinel\u7684\u6D41\u63A7\u914D\u7F6E\u4FDD\u5B58\u5728nacos\u4E2D\uFF0C\u56E0\u4E3Anacos\u7684\u914D\u7F6E\u6301\u4E45\u5316\u5728\u4E86\u6570\u636E\u5E93\u4E2D\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636443367569-59d065b4-ec4e-43c0-8f50-8f805c8c818f.png" alt="img"></p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token property">&quot;resource&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/rateLimit/byUrl&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;limitApp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;grade&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;count&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token property">&quot;strategy&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;controlBehavior&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token property">&quot;clusterMode&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>resource\uFF1A\u8D44\u6E90\u540D\u79F0\uFF1B</p><p>limitApp\uFF1A\u6765\u6E90\u5E94\u7528\uFF1B</p><p>grade\uFF1A\u9608\u503C\u7C7B\u578B\uFF0C0\u8868\u793A\u7EBF\u7A0B\u6570\uFF0C1\u8868\u793AQPS\uFF1B</p><p>count\uFF1A\u5355\u673A\u9608\u503C\uFF1B</p><p>strategy\uFF1A\u6D41\u63A7\u6A21\u5F0F\uFF0C0\u8868\u793A\u76F4\u63A5\uFF0C1\u8868\u793A\u5173\u8054\uFF0C2\u8868\u793A\u94FE\u8DEF\uFF1B</p><p>controlBehavior\uFF1A\u6D41\u63A7\u6548\u679C\uFF0C0\u8868\u793A\u5FEB\u901F\u5931\u8D25\uFF0C1\u8868\u793AWarm Up\uFF0C2\u8868\u793A\u6392\u961F\u7B49\u5F85\uFF1B</p><p>clusterMode\uFF1A\u662F\u5426\u96C6\u7FA4\u3002</p><p>\u6CE8\u610F\uFF1A\u8FD9\u91CC\u5982\u679C\u8981\u914Dnacos\u7684\u547D\u540D\u7A7A\u95F4\uFF08public\u3001dev\u3001test\uFF09\u7684\u8BDD\uFF0C\u5E94\u8BE5\u662F\u914Dnamespace\u7684id\uFF0C\u4E0D\u662F\u540D\u79F0</p><h6 id="_4-\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#_4-\u6D4B\u8BD5" aria-hidden="true">#</a> (4) \u6D4B\u8BD5</h6><p>\u542F\u52A88401\uFF0C\u8BBF\u95EE8401\u4EFB\u610F\u63A5\u53E3\uFF0C\u5237\u65B0Sentinel\u3002\u53EF\u4EE5\u770B\u5230Sentinel\u4E2D\u52A0\u8F7D\u4E86\u901A\u8FC7nacos\u6301\u4E45\u5316\u7684\u89C4\u5219\u914D\u7F6E\u6587\u4EF6\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636459020329-7d5d5e38-9dfb-48bd-96bb-2488b066a8f8.png" alt="img"></p><p>\u5173\u63898401\u540E\u53D1\u73B0\u6D41\u63A7\u89C4\u5219\u6CA1\u6709\u4E86\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636459171130-489aa6a9-cf4c-4c28-94ba-456418bbaa4f.png" alt="img"></p><p>\u518D\u6B21\u542F\u52A88401\u67E5\u770Bsentinel\uFF0C\u8BBF\u95EE\u51E0\u6B218401\u540E\u6D41\u63A7\u89C4\u5219\u53C8\u51FA\u73B0\u4E86\u3002</p><p>\u67E5\u770B\u6570\u636E\u5E93\uFF0C\u53D1\u73B0\u89C4\u5219\u6301\u4E45\u5316\u5230\u6570\u636E\u5E93\u4E2D\u4E86\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636459413078-73a851a4-729f-4e9a-b5ef-1d1bddf40cdf.png" alt="img"></p><h2 id="_15-springcloud-alibaba-seata\u5904\u7406\u5206\u5E03\u5F0F\u4E8B\u52A1" tabindex="-1"><a class="header-anchor" href="#_15-springcloud-alibaba-seata\u5904\u7406\u5206\u5E03\u5F0F\u4E8B\u52A1" aria-hidden="true">#</a> 15.SpringCloud Alibaba Seata\u5904\u7406\u5206\u5E03\u5F0F\u4E8B\u52A1</h2><h3 id="\u5206\u5E03\u5F0F\u4E8B\u52A1\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#\u5206\u5E03\u5F0F\u4E8B\u52A1\u95EE\u9898" aria-hidden="true">#</a> \u5206\u5E03\u5F0F\u4E8B\u52A1\u95EE\u9898</h3><p><strong>\u53EA\u8981\u7528\u5230\u5206\u5E03\u5F0F\uFF0C\u5FC5\u7136\u4F1A\u63D0\u53CA\u5206\u5E03\u5F0F\u7684\u4E8B\u52A1\u3002</strong></p><p>\u5728\u5206\u5E03\u5F0F\u4E4B\u524D\uFF0C\u4E00\u5207\u7EC4\u4EF6\u5168\u90FD\u5728\u4E00\u53F0\u673A\u5668\u4E0A\u3002</p><p>\u5728\u4F7F\u7528\u5206\u5E03\u5F0F\u4E4B\u540E\uFF0C\u5355\u4F53\u5E94\u7528\u88AB\u62C6\u5206\u6210\u5FAE\u670D\u52A1\u5E94\u7528\uFF0C\u539F\u6765\u7684\u4E09\u4E2A\u6A21\u5757\u88AB\u62C6\u5206\u6210\u4E09\u4E2A\u72EC\u7ACB\u7684\u5E94\u7528\uFF0C\u5206\u522B\u4F7F\u7528\u4E09\u4E2A\u72EC\u7ACB\u7684\u6570\u636E\u6E90\u3002</p><p>\u4E1A\u52A1\u64CD\u4F5C\u9700\u8981\u8C03\u7528\u4E09\u4E2A\u670D\u52A1\u6765\u5B8C\u6210\u3002\u6B64\u65F6\u6BCF\u4E2A\u670D\u52A1\u5185\u90E8\u7684\u6570\u636E\u4E00\u81F4\u6027\u7531<strong>\u672C\u5730</strong>\u4E8B\u52A1\u6765\u4FDD\u8BC1\uFF0C\u4F46\u662F<strong>\u5168\u5C40</strong>\u7684\u6570\u636E\u4E00\u81F4\u6027\u95EE\u9898\u6CA1\u6CD5\u4FDD\u8BC1\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636468367331-5feffbdc-ec8f-4620-9c50-d8c5485c2871.png" alt="img"></p><p>\u4E00\u53E5\u8BDD\uFF1A<code>\u4E00\u6B21\u4E1A\u52A1\u64CD\u4F5C\u9700\u8981\u8DE8\u591A\u4E2A\u6570\u636E\u6E90\u6216\u9700\u8981\u8DE8\u591A\u4E2A\u7CFB\u7EDF\u8FDB\u884C\u8FDC\u7A0B\u8C03\u7528\uFF0C\u5C31\u4F1A\u4EA7\u751F\u5206\u5E03\u5F0F\u4E8B\u52A1\u95EE\u9898\u3002</code></p><h3 id="\u4E00\u3001seata\u7B80\u4ECB\u4E0E\u5B89\u88C5" tabindex="-1"><a class="header-anchor" href="#\u4E00\u3001seata\u7B80\u4ECB\u4E0E\u5B89\u88C5" aria-hidden="true">#</a> \u4E00\u3001Seata\u7B80\u4ECB\u4E0E\u5B89\u88C5</h3>`,47),Ft=s("Seata\u662F\u4E00\u6B3E\u5F00\u6E90\u7684\u5206\u5E03\u5F0F\u4E8B\u52A1\u89E3\u51B3\u65B9\u6848\uFF0C\u81F4\u529B\u4E8E\u5728\u5FAE\u670D\u52A1\u67B6\u6784\u4E0B\u63D0\u4F9B\u9AD8\u6027\u80FD\u548C\u7B80\u5355\u6613\u7528\u7684\u5206\u5E03\u5F0F\u4E8B\u52A1\u670D\u52A1\u3002 "),Ut={href:"http://seata.io/zh-cn/",target:"_blank",rel:"noopener noreferrer"},Ht=s("\u5B98\u7F51"),Gt=p(`<h5 id="_1-1-\u76F8\u5173\u672F\u8BED" tabindex="-1"><a class="header-anchor" href="#_1-1-\u76F8\u5173\u672F\u8BED" aria-hidden="true">#</a> 1.1 \u76F8\u5173\u672F\u8BED</h5><p>\u4E00\u4E2A\u5178\u578B\u7684\u5206\u5E03\u5F0F\u4E8B\u52A1\u8FC7\u7A0B\uFF0C\u53EF\u4EE5\u7528\u5206\u5E03\u5F0F\u5904\u7406\u8FC7\u7A0B\u7684<strong>\u4E00ID+\u4E09\u7EC4\u4EF6</strong>\u6A21\u578B\u6765\u63CF\u8FF0\u3002</p><p>\u4E00ID\uFF08<strong>\u5168\u5C40\u552F\u4E00\u7684\u4E8B\u52A1ID</strong>\uFF09\uFF1ATransaction ID XID\uFF0C\u5728\u8FD9\u4E2A\u4E8B\u52A1ID\u4E0B\u7684\u6240\u6709\u4E8B\u52A1\u4F1A\u88AB\u7EDF\u4E00\u63A7\u5236</p><p><strong>\u4E09\u7EC4\u4EF6</strong>\uFF1A</p><ul><li><strong>Transaction Coordinator (TC)</strong>\uFF1A\u4E8B\u52A1\u534F\u8C03\u5668\uFF0C\u7EF4\u62A4\u5168\u5C40\u4E8B\u52A1\u7684\u8FD0\u884C\u72B6\u6001\uFF0C\u8D1F\u8D23\u534F\u8C03\u5E76\u9A71\u52A8\u5168\u5C40\u4E8B\u52A1\u7684\u63D0\u4EA4\u6216\u56DE\u6EDA\uFF1B\uFF08Server\u7AEF\uFF0C\u4E3A\u5355\u72EC\u670D\u52A1\u5668\u90E8\u7F72\uFF09</li><li><strong>Transaction Manager (TM)</strong>\uFF1A\u4E8B\u52A1\u7BA1\u7406\u5668\uFF0C\u63A7\u5236\u5168\u5C40\u4E8B\u52A1\u7684\u8FB9\u754C\uFF0C\u8D1F\u8D23\u5F00\u542F\u4E00\u4E2A\u5168\u5C40\u4E8B\u52A1\uFF0C\u5E76\u6700\u7EC8\u53D1\u8D77\u5168\u5C40\u63D0\u4EA4\u6216\u5168\u5C40\u56DE\u6EDA\u7684\u51B3\u8BAE\uFF1B</li><li><strong>Resource Manager (RM)</strong>\uFF1A\u8D44\u6E90\u7BA1\u7406\u5668\uFF0C\u63A7\u5236\u5206\u652F\u4E8B\u52A1\uFF0C\u8D1F\u8D23\u5206\u652F\u6CE8\u518C\u3001\u72B6\u6001\u6C47\u62A5\uFF0C\u5E76\u63A5\u6536\u4E8B\u52A1\u534F\u8C03\u5668\u7684\u6307\u4EE4\uFF0C\u9A71\u52A8\u5206\u652F\uFF08\u672C\u5730\uFF09\u4E8B\u52A1\u7684\u63D0\u4EA4\u548C\u56DE\u6EDA</li><li>Seata\u5206TC\u3001TM\u548CRM\u4E09\u4E2A\u89D2\u8272\uFF0C<strong>TC\uFF08Server\u7AEF\uFF09\u4E3A\u5355\u72EC\u670D\u52A1\u7AEF\u90E8\u7F72</strong>\uFF0C<strong>TM\u548CRM\uFF08Client\u7AEF\uFF09\u7531\u4E1A\u52A1\u7CFB\u7EDF\u96C6\u6210\uFF08\u5FAE\u670D\u52A1\uFF09</strong>\u3002</li></ul><h5 id="_1-2-\u5178\u578B\u7684\u5206\u5E03\u5F0F\u63A7\u5236\u4E8B\u52A1\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#_1-2-\u5178\u578B\u7684\u5206\u5E03\u5F0F\u63A7\u5236\u4E8B\u52A1\u6D41\u7A0B" aria-hidden="true">#</a> 1.2 \u5178\u578B\u7684\u5206\u5E03\u5F0F\u63A7\u5236\u4E8B\u52A1\u6D41\u7A0B</h5><ol><li>TM \u5411 TC \u7533\u8BF7\u5F00\u542F\u4E00\u4E2A\u5168\u5C40\u4E8B\u52A1\uFF0C\u5168\u5C40\u4E8B\u52A1\u521B\u5EFA\u6210\u529F\u5E76\u751F\u6210\u4E00\u4E2A<strong>\u5168\u5C40\u552F\u4E00\u7684 XID</strong>\uFF1B</li><li>XID \u5728\u5FAE\u670D\u52A1\u8C03\u7528\u94FE\u8DEF\u7684\u4E0A\u4E0B\u6587\u4E2D\u4F20\u64AD\uFF1B\uFF08\u4E5F\u5C31\u662F\u5728\u591A\u4E2ATM\uFF0CRM\u4E2D\u4F20\u64AD\uFF09</li><li>RM \u5411 TC \u6CE8\u518C\u5206\u652F\u4E8B\u52A1\uFF0C\u5C06\u5176\u7EB3\u5165 XID \u5BF9\u5E94\u5168\u5C40\u4E8B\u52A1\u7684\u7BA1\u8F96\uFF1B</li><li>TM \u5411 TC \u53D1\u8D77\u9488\u5BF9 XID \u7684\u5168\u5C40\u63D0\u4EA4\u6216\u56DE\u6EDA\u51B3\u8BAE\uFF1B</li><li>TC \u8C03\u5EA6 XID \u4E0B\u7BA1\u8F96\u7684\u5168\u90E8\u5206\u652F\u4E8B\u52A1\u5B8C\u6210\u63D0\u4EA4\u6216\u56DE\u6EDA\u8BF7\u6C42\u3002</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636511629414-0e4a7788-1488-40b8-8b5f-93f330a481b7.png" alt="img"></p><h5 id="_1-3-seata-server\u7684\u4E0B\u8F7D\u4E0E\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_1-3-seata-server\u7684\u4E0B\u8F7D\u4E0E\u914D\u7F6E" aria-hidden="true">#</a> 1.3 Seata-Server\u7684\u4E0B\u8F7D\u4E0E\u914D\u7F6E</h5><p>\u6211\u8FD9\u91CC\u4E0B\u8F7D\u4E860.9.0\u7248\u672C\u8DDF1.4.2\u7248\u672C\uFF08\u914D\u4E86\u534A\u5929\u6CA1\u914D\u597D\uFF0C\u540E\u9762\u518D\u586B\u5751\uFF09\uFF0C\u5DEE\u522B\u8FD8\u662F\u86EE\u5927\u7684\u3002</p><h6 id="_1-3-1-\u4FEE\u6539file-conf\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_1-3-1-\u4FEE\u6539file-conf\u6587\u4EF6" aria-hidden="true">#</a> 1.3.1 \u4FEE\u6539file.conf\u6587\u4EF6</h6><p>\u89E3\u538B\u5230\u6307\u5B9A\u76EE\u5F55\u5E76\u4FEE\u6539conf\u76EE\u5F55\u4E0B\u7684file.conf\u914D\u7F6E\u6587\u4EF6\u3002</p><ol><li><p>\u5907\u4EFD\u539F\u59CBfile.conf\u6587\u4EF6\u3002</p></li><li><ol><li>\u4E3B\u8981\u4FEE\u6539\uFF1A\u81EA\u5B9A\u4E49\u4E8B\u52A1\u7EC4\u540D\u79F0+\u4E8B\u52A1\u65E5\u5FD7\u5B58\u50A8\u6A21\u5F0F\u4E3Adb+\u6570\u636E\u5E93\u8FDE\u63A5\u4FE1\u606F\u3002</li></ol></li><li><p>\u4FEE\u6539file.conf\u6587\u4EF6</p></li><li><ol><li>service\u6A21\u5757\uFF081.4.2\u91CC\u9762\u6CA1\u6709\u8FD9\u4E2A\u6A21\u5757\uFF0C\u9700\u8981\u81EA\u5DF1\u52A0\uFF09</li></ol></li><li><p>store\u6A21\u5757</p></li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636531841434-f5abb282-86e4-48b1-b7a0-71ad75de1679.png" alt="img"></p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token comment">## transaction log store, only used in seata-server</span>
<span class="token key attr-name">store</span> <span class="token value attr-value">{</span>
<span class="token comment">  ## store mode: file\u3001db\u3001redis</span>
<span class="token key attr-name">  mode</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;db&quot;</span>
<span class="token comment">  ## rsa decryption public key</span>
<span class="token key attr-name">  publicKey</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;&quot;</span>
<span class="token comment">  ## file store property</span>
<span class="token key attr-name">  file</span> <span class="token value attr-value">{</span>
<span class="token comment">    ## store location dir</span>
<span class="token key attr-name">    dir</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;sessionStore&quot;</span>
<span class="token comment">    # branch session size , if exceeded first try compress lockkey, still exceeded throws exceptions</span>
<span class="token key attr-name">    maxBranchSessionSize</span> <span class="token punctuation">=</span> <span class="token value attr-value">16384</span>
<span class="token comment">    # globe session size , if exceeded throws exceptions</span>
<span class="token key attr-name">    maxGlobalSessionSize</span> <span class="token punctuation">=</span> <span class="token value attr-value">512</span>
<span class="token comment">    # file buffer size , if exceeded allocate new buffer</span>
<span class="token key attr-name">    fileWriteBufferCacheSize</span> <span class="token punctuation">=</span> <span class="token value attr-value">16384</span>
<span class="token comment">    # when recover batch read size</span>
<span class="token key attr-name">    sessionReloadReadSize</span> <span class="token punctuation">=</span> <span class="token value attr-value">100</span>
<span class="token comment">    # async, sync</span>
<span class="token key attr-name">    flushDiskMode</span> <span class="token punctuation">=</span> <span class="token value attr-value">async</span>
  }

<span class="token comment">  ## database store property</span>
<span class="token key attr-name">  db</span> <span class="token value attr-value">{</span>
<span class="token comment">    ## the implement of javax.sql.DataSource, such as DruidDataSource(druid)/BasicDataSource(dbcp)/HikariDataSource(hikari) etc.</span>
<span class="token key attr-name">    datasource</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;druid&quot;</span>
<span class="token comment">    ## mysql/oracle/postgresql/h2/oceanbase etc.</span>
<span class="token key attr-name">    dbType</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;mysql&quot;</span>
<span class="token comment">	## mysql 5.xx</span>
<span class="token comment">    ## driverClassName = &quot;com.mysql.jdbc.Driver&quot;</span>
<span class="token comment">	## mysql 8.xx</span>
<span class="token key attr-name">	driverClassName</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;com.mysql.cj.jdbc.Driver&quot;</span>
<span class="token comment">    ## if using mysql to store the data, recommend add rewriteBatchedStatements=true in jdbc connection param</span>
<span class="token comment">    ## url = &quot;jdbc:mysql://127.0.0.1:3306/seata?rewriteBatchedStatements=true&quot;</span>
<span class="token key attr-name">	url</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;jdbc:mysql://127.0.0.1:3306/seata?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false&amp;nullCatalogMeansCurrent=true&amp;serverTimezone=UTC&quot;</span>
<span class="token key attr-name">    user</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;root&quot;</span>
<span class="token key attr-name">    password</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;10086&quot;</span>
<span class="token key attr-name">    minConn</span> <span class="token punctuation">=</span> <span class="token value attr-value">5</span>
<span class="token key attr-name">    maxConn</span> <span class="token punctuation">=</span> <span class="token value attr-value">100</span>
<span class="token key attr-name">    globalTable</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;global_table&quot;</span>
<span class="token key attr-name">    branchTable</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;branch_table&quot;</span>
<span class="token key attr-name">    lockTable</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;lock_table&quot;</span>
<span class="token key attr-name">    queryLimit</span> <span class="token punctuation">=</span> <span class="token value attr-value">100</span>
<span class="token key attr-name">    maxWait</span> <span class="token punctuation">=</span> <span class="token value attr-value">5000</span>
  }

<span class="token comment">  ## redis store property</span>
<span class="token key attr-name">  redis</span> <span class="token value attr-value">{</span>
<span class="token comment">    ## redis mode: single\u3001sentinel</span>
<span class="token key attr-name">    mode</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;single&quot;</span>
<span class="token comment">    ## single mode property</span>
<span class="token key attr-name">    single</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">      host</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;127.0.0.1&quot;</span>
<span class="token key attr-name">      port</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;6379&quot;</span>
    }
<span class="token comment">    ## sentinel mode property</span>
<span class="token key attr-name">    sentinel</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">      masterName</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;&quot;</span>
<span class="token comment">      ## such as &quot;10.28.235.65:26379,10.28.235.65:26380,10.28.235.65:26381&quot;</span>
<span class="token key attr-name">      sentinelHosts</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;&quot;</span>
    }
<span class="token key attr-name">    password</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;&quot;</span>
<span class="token key attr-name">    database</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;0&quot;</span>
<span class="token key attr-name">    minConn</span> <span class="token punctuation">=</span> <span class="token value attr-value">1</span>
<span class="token key attr-name">    maxConn</span> <span class="token punctuation">=</span> <span class="token value attr-value">10</span>
<span class="token key attr-name">    maxTotal</span> <span class="token punctuation">=</span> <span class="token value attr-value">100</span>
<span class="token key attr-name">    queryLimit</span> <span class="token punctuation">=</span> <span class="token value attr-value">100</span>
  }
}
<span class="token comment">## 1.4.2 \u7248\u672C\u9700\u8981\u81EA\u5DF1\u624B\u52A8\u589E\u52A0service\u6A21\u5757</span>
<span class="token key attr-name">service</span> <span class="token value attr-value">{</span>
<span class="token comment">  #vgroup-&gt;rgroup</span>
<span class="token key attr-name">  vgroup_mapping.my_test_tx_group</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;my_group&quot;    </span>
<span class="token comment">  #only support single node</span>
<span class="token key attr-name">  default.grouplist</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;127.0.0.1:8091&quot;</span>
<span class="token comment">  #degrade current not support</span>
<span class="token key attr-name">  enableDegrade</span> <span class="token punctuation">=</span> <span class="token value attr-value">false</span>
<span class="token comment">  #disable</span>
<span class="token key attr-name">  disable</span> <span class="token punctuation">=</span> <span class="token value attr-value">false</span>
<span class="token comment">  #unit ms,s,m,h,d represents milliseconds, seconds, minutes, hours, days, default permanent</span>
<span class="token key attr-name">  max.commit.retry.timeout</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;-1&quot;</span>
<span class="token key attr-name">  max.rollback.retry.timeout</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;-1&quot;</span>
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_1-3-2-\u6570\u636E\u5E93\u4E2D\u5EFA\u5E93\u5EFA\u8868" tabindex="-1"><a class="header-anchor" href="#_1-3-2-\u6570\u636E\u5E93\u4E2D\u5EFA\u5E93\u5EFA\u8868" aria-hidden="true">#</a> 1.3.2 \u6570\u636E\u5E93\u4E2D\u5EFA\u5E93\u5EFA\u8868</h6><p>\u6570\u636E\u5E93\u65B0\u5EFA\u5E93seata\uFF0C\u5EFA\u8868db_store.sql\u5728\\seata-server-0.9.0\\seata\\conf\u76EE\u5F55\u91CC\u9762</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636533282768-affabe76-a21f-4727-aa06-ded73aaa73cb.png" alt="img"></p><h6 id="_1-3-3-\u4FEE\u6539seata-server-0-9-0-seata-conf\u76EE\u5F55\u4E0B\u7684registry-conf\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_1-3-3-\u4FEE\u6539seata-server-0-9-0-seata-conf\u76EE\u5F55\u4E0B\u7684registry-conf\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> 1.3.3 \u4FEE\u6539seata-server-0.9.0\\seata\\conf\u76EE\u5F55\u4E0B\u7684registry.conf\u914D\u7F6E\u6587\u4EF6</h6><p>\u76EE\u7684\u662F\uFF1A\u6307\u660E\u6CE8\u518C\u4E2D\u5FC3\u4E3Anacos\uFF0C\u53CA\u4FEE\u6539nacos\u8FDE\u63A5\u4FE1\u606F</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636533822408-2ed7382f-c9ba-41f2-af4d-c7a7313b4c1a.png" alt="img"></p><h6 id="_1-3-4-\u542F\u52A8nacos\u548Cseata" tabindex="-1"><a class="header-anchor" href="#_1-3-4-\u542F\u52A8nacos\u548Cseata" aria-hidden="true">#</a> 1.3.4 \u542F\u52A8nacos\u548Cseata</h6><p>seata-server-0.9.0\\seata\\bin\\seata-server.bat</p><p>\u542F\u52A8\u5931\u8D25\uFF0C\u62A5\u9519\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636540085504-750df869-8d65-42d9-80af-30c3f4e927d5.png" alt="img"></p><p>\u89E3\u51B3\uFF1A0.9.0\u9ED8\u8BA4\u7684mysql\u662F5.1.30\u7248\u672C\uFF0C\u5C06lib\u6587\u4EF6\u5939\u4E0Bmysql-connector-java-5.1.30.jar\u5220\u9664\uFF0C\u66FF\u6362\u6210\u81EA\u5DF1mysql\u7248\u672C\u7684jar\u5305\uFF0C\u6211\u7684\u662Fmysql-connector-java-8.0.22.jar\u3002</p><p>\u518D\u6B21\u542F\u52A8\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636540290726-7072e4b8-6751-4779-9ed6-829a06a63ee6.png" alt="img"></p><p>\u51FA\u73B0\u8FD9\u4E9B\u63D0\u793A\u4FE1\u606F\u4EE3\u8868seata\u542F\u52A8\u6210\u529F\u3002</p><p>nacos\u4E2D\u6210\u529F\u6CE8\u518C\u4E86seate\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636540463325-cae9956d-6610-43ac-ae3c-60c81e803afc.png" alt="img"></p><h5 id="seata-1-4-2\u7248\u672C\u586B\u5751-nacos\u4F5C\u4E3Aseata\u7684\u6CE8\u518C-\u914D\u7F6E\u4E2D\u5FC3" tabindex="-1"><a class="header-anchor" href="#seata-1-4-2\u7248\u672C\u586B\u5751-nacos\u4F5C\u4E3Aseata\u7684\u6CE8\u518C-\u914D\u7F6E\u4E2D\u5FC3" aria-hidden="true">#</a> Seata 1.4.2\u7248\u672C\u586B\u5751---nacos\u4F5C\u4E3Aseata\u7684\u6CE8\u518C/\u914D\u7F6E\u4E2D\u5FC3</h5>`,32),Vt={href:"https://blog.csdn.net/weixin_44790046/article/details/106970822",target:"_blank",rel:"noopener noreferrer"},Qt=s("seata1.2.0"),zt=s(),Kt={href:"https://blog.csdn.net/jixieguang/article/details/110621561",target:"_blank",rel:"noopener noreferrer"},Yt=s("Seata1.4.0+nacos"),Xt=p('<p>Seata0.9.0\u7248\u672C\u4E0D\u652F\u6301\u96C6\u7FA4\uFF0C\u751F\u4EA7\u73AF\u5883\u4E0B\u9700\u8981\u4F7F\u75281.0.0\u4EE5\u4E0A\u7248\u672C\u3002\u6211\u4EEC\u8FD9\u91CC\u914D\u7F6Eseata\u7684\u6700\u65B0\u7248\u672C1.4.2\uFF0C\u4E0B\u8F7D\u540E\u6587\u4EF6\u76EE\u5F55\u5982\u4E0B\u56FE\u6240\u793A\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636963968461-50e5b2f3-d6e2-4156-bf95-09acb6ae7516.png" alt="img"></p><h6 id="_0-\u542F\u52A8nacos" tabindex="-1"><a class="header-anchor" href="#_0-\u542F\u52A8nacos" aria-hidden="true">#</a> 0. \u542F\u52A8nacos</h6><p>\u542F\u52A8nacos\uFF0C\u65B0\u5EFA\u4E00\u4E2A\u547D\u540D\u7A7A\u95F4seata\u7528\u4E8E\u5B58\u653Eseata\u7684\u914D\u7F6E\u4FE1\u606F\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637029808220-a37b6073-5157-410e-b0ac-a9ec6f165fd4.png" alt="img"></p><p>\u6CE8\u610F\u8FD9\u91CC\u7684\u547D\u540D\u7A7A\u95F4ID\uFF0C\u540E\u9762\u4F1A\u7528\u5230\u3002<strong>\u8FD9\u91CC\u4E0D\u65B0\u5EFA\u4E5F\u53EF\u4EE5\uFF0Cseata\u4F7F\u7528\u7684\u662Fpublic\u3002</strong></p><p><strong>\u6211\u4EEC\u4F7F\u7528nacos\u5145\u5F53seata\u7684\u6CE8\u518C\u4E2D\u5FC3\u548C\u914D\u7F6E\u4E2D\u5FC3\uFF01</strong></p><h6 id="_1-\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_1-\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> 1. \u4FEE\u6539\u914D\u7F6E\u6587\u4EF6</h6><p>######## \u2460\u8FDB\u5165conf\u6587\u4EF6\u5939\uFF0C\u4FEE\u6539file.conf\u6587\u4EF6</p><p>1.4.2\u7248\u672C\u53EF\u4EE5\u53C2\u8003file.conf.example(server\u7AEF)\u548Cconf\u6587\u4EF6\u5939\u4E0B<strong>README-zh.md\u4E2D\u7684client</strong>\u7AEF\u914D\u7F6E</p><p>\u603B\u5171\u9700\u8981\u4FEE\u6539\u7684\u5730\u65B9\uFF1A\u6211\u8FD9\u91CC\u7528seate_1_4_2\u6570\u636E\u5E93\u6765\u5BF9\u5E94seata1.4.2\u7248\u672C</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636978078529-61784d3f-4230-46b3-8612-1dc1b1f61152.png" alt="img"></p>',12),Wt=s("\u6700\u7EC8\u5B8C\u6574\u4EE3\u7801file.conf\uFF1A"),$t={href:"https://www.yuque.com/attachments/yuque/0/2021/txt/22423156/1636978207422-66810a14-f335-4a73-8dee-998f58dfcd7c.txt",target:"_blank",rel:"noopener noreferrer"},Jt=s("\u{1F4CE}file.conf.txt"),Zt=n("p",null,"######## \u2461\u4FEE\u6539conf\\registry.conf\u6587\u4EF6",-1),np=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636978611296-61ea13d9-ba2f-4343-a016-66f7ade007bd.png",alt:"img"})],-1),sp=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637047172825-51ffe35a-3d7b-451f-b7a9-4789089a03e4.png",alt:"img"})],-1),ap=n("p",null,[n("strong",null,"\u601D\u8003\uFF1A\u8FD9\u91CC\u6211\u4EEC\u628Aseata-server\u7AEF\u7684config\u8BBE\u7F6E\u4E3A\u4E86nacos\uFF0C\u90A3\u4E48\u662F\u4E0D\u662F\u7B2C\u4E00\u6B65\u7684file.conf\u6587\u4EF6\u5C31\u4E0D\u518D\u9700\u8981\u4E86\u3002\u56E0\u4E3A\u76F4\u63A5\u4ECEnacos\u8BFB\u53D6\u914D\u7F6E\uFF1F")],-1),tp=n("h6",{id:"_2-\u5C06\u914D\u7F6E\u5BFC\u5165\u5230nacos",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_2-\u5C06\u914D\u7F6E\u5BFC\u5165\u5230nacos","aria-hidden":"true"},"#"),s(" 2. \u5C06\u914D\u7F6E\u5BFC\u5165\u5230nacos")],-1),pp=n("p",null,"######## \u2460 \u51C6\u5907nacos-config.sh\u811A\u672C",-1),ep=s("\u5728conf\u6587\u4EF6\u5939\u4E0B\uFF0C\u9700\u8981\u6709\u4E2Anacos-config.sh\u6587\u4EF6\uFF0C\u8FD9\u4E2A\u6587\u4EF61.4.2\u7248\u672C\u6CA1\u6709\u3002README-zh.md\u6587\u4EF6\u4E2D\u8BBF\u95EE"),op=n("strong",null,"config-center",-1),cp=s("\u8D85\u94FE\u63A5\uFF08"),lp={href:"https://github.com/seata/seata/tree/develop/script/config-center%EF%BC%89%EF%BC%8Cnacos%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%EF%BC%9A",target:"_blank",rel:"noopener noreferrer"},ip=s("https://github.com/seata/seata/tree/develop/script/config-center\uFF09\uFF0Cnacos\u6587\u4EF6\u5939\u4E0B\uFF1A"),up=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636979042179-785512f7-9422-4f15-b316-78bc0cb8ca43.png",alt:"img"})],-1),kp=s("\u7528\u8FD9\u4E2A\u53EF\u4EE5\u76F4\u63A5\u4E0B\u5F53\u524D\u9875\u7684\u6587\u4EF6"),rp={href:"http://blog.luckly-mjw.cn/tool-show/github-directory-downloader/index.html",target:"_blank",rel:"noopener noreferrer"},dp=s("github-directory-downloader"),mp=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636979658725-0d097480-053f-4717-95f2-f0b517e69ee6.png",alt:"img"})],-1),gp={href:"https://www.yuque.com/attachments/yuque/0/2021/sh/22423156/1636979669265-dc8c3809-bc69-4326-95fb-06e2313bd41a.sh",target:"_blank",rel:"noopener noreferrer"},vp=s("\u{1F4CE}nacos-config.sh"),bp=p('<p>######## \u2461 config.txt\u51C6\u5907\u53CA\u4FEE\u6539</p><p>\u5728conf\u76EE\u5F55\u4E0B\u8FD8\u9700\u8981\u4E00\u4E2Aconfig.txt\u6587\u4EF6\uFF0C1.4.2\u7248\u672C\u540C\u6837\u6CA1\u6709\uFF0C\u8FD8\u662F\u53BBREADME\u91CC\u9762\u7684config-center\u8D85\u94FE\u63A5\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636979791988-612e5b27-d79c-4467-a096-28dd77757fdc.png" alt="img"></p><p>config.txt\u9700\u8981\u653E\u5728conf\u7684\u4E0A\u7EA7\u76EE\u5F55\u4E0B\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637047258914-56fed840-82ca-4b98-90e4-8776b0e8f350.png" alt="img"></p><p>\u4FEE\u6539config.txt\u6587\u4EF6\u4E2D\u7684\u5185\u5BB9\uFF0C\u4E3B\u8981\u662F\u4E0B\u9762\u8FD9\u51E0\u9879\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637047663366-547b68e5-66fc-4110-8336-61d030cc1656.png" alt="img"></p><p>\u6539\u4E3A\u4F7F\u7528db\u5B58\u50A8\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637047446901-badf8370-0ef1-46b7-ab5b-212198588148.png" alt="img"></p><p><strong>\u6CE8\u610F\u8FD9\u91CCstore.db.url\u4E2D\u6570\u636E\u5E93\u7684\u540D\u5B57\u5C31\u662F\u6211\u4EEC\u4E4B\u540E\u9700\u8981\u65B0\u5EFA\u7684\u6570\u636E\u5E93\u7684\u540D\u5B57\u3002</strong></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637060537507-74cbaa87-b363-4cf8-9345-f29a47c739c8.png" alt="img">\u76F8\u6BD4\u4E8E\u5176\u4ED6\u7248\u672C\uFF0C1.4.2\u8FD9\u91CC\u591A\u4E86\u4E2AdistributedLockTable\u3002</p><p>\u6574\u4E2Aconfig.txt\u6587\u4EF6\u4E2D\uFF0Cstore.publicKey\u3001store.redis.sentinel.masterName\u3001store.redis.sentinel.sentinelHosts\u3001store.redis.password\u56DB\u4E2A\u5C5E\u6027\u9ED8\u8BA4\u90FD\u662F\u7A7A\u7684<img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637047508781-a702d6a3-cf10-4ebc-9606-8f2c039c79dc.png" alt="img">\u3002\u6240\u4EE5\u540E\u9762\u5728\u5C06config.txt\u6587\u4EF6\u4E2D\u7684\u914D\u7F6E\u6CE8\u518C\u5230nacos\u7684\u65F6\u5019\uFF0C\u4F1A\u51FA\u73B0\u56DB\u4E2A\u5931\u8D25\u9879\u3002</p><p>######## \u2462 \u5BFC\u5165seata\u76F8\u5E94\u7684\u914D\u7F6E\u9879\u5230Nacos</p>',13),hp=s("config.txt\u5C31\u662Fseata\u5404\u79CD\u8BE6\u7EC6\u7684\u914D\u7F6E\uFF0C\u6267\u884Cnacos-config.sh\u5373\u53EF\u5C06\u8FD9\u4E9B\u914D\u7F6E\u5BFC\u5165\u5230nacos\u3002\u8FD9\u6837\u5C31\u4E0D\u9700\u8981\u5C06file.conf\u548Cregistry.conf\u653E\u5230\u6211\u4EEC\u7684\u9879\u76EE\u4E2D\u4E86\uFF0C\u9700\u8981\u4EC0\u4E48\u914D\u7F6E\u5C31\u76F4\u63A5\u4ECEnacos\u4E2D\u8BFB\u53D6\u3002\uFF08\u8FD9\u53E5\u8BDD\u662F\u53C2\u8003\u535A\u5BA2"),yp={href:"https://blog.csdn.net/jixieguang/article/details/110621561%EF%BC%8C%E6%88%91%E8%A7%89%E4%B8%8D%E5%AE%8C%E5%85%A8%E5%AF%B9%EF%BC%8C%E5%90%8E%E9%9D%A2registry.conf%E9%87%8C%E7%9A%84%E9%85%8D%E7%BD%AE%E9%A1%B9%E8%99%BD%E7%84%B6%E4%B8%8D%E9%9C%80%E8%A6%81.conf%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE%EF%BC%8C%E4%BD%86%E6%98%AF%E9%9C%80%E8%A6%81%E5%9C%A8yml%E6%88%96properties%E6%96%87%E4%BB%B6%E4%B8%AD%E9%85%8D%E7%BD%AE%EF%BC%8C%E8%80%8Cfile.conf%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E5%9C%A8nacos%E4%B8%AD%E8%AF%BB%E5%8F%96%EF%BC%89",target:"_blank",rel:"noopener noreferrer"},fp=s("https://blog.csdn.net/jixieguang/article/details/110621561\uFF0C\u6211\u89C9\u4E0D\u5B8C\u5168\u5BF9\uFF0C\u540E\u9762registry.conf\u91CC\u7684\u914D\u7F6E\u9879\u867D\u7136\u4E0D\u9700\u8981.conf\u6587\u4EF6\u914D\u7F6E\uFF0C\u4F46\u662F\u9700\u8981\u5728yml\u6216properties\u6587\u4EF6\u4E2D\u914D\u7F6E\uFF0C\u800Cfile.conf\u53EF\u4EE5\u76F4\u63A5\u5728nacos\u4E2D\u8BFB\u53D6\uFF09"),qp=p('<p>\u5BFC\u5165\u914D\u7F6E\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637061235108-cd9a6f20-4af7-43ae-853f-9c7dfca5463a.png" alt="img"></p><p>\u7136\u540E\u5728git bash\u754C\u9762\u8F93\u5165\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">sh</span> nacos-config.sh -h localhost -p <span class="token number">8848</span> -g SEATA_GROUP -t f0378218-b129-4fd8-839c-9bdfd010205b -u nacos -w nacos\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6CE8\uFF1Ah\u8868\u793Anacos\u7684\u5730\u5740\uFF0Cp\u8868\u793A\u7AEF\u53E3\u53F7\uFF0Cg\u8868\u793A\u914D\u7F6E\u7684\u5206\u7EC4\uFF0Ct\u8868\u793A\u547D\u540D\u7A7A\u95F4\u7684ID\uFF0Cu\u8DDFw\u8868\u793Anacos\u7684\u8D26\u6237\u5BC6\u7801\u3002\u5982\u679C\u6CA1\u6709\u8BBE\u7F6E\u547D\u540D\u7A7A\u95F4\uFF0C\u800C\u4E14\u90FD\u662F\u9ED8\u8BA4\u9009\u9879\u76F4\u63A5 <code>sh nacos-config.sh -h localhost</code>\u5C31\u884C\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637061534007-6fd0a49d-3739-45a5-99ec-716b0f42ce8b.png" alt="img"></p><p>\u53EF\u4EE5\u770B\u5230\u517198\u9879\uFF0C\u5BFC\u5165\u5931\u8D254\u9879\uFF0C\u5C31\u662F\u4E0A\u9762\u6CA1\u6709\u503C\u7684\u90A3\u56DB\u9879\uFF08\u4E0D\u5F71\u54CD\uFF0C\u5982\u679C\u7528\u5230\u76F4\u63A5\u5728nacos\u91CC\u9762\u65B0\u5EFA\u914D\u7F6E\u5373\u53EF\uFF09</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637061628150-648485a8-cafa-4442-8f24-c0f4d1f292f3.png" alt="img"></p><p>\u53EF\u4EE5\u770B\u5230\uFF0Cnacos\u7684seata\u547D\u540D\u7A7A\u95F4\u4E2D\u5DF2\u7ECF\u5BFC\u5165\u4E86\u914D\u7F6E\u9879\u3002\uFF08seata\u547D\u540D\u7A7A\u95F4\u662F\u6211\u81EA\u5DF1\u521B\u5EFA\u7684\uFF0C\u53EF\u4EE5\u6309\u81EA\u5DF1\u7684\u9700\u6C42\u521B\u5EFA\uFF0C\u4E0D\u521B\u5EFA\u9ED8\u8BA4\u7684\u5C31\u662Fpublic\u3002\uFF09</p><h6 id="_3-\u6570\u636E\u5E93\u4E2D\u5EFA\u5E93\u5EFA\u8868" tabindex="-1"><a class="header-anchor" href="#_3-\u6570\u636E\u5E93\u4E2D\u5EFA\u5E93\u5EFA\u8868" aria-hidden="true">#</a> 3. \u6570\u636E\u5E93\u4E2D\u5EFA\u5E93\u5EFA\u8868</h6><p>\u6211\u4EEC\u5148\u521B\u5EFA\u6570\u636E\u5E93seata1_4_2\uFF08\u6570\u636E\u5E93\u8981\u4E0Econfig.txt\u4E2Ddb\u8BBE\u7F6E\u90A3\u91CC\u5BF9\u5E94\uFF09\uFF0C\u6570\u636E\u5E93\u7684\u5EFA\u8868\u8BED\u53E5\u5728README\u6587\u4EF6\u7684server\u8FDE\u63A5\u4E2D\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636543057789-77a7f2ee-9448-4d64-8e4e-95a2b5e1d8c4.png" alt="img"></p><p>\u7136\u540E\u6267\u884Cmysql.sql\uFF081.4.2\u591A\u4E86\u4E2Adistributed_lock\u8868\uFF0C\u548C\u4E00\u4E9B\u63D2\u5165\u8BED\u53E5\uFF09\uFF1A</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- -------------------------------- The script used when storeMode is &#39;db&#39; --------------------------------</span>\n<span class="token comment">-- the table to store GlobalSession data</span>\n<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>global_table<span class="token punctuation">`</span></span>\n<span class="token punctuation">(</span>\n    <span class="token identifier"><span class="token punctuation">`</span>xid<span class="token punctuation">`</span></span>                       <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>transaction_id<span class="token punctuation">`</span></span>            <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span>                    <span class="token keyword">TINYINT</span>      <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>application_id<span class="token punctuation">`</span></span>            <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>transaction_service_group<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>transaction_name<span class="token punctuation">`</span></span>          <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>timeout<span class="token punctuation">`</span></span>                   <span class="token keyword">INT</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>begin_time<span class="token punctuation">`</span></span>                <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>application_data<span class="token punctuation">`</span></span>          <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span>                <span class="token keyword">DATETIME</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span>              <span class="token keyword">DATETIME</span><span class="token punctuation">,</span>\n    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>xid<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>idx_gmt_modified_status<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>idx_transaction_id<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>transaction_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span>\n  <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span> <span class="token operator">=</span> utf8<span class="token punctuation">;</span>\n\n<span class="token comment">-- the table to store BranchSession data</span>\n<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>branch_table<span class="token punctuation">`</span></span>\n<span class="token punctuation">(</span>\n    <span class="token identifier"><span class="token punctuation">`</span>branch_id<span class="token punctuation">`</span></span>         <span class="token keyword">BIGINT</span>       <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>xid<span class="token punctuation">`</span></span>               <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>transaction_id<span class="token punctuation">`</span></span>    <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>resource_group_id<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>resource_id<span class="token punctuation">`</span></span>       <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>branch_type<span class="token punctuation">`</span></span>       <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span>            <span class="token keyword">TINYINT</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>client_id<span class="token punctuation">`</span></span>         <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>application_data<span class="token punctuation">`</span></span>  <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span>        <span class="token keyword">DATETIME</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span>      <span class="token keyword">DATETIME</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>branch_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>idx_xid<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>xid<span class="token punctuation">`</span></span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span>\n  <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span> <span class="token operator">=</span> utf8<span class="token punctuation">;</span>\n\n<span class="token comment">-- the table to store lock data</span>\n<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>lock_table<span class="token punctuation">`</span></span>\n<span class="token punctuation">(</span>\n    <span class="token identifier"><span class="token punctuation">`</span>row_key<span class="token punctuation">`</span></span>        <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>xid<span class="token punctuation">`</span></span>            <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>transaction_id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>branch_id<span class="token punctuation">`</span></span>      <span class="token keyword">BIGINT</span>       <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>resource_id<span class="token punctuation">`</span></span>    <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>table_name<span class="token punctuation">`</span></span>     <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>pk<span class="token punctuation">`</span></span>             <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>gmt_create<span class="token punctuation">`</span></span>     <span class="token keyword">DATETIME</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>gmt_modified<span class="token punctuation">`</span></span>   <span class="token keyword">DATETIME</span><span class="token punctuation">,</span>\n    <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>row_key<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>idx_branch_id<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>branch_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span>\n  <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span> <span class="token operator">=</span> utf8<span class="token punctuation">;</span>\n\n<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>distributed_lock<span class="token punctuation">`</span></span>\n<span class="token punctuation">(</span>\n    <span class="token identifier"><span class="token punctuation">`</span>lock_key<span class="token punctuation">`</span></span>       <span class="token keyword">CHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>lock_value<span class="token punctuation">`</span></span>     <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>expire<span class="token punctuation">`</span></span>         <span class="token keyword">BIGINT</span><span class="token punctuation">,</span>\n    <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>lock_key<span class="token punctuation">`</span></span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span>\n  <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span> <span class="token operator">=</span> utf8mb4<span class="token punctuation">;</span>\n\n<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>distributed_lock<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>lock_key<span class="token punctuation">,</span> lock_value<span class="token punctuation">,</span> expire<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;AsyncCommitting&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>distributed_lock<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>lock_key<span class="token punctuation">,</span> lock_value<span class="token punctuation">,</span> expire<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;RetryCommitting&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>distributed_lock<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>lock_key<span class="token punctuation">,</span> lock_value<span class="token punctuation">,</span> expire<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;RetryRollbacking&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>distributed_lock<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>lock_key<span class="token punctuation">,</span> lock_value<span class="token punctuation">,</span> expire<span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;TxTimeoutCheck&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637062163704-a5352fe8-9d6d-4997-97c4-a09f41404864.png" alt="img">\uFF0C\u8FD9\u56DB\u5F20\u8868\u8DDFconfig.txt\u6587\u4EF6\u4E2D\u7684\u914D\u7F6E\u5BF9\u5E94\u3002</p><h6 id="_4-\u542F\u52A8seata" tabindex="-1"><a class="header-anchor" href="#_4-\u542F\u52A8seata" aria-hidden="true">#</a> 4. \u542F\u52A8seata</h6><p>\u8FD0\u884Cbin\u76EE\u5F55\u4E0B\u7684seata-server.bat\u3002</p><p>\u51FA\u73B0\u4E0B\u9762\u5B57\u6BB5\u8868\u793Aseata\u542F\u52A8\u6210\u529F\u3002seata\u542F\u52A8\u65E5\u5FD7\u5728C:\\Users\\admin\\logs\\seata\u6587\u4EF6\u5939\u4E0B\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636544358754-13d5bceb-8223-4f92-8fe1-7e196e59906d.png" alt="img"></p><p>nacos\u4E2D\u5728seata\u547D\u540D\u7A7A\u95F4\u5185\u4E5F\u6210\u529F\u6CE8\u518C\uFF0C\u6CE8\u610F\u8FD9\u91CC\u670D\u52A1\u540D\u5BF9\u5E94\u7684\u662Fregistry.conf\u6587\u4EF6\u4E2Dnacos\u4E0B\u9762application\u7684\u503C\u30020.9.0\u7248\u672C\u597D\u50CF\u8BBE\u7F6E\u4E0D\u4E86\u8FD9\u4E2A\uFF0C\u9ED8\u8BA4\u662FserverAddr\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637062927719-91dd19dc-bf55-4d31-975a-f3a4d9225f59.png" alt="img"></p><h3 id="\u4E8C\u3001\u8BA2\u5355-\u5E93\u5B58-\u8D26\u6237\u4E1A\u52A1\u6570\u636E\u5E93\u51C6\u5907" tabindex="-1"><a class="header-anchor" href="#\u4E8C\u3001\u8BA2\u5355-\u5E93\u5B58-\u8D26\u6237\u4E1A\u52A1\u6570\u636E\u5E93\u51C6\u5907" aria-hidden="true">#</a> \u4E8C\u3001\u8BA2\u5355/\u5E93\u5B58/\u8D26\u6237\u4E1A\u52A1\u6570\u636E\u5E93\u51C6\u5907</h3><p>\u4EE5\u4E0B\u6F14\u793A\u90FD\u9700\u8981\u5148\u542F\u52A8Nacos\u540E\u542F\u52A8Seata\uFF0C\u4FDD\u8BC1\u4E24\u4E2A\u90FDOK\u3002Seata\u6CA1\u542F\u52A8\u62A5\u9519no available server to connect\u3002</p><h5 id="_2-1-\u5206\u5E03\u5F0F\u4E8B\u52A1\u4E1A\u52A1\u8BF4\u660E" tabindex="-1"><a class="header-anchor" href="#_2-1-\u5206\u5E03\u5F0F\u4E8B\u52A1\u4E1A\u52A1\u8BF4\u660E" aria-hidden="true">#</a> 2.1 \u5206\u5E03\u5F0F\u4E8B\u52A1\u4E1A\u52A1\u8BF4\u660E</h5><p>\u8FD9\u91CC\u6211\u4EEC\u4F1A\u521B\u5EFA\u4E09\u4E2A\u670D\u52A1\uFF0C\u4E00\u4E2A\u8BA2\u5355\u670D\u52A1\uFF0C\u4E00\u4E2A\u5E93\u5B58\u670D\u52A1\uFF0C\u4E00\u4E2A\u8D26\u6237\u670D\u52A1\u3002</p><p>\u5F53\u7528\u6237\u4E0B\u5355\u65F6\uFF0C\u4F1A\u5728\u8BA2\u5355\u670D\u52A1\u4E2D\u521B\u5EFA\u4E00\u4E2A\u8BA2\u5355\uFF0C\u7136\u540E\u901A\u8FC7\u8FDC\u7A0B\u8C03\u7528\u5E93\u5B58\u670D\u52A1\u6765\u6263\u51CF\u4E0B\u5355\u5546\u54C1\u7684\u5E93\u5B58\uFF0C\u518D\u901A\u8FC7\u8FDC\u7A0B\u8C03\u7528\u8D26\u6237\u670D\u52A1\u6765\u6263\u51CF\u7528\u6237\u8D26\u6237\u91CC\u9762\u7684\u4F59\u989D\uFF0C\u6700\u540E\u5728\u8BA2\u5355\u670D\u52A1\u4E2D\u4FEE\u6539\u8BA2\u5355\u72B6\u6001\u4E3A\u5DF2\u5B8C\u6210\u3002</p><p>\u8BE5\u64CD\u4F5C\u8DE8\u8D8A\u4E09\u4E2A\u6570\u636E\u5E93\uFF0C\u6709\u4E24\u6B21\u8FDC\u7A0B\u8C03\u7528\uFF0C\u5F88\u660E\u663E\u4F1A\u6709\u5206\u5E03\u5F0F\u4E8B\u52A1\u95EE\u9898\u3002</p><p>\u4E0B\u8BA2\u5355---&gt;\u6263\u5E93\u5B58---&gt;\u51CF\u8D26\u6237(\u4F59\u989D)</p><h5 id="_2-2-\u521B\u5EFA\u4E1A\u52A1\u6570\u636E\u5E93\u4E0E\u8868" tabindex="-1"><a class="header-anchor" href="#_2-2-\u521B\u5EFA\u4E1A\u52A1\u6570\u636E\u5E93\u4E0E\u8868" aria-hidden="true">#</a> 2.2 \u521B\u5EFA\u4E1A\u52A1\u6570\u636E\u5E93\u4E0E\u8868</h5><h6 id="_1-\u521B\u5EFA\u4E1A\u52A1\u6570\u636E\u5E93" tabindex="-1"><a class="header-anchor" href="#_1-\u521B\u5EFA\u4E1A\u52A1\u6570\u636E\u5E93" aria-hidden="true">#</a> 1. \u521B\u5EFA\u4E1A\u52A1\u6570\u636E\u5E93</h6><ul><li>seata_order\uFF1A\u5B58\u50A8\u8BA2\u5355\u7684\u6570\u636E\u5E93\uFF1B</li><li>seata_storage\uFF1A\u5B58\u50A8\u5E93\u5B58\u7684\u6570\u636E\u5E93\uFF1B</li><li>seata_account\uFF1A\u5B58\u50A8\u8D26\u6237\u4FE1\u606F\u7684\u6570\u636E\u5E93\u3002</li></ul><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> seata_order<span class="token punctuation">;</span>\n \n<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> seata_storage<span class="token punctuation">;</span>\n \n<span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> seata_account<span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_2-\u6309\u7167\u4E0A\u8FF03\u5E93\u5206\u522B\u521B\u5EFA\u5BF9\u5E94\u4E1A\u52A1\u8868" tabindex="-1"><a class="header-anchor" href="#_2-\u6309\u7167\u4E0A\u8FF03\u5E93\u5206\u522B\u521B\u5EFA\u5BF9\u5E94\u4E1A\u52A1\u8868" aria-hidden="true">#</a> 2. \u6309\u7167\u4E0A\u8FF03\u5E93\u5206\u522B\u521B\u5EFA\u5BF9\u5E94\u4E1A\u52A1\u8868</h6><p>seata_order\u5E93\u4E0B\u5EFAt_order\u8868\uFF1A</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> seata_order<span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>t_order<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>\n  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u7528\u6237id&#39;</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>product_id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u4EA7\u54C1id&#39;</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>count<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u6570\u91CF&#39;</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>money<span class="token punctuation">`</span></span> <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u91D1\u989D&#39;</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>status<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u8BA2\u5355\u72B6\u6001\uFF1A0\uFF1A\u521B\u5EFA\u4E2D\uFF1B1\uFF1A\u5DF2\u5B8C\u7ED3&#39;</span> \n<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">INNODB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">7</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>seata_storage\u5E93\u4E0B\u5EFAt_storage \u8868:</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>seata_storage<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>t_storage<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>\n <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>\n <span class="token identifier"><span class="token punctuation">`</span>product_id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u4EA7\u54C1id&#39;</span><span class="token punctuation">,</span>\n <span class="token identifier"><span class="token punctuation">`</span>total<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u603B\u5E93\u5B58&#39;</span><span class="token punctuation">,</span>\n <span class="token identifier"><span class="token punctuation">`</span>used<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u5DF2\u7528\u5E93\u5B58&#39;</span><span class="token punctuation">,</span>\n <span class="token identifier"><span class="token punctuation">`</span>residue<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u5269\u4F59\u5E93\u5B58&#39;</span>\n<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">INNODB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>\n \n \n<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> seata_storage<span class="token punctuation">.</span>t_storage<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>product_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>total<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>used<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>residue<span class="token punctuation">`</span></span><span class="token punctuation">)</span>\n<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;100&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;100&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>seata_account\u5E93\u4E0B\u5EFAt_account \u8868:</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>seata_account<span class="token punctuation">`</span></span><span class="token punctuation">.</span>t_account <span class="token punctuation">(</span>\n  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u7528\u6237id&#39;</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>total<span class="token punctuation">`</span></span> <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u603B\u989D\u5EA6&#39;</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>used<span class="token punctuation">`</span></span> <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u5DF2\u7528\u4F59\u989D&#39;</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>residue<span class="token punctuation">`</span></span> <span class="token keyword">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token string">&#39;0&#39;</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;\u5269\u4F59\u53EF\u7528\u989D\u5EA6&#39;</span>\n<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">INNODB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">2</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>\n \n<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> seata_account<span class="token punctuation">.</span>t_account<span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>total<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>used<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>residue<span class="token punctuation">`</span></span><span class="token punctuation">)</span>  <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;1000&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;1000&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_3-\u6309\u7167\u4E0A\u8FF03\u5E93\u5206\u522B\u5EFA\u5BF9\u5E94\u7684\u56DE\u6EDA\u65E5\u5FD7\u8868" tabindex="-1"><a class="header-anchor" href="#_3-\u6309\u7167\u4E0A\u8FF03\u5E93\u5206\u522B\u5EFA\u5BF9\u5E94\u7684\u56DE\u6EDA\u65E5\u5FD7\u8868" aria-hidden="true">#</a> 3. \u6309\u7167\u4E0A\u8FF03\u5E93\u5206\u522B\u5EFA\u5BF9\u5E94\u7684\u56DE\u6EDA\u65E5\u5FD7\u8868</h6><p>\u8BA2\u5355-\u5E93\u5B58-\u8D26\u62373\u4E2A\u5E93\u4E0B\u90FD\u9700\u8981\u5EFA\u5404\u81EA\u7684\u56DE\u6EDA\u65E5\u5FD7\u8868\uFF0C\\seata-server-0.9.0\\seata\\conf\u76EE\u5F55\u4E0B\u7684db_undo_log.sql\uFF1B1.4.2\u7248\u672C\u7684\u5728README_ZH\u6587\u4EF6\u4E2D\u7684client\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636548279472-a160bd9b-045f-4a31-93ab-6e56480ae2f6.png" alt="img"><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636548287477-760e3369-f841-4a74-8c07-c51cc4a2c77f.png" alt="img"></p><p>**\u6CE8\u610F\uFF1A**<strong>0.9\u7248\u672C\u8DDF1.4.2\u7248\u672C\u7684undo_log\u8868\u7684\u5C5E\u6027\u6709\u5DEE\u522B\uFF0C<strong><strong>1.4.2\u7248\u672C\u6CA1\u6709id\u8DDFext\u8FD9\u4E24\u4E2A\u5C5E\u6027</strong></strong>\uFF0C\u4E2A\u4EBA\u89C9\u5F97\u4F7F\u7528\u4E0A\u6CA1\u6709\u5F71\u54CD</strong></p><p>\u8FD9\u91CC\u7684\u8BDD\u6211\u8FD8\u662F\u63090.9.0\u7248\u672C\u6765\u5EFA\u8868\u3002</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># 0.9.0 \u7248\u672C</span>\n<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>undo_log<span class="token punctuation">`</span></span><span class="token punctuation">;</span>\n<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>undo_log<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>\n  <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>branch_id<span class="token punctuation">`</span></span> <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>xid<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>context<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>rollback_info<span class="token punctuation">`</span></span> <span class="token keyword">LONGBLOB</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>log_status<span class="token punctuation">`</span></span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>log_created<span class="token punctuation">`</span></span> <span class="token keyword">DATETIME</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>log_modified<span class="token punctuation">`</span></span> <span class="token keyword">DATETIME</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n  <span class="token identifier"><span class="token punctuation">`</span>ext<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>\n  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n  <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>ux_undo_log<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>xid<span class="token punctuation">`</span></span><span class="token punctuation">,</span><span class="token identifier"><span class="token punctuation">`</span>branch_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">INNODB</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span>\n\n<span class="token comment"># 1.4.2\u7248\u672C</span>\n<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>undo_log<span class="token punctuation">`</span></span><span class="token punctuation">;</span>\n<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token identifier"><span class="token punctuation">`</span>undo_log<span class="token punctuation">`</span></span>\n<span class="token punctuation">(</span>\n    <span class="token identifier"><span class="token punctuation">`</span>branch_id<span class="token punctuation">`</span></span>     <span class="token keyword">BIGINT</span>       <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;branch transaction id&#39;</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>xid<span class="token punctuation">`</span></span>           <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;global transaction id&#39;</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>context<span class="token punctuation">`</span></span>       <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;undo_log context,such as serialization&#39;</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>rollback_info<span class="token punctuation">`</span></span> <span class="token keyword">LONGBLOB</span>     <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;rollback info&#39;</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>log_status<span class="token punctuation">`</span></span>    <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>      <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;0:normal status,1:defense status&#39;</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>log_created<span class="token punctuation">`</span></span>   <span class="token keyword">DATETIME</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>  <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;create datetime&#39;</span><span class="token punctuation">,</span>\n    <span class="token identifier"><span class="token punctuation">`</span>log_modified<span class="token punctuation">`</span></span>  <span class="token keyword">DATETIME</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>  <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;modify datetime&#39;</span><span class="token punctuation">,</span>\n    <span class="token keyword">UNIQUE</span> <span class="token keyword">KEY</span> <span class="token identifier"><span class="token punctuation">`</span>ux_undo_log<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>xid<span class="token punctuation">`</span></span><span class="token punctuation">,</span> <span class="token identifier"><span class="token punctuation">`</span>branch_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span>\n  <span class="token keyword">AUTO_INCREMENT</span> <span class="token operator">=</span> <span class="token number">1</span>\n  <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span> <span class="token operator">=</span> utf8 <span class="token keyword">COMMENT</span> <span class="token operator">=</span><span class="token string">&#39;AT transaction mode undo table&#39;</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6700\u7EC8\u6548\u679C\uFF1A \u8FD9\u91CC\u5C55\u793A\u4E861.4.2\u7248\u672C\u8DDF0.9\u7248\u672C\uFF0C\u5B9E\u9645\u4E2D\u7528\u4E00\u4E2A\u5C31\u884C\uFF0C\u522B\u7684\u7248\u672C\u4E00\u6837\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636548808495-fa194c4f-7fc4-4863-871d-b044e93b9500.png" alt="img"></p><h3 id="\u4E09\u3001\u8BA2\u5355-\u5E93\u5B58-\u8D26\u6237\u4E1A\u52A1\u5FAE\u670D\u52A1\u51C6\u5907" tabindex="-1"><a class="header-anchor" href="#\u4E09\u3001\u8BA2\u5355-\u5E93\u5B58-\u8D26\u6237\u4E1A\u52A1\u5FAE\u670D\u52A1\u51C6\u5907" aria-hidden="true">#</a> \u4E09\u3001\u8BA2\u5355/\u5E93\u5B58/\u8D26\u6237\u4E1A\u52A1\u5FAE\u670D\u52A1\u51C6\u5907</h3><p>\u4E1A\u52A1\u9700\u6C42\uFF1A\u4E0B\u8BA2\u5355-&gt;\u51CF\u5E93\u5B58-&gt;\u6263\u4F59\u989D-&gt;\u6539(\u8BA2\u5355)\u72B6\u6001</p><hr><h5 id="\u7248\u672C\u5BF9\u5E94\u5173\u7CFB\u2014\u2014\u5F88\u91CD\u8981" tabindex="-1"><a class="header-anchor" href="#\u7248\u672C\u5BF9\u5E94\u5173\u7CFB\u2014\u2014\u5F88\u91CD\u8981" aria-hidden="true">#</a> \u7248\u672C\u5BF9\u5E94\u5173\u7CFB\u2014\u2014\u5F88\u91CD\u8981</h5>',51),wp=s("**\u6CE8\u610F\uFF1A**\u7531\u4E8Eseata0.9.0\u7248\u672C\u8DDF1.0\u4E4B\u540E\u7684\u7248\u672C\uFF08\u652F\u6301yml\u3001properties\u914D\u7F6E\uFF09\u533A\u522B\u5DE8\u5927\uFF0C\u8FD9\u91CC\u4F7F\u75280.9.0\u7248\u672C\uFF08\u8DDF\u89C6\u9891\u4E00\u81F4\uFF09\uFF0C\u5176\u7248\u672C\u5BF9\u5E94\u5173\u7CFB\u89C1"),_p={href:"https://github.com/alibaba/spring-cloud-alibaba/wiki/%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E",target:"_blank",rel:"noopener noreferrer"},xp=s("\u7248\u672C\u8BF4\u660E"),Ip=s("\u3002\uFF08"),Sp=n("strong",null,"seata0.9.0 + nacos 1.1.4 + sentinel 1.7.0 + SpringCloud Alibaba 2.1.1RELEASE",-1),Ep=s("\uFF09\u524D\u9762\u7528\u7684\u5404\u7EC4\u4EF6\u7248\u672C\u5F97\u5BF9\u5E94\u4E0A\uFF08\u5934\u75BC\uFF09"),Ap=p(`<h5 id="_3-1-\u65B0\u5EFA\u8BA2\u5355order-module\u2014\u2014seata-order-service2001" tabindex="-1"><a class="header-anchor" href="#_3-1-\u65B0\u5EFA\u8BA2\u5355order-module\u2014\u2014seata-order-service2001" aria-hidden="true">#</a> 3.1 \u65B0\u5EFA\u8BA2\u5355Order-Module\u2014\u2014seata-order-service2001</h5><p>\u65B0\u5EFAseata-order-service2001</p><h6 id="_1-pom-2" tabindex="-1"><a class="header-anchor" href="#_1-pom-2" aria-hidden="true">#</a> (1) pom</h6><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jdk8cloud2021<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>seata-order-service2001<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--nacos--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--seata--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- \u56E0\u4E3A\u517C\u5BB9\u7248\u672C\u95EE\u9898,\u6240\u4EE5\u9700\u8981\u5254\u9664\u5B83\u81EA\u5E26\u7684seata\u7684\u5305 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>seata-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
     		<span class="token comment">&lt;!-- \u8981\u8DDF\u6211\u4EEC\u5B89\u88C5SeaTa\u7684\u4E00\u81F4\uFF01 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>seata-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.9.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--feign--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--web-actuator--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--mysql-druid--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.22<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>druid-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.1.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_2-application-yml" tabindex="-1"><a class="header-anchor" href="#_2-application-yml" aria-hidden="true">#</a> (2) application.yml</h6><p>\u8FD9\u91CC\u914D\u7F6E\u7684\u662F\u6211\u4EEC\u81EA\u5DF1\u5FAE\u670D\u52A1\u7684\u6570\u636E\u6E90</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">2001</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> seata<span class="token punctuation">-</span>order<span class="token punctuation">-</span>service
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">alibaba</span><span class="token punctuation">:</span>
      <span class="token key atrule">seata</span><span class="token punctuation">:</span>
        <span class="token comment">#\u81EA\u5B9A\u4E49\u4E8B\u52A1\u7EC4\u540D\u79F0\u9700\u8981\u4E0Eseata-server\u4E2Dfile.conf\u4E2D\u914D\u7F6E\u7684\u4E8B\u52A1\u7EC4ID\u5BF9\u5E94</span>
        <span class="token comment">#vgroup_mapping.my_test_tx_group = &quot;my_group&quot;</span>
        <span class="token key atrule">tx-service-group</span><span class="token punctuation">:</span> my_group
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/seata_order<span class="token punctuation">?</span>useUnicode=true<span class="token important">&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=UTC</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">10086</span>

<span class="token key atrule">feign</span><span class="token punctuation">:</span>
  <span class="token key atrule">hystrix</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>

<span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">io</span><span class="token punctuation">:</span>
      <span class="token key atrule">seata</span><span class="token punctuation">:</span> info

<span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token key atrule">mapperLocations</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>mapper/<span class="token important">*.xml</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_3-file-conf" tabindex="-1"><a class="header-anchor" href="#_3-file-conf" aria-hidden="true">#</a> (3) file.conf</h6><p>\u7A0B\u5E8F\u4E2D\u4F9D\u8D56\u7684\u662F seata-all\uFF0C\u5BF9\u5E94\u4E8E *.conf \u6587\u4EF6\uFF0C\u6240\u4EE5\u9700\u8981\u5728resource\u65B0\u5EFA.conf\u6587\u4EF6\uFF0C\u9AD8\u7248\u672C\u7684\u652F\u6301yml\u3001properties\u914D\u7F6E\u3002\u8FD9\u91CC\u4EC5\u4EC5\u662Fseata-order-service2001\u6A21\u5757\u7684file.conf\uFF08\u914D\u7F6E2001\u7684\u5206\u5E03\u5F0F\u4E8B\u52A1\uFF09\uFF0Cseata\u8F6F\u4EF6\u90A3\u91CC\u914D\u7F6E\u7684\u662F\u603B\u63A7file.conf\u3002</p><p>\u6CE8\u610F\u4FEE\u6539\u8FD9\u4E24\u5904\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636715541883-b0548d85-0e4a-440e-821b-f07c2d75f270.png" alt="img"></p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">transport</span> <span class="token value attr-value">{</span>
<span class="token comment">  # tcp udt unix-domain-socket</span>
<span class="token key attr-name">  type</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;TCP&quot;</span>
<span class="token comment">  #NIO NATIVE</span>
<span class="token key attr-name">  server</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;NIO&quot;</span>
<span class="token comment">  #enable heartbeat</span>
<span class="token key attr-name">  heartbeat</span> <span class="token punctuation">=</span> <span class="token value attr-value">true</span>
<span class="token comment">  #thread factory for netty</span>
<span class="token key attr-name">  thread-factory</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    boss-thread-prefix</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;NettyBoss&quot;</span>
<span class="token key attr-name">    worker-thread-prefix</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;NettyServerNIOWorker&quot;</span>
<span class="token key attr-name">    server-executor-thread-prefix</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;NettyServerBizHandler&quot;</span>
<span class="token key attr-name">    share-boss-worker</span> <span class="token punctuation">=</span> <span class="token value attr-value">false</span>
<span class="token key attr-name">    client-selector-thread-prefix</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;NettyClientSelector&quot;</span>
<span class="token key attr-name">    client-selector-thread-size</span> <span class="token punctuation">=</span> <span class="token value attr-value">1</span>
<span class="token key attr-name">    client-worker-thread-prefix</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;NettyClientWorkerThread&quot;</span>
<span class="token comment">    # netty boss thread size,will not be used for UDT</span>
<span class="token key attr-name">    boss-thread-size</span> <span class="token punctuation">=</span> <span class="token value attr-value">1</span>
<span class="token comment">    #auto default pin or 8</span>
<span class="token key attr-name">    worker-thread-size</span> <span class="token punctuation">=</span> <span class="token value attr-value">8</span>
  }
<span class="token key attr-name">  shutdown</span> <span class="token value attr-value">{</span>
<span class="token comment">    # when destroy server, wait seconds</span>
<span class="token key attr-name">    wait</span> <span class="token punctuation">=</span> <span class="token value attr-value">3</span>
  }
<span class="token key attr-name">  serialization</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;seata&quot;</span>
<span class="token key attr-name">  compressor</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;none&quot;</span>
}

<span class="token key attr-name">service</span> <span class="token value attr-value">{</span>
<span class="token comment">  #\u4FEE\u6539\u81EA\u5B9A\u4E49\u4E8B\u52A1\u7EC4\u540D\u79F0\uFF0C\u8FD9\u91CC\u8DDF\u5728seata\u91CC\u914D\u7F6E\u7684\u4E0D\u4E00\u6837\uFF0C\u8FD9\u91CC\u53EA\u9488\u5BF92001\u81EA\u5DF1\u7684\u4E8B\u52A1\uFF0C</span>
<span class="token comment">  #\u800Cseata\u91CC\u9488\u5BF9\u7684\u662F\u6574\u4E2A\u5206\u5E03\u5F0F\u5168\u5C40\u4E8B\u52A1</span>
<span class="token comment">  #\u8FD9\u91CC\u8981\u6CE8\u610F vgroup_mapping. \u540E\u9762\u7684\u503C\uFF0C\u8981\u8DDFseata-server\u5B89\u88C5\u65F6 conf \u6587\u4EF6\u5939\u4E0Bfile.conf service\u6A21\u5757\u8BBE\u5B9A\u7684</span>
<span class="token comment">  #vgroup_mapping.my_test_tx_group = &quot;my_group&quot;</span>
<span class="token key attr-name">  vgroup_mapping.my_group</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;default&quot;</span>

<span class="token key attr-name">  default.grouplist</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;127.0.0.1:8091&quot;</span>
<span class="token key attr-name">  enableDegrade</span> <span class="token punctuation">=</span> <span class="token value attr-value">false</span>
<span class="token key attr-name">  disable</span> <span class="token punctuation">=</span> <span class="token value attr-value">false</span>
<span class="token key attr-name">  max.commit.retry.timeout</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;-1&quot;</span>
<span class="token key attr-name">  max.rollback.retry.timeout</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;-1&quot;</span>
<span class="token key attr-name">  disableGlobalTransaction</span> <span class="token punctuation">=</span> <span class="token value attr-value">false</span>
}


<span class="token key attr-name">client</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">  async.commit.buffer.limit</span> <span class="token punctuation">=</span> <span class="token value attr-value">10000</span>
<span class="token key attr-name">  lock</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    retry.internal</span> <span class="token punctuation">=</span> <span class="token value attr-value">10</span>
<span class="token key attr-name">    retry.times</span> <span class="token punctuation">=</span> <span class="token value attr-value">30</span>
  }
<span class="token key attr-name">  report.retry.count</span> <span class="token punctuation">=</span> <span class="token value attr-value">5</span>
<span class="token key attr-name">  tm.commit.retry.count</span> <span class="token punctuation">=</span> <span class="token value attr-value">1</span>
<span class="token key attr-name">  tm.rollback.retry.count</span> <span class="token punctuation">=</span> <span class="token value attr-value">1</span>
}

<span class="token comment">## transaction log store</span>
<span class="token key attr-name">store</span> <span class="token value attr-value">{</span>
<span class="token comment">  ## store mode: file\u3001db</span>
<span class="token key attr-name">  mode</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;db&quot;</span>

<span class="token comment">  ## file store</span>
<span class="token key attr-name">  file</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    dir</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;sessionStore&quot;</span>

<span class="token comment">    # branch session size , if exceeded first try compress lockkey, still exceeded throws exceptions</span>
<span class="token key attr-name">    max-branch-session-size</span> <span class="token punctuation">=</span> <span class="token value attr-value">16384</span>
<span class="token comment">    # globe session size , if exceeded throws exceptions</span>
<span class="token key attr-name">    max-global-session-size</span> <span class="token punctuation">=</span> <span class="token value attr-value">512</span>
<span class="token comment">    # file buffer size , if exceeded allocate new buffer</span>
<span class="token key attr-name">    file-write-buffer-cache-size</span> <span class="token punctuation">=</span> <span class="token value attr-value">16384</span>
<span class="token comment">    # when recover batch read size</span>
<span class="token key attr-name">    session.reload.read_size</span> <span class="token punctuation">=</span> <span class="token value attr-value">100</span>
<span class="token comment">    # async, sync</span>
<span class="token key attr-name">    flush-disk-mode</span> <span class="token punctuation">=</span> <span class="token value attr-value">async</span>
  }

<span class="token comment">  ## database store</span>
<span class="token key attr-name">  db</span> <span class="token value attr-value">{</span>
<span class="token comment">    ## the implement of javax.sql.DataSource, such as DruidDataSource(druid)/BasicDataSource(dbcp) etc.</span>
<span class="token key attr-name">    datasource</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;dbcp&quot;</span>
<span class="token comment">    ## mysql/oracle/h2/oceanbase etc.</span>
<span class="token key attr-name">    db-type</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;mysql&quot;</span>
<span class="token comment">    ## \u8FD9\u91CC\u8981\u6CE8\u610Fmysql5\u8DDFmysql8\u4E0D\u4E00\u6837</span>
<span class="token key attr-name">    driver-class-name</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;com.mysql.cj.jdbc.Driver&quot;</span>
<span class="token key attr-name">    url</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;jdbc:mysql://127.0.0.1:3306/seata?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=UTC&quot;</span>
<span class="token key attr-name">    user</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;root&quot;</span>
<span class="token key attr-name">    password</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;10086&quot;</span>
<span class="token key attr-name">    min-conn</span> <span class="token punctuation">=</span> <span class="token value attr-value">1</span>
<span class="token key attr-name">    max-conn</span> <span class="token punctuation">=</span> <span class="token value attr-value">3</span>
<span class="token key attr-name">    global.table</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;global_table&quot;</span>
<span class="token key attr-name">    branch.table</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;branch_table&quot;</span>
<span class="token key attr-name">    lock-table</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;lock_table&quot;</span>
<span class="token key attr-name">    query-limit</span> <span class="token punctuation">=</span> <span class="token value attr-value">100</span>
  }
}
<span class="token key attr-name">lock</span> <span class="token value attr-value">{</span>
<span class="token comment">  ## the lock store mode: local\u3001remote</span>
<span class="token key attr-name">  mode</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;remote&quot;</span>

<span class="token key attr-name">  local</span> <span class="token value attr-value">{</span>
<span class="token comment">    ## store locks in user&#39;s database</span>
  }

<span class="token key attr-name">  remote</span> <span class="token value attr-value">{</span>
<span class="token comment">    ## store locks in the seata&#39;s server</span>
  }
}
<span class="token key attr-name">recovery</span> <span class="token value attr-value">{</span>
<span class="token comment">  #schedule committing retry period in milliseconds</span>
<span class="token key attr-name">  committing-retry-period</span> <span class="token punctuation">=</span> <span class="token value attr-value">1000</span>
<span class="token comment">  #schedule asyn committing retry period in milliseconds</span>
<span class="token key attr-name">  asyn-committing-retry-period</span> <span class="token punctuation">=</span> <span class="token value attr-value">1000</span>
<span class="token comment">  #schedule rollbacking retry period in milliseconds</span>
<span class="token key attr-name">  rollbacking-retry-period</span> <span class="token punctuation">=</span> <span class="token value attr-value">1000</span>
<span class="token comment">  #schedule timeout retry period in milliseconds</span>
<span class="token key attr-name">  timeout-retry-period</span> <span class="token punctuation">=</span> <span class="token value attr-value">1000</span>
}

<span class="token key attr-name">transaction</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">  undo.data.validation</span> <span class="token punctuation">=</span> <span class="token value attr-value">true</span>
<span class="token key attr-name">  undo.log.serialization</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;jackson&quot;</span>
<span class="token key attr-name">  undo.log.save.days</span> <span class="token punctuation">=</span> <span class="token value attr-value">7</span>
<span class="token comment">  #schedule delete expired undo_log in milliseconds</span>
<span class="token key attr-name">  undo.log.delete.period</span> <span class="token punctuation">=</span> <span class="token value attr-value">86400000</span>
<span class="token key attr-name">  undo.log.table</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;undo_log&quot;</span>
}

<span class="token comment">## metrics settings</span>
<span class="token key attr-name">metrics</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">  enabled</span> <span class="token punctuation">=</span> <span class="token value attr-value">false</span>
<span class="token key attr-name">  registry-type</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;compact&quot;</span>
<span class="token comment">  # multi exporters use comma divided</span>
<span class="token key attr-name">  exporter-list</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;prometheus&quot;</span>
<span class="token key attr-name">  exporter-prometheus-port</span> <span class="token punctuation">=</span> <span class="token value attr-value">9898</span>
}

<span class="token key attr-name">support</span> <span class="token value attr-value">{</span>
<span class="token comment">  ## spring</span>
<span class="token key attr-name">  spring</span> <span class="token value attr-value">{</span>
<span class="token comment">    # auto proxy the DataSource bean</span>
<span class="token key attr-name">    datasource.autoproxy</span> <span class="token punctuation">=</span> <span class="token value attr-value">false</span>
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u51E0\u4E2A\u914D\u7F6E\u6587\u4EF6\u5BF9\u5E94\u5173\u7CFB</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636715439474-c19e0db9-7d20-41f3-acba-898bb1071b32.png" alt="img"></p><h6 id="_4-registry-conf" tabindex="-1"><a class="header-anchor" href="#_4-registry-conf" aria-hidden="true">#</a> (4) registry.conf</h6><p>\u6307\u660E\u6CE8\u518C\u5230nacos\u4E2D\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636553697753-f5c87f38-aeed-42e2-8e09-5c8daf7f81bb.png" alt="img"></p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">registry</span> <span class="token value attr-value">{</span>
<span class="token comment">  # file \u3001nacos \u3001eureka\u3001redis\u3001zk\u3001consul\u3001etcd3\u3001sofa</span>
<span class="token key attr-name">  type</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;nacos&quot;</span>

<span class="token key attr-name">  nacos</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    serverAddr</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;localhost:8848&quot;    # \u5982\u679Cnacos\u4E0D\u5728\u672C\u673A\uFF0C\u5C31\u5199\u670D\u52A1\u5668\u7684IP</span>
<span class="token key attr-name">    namespace</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;&quot;</span>
<span class="token key attr-name">    cluster</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;default&quot;</span>
  }
<span class="token key attr-name">  eureka</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    serviceUrl</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;http://localhost:8761/eureka&quot;</span>
<span class="token key attr-name">    application</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;default&quot;</span>
<span class="token key attr-name">    weight</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;1&quot;</span>
  }
<span class="token key attr-name">  redis</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    serverAddr</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;localhost:6379&quot;</span>
<span class="token key attr-name">    db</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;0&quot;</span>
  }
<span class="token key attr-name">  zk</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    cluster</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;default&quot;</span>
<span class="token key attr-name">    serverAddr</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;127.0.0.1:2181&quot;</span>
<span class="token key attr-name">    session.timeout</span> <span class="token punctuation">=</span> <span class="token value attr-value">6000</span>
<span class="token key attr-name">    connect.timeout</span> <span class="token punctuation">=</span> <span class="token value attr-value">2000</span>
  }
<span class="token key attr-name">  consul</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    cluster</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;default&quot;</span>
<span class="token key attr-name">    serverAddr</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;127.0.0.1:8500&quot;</span>
  }
<span class="token key attr-name">  etcd3</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    cluster</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;default&quot;</span>
<span class="token key attr-name">    serverAddr</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;http://localhost:2379&quot;</span>
  }
<span class="token key attr-name">  sofa</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    serverAddr</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;127.0.0.1:9603&quot;</span>
<span class="token key attr-name">    application</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;default&quot;</span>
<span class="token key attr-name">    region</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;DEFAULT_ZONE&quot;</span>
<span class="token key attr-name">    datacenter</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;DefaultDataCenter&quot;</span>
<span class="token key attr-name">    cluster</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;default&quot;</span>
<span class="token key attr-name">    group</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;SEATA_GROUP&quot;</span>
<span class="token key attr-name">    addressWaitTime</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;3000&quot;</span>
  }
<span class="token key attr-name">  file</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    name</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;file.conf&quot;</span>
  }
}

<span class="token key attr-name">config</span> <span class="token value attr-value">{</span>
<span class="token comment">  # file\u3001nacos \u3001apollo\u3001zk\u3001consul\u3001etcd3</span>
<span class="token key attr-name">  type</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;file&quot;</span>

<span class="token key attr-name">  nacos</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    serverAddr</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;localhost&quot;</span>
<span class="token key attr-name">    namespace</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;&quot;</span>
  }
<span class="token key attr-name">  consul</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    serverAddr</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;127.0.0.1:8500&quot;</span>
  }
<span class="token key attr-name">  apollo</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    app.id</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;seata-server&quot;</span>
<span class="token key attr-name">    apollo.meta</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;http://192.168.1.204:8801&quot;</span>
  }
<span class="token key attr-name">  zk</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    serverAddr</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;127.0.0.1:2181&quot;</span>
<span class="token key attr-name">    session.timeout</span> <span class="token punctuation">=</span> <span class="token value attr-value">6000</span>
<span class="token key attr-name">    connect.timeout</span> <span class="token punctuation">=</span> <span class="token value attr-value">2000</span>
  }
<span class="token key attr-name">  etcd3</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    serverAddr</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;http://localhost:2379&quot;</span>
  }
<span class="token key attr-name">  file</span> <span class="token value attr-value">{</span>
<span class="token key attr-name">    name</span> <span class="token punctuation">=</span> <span class="token value attr-value">&quot;file.conf&quot;</span>
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_5-domain" tabindex="-1"><a class="header-anchor" href="#_5-domain" aria-hidden="true">#</a> (5) domain</h6><p>domain \u5C31\u662Fentity\uFF08pojo\uFF0Cbean\uFF09\uFF0C\u5BF9\u5E94\u6570\u636E\u5E93\u7684\u8868\uFF0C\u4E0D\u540C\u516C\u53F8\u4E60\u60EF\u4E0D\u4E00\u6837\u3002</p><p>\u65B0\u5EFAOrder\u7C7B\u4E0ECommonResult\u7C7B</p><p>######## Order</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Order</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Long</span> productId<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Integer</span> count<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> money<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * \u8BA2\u5355\u72B6\u6001\uFF1A0\uFF1A\u521B\u5EFA\u4E2D\uFF1B1\uFF1A\u5DF2\u5B8C\u7ED3
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> status<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## CommonResult</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>


<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> code<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">T</span> data<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> code<span class="token punctuation">,</span> <span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> message<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_6-dao\u63A5\u53E3\u53CA\u5B9E\u73B0-sql\u6620\u5C04\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_6-dao\u63A5\u53E3\u53CA\u5B9E\u73B0-sql\u6620\u5C04\u6587\u4EF6" aria-hidden="true">#</a> (6) Dao\u63A5\u53E3\u53CA\u5B9E\u73B0(SQL\u6620\u5C04\u6587\u4EF6)</h6><p>dao\u4E2D\u81F3\u5C11\u8981\u6709\u4E24\u4E2A\u65B9\u6CD5\uFF0C\u4E00\u4E2A\u662F\u521B\u5EFA\u8BA2\u5355\uFF0C\u4E00\u4E2A\u662F\u4FEE\u6539\u8BA2\u5355\u72B6\u6001</p><p>######## OrderDao</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>dao</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Order</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Param</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * <span class="token keyword">@author</span> MrLinxi
 * @Description
 * <span class="token keyword">@create</span> 2021-11-10-22:24
 */</span>
<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">OrderDao</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * \u521B\u5EFA\u8BA2\u5355
     */</span>
    <span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * \u4FEE\u6539\u8BA2\u5355\u72B6\u6001\uFF0C\u4ECE0\u6539\u4E3A1
     */</span>
    <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;status&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> status<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## OrderMapper.xml</p><p>resources\u6587\u4EF6\u5939\u4E0B\u65B0\u5EFAmapper\u6587\u4EF6\u5939\u540E\u6DFB\u52A0OrderMapper.xml\u3002\u5B8C\u6210dao\u7684\u5177\u4F53\u5B9E\u73B0\u3002</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span> <span class="token name">PUBLIC</span> <span class="token string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="token string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> <span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.atguigu.cloudalibaba.dao.OrderDao<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!--\u5B9A\u4E49\u4E00\u4E2A\u7ED3\u679C\u96C6\u548C\u5B9E\u4F53\u7C7B\u7684\u6620\u5C04\u8868--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BaseResultMap<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.atguigu.cloudalibaba.domain.Order<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BIGINT<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BIGINT<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>product_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BIGINT<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>count<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>count<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>INTEGER<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>money<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>money<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DECIMAL<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>status<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>status<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>INTEGER<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>create<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        INSERT INTO \`t_order\` (\`id\`, \`user_id\`, \`product_id\`, \`count\`, \`money\`, \`status\`)
        VALUES (NULL, #{userId}, #{productId}, #{count}, #{money}, 0);
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>update<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        UPDATE \`t_order\`
        SET status = 1
        WHERE user_id = #{userId} AND status = #{status};
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_7-service\u63A5\u53E3\u53CA\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#_7-service\u63A5\u53E3\u53CA\u5B9E\u73B0" aria-hidden="true">#</a> (7) Service\u63A5\u53E3\u53CA\u5B9E\u73B0</h6><p><strong>Order2001\u9A71\u52A8\u81EA\u5DF1\uFF0C\u5916\u52A0\u8C03\u7528\u5E93\u5B58\u548C\u8D26\u6237\uFF1A\u51713\u4E2Aservice</strong></p><p>######## OrderService</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Order</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u521B\u5EFA\u8BA2\u5355</span>
    <span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## StorageService</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>openfeign<span class="token punctuation">.</span></span><span class="token class-name">FeignClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PostMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestParam</span></span><span class="token punctuation">;</span>

<span class="token comment">//\u901A\u8FC7OpenFeign\u8FDC\u7A0B\u8C03\u7528\u5E93\u5B58\u7684\u5FAE\u670D\u52A1</span>
<span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;seata-storage-service&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">StorageService</span> <span class="token punctuation">{</span>
    <span class="token comment">//\u6263\u51CF\u5E93\u5B58\uFF0C\u6BD4\u5982\u4E70\u4E865\u4E2A1\u53F7\u5546\u54C1\uFF1A\u5BF91\u53F7\u5546\u54C1\u5E93\u5B58\u51CF5</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/storage/decrease&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">CommonResult</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;productId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> productId<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;count&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## AccountService</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>openfeign<span class="token punctuation">.</span></span><span class="token class-name">FeignClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PostMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestParam</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span></span><span class="token punctuation">;</span>

<span class="token comment">//\u901A\u8FC7OpenFeign\u8FDC\u7A0B\u8C03\u7528\u8D26\u53F7\u5FAE\u670D\u52A1</span>
<span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;seata-account-service&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AccountService</span> <span class="token punctuation">{</span>
    <span class="token comment">//\u6263\u51CF\u8D26\u6237\u4F59\u989D\uFF0C\u9700\u8981\u4F20\u5165\u7528\u6237ID\u8DDF\u6263\u9664\u7684\u91D1\u989D</span>
    <span class="token comment">//@RequestMapping(value = &quot;/account/decrease&quot;, method = RequestMethod.POST, produces = &quot;application/json; charset=UTF-8&quot;)</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/account/decrease&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">CommonResult</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;money&quot;</span><span class="token punctuation">)</span> <span class="token class-name">BigDecimal</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## OrderServiceImpl</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">Impl</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>dao<span class="token punctuation">.</span></span><span class="token class-name">OrderDao</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Order</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">AccountService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">OrderService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">StorageService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">OrderDao</span> orderDao<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">StorageService</span> storageService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">AccountService</span> accountService<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * \u521B\u5EFA\u8BA2\u5355-&gt;\u8C03\u7528\u5E93\u5B58\u670D\u52A1\u6263\u51CF\u5E93\u5B58-&gt;\u8C03\u7528\u8D26\u6237\u670D\u52A1\u6263\u51CF\u8D26\u6237\u4F59\u989D-&gt;\u4FEE\u6539\u8BA2\u5355\u72B6\u6001
     * \u7B80\u5355\u8BF4\uFF1A
     * \u4E0B\u8BA2\u5355-&gt;\u51CF\u5E93\u5B58-&gt;\u51CF\u4F59\u989D-&gt;\u6539\u72B6\u6001
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;\u4E0B\u5355\u5F00\u59CB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u672C\u5E94\u7528\u521B\u5EFA\u8BA2\u5355</span>
        orderDao<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//\u8FDC\u7A0B\u8C03\u7528\u5E93\u5B58\u670D\u52A1\u6263\u51CF\u5E93\u5B58</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;\u8BA2\u5355\u5FAE\u670D\u52A1\u8C03\u7528\u5E93\u5B58\u5FAE\u670D\u52A1\uFF0C\u6263\u51CF\u5E93\u5B58\u5F00\u59CB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        storageService<span class="token punctuation">.</span><span class="token function">decrease</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getProductId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>order<span class="token punctuation">.</span><span class="token function">getCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;\u8BA2\u5355\u5FAE\u670D\u52A1\u8C03\u7528\u5E93\u5B58\u5FAE\u670D\u52A1\uFF0C\u6263\u51CF\u5E93\u5B58\u7ED3\u675F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//\u8FDC\u7A0B\u8C03\u7528\u8D26\u6237\u670D\u52A1\u6263\u51CF\u4F59\u989D</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;\u8BA2\u5355\u5FAE\u670D\u52A1\u8C03\u7528\u8D26\u6237\u5FAE\u670D\u52A1\uFF0C\u6263\u51CF\u4F59\u989D\u5F00\u59CB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        accountService<span class="token punctuation">.</span><span class="token function">decrease</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>order<span class="token punctuation">.</span><span class="token function">getMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;\u8BA2\u5355\u5FAE\u670D\u52A1\u8C03\u7528\u8D26\u6237\u5FAE\u670D\u52A1\uFF0C\u51CF\u4F59\u989D\u7ED3\u675F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//\u4FEE\u6539\u8BA2\u5355\u72B6\u6001\u4E3A\u5DF2\u5B8C\u6210</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;order-service\u4E2D\u4FEE\u6539\u8BA2\u5355\u72B6\u6001\u5F00\u59CB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8FD9\u91CC\u7684\u8BDD\u662F\u4E0D\u662F\u5E94\u8BE5\u662ForderId\uFF1F</span>
        orderDao<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;order-service\u4E2D\u4FEE\u6539\u8BA2\u5355\u72B6\u6001\u7ED3\u675F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;\u4E0B\u5355\u7ED3\u675F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_8-controller" tabindex="-1"><a class="header-anchor" href="#_8-controller" aria-hidden="true">#</a> (8) controller</h6><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Order</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">OrderService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">OrderService</span> orderService<span class="token punctuation">;</span>

    <span class="token comment">//\u521B\u5EFA\u8BA2\u5355</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/order/create&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        orderService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">&quot;\u8BA2\u5355\u521B\u5EFA\u6210\u529F!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_9-config" tabindex="-1"><a class="header-anchor" href="#_9-config" aria-hidden="true">#</a> (9) config</h6><p>######## MyBatisConfig</p><p>mybatis\u914D\u7F6E\u7C7B\uFF0C\u7ED1\u5B9A\u5B9E\u73B0\u6587\u4EF6OrderMapper.xml\u4E0EDao\u63A5\u53E3</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">MapperScan</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;com.atguigu.cloudalibaba.dao&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyBatisConfig</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## DataSourceProxyConfig</p><p>DataSouce\u7684\u5305\u662Fsql\u4E0B\u7684\uFF0CDataSourceProxy\u662Fseata\u4E0B\u7684\uFF0C\u4E0D\u8981\u641E\u9519\u4E86\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636623945614-0c74dca4-e78e-4a6d-b65f-f3bf588c143c.png" alt="img"></p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>druid<span class="token punctuation">.</span>pool<span class="token punctuation">.</span></span><span class="token class-name">DruidDataSource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>seata<span class="token punctuation">.</span>rm<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span></span><span class="token class-name">DataSourceProxy</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>session<span class="token punctuation">.</span></span><span class="token class-name">SqlSessionFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span></span><span class="token class-name">SqlSessionFactoryBean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span></span><span class="token class-name">SpringManagedTransactionFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>context<span class="token punctuation">.</span>properties<span class="token punctuation">.</span></span><span class="token class-name">ConfigurationProperties</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Primary</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span>support<span class="token punctuation">.</span></span><span class="token class-name">PathMatchingResourcePatternResolver</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">DataSource</span></span><span class="token punctuation">;</span>

<span class="token comment">//\u4F7F\u7528Seata\u5BF9\u6570\u636E\u6E90\u8FDB\u884C\u4EE3\u7406</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataSourceProxyConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;\${mybatis.mapperLocations}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> mapperLocations<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;spring.datasource&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">druidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
<span class="token comment">//    @Primary</span>
    <span class="token comment">//DataSourceProxy\u65B9\u6CD5\u4E0A\u6807\u6CE8@Primary\u5C31\u53EF\u4EE5\u4E86\uFF0C\u8FD9\u6837\u5C31\u81EA\u52A8\u7528\u7684\u4EE3\u7406\u7684DataSource(DS\u7684\u5B50\u7C7B)\uFF0C</span>
    <span class="token comment">// \u800C\u4E0D\u662FDruid\u7684, \u5426\u5219\u5C31\u9700\u8981\u81EA\u5DF1\u6784\u9020sqlSessionFactory</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSourceProxy</span> <span class="token function">dataSourceProxy</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DataSourceProxy</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">SqlSessionFactory</span> <span class="token function">sqlSessionFactoryBean</span><span class="token punctuation">(</span><span class="token class-name">DataSourceProxy</span> dataSourceProxy<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">SqlSessionFactoryBean</span> sqlSessionFactoryBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SqlSessionFactoryBean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSessionFactoryBean<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>dataSourceProxy<span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSessionFactoryBean<span class="token punctuation">.</span><span class="token function">setMapperLocations</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span>mapperLocations<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sqlSessionFactoryBean<span class="token punctuation">.</span><span class="token function">setTransactionFactory</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SpringManagedTransactionFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> sqlSessionFactoryBean<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_10-\u4E3B\u542F\u52A8\u7C7B" tabindex="-1"><a class="header-anchor" href="#_10-\u4E3B\u542F\u52A8\u7C7B" aria-hidden="true">#</a> (10) \u4E3B\u542F\u52A8\u7C7B</h6><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span><span class="token class-name">DataSourceAutoConfiguration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>openfeign<span class="token punctuation">.</span></span><span class="token class-name">EnableFeignClients</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@EnableFeignClients</span>
<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@SpringBootApplication</span><span class="token punctuation">(</span>exclude <span class="token operator">=</span> <span class="token class-name">DataSourceAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token comment">//\u53D6\u6D88\u6570\u636E\u6E90\u7684\u81EA\u52A8\u521B\u5EFA</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SeataOrderMainApp2001</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">SeataOrderMainApp2001</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## \u542F\u52A8\u6D4B\u8BD5</p><p>\u5148\u542F\u52A8nacos-1.1.4\u548Cseata-0.9.0\uFF0C\u518D\u542F\u52A82001\u3002</p><p>2001\u542F\u52A8\u6210\u529F\uFF0C\u6210\u529F\u6CE8\u518C\u5230nacos\u4E2D</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636722603007-0a6df6bf-28d9-44dd-8d58-e76b14d94427.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636722630747-fbdc8cc0-dd4c-45bf-96cb-4da7906a623e.png" alt="img"></p><p>\u6D4B\u8BD5nacos-2.0.3\u548Cseata-0.9.0\uFF0C\u518D\u542F\u52A82001 \u4E5F\u53EF\u4EE5\u542F\u52A8\u6210\u529F</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636722844267-369a9bea-7ac3-4d0a-a2f0-ef322fc362d4.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636722828489-0bdc54a6-0acc-4a8f-8972-ff8d7ba0985a.png" alt="img"></p><h5 id="_3-2-\u65B0\u5EFA\u5E93\u5B58storage-module\u2014\u2014seata-storage-service2002" tabindex="-1"><a class="header-anchor" href="#_3-2-\u65B0\u5EFA\u5E93\u5B58storage-module\u2014\u2014seata-storage-service2002" aria-hidden="true">#</a> 3.2 \u65B0\u5EFA\u5E93\u5B58Storage-Module\u2014\u2014seata-storage-service2002</h5><h6 id="_1-pom-3" tabindex="-1"><a class="header-anchor" href="#_1-pom-3" aria-hidden="true">#</a> (1) pom</h6><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jdk8cloud2021<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>seata-storage-service2002<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--nacos--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--seata--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- \u56E0\u4E3A\u517C\u5BB9\u7248\u672C\u95EE\u9898,\u6240\u4EE5\u9700\u8981\u5254\u9664\u5B83\u81EA\u5E26\u7684seata\u7684\u5305 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>seata-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--\u8FD9\u91CC\u5F15\u5165\u7684\u7248\u672C\u8981\u8DDF\u5B89\u88C5\u7684\u7248\u672C\u5BF9\u5E94--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>seata-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.9.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--feign--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--web-actuator--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--mysql-druid--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.22<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>druid-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.1.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_2-application-yml-1" tabindex="-1"><a class="header-anchor" href="#_2-application-yml-1" aria-hidden="true">#</a> (2) application.yml</h6><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">2002</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> seata<span class="token punctuation">-</span>storage<span class="token punctuation">-</span>service
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">alibaba</span><span class="token punctuation">:</span>
      <span class="token key atrule">seata</span><span class="token punctuation">:</span>
        <span class="token comment">#\u81EA\u5B9A\u4E49\u4E8B\u52A1\u7EC4\u540D\u79F0\u9700\u8981\u4E0Eseata-server\u4E2Dfile.conf\u4E2D\u914D\u7F6E\u7684\u4E8B\u52A1\u7EC4ID\u5BF9\u5E94</span>
        <span class="token comment">#vgroup_mapping.my_test_tx_group = &quot;my_group&quot;</span>
        <span class="token comment">#        tx-service-group: my_test_tx_group</span>
        <span class="token key atrule">tx-service-group</span><span class="token punctuation">:</span> my_group
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/seata_storage<span class="token punctuation">?</span>useUnicode=true<span class="token important">&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=UTC</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">10086</span>

<span class="token comment">#\u670D\u52A1\u63D0\u4F9B\u7AEF\u4E0D\u9700\u8981\u8FDC\u7A0B\u8C03\u7528</span>
<span class="token comment">#feign:</span>
<span class="token comment">#  hystrix:</span>
<span class="token comment">#    enabled: false</span>

<span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">io</span><span class="token punctuation">:</span>
      <span class="token key atrule">seata</span><span class="token punctuation">:</span> info

<span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token comment"># \u626B\u63CF\u7C7B\u8DEF\u5F84\u4E0Bmapper\u6587\u4EF6\u5939\u4E0B\u7684.xml\u914D\u7F6E\u6587\u4EF6</span>
  <span class="token key atrule">mapperLocations</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>mapper/<span class="token important">*.xml</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_3-file-conf-registry-conf" tabindex="-1"><a class="header-anchor" href="#_3-file-conf-registry-conf" aria-hidden="true">#</a> (3) file.conf &amp; registry.conf</h6><p>\u8DDF2001\u7684\u4E00\u6A21\u4E00\u6837</p><h6 id="_4-domain" tabindex="-1"><a class="header-anchor" href="#_4-domain" aria-hidden="true">#</a> (4) domain</h6><p>######## Storage</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>domian</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Storage</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token comment">//\u4EA7\u54C1ID</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> productId<span class="token punctuation">;</span>

    <span class="token comment">//\u603B\u5E93\u5B58</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> total<span class="token punctuation">;</span>

    <span class="token comment">//\u5DF2\u7528\u5E93\u5B58</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> used<span class="token punctuation">;</span>

    <span class="token comment">//\u5269\u4F59\u5E93\u5B58</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> residue<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## CommonResult</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> code<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">T</span> data<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> code<span class="token punctuation">,</span> <span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> message<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_5-dao\u63A5\u53E3\u53CA\u5B9E\u73B0-sql\u6620\u5C04\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_5-dao\u63A5\u53E3\u53CA\u5B9E\u73B0-sql\u6620\u5C04\u6587\u4EF6" aria-hidden="true">#</a> (5) Dao\u63A5\u53E3\u53CA\u5B9E\u73B0(SQL\u6620\u5C04\u6587\u4EF6)</h6><p>######## StorageDao</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>dao</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Param</span></span><span class="token punctuation">;</span>


<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">StorageDao</span> <span class="token punctuation">{</span>
        <span class="token comment">//\u6263\u51CF\u5E93\u5B58\uFF1A\u6839\u636E\u4EA7\u54C1ID\u6263\u9664</span>
    <span class="token keyword">void</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;productId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> productId<span class="token punctuation">,</span> <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;count&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Integer</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## StorageMapper.xml</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span> <span class="token name">PUBLIC</span> <span class="token string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="token string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> <span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.atguigu.cloudalibaba.dao.StorageDao<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>storage<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.atguigu.cloudalibaba.domian.Storage<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BIGINT<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>product_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>productId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BIGINT<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>result</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>total<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>total<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BIGINT<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>result</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>used<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>used<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>INTEGER<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>result</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>residue<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>residue<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>INTEGER<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>result</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>decrease<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        update \`t_storage\`
        SET \`used\` = \`used\` + #{count}, \`residue\` = \`residue\` - #{count}
        WHERE \`product_id\` = #{productId};
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_6-service\u63A5\u53E3\u53CA\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#_6-service\u63A5\u53E3\u53CA\u5B9E\u73B0" aria-hidden="true">#</a> (6) Service\u63A5\u53E3\u53CA\u5B9E\u73B0</h6><p>StorageService</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>


<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">StorageService</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * \u6263\u51CF\u5E93\u5B58
     */</span>
    <span class="token keyword">void</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token class-name">Long</span> productId<span class="token punctuation">,</span> <span class="token class-name">Integer</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>StorageServiceImpl</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">Impl</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>dao<span class="token punctuation">.</span></span><span class="token class-name">StorageDao</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">StorageService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>


<span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StorageServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">StorageService</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> LOGGER <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">StorageServiceImpl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">StorageDao</span> storageDao<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * \u6263\u51CF\u5E93\u5B58
     * <span class="token keyword">@param</span> <span class="token parameter">productId</span>
     * <span class="token keyword">@param</span> <span class="token parameter">count</span>
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token class-name">Long</span> productId<span class="token punctuation">,</span> <span class="token class-name">Integer</span> count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token comment">//        log.info(&quot;--------&gt;storage-service\u4E2D\u6263\u51CF\u5E93\u5B58&quot;);</span>
        LOGGER<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;--------&gt;storage-service\u4E2D\u6263\u51CF\u5E93\u5B58&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        storageDao<span class="token punctuation">.</span><span class="token function">decrease</span><span class="token punctuation">(</span>productId<span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_7-controller" tabindex="-1"><a class="header-anchor" href="#_7-controller" aria-hidden="true">#</a> (7) Controller</h6><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>domian<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">StorageService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>


<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StorageController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">StorageService</span> storageService<span class="token punctuation">;</span>

    <span class="token comment">//RequestMapping\u9ED8\u8BA4GET POST\u8BF7\u6C42\u90FD\u652F\u6301\uFF0C\u6839\u636E\u524D\u7AEF\u81EA\u52A8\u9002\u5E94</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/storage/decrease&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token class-name">Long</span> productId<span class="token punctuation">,</span> <span class="token class-name">Integer</span> count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        storageService<span class="token punctuation">.</span><span class="token function">decrease</span><span class="token punctuation">(</span>productId<span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">&quot;\u6263\u51CF\u5E93\u5B58\u6210\u529F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_8-config\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#_8-config\u914D\u7F6E" aria-hidden="true">#</a> (8) config\u914D\u7F6E</h6><p>\u4E0E2001\u7684\u4E00\u6A21\u4E00\u6837</p><h6 id="_9-\u4E3B\u542F\u52A8\u7C7B" tabindex="-1"><a class="header-anchor" href="#_9-\u4E3B\u542F\u52A8\u7C7B" aria-hidden="true">#</a> (9) \u4E3B\u542F\u52A8\u7C7B</h6><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba</span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">MapperScan</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span><span class="token class-name">DataSourceAutoConfiguration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>openfeign<span class="token punctuation">.</span></span><span class="token class-name">EnableFeignClients</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@SpringBootApplication</span><span class="token punctuation">(</span>exclude <span class="token operator">=</span> <span class="token class-name">DataSourceAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableFeignClients</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SeataStorageMainApp2002</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">SeataStorageMainApp2002</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="\u542F\u52A8\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#\u542F\u52A8\u6D4B\u8BD5" aria-hidden="true">#</a> \u542F\u52A8\u6D4B\u8BD5</h6><p>\u542F\u52A8nacos\u3001seata\u30012002\uFF1B\u542F\u52A8\u6210\u529F\uFF0C\u6CE8\u518C\u8FDBnacos\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636875245112-c004268f-3305-4a0c-9ae3-c6932f034de0.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636875238158-59a99c9d-03ac-4563-bda8-9b9d755410a6.png" alt="img"></p><h5 id="_3-3-\u65B0\u5EFA\u8D26\u6237account-module\u2014\u2014seata-account-service2003" tabindex="-1"><a class="header-anchor" href="#_3-3-\u65B0\u5EFA\u8D26\u6237account-module\u2014\u2014seata-account-service2003" aria-hidden="true">#</a> 3.3 \u65B0\u5EFA\u8D26\u6237Account-Module\u2014\u2014seata-account-service2003</h5><h6 id="_1-pom-4" tabindex="-1"><a class="header-anchor" href="#_1-pom-4" aria-hidden="true">#</a> (1) pom</h6><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jdk8cloud2021<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.atguigu.springcloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>seata-account-service2003<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--nacos--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-discovery<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--seata--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- \u56E0\u4E3A\u517C\u5BB9\u7248\u672C\u95EE\u9898,\u6240\u4EE5\u9700\u8981\u5254\u9664\u5B83\u81EA\u5E26\u7684seata\u7684\u5305 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>seata-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>seata-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.9.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--feign--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--web-actuator--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--mysql-druid--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.22<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>druid-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.1.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mybatis.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optional</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optional</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_2-application-yml-2" tabindex="-1"><a class="header-anchor" href="#_2-application-yml-2" aria-hidden="true">#</a> (2) application.yml</h6><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">2003</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> seata<span class="token punctuation">-</span>account<span class="token punctuation">-</span>service
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">alibaba</span><span class="token punctuation">:</span>
      <span class="token key atrule">seata</span><span class="token punctuation">:</span>
        <span class="token comment">#\u81EA\u5B9A\u4E49\u4E8B\u52A1\u7EC4\u540D\u79F0\u9700\u8981\u4E0Eseata-server\u4E2Dfile.conf\u4E2D\u914D\u7F6E\u7684\u4E8B\u52A1\u7EC4ID\u5BF9\u5E94</span>
        <span class="token comment">#vgroup_mapping.my_test_tx_group = &quot;my_group&quot;</span>
        <span class="token comment">#        tx-service-group: my_test_tx_group</span>
        <span class="token key atrule">tx-service-group</span><span class="token punctuation">:</span> my_group
    <span class="token comment">#        tx-service-group: default</span>
    <span class="token comment">#        tx-service-group: my_test_tx_group</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/seata_account<span class="token punctuation">?</span>useUnicode=true<span class="token important">&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=UTC</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">10086</span>

<span class="token comment">#feign:</span>
<span class="token comment">#  hystrix:</span>
<span class="token comment">#    enabled: false</span>

<span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">io</span><span class="token punctuation">:</span>
      <span class="token key atrule">seata</span><span class="token punctuation">:</span> info

<span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token comment"># \u626B\u63CF\u7C7B\u8DEF\u5F84\u4E0Bmapper\u6587\u4EF6\u5939\u4E0B\u7684.xml\u914D\u7F6E\u6587\u4EF6</span>
  <span class="token key atrule">mapperLocations</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>mapper/<span class="token important">*.xml</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_3-file-conf-registry-conf-1" tabindex="-1"><a class="header-anchor" href="#_3-file-conf-registry-conf-1" aria-hidden="true">#</a> (3) file.conf &amp; registry.conf</h6><p>\u8DDF2001\u4E00\u6A21\u4E00\u6837</p><h6 id="_4-domain-1" tabindex="-1"><a class="header-anchor" href="#_4-domain-1" aria-hidden="true">#</a> (4) domain</h6><p>######## Account</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Account</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token comment">//\u7528\u6237ID</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span>

    <span class="token comment">//\u603B\u989D\u5EA6</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> total<span class="token punctuation">;</span>

    <span class="token comment">//\u5DF2\u7528\u989D\u5EA6</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> used<span class="token punctuation">;</span>

    <span class="token comment">//\u5269\u4F59\u989D\u5EA6</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> residue<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## CommonResult</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommonResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> code<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">T</span> data<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> code<span class="token punctuation">,</span> <span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> message<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_5-dao\u63A5\u53E3\u53CA\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#_5-dao\u63A5\u53E3\u53CA\u5B9E\u73B0" aria-hidden="true">#</a> (5) Dao\u63A5\u53E3\u53CA\u5B9E\u73B0</h6><p>######## AccountDao</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>dao</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Param</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AccountDao</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * \u6263\u51CF\u8D26\u6237\u4F59\u989D
     * <span class="token keyword">@param</span> <span class="token parameter">userId</span>
     * <span class="token keyword">@param</span> <span class="token parameter">money</span>
     */</span>
    <span class="token keyword">void</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">&quot;money&quot;</span><span class="token punctuation">)</span> <span class="token class-name">BigDecimal</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## AccountMapper.xml</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span> <span class="token name">PUBLIC</span> <span class="token string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="token string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> <span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.atguigu.cloudalibaba.dao.AccountDao<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BaseResultMap<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.atguigu.cloudalibaba.domain.Account<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BIGINT<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user_id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userId<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>BIGINT<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>result</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>total<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>total<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DECIMAL<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>result</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>used<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>used<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DECIMAL<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>result</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>residue<span class="token punctuation">&quot;</span></span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>residue<span class="token punctuation">&quot;</span></span> <span class="token attr-name">jdbcType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DECIMAL<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>result</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>decrease<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        UPDATE t_account
        SET \`used\` = \`used\` + #{money}, \`residue\` = \`residue\` - #{money}
        WHERE \`user_id\` = #{userId};
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_6-service\u63A5\u53E3\u53CA\u5B9E\u73B0-1" tabindex="-1"><a class="header-anchor" href="#_6-service\u63A5\u53E3\u53CA\u5B9E\u73B0-1" aria-hidden="true">#</a> (6) Service\u63A5\u53E3\u53CA\u5B9E\u73B0</h6><p>######## AccountService</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestParam</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span></span><span class="token punctuation">;</span>


<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AccountService</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * \u6263\u51CF\u8D26\u6237\u91D1\u989D
     * <span class="token keyword">@param</span> <span class="token parameter">userId</span>  \u7528\u6237ID
     * <span class="token keyword">@param</span> <span class="token parameter">money</span>  \u91D1\u989D
     */</span>
    <span class="token keyword">void</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;money&quot;</span><span class="token punctuation">)</span> <span class="token class-name">BigDecimal</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## AccountServiceImpl</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>dao<span class="token punctuation">.</span></span><span class="token class-name">AccountDao</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">AccountService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">AccountService</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> LOGGER <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">AccountServiceImpl</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token class-name">AccountDao</span> accountDao<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * \u6263\u51CF\u8D26\u6237\u4F59\u989D
     * <span class="token keyword">@param</span> <span class="token parameter">userId</span> \u7528\u6237ID
     * <span class="token keyword">@param</span> <span class="token parameter">money</span>  \u91D1\u989D
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token class-name">BigDecimal</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        LOGGER<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;account-service\u4E2D\u6263\u51CF\u8D26\u6237\u4F59\u989D\u5F00\u59CB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u6A21\u62DF\u8D85\u65F6\u5F02\u5E38\uFF0C\u5168\u5C40\u4E8B\u52A1\u56DE\u6EDA</span>
        <span class="token comment">//\u6682\u505C\u51E0\u79D2\u949F\u7EBF\u7A0B</span>
        <span class="token comment">//try { TimeUnit.SECONDS.sleep(30); } catch (InterruptedException e) { e.printStackTrace(); }</span>
        accountDao<span class="token punctuation">.</span><span class="token function">decrease</span><span class="token punctuation">(</span>userId<span class="token punctuation">,</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>
        LOGGER<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;account-service\u4E2D\u6263\u51CF\u8D26\u6237\u4F59\u989D\u7ED3\u675F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_7-controller-1" tabindex="-1"><a class="header-anchor" href="#_7-controller-1" aria-hidden="true">#</a> (7) Controller</h6><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">CommonResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">AccountService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestParam</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>math<span class="token punctuation">.</span></span><span class="token class-name">BigDecimal</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AccountController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">AccountService</span> accountService<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * \u6263\u51CF\u8D26\u6237\u4F59\u989D
     */</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/account/decrease&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;userId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> userId<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;money&quot;</span><span class="token punctuation">)</span> <span class="token class-name">BigDecimal</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        accountService<span class="token punctuation">.</span><span class="token function">decrease</span><span class="token punctuation">(</span>userId<span class="token punctuation">,</span> money<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">&quot;\u6263\u51CF\u8D26\u6237\u4F59\u989D\u6210\u529F\uFF01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_8-config\u914D\u7F6E-1" tabindex="-1"><a class="header-anchor" href="#_8-config\u914D\u7F6E-1" aria-hidden="true">#</a> (8) config\u914D\u7F6E</h6><p>\u548C2001\u4E00\u6A21\u4E00\u6837</p><h6 id="_9-\u4E3B\u542F\u52A8\u7C7B-1" tabindex="-1"><a class="header-anchor" href="#_9-\u4E3B\u542F\u52A8\u7C7B-1" aria-hidden="true">#</a> (9) \u4E3B\u542F\u52A8\u7C7B</h6><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span><span class="token class-name">DataSourceAutoConfiguration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>openfeign<span class="token punctuation">.</span></span><span class="token class-name">EnableFeignClients</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@EnableFeignClients</span>
<span class="token annotation punctuation">@SpringBootApplication</span><span class="token punctuation">(</span>exclude <span class="token operator">=</span> <span class="token class-name">DataSourceAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SeataAccountMainApp2003</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">SeataAccountMainApp2003</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="\u542F\u52A8\u6D4B\u8BD5-1" tabindex="-1"><a class="header-anchor" href="#\u542F\u52A8\u6D4B\u8BD5-1" aria-hidden="true">#</a> \u542F\u52A8\u6D4B\u8BD5</h6><p>\u542F\u52A8nacos\u3001seata\u30012003\uFF1B\u542F\u52A8\u6210\u529F\uFF0C\u6210\u529F\u6CE8\u518C\u8FDBnacos</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636876914165-bcd89219-515c-455d-82e0-2ad415e6259f.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636876923512-1ea962ff-f4c0-4d8a-add6-03b957213344.png" alt="img"></p><h5 id="\u586B\u5751\u9AD8\u7248\u672Cseata1-4-2client\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u586B\u5751\u9AD8\u7248\u672Cseata1-4-2client\u914D\u7F6E" aria-hidden="true">#</a> ### \u586B\u5751\u9AD8\u7248\u672Cseata1.4.2client\u914D\u7F6E</h5>`,127),Cp={href:"https://blog.csdn.net/weixin_44790046/article/details/106970822",target:"_blank",rel:"noopener noreferrer"},Tp=s("seata1.2.0"),Rp=s(),Lp={href:"https://blog.csdn.net/jixieguang/article/details/110621561",target:"_blank",rel:"noopener noreferrer"},Np=s("Seata1.4.0+nacos"),jp=p(`<p>\u4F7F\u7528seata1.4.2 \u5404\u4E2A\u5FAE\u670D\u52A1\u6574\u4F53\u4E0A\u7684\u4EE3\u7801\u662F\u5DEE\u4E0D\u591A\u7684\uFF0C\u533A\u522B\u7684\u5730\u65B9\u5728\u4E8E1.4.2\u652F\u6301yml\u3001properties\u6587\u4EF6\u91CC\u914D\u7F6Eclient\u7AEF\u7684seata\uFF0C\u4E0D\u518D\u9700\u8981file.conf/registry.conf\u6587\u4EF6\u3002\u540C\u65F6\u652F\u6301**@EnableAutoDataSourceProxy**\u6CE8\u89E3\u5F00\u542F\u6570\u636E\u6E90\u7684\u81EA\u52A8\u4EE3\u7406\uFF08\u4E0D\u9700\u8981\u624B\u52A8\u914D\u7F6E\u6570\u636E\u6E90\uFF09</p><h6 id="_1-\u4FEE\u6539\u7236\u5DE5\u7A0B\u7248\u672C\u63A7\u5236" tabindex="-1"><a class="header-anchor" href="#_1-\u4FEE\u6539\u7236\u5DE5\u7A0B\u7248\u672C\u63A7\u5236" aria-hidden="true">#</a> \u2460 \u4FEE\u6539\u7236\u5DE5\u7A0B\u7248\u672C\u63A7\u5236</h6><p>seata\u9AD8\u7248\u672C\u5404\u5FAE\u670D\u52A1\u53EF\u4EE5\u76F4\u63A5\u901A\u8FC7yml\u3001properties\u6765\u914D\u7F6Eseata\uFF0C\u4E0D\u9700\u8981\u5728\u5FAE\u670D\u52A1\u4E2D\u52A0\u5165file.conf\u548Cregistry.conf\u6587\u4EF6\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637067484131-41b3b3e5-e13c-43d7-a295-87f5629afb9a.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637067487583-f3020854-dec1-4ff4-9b33-b452be46bbfd.png" alt="img"></p><p>\u6CE8\u610F\u7248\u672C\u5BF9\u5E94\u5173\u7CFB\uFF0C\u8FD9\u91CC\u8981\u4F7F\u7528<strong>SpringCloud Hoxton.SR9+SpringCloud Alibaba 2.2.6.RELEASE+Spring Boot 2.3.2RELEASE+Nacos 1.4.2\uFF08\u6211\u7528\u76842.0.3\uFF09+Seata 1.3.0\uFF08\u6211\u7528\u76841.4.2\uFF09</strong>\u3002</p><p>\u4FEE\u6539\u7236\u5DE5\u7A0B\u7684\u4F9D\u8D56\u7248\u672C\uFF0C\u4E3B\u8981\u662F\u8BA9springboot\u3001SpringCloud\u3001SpringCloud alibaba\u7248\u672C\u5BF9\u5E94\u3002</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--spring boot 2.3.2--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3.2.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--spring cloud Hoxton.SR9--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>Hoxton.SR9<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--spring cloud alibaba 2.2.6.RELEASE--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-alibaba-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.2.6.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_2-\u4FEE\u6539\u5FAE\u670D\u52A1\u6A21\u5757seata\u4F9D\u8D56pom" tabindex="-1"><a class="header-anchor" href="#_2-\u4FEE\u6539\u5FAE\u670D\u52A1\u6A21\u5757seata\u4F9D\u8D56pom" aria-hidden="true">#</a> \u2461 \u4FEE\u6539\u5FAE\u670D\u52A1\u6A21\u5757seata\u4F9D\u8D56pom</h6><p>\u5B98\u7F51\u4E0A\u5BF9seata\u4F9D\u8D56\u662F\u8FD9\u4E48\u63CF\u8FF0\u7684\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637081103185-526524eb-d9c6-45c4-86f7-75f35eb942dd.png" alt="img"></p><p>\u5B98\u7F51\u63A8\u8350\u4F9D\u8D56\u914D\u7F6E\u65B9\u5F0F\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637113871974-fb756b45-4fb4-4bf2-90be-f4a05f4eb303.png" alt="img"></p><p>\u4F46\u662F\u7ECF\u8FC7\u6211\u6D4B\u8BD5\u53D1\u73B0\uFF0C\u8FD8\u662F\u9700\u8981\u6392\u9664\u6389spring-cloud-starter-alibaba-seata\u91CC\u9762\u7684seata-all</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!--seata--&gt;</span>
<span class="token comment">&lt;!--seata-spring-boot-starter \u96C6\u6210\u4E86seata-all\uFF0C\u7248\u672C\u5BF9\u5E94--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>seata-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.4.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- \u56E0\u4E3A\u517C\u5BB9\u7248\u672C\u95EE\u9898,\u6240\u4EE5\u9700\u8981\u5254\u9664\u5B83\u81EA\u5E26\u7684seata\u7684\u5305 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>seata-all<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.seata<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>seata-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5B9E\u9645\u4E0A\u6211\u6709\u5FAE\u670D\u52A1\u53EA\u914D\u7F6E\u4E86seata-spring-boot-starter\u4F9D\u8D56\uFF0Cspring-cloud-starter-alibaba-seata\u6CA1\u6709\u914D\u7F6E\uFF0C\u5E76\u4E0D\u5F71\u54CD\u6B63\u5E38\u4F7F\u7528\u3002</p><h6 id="_3-\u4FEE\u6539\u5FAE\u670D\u52A1application-yml" tabindex="-1"><a class="header-anchor" href="#_3-\u4FEE\u6539\u5FAE\u670D\u52A1application-yml" aria-hidden="true">#</a> \u2462 \u4FEE\u6539\u5FAE\u670D\u52A1application.yml</h6><p>\u76F4\u63A5\u5C06seata\u7684\u76F8\u5173\u914D\u7F6E\uFF0C\u914D\u7F6E\u5230application.yml\u6587\u4EF6\u4E2D\uFF0C\u51E0\u4E2A\u5FAE\u670D\u52A1\u7684yml\u7C7B\u4F3C\uFF1A</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token comment">#  \u8FD9\u4E00\u5757\u662F\u914D\u7F6Eseata\u7684</span>
<span class="token key atrule">seata</span><span class="token punctuation">:</span>
  <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">application-id</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>spring.application.name<span class="token punctuation">}</span>
  <span class="token key atrule">enable-auto-data-source-proxy</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#\u662F\u5426\u5F00\u542F\u6570\u636E\u6E90\u81EA\u52A8\u4EE3\u7406,\u9ED8\u8BA4\u4E3Atrue</span>
  <span class="token key atrule">tx-service-group</span><span class="token punctuation">:</span> my_test_tx_group  <span class="token comment">#\u8981\u4E0Econfig.txt\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684vgroupMapping\u4E00\u81F4</span>
  <span class="token key atrule">registry</span><span class="token punctuation">:</span> <span class="token comment">#registry\u6839\u636Eseata\u670D\u52A1\u7AEF\u7684registry\u914D\u7F6E</span>
    <span class="token key atrule">type</span><span class="token punctuation">:</span> nacos <span class="token comment">#\u9ED8\u8BA4\u4E3Afile</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">application</span><span class="token punctuation">:</span> seata<span class="token punctuation">-</span>server <span class="token comment">#\u914D\u7F6E\u81EA\u5DF1\u7684seata\u670D\u52A1,\u4E0Eregistry.conf\u4E00\u81F4</span>
      <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span> <span class="token comment">#\u6839\u636E\u81EA\u5DF1\u7684seata\u670D\u52A1\u914D\u7F6E</span>
      <span class="token key atrule">username</span><span class="token punctuation">:</span> nacos <span class="token comment">#\u6839\u636E\u81EA\u5DF1\u7684seata\u670D\u52A1\u914D\u7F6E</span>
      <span class="token key atrule">password</span><span class="token punctuation">:</span> nacos  <span class="token comment">#\u6839\u636E\u81EA\u5DF1\u7684seata\u670D\u52A1\u914D\u7F6E</span>
      <span class="token key atrule">namespace</span><span class="token punctuation">:</span> f0378218<span class="token punctuation">-</span>b129<span class="token punctuation">-</span>4fd8<span class="token punctuation">-</span>839c<span class="token punctuation">-</span>9bdfd010205b <span class="token comment">#\u6839\u636E\u81EA\u5DF1\u7684seata\u670D\u52A1\u914D\u7F6E</span>
      <span class="token key atrule">cluster</span><span class="token punctuation">:</span> default <span class="token comment"># \u914D\u7F6E\u81EA\u5DF1\u7684seata\u670D\u52A1cluster, \u9ED8\u8BA4\u4E3A default</span>
      <span class="token key atrule">group</span><span class="token punctuation">:</span> <span class="token string">&quot;SEATA_GROUP&quot;</span> <span class="token comment">#\u6839\u636E\u81EA\u5DF1\u7684seata\u670D\u52A1\u914D\u7F6E</span>
  <span class="token key atrule">config</span><span class="token punctuation">:</span>
    <span class="token key atrule">type</span><span class="token punctuation">:</span> nacos <span class="token comment">#\u914D\u7F6E\u4E2D\u5FC3\u8BBE\u7F6E\u4E3Anacos\uFF0C\u76F4\u63A5\u4ECEnacos\u4E0A\u83B7\u53D6\u914D\u7F6E</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span>  <span class="token comment">#\u914D\u7F6E\u81EA\u5DF1\u7684nacos\u5730\u5740</span>
      <span class="token key atrule">group</span><span class="token punctuation">:</span> SEATA_GROUP  <span class="token comment">#\u914D\u7F6E\u81EA\u5DF1\u7684group\uFF0C\u8FD9\u91CC\u6211\u914D\u7F6E\u8DDFregistry.conf\u4E00\u6837</span>
      <span class="token key atrule">username</span><span class="token punctuation">:</span> nacos  <span class="token comment">#\u914D\u7F6E\u81EA\u5DF1\u7684username</span>
      <span class="token key atrule">password</span><span class="token punctuation">:</span> nacos  <span class="token comment">#\u914D\u7F6E\u81EA\u5DF1\u7684password</span>
      <span class="token key atrule">namespace</span><span class="token punctuation">:</span> f0378218<span class="token punctuation">-</span>b129<span class="token punctuation">-</span>4fd8<span class="token punctuation">-</span>839c<span class="token punctuation">-</span>9bdfd010205b  <span class="token comment">#\u6839\u636E\u81EA\u5DF1\u7684seata\u670D\u52A1\u914D\u7F6E</span>
      <span class="token comment"># dataId\u5982\u679C\u4E0D\u7528\uFF0C\u5C31\u4E0D\u9700\u8981\u914D\u7F6E</span>
<span class="token comment">#      dataId: seataServer.properties  #\u914D\u7F6E\u81EA\u5DF1\u7684dataId,\u7531\u4E8E\u642D\u5EFA\u670D\u52A1\u7AEF\u65F6\u628A\u5BA2\u6237\u7AEF\u7684\u914D\u7F6E\u4E5F\u5199\u5728\u4E86seataServer.properties,\u6240\u4EE5\u8FD9\u91CC\u7528\u4E86\u548C\u670D\u52A1\u7AEF\u4E00\u6837\u7684\u914D\u7F6E\u6587\u4EF6,\u5B9E\u9645\u5BA2\u6237\u7AEF\u548C\u670D\u52A1\u7AEF\u7684\u914D\u7F6E\u6587\u4EF6\u5206\u79BB\u51FA\u6765\u66F4\u597D</span>


<span class="token comment"># \u8FD9\u91CC\u662F\u914D\u7F6E\u5FAE\u670D\u52A1\u7684\u7AEF\u53E3\u3001\u6CE8\u518C\u5230\u54EA\u3001\u6570\u636E\u6E90\u7B49\u7B49</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">2001</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> seata<span class="token punctuation">-</span>order<span class="token punctuation">-</span>service
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token comment">#    alibaba:</span>
    <span class="token comment">#      seata:</span>
    <span class="token comment">#        #\u81EA\u5B9A\u4E49\u4E8B\u52A1\u7EC4\u540D\u79F0\u9700\u8981\u4E0Eseata-server\u4E2Dfile.conf\u4E2D\u914D\u7F6E\u7684\u4E8B\u52A1\u7EC4ID\u5BF9\u5E94</span>
    <span class="token comment">#        #vgroup_mapping.my_test_tx_group = &quot;my_group&quot;</span>
    <span class="token comment">#        tx-service-group: my_group</span>
    <span class="token key atrule">nacos</span><span class="token punctuation">:</span>
      <span class="token key atrule">discovery</span><span class="token punctuation">:</span>
        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8848</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/seata_order<span class="token punctuation">?</span>useUnicode=true<span class="token important">&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=UTC</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">10086</span>

<span class="token key atrule">feign</span><span class="token punctuation">:</span>
  <span class="token key atrule">hystrix</span><span class="token punctuation">:</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>

<span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">io</span><span class="token punctuation">:</span>
      <span class="token key atrule">seata</span><span class="token punctuation">:</span> info

<span class="token key atrule">mybatis</span><span class="token punctuation">:</span>
  <span class="token key atrule">mapperLocations</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>mapper/<span class="token important">*.xml</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6CE8\u610F\u5BF9\u5E94\u5173\u7CFB\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1637126855997-372aeee0-b262-4ec0-8207-57dc27013051.png" alt="img"></p><h6 id="_4-\u4FEE\u6539\u4E3B\u542F\u52A8\u7C7B\u548Cdatasourceproxyconfig\u7C7B" tabindex="-1"><a class="header-anchor" href="#_4-\u4FEE\u6539\u4E3B\u542F\u52A8\u7C7B\u548Cdatasourceproxyconfig\u7C7B" aria-hidden="true">#</a> \u2463 \u4FEE\u6539\u4E3B\u542F\u52A8\u7C7B\u548CDataSourceProxyConfig\u7C7B</h6><p>######## \u4E3B\u542F\u52A8\u7C7B</p><p>\u4E3B\u542F\u52A8\u7C7B\u52A0\u4E0A@EnableAutoDataSourceProxy\u6CE8\u89E3\uFF0C\u8FD9\u91CC\u4EE5storage\u7684\u5FAE\u670D\u52A1\u4E3A\u4F8B\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>seata<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span></span><span class="token class-name">EnableAutoDataSourceProxy</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span><span class="token class-name">DataSourceAutoConfiguration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>client<span class="token punctuation">.</span>discovery<span class="token punctuation">.</span></span><span class="token class-name">EnableDiscoveryClient</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span>openfeign<span class="token punctuation">.</span></span><span class="token class-name">EnableFeignClients</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootApplication</span><span class="token punctuation">(</span>exclude <span class="token operator">=</span> <span class="token class-name">DataSourceAutoConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableDiscoveryClient</span>
<span class="token annotation punctuation">@EnableFeignClients</span>
<span class="token annotation punctuation">@EnableAutoDataSourceProxy</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StorageMainApp2002</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">StorageMainApp2002</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>######## \u914D\u7F6E\u7C7B</p><p>\u4F7F\u7528**@EnableAutoDataSourceProxy<strong>\u6CE8\u89E3\u540E\uFF0C\u4E0D\u518D\u9700\u8981DataSourceProxyConfig\u914D\u7F6E\u6570\u636E\u6E90\u4EE3\u7406\u3002\u5F3A\u884C\u5199\u4F1A\u62A5\u9519\u3002\u5982\u679C\u9700\u8981\u81EA\u5DF1\u914D\u7F6E\u6570\u636E\u6E90\u4EE3\u7406\u7684\u8BDD\uFF0C\u5728application.yml\u4E2D\u8BBE\u7F6E</strong>seata.enable-auto-data-source-proxy<strong>\u4E3A</strong>false**\uFF0C\u4E3B\u542F\u52A8\u7C7B\u4E0A\u53BB\u6389**@EnableAutoDataSourceProxy**\u6CE8\u89E3\u5373\u53EF\u3002</p><p>######## \u53C2\u8003\u535A\u5BA2</p>`,28),Dp={href:"https://blog.csdn.net/ww_run/article/details/120099870?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1.no_search_link&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-1.no_search_link",target:"_blank",rel:"noopener noreferrer"},Bp=s("Seata1.4.2+Nacos\u642D\u5EFA\u4F7F\u7528"),Mp={href:"https://blog.csdn.net/potatoillusion/article/details/117827986?spm=1001.2101.3001.6650.3&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-3.no_search_link&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-3.no_search_link",target:"_blank",rel:"noopener noreferrer"},Pp=s("Seata1.4.2\u6574\u5408SpringCloud H\u2014\u2014Seata\u5B89\u88C5\u4E0E\u642D\u5EFA"),Op={href:"https://blog.csdn.net/ClearCiM/article/details/119953255",target:"_blank",rel:"noopener noreferrer"},Fp=s("https://blog.csdn.net/ClearCiM/article/details/119953255"),Up={href:"https://blog.csdn.net/tyvbpq/article/details/119703363?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~aggregatepage~first_rank_ecpm_v1~rank_v31_ecpm-10-119703363.pc_agg_new_rank&utm_term=dataid+nacos+seata+%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83&spm=1000.2123.3001.4430",target:"_blank",rel:"noopener noreferrer"},Hp=s("spring cloud\u4F7F\u7528nacos\u548Cseata\uFF08windows\u73AF\u5883\uFF09"),Gp={href:"https://blog.csdn.net/hongtaolong/article/details/120144437?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~aggregatepage~first_rank_ecpm_v1~rank_v31_ecpm-7-120144437.pc_agg_new_rank&utm_term=dataid+nacos+seata+%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83&spm=1000.2123.3001.4430",target:"_blank",rel:"noopener noreferrer"},Vp=s("SEATA\u914D\u5408nacos\u4F7F\u7528"),Qp=p('<h3 id="\u56DB\u3001\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#\u56DB\u3001\u6D4B\u8BD5" aria-hidden="true">#</a> \u56DB\u3001\u6D4B\u8BD5</h3><h5 id="seata\u5168\u5C40\u4E8B\u52A1\u600E\u4E48\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#seata\u5168\u5C40\u4E8B\u52A1\u600E\u4E48\u4F7F\u7528" aria-hidden="true">#</a> Seata\u5168\u5C40\u4E8B\u52A1\u600E\u4E48\u4F7F\u7528</h5><p>Spring\u63D0\u4F9B\u7684\u672C\u5730\u4E8B\u52A1\uFF1A@Transactional</p><p>Seata\u63D0\u4F9B\u7684\u5168\u5C40\u4E8B\u52A1\uFF1A@GlobalTransactional</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636880513744-d81289ab-be90-4832-b76c-facc47ef00d9.png" alt="img"></p><h5 id="_4-0-\u6570\u636E\u5E93\u521D\u59CB\u60C5\u51B5" tabindex="-1"><a class="header-anchor" href="#_4-0-\u6570\u636E\u5E93\u521D\u59CB\u60C5\u51B5" aria-hidden="true">#</a> 4.0 \u6570\u636E\u5E93\u521D\u59CB\u60C5\u51B5</h5><p>\u4E0B\u8BA2\u5355-&gt;\u51CF\u5E93\u5B58-&gt;\u6263\u4F59\u989D-&gt;\u6539(\u8BA2\u5355)\u72B6\u6001</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636880852242-f2460919-e326-4d4e-89b6-78c348c2eedd.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636880870145-b34edc59-33e6-415b-a2c5-b94c70955f73.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636880884317-f5faa635-ee75-457e-8c66-294a360f6083.png" alt="img"></p><h5 id="_4-1-\u6D4B\u8BD5\u6B63\u5E38\u4E0B\u5355" tabindex="-1"><a class="header-anchor" href="#_4-1-\u6D4B\u8BD5\u6B63\u5E38\u4E0B\u5355" aria-hidden="true">#</a> 4.1 \u6D4B\u8BD5\u6B63\u5E38\u4E0B\u5355</h5><p>\u542F\u52A8nacos\u3001seata\u30012001\u30012002\u30012003\uFF1B</p>',12),zp=s("\u6D4B\u8BD5\uFF1A"),Kp={href:"http://localhost:2001/order/create?userId=1&productId=1&count=10&money=100",target:"_blank",rel:"noopener noreferrer"},Yp=s("http://localhost:2001/order/create?userId=1&productId=1&count=10&money=100"),Xp=n("h6",{id:"\u62A5\u9519",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u62A5\u9519","aria-hidden":"true"},"#"),s(" \u62A5\u9519")],-1),Wp=n("p",null,[n("strong",null,[s("java.sql.SQLException:Failed to fetch schema of "),n("code",null,"t_order")])],-1),$p=n("p",null,"Connector/J 5.0.0\u4EE5\u540E\u7684\u7248\u672C\u6709\u4E00\u4E2A\u540D\u4E3AuseInformationSchema\u7684\u6570\u636E\u5E93\u8FDE\u63A5\u53C2\u6570\uFF0CConnector/J \u5728mysql8.0\u4E2D\u9ED8\u8BA4\u914D\u7F6E\u8FDE\u63A5\u5C5E\u6027useInformationSchema\u4E3Atrue\uFF0C\u4F7F\u67E5\u8BE2table\u4FE1\u606F\u65F6\u66F4\u4E3A\u6709\u6548\u3002\u7528\u6237\u4F9D\u7136\u53EF\u4EE5\u914D\u7F6EuseInformationSchema\u4E3Afalse\uFF0C\u4F46\u662F\u57288.0.3\u53CA\u5176\u4E4B\u540E\u7684\u7248\u672C\u4E2D\uFF0C\u7531\u4E8E\u4E0D\u80FD\u652F\u6301\u65E9\u671F\u7684\u7279\u6027\uFF0C\u67D0\u4E9B\u6570\u636E\u5B57\u5178\u7684\u67E5\u8BE2\u53EF\u80FD\u4F1A\u5931\u8D25\u3002",-1),Jp=n("p",null,"useInformationSchema\u914D\u7F6E\u4E3Afalse\u7684\u65F6\u5019\uFF0C\u4E5F\u53EF\u80FD\u4F1A\u9020\u6210REMARKS\u4FE1\u606F\uFF08\u5BF9\u5E94\u6570\u636E\u5E93\u4E2D\u5404\u5B57\u6BB5\u7684comment\uFF09\u7684\u7F3A\u5931\u3002",-1),Zp=n("p",null,[n("img",{src:"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636885157700-4b671044-f674-448a-b790-687be655d1c5.png",alt:"img"})],-1),ne=s("\u5728\u5404\u5FAE\u670D\u52A1\u7684application.yml \u6587\u4EF6\u7684spring.datasource.url \u540E\u9762\u52A0\u4E0A"),se=n("code",null,"&useInformationSchema=false",-1),ae=s("\u8BBE\u7F6EuseInformationSchema\u4E3Afalse\uFF0C\u5373\u53EF\u89E3\u51B3\u8BE5\u95EE\u9898\u3002 \u53C2\u8003\uFF1A"),te={href:"https://www.jianshu.com/p/acc99f891e91",target:"_blank",rel:"noopener noreferrer"},pe=s("https://www.jianshu.com/p/acc99f891e91"),ee=p(`<h6 id="\u518D\u6B21\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#\u518D\u6B21\u6D4B\u8BD5" aria-hidden="true">#</a> \u518D\u6B21\u6D4B\u8BD5</h6><p>\u8BBF\u95EE\u6210\u529F</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636885386660-f73be4c7-8f96-4436-928d-1b8924c3e812.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636886967312-d6cb850f-eef7-43bb-be02-6c9e46b69755.png" alt="img"></p><p>\u6570\u636E\u5E93\u60C5\u51B5\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636885516045-e1f6a2a8-5637-4893-b021-97562e32d8cc.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636885537110-40bda427-d547-423d-9538-eff77ce3141d.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636885554249-edf1239b-27f2-4718-b529-1668c3229230.png" alt="img"></p><h5 id="_4-2-\u6D4B\u8BD5\u8D85\u65F6\u5F02\u5E38-\u4E0D\u52A0-globaltransactional" tabindex="-1"><a class="header-anchor" href="#_4-2-\u6D4B\u8BD5\u8D85\u65F6\u5F02\u5E38-\u4E0D\u52A0-globaltransactional" aria-hidden="true">#</a> 4.2 \u6D4B\u8BD5\u8D85\u65F6\u5F02\u5E38\uFF1A\u4E0D\u52A0@GlobalTransactional</h5><h6 id="accountserviceimpl\u6DFB\u52A0\u8D85\u65F6" tabindex="-1"><a class="header-anchor" href="#accountserviceimpl\u6DFB\u52A0\u8D85\u65F6" aria-hidden="true">#</a> AccountServiceImpl\u6DFB\u52A0\u8D85\u65F6\uFF1A</h6><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636887315777-49f3f304-95a5-4e84-84e1-db98d2063d0a.png" alt="img"></p><p>\u6211\u4EEC\u4F7F\u7528\u7684\u662FOpenfeign\uFF0C\u9ED8\u8BA4\u8D85\u65F6\u65F6\u957F\u662F1s\uFF0C\u8FD9\u91CC\u6211\u4EEC\u5EF6\u8FDF30s\u3002</p><h6 id="\u62A5\u9519\u8D85\u65F6\u5F02\u5E38" tabindex="-1"><a class="header-anchor" href="#\u62A5\u9519\u8D85\u65F6\u5F02\u5E38" aria-hidden="true">#</a> \u62A5\u9519\u8D85\u65F6\u5F02\u5E38\uFF1A</h6><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636887516874-e984a427-fd14-49c6-a025-d8a2ec94f904.png" alt="img"></p><h6 id="\u6570\u636E\u5E93\u60C5\u51B5" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u5E93\u60C5\u51B5" aria-hidden="true">#</a> \u6570\u636E\u5E93\u60C5\u51B5\uFF1A</h6><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636887749627-98e85882-a208-4380-beb1-3f68531995d2.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636887791521-b7101ffd-ac2f-4d8c-9be1-aea20ea51d7c.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636887816708-5257dccc-a554-410a-8e0d-2f742a3e26cd.png" alt="img"></p><p>\u5F53\u5E93\u5B58\u548C\u8D26\u6237\u91D1\u989D\u6263\u51CF\u540E\uFF0C\u8BA2\u5355\u72B6\u6001\u5E76\u6CA1\u6709\u8BBE\u7F6E\u4E3A\u5DF2\u7ECF\u5B8C\u6210\uFF0C\u6CA1\u6709\u4ECE\u96F6\u6539\u4E3A1\uFF1B\u800C\u4E14\u7531\u4E8Efeign\u7684\u91CD\u8BD5\u673A\u5236\uFF0C\u8D26\u6237\u4F59\u989D\u8FD8\u6709\u53EF\u80FD\u88AB\u591A\u6B21\u6263\u51CF\u3002</p><h5 id="_4-3-\u6D4B\u8BD5\u8D85\u65F6\u5F02\u5E38-\u52A0-globaltransactional" tabindex="-1"><a class="header-anchor" href="#_4-3-\u6D4B\u8BD5\u8D85\u65F6\u5F02\u5E38-\u52A0-globaltransactional" aria-hidden="true">#</a> 4.3 \u6D4B\u8BD5\u8D85\u65F6\u5F02\u5E38\uFF1A\u52A0@GlobalTransactional</h5><p>OrderServiceImpl\u6DFB\u52A0**@GlobalTransactional**\u6CE8\u89E3\uFF0C\u6CE8\u610F\u6539\u6CE8\u89E3\u53EA\u80FD\u7528\u5728\u65B9\u6CD5\u4E0A\uFF01</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636888242942-a1c827b4-5ec0-4515-bf74-e1e6f358cdbf.png" alt="img"></p><ul><li>name\uFF1A\u7ED9\u5B9A\u5168\u5C40\u4E8B\u52A1\u5B9E\u4F8B\u7684\u540D\u79F0\uFF0C\u968F\u4FBF\u53D6\uFF0C\u552F\u4E00\u5373\u53EF</li><li>rollbackFor\uFF1A\u5F53\u53D1\u751F\u4EC0\u4E48\u6837\u7684\u5F02\u5E38\u65F6\uFF0C\u8FDB\u884C\u56DE\u6EDA</li><li>noRollbackFor\uFF1A\u53D1\u751F\u4EC0\u4E48\u6837\u7684\u5F02\u5E38\u4E0D\u8FDB\u884C\u56DE\u6EDA\u3002</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">Impl</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>dao<span class="token punctuation">.</span></span><span class="token class-name">OrderDao</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Order</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">AccountService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">OrderService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>atguigu<span class="token punctuation">.</span>cloudalibaba<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">StorageService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>seata<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GlobalTransactional</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Resource</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">OrderService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">OrderDao</span> orderDao<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">StorageService</span> storageService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Resource</span>
    <span class="token keyword">private</span> <span class="token class-name">AccountService</span> accountService<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * \u521B\u5EFA\u8BA2\u5355-&gt;\u8C03\u7528\u5E93\u5B58\u670D\u52A1\u6263\u51CF\u5E93\u5B58-&gt;\u8C03\u7528\u8D26\u6237\u670D\u52A1\u6263\u51CF\u8D26\u6237\u4F59\u989D-&gt;\u4FEE\u6539\u8BA2\u5355\u72B6\u6001
     * \u7B80\u5355\u8BF4\uFF1A
     * \u4E0B\u8BA2\u5355-&gt;\u51CF\u5E93\u5B58-&gt;\u51CF\u4F59\u989D-&gt;\u6539\u72B6\u6001
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token comment">//\u5168\u5C40\u4E8B\u52A1\uFF0C\u53D1\u751F\u5F02\u5E38\u8FDB\u884C\u56DE\u6EDA</span>
    <span class="token annotation punctuation">@GlobalTransactional</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;lsp-create-order&quot;</span><span class="token punctuation">,</span> rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Order</span> order<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;\u4E0B\u5355\u5F00\u59CB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u672C\u5E94\u7528\u521B\u5EFA\u8BA2\u5355</span>
        orderDao<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//\u8FDC\u7A0B\u8C03\u7528\u5E93\u5B58\u670D\u52A1\u6263\u51CF\u5E93\u5B58</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;\u8BA2\u5355\u5FAE\u670D\u52A1\u8C03\u7528\u5E93\u5B58\u5FAE\u670D\u52A1\uFF0C\u6263\u51CF\u5E93\u5B58\u5F00\u59CB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        storageService<span class="token punctuation">.</span><span class="token function">decrease</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getProductId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>order<span class="token punctuation">.</span><span class="token function">getCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;\u8BA2\u5355\u5FAE\u670D\u52A1\u8C03\u7528\u5E93\u5B58\u5FAE\u670D\u52A1\uFF0C\u6263\u51CF\u5E93\u5B58\u7ED3\u675F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//\u8FDC\u7A0B\u8C03\u7528\u8D26\u6237\u670D\u52A1\u6263\u51CF\u4F59\u989D</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;\u8BA2\u5355\u5FAE\u670D\u52A1\u8C03\u7528\u8D26\u6237\u5FAE\u670D\u52A1\uFF0C\u6263\u51CF\u4F59\u989D\u5F00\u59CB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        accountService<span class="token punctuation">.</span><span class="token function">decrease</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>order<span class="token punctuation">.</span><span class="token function">getMoney</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;\u8BA2\u5355\u5FAE\u670D\u52A1\u8C03\u7528\u8D26\u6237\u5FAE\u670D\u52A1\uFF0C\u51CF\u4F59\u989D\u7ED3\u675F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//\u4FEE\u6539\u8BA2\u5355\u72B6\u6001\u4E3A\u5DF2\u5B8C\u6210</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;order-service\u4E2D\u4FEE\u6539\u8BA2\u5355\u72B6\u6001\u5F00\u59CB&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8FD9\u91CC\u7684\u8BDD\u662F\u4E0D\u662F\u5E94\u8BE5\u662ForderId\uFF1F</span>
        orderDao<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>order<span class="token punctuation">.</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;order-service\u4E2D\u4FEE\u6539\u8BA2\u5355\u72B6\u6001\u7ED3\u675F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;-------&gt;\u4E0B\u5355\u7ED3\u675F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6D4B\u8BD5\uFF1A</p><p>\u4F9D\u7136\u8D85\u65F6\u5F02\u5E38</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636888529834-49d19c5c-0783-40b5-9200-801af4a1135e.png" alt="img"></p><p>\u6570\u636E\u5E93\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636888594617-08abffce-914c-4c7e-812f-821a487cdac0.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636888612571-33a3fca6-5c67-4c45-ab54-07cb3beee91e.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636888631676-3966be70-025d-446f-99bc-77d1872131b9.png" alt="img"></p><p>\u6211\u4EEC\u53D1\u73B0\u6570\u636E\u5E93\u4E2D\u7684\u6570\u636E\u6839\u672C\u5C31\u6CA1\u6709\u53D8\u5316\uFF0C\u8BB0\u5F55\u90FD\u6DFB\u52A0\u4E0D\u8FDB\u6765\uFF0C\u8BF4\u660E\u56DE\u6EDA\u6210\u529F\uFF01</p><h5 id="_4-4-\u5C0F\u7ED3" tabindex="-1"><a class="header-anchor" href="#_4-4-\u5C0F\u7ED3" aria-hidden="true">#</a> 4.4 \u5C0F\u7ED3</h5><p>\u505A\u597D\u914D\u7F6E\u540E\uFF0C\u6211\u4EEC\u53EA\u9700\u8981\u4F7F\u7528\u4E00\u4E2A @GlobalTransactional(name = &quot;lsp-create-order&quot;, rollbackFor = Exception.class) \u653E\u5728\u4E1A\u52A1\u7684\u5165\u53E3\uFF0C\u5373\u53EF\u5B9E\u73B0\u63A7\u5236\u5168\u5C40\u7684\u4E8B\u52A1\u3002\u6CE8\u610F\u8BE5\u6CE8\u89E3\u53EA\u80FD\u653E\u5728\u65B9\u6CD5\u4E0A\u3002</p><h3 id="\u4E94\u3001\u8865\u5145\u8BF4\u660E" tabindex="-1"><a class="header-anchor" href="#\u4E94\u3001\u8865\u5145\u8BF4\u660E" aria-hidden="true">#</a> \u4E94\u3001\u8865\u5145\u8BF4\u660E</h3><p>Seata\uFF1ASimple Extensible Autonomous Transaction Architecture\uFF0C\u7B80\u5355\u53EF\u6269\u5C55\u81EA\u6CBB\u4E8B\u52A1\u6846\u67B6</p><p>0.9\u4E0D\u652F\u6301\u96C6\u7FA4\uFF0C\u751F\u4EA7\u73AF\u5883\u8BF7\u4F7F\u75281.0\u4EE5\u4E0A\u7684\u7248\u672C\u3002</p><h5 id="_5-0-undo-log\u8868\u7684\u4F5C\u7528" tabindex="-1"><a class="header-anchor" href="#_5-0-undo-log\u8868\u7684\u4F5C\u7528" aria-hidden="true">#</a> 5.0 undo_log\u8868\u7684\u4F5C\u7528</h5><p>\u6A21\u5757\u5185\u65B9\u6CD5\u4E5F\u53EF\u4EE5\u52A0@Transactional\u6CE8\u89E3\uFF0C\u5982\u679C\u4E00\u4E2A\u6A21\u5757\u7684\u4E8B\u52A1\u63D0\u4EA4\u4E86\uFF0CSeata\u4F1A\u628A\u63D0\u4EA4\u4E86\u54EA\u4E9B\u6570\u636E\u8BB0\u5F55\u5230undo_log\u8868\u4E2D\uFF0C\u5982\u679C\u8FD9\u65F6TC\u901A\u77E5\u5168\u5C40\u4E8B\u52A1\u56DE\u6EDA\uFF0C\u90A3\u4E48RM\u5C31\u4ECEundo_log\u8868\u4E2D\u83B7\u53D6\u4E4B\u524D\u4FEE\u6539\u4E86\u54EA\u4E9B\u8D44\u6E90\uFF0C\u5E76\u6839\u636E\u8FD9\u4E2A\u8868\u56DE\u6EDA\u3002\uFF08\u6709\u5F85\u8003\u8BC1\uFF09</p><h5 id="_5-1-\u518D\u770Btc-tm-rm\u4E09\u5927\u7EC4\u4EF6" tabindex="-1"><a class="header-anchor" href="#_5-1-\u518D\u770Btc-tm-rm\u4E09\u5927\u7EC4\u4EF6" aria-hidden="true">#</a> 5.1 \u518D\u770BTC/TM/RM\u4E09\u5927\u7EC4\u4EF6</h5><p>TC\uFF1Aseata\u670D\u52A1\u5668\uFF1B \uFF08\u6211\u4EEC\u7535\u8111\u4E0A\u542F\u52A8\u7684seata \uFF09</p><p>TM\uFF1A\u4E8B\u7269\u7684\u53D1\u8D77\u8005\uFF0C\u4E1A\u52A1\u7684\u5165\u53E3\u3002 \u54EA\u4E2A\u5FAE\u670D\u52A1\u4F7F\u7528\u4E86**@GlobalTransactional**\u54EA\u4E2A\u5C31\u662FTM</p><p>RM\uFF1A\u4E8B\u52A1\u7684\u53C2\u4E0E\u8005\uFF0C\u4E00\u4E2A\u6570\u636E\u5E93\u5C31\u662F\u4E00\u4E2ARM\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636890980594-f9db0624-1c09-4055-8c65-5c087d16b36f.png" alt="img"></p><p>\u5206\u5E03\u5F0F\u4E8B\u52A1\u7684\u6267\u884C\u6D41\u7A0B\uFF1A</p><ol><li>TM \u5F00\u542F\u5206\u5E03\u5F0F\u4E8B\u52A1\uFF08TM \u5411 TC \u6CE8\u518C\u5168\u5C40\u4E8B\u52A1\u8BB0\u5F55\uFF09\uFF1B</li><li>\u6309\u4E1A\u52A1\u573A\u666F\uFF0C\u7F16\u6392\u6570\u636E\u5E93\u3001\u670D\u52A1\u7B49\u4E8B\u52A1\u5185\u8D44\u6E90\uFF08RM \u5411 TC \u6C47\u62A5\u8D44\u6E90\u51C6\u5907\u72B6\u6001 \uFF09\uFF1B</li><li>TM \u7ED3\u675F\u5206\u5E03\u5F0F\u4E8B\u52A1\uFF0C\u4E8B\u52A1\u4E00\u9636\u6BB5\u7ED3\u675F\uFF08TM \u901A\u77E5 TC \u63D0\u4EA4/\u56DE\u6EDA\u5206\u5E03\u5F0F\u4E8B\u52A1\uFF09\uFF1B</li><li>TC \u6C47\u603B\u4E8B\u52A1\u4FE1\u606F\uFF0C\u51B3\u5B9A\u5206\u5E03\u5F0F\u4E8B\u52A1\u662F\u63D0\u4EA4\u8FD8\u662F\u56DE\u6EDA\uFF1B</li><li>TC \u901A\u77E5\u6240\u6709 RM \u63D0\u4EA4/\u56DE\u6EDA \u8D44\u6E90\uFF0C\u4E8B\u52A1\u4E8C\u9636\u6BB5\u7ED3\u675F\u3002</li></ol><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636890679040-20e2d483-549c-459a-b481-693caab0d239.png" alt="img"></p><h5 id="_5-2-at\u6A21\u5F0F-\u9ED8\u8BA4-\u5982\u4F55\u505A\u5230\u5BF9\u4E1A\u52A1\u7684\u65E0\u4FB5\u5165" tabindex="-1"><a class="header-anchor" href="#_5-2-at\u6A21\u5F0F-\u9ED8\u8BA4-\u5982\u4F55\u505A\u5230\u5BF9\u4E1A\u52A1\u7684\u65E0\u4FB5\u5165" aria-hidden="true">#</a> 5.2 AT\u6A21\u5F0F\uFF08\u9ED8\u8BA4\uFF09\u5982\u4F55\u505A\u5230\u5BF9\u4E1A\u52A1\u7684\u65E0\u4FB5\u5165</h5><p>Seata\u6709\u56DB\u5927\u6A21\u5F0F\uFF1AAT\uFF08\u9ED8\u8BA4\uFF09\u3001TCC\u3001SAGA\u3001XA\u3002\uFF08\u963F\u91CC\u4E91\u4E0A\u7684AT\u53EB\u505AGTS\uFF0C\u6536\u8D39\uFF09</p>`,49),oe={href:"http://seata.io/zh-cn/docs/dev/mode/at-mode.html",target:"_blank",rel:"noopener noreferrer"},ce=s("AT\u6A21\u5F0F"),le=p('<p>AT\u6A21\u5F0F\u4E24\u9636\u6BB5\u63D0\u4EA4\u534F\u8BAE\u7684\u6F14\u53D8\uFF1A</p><ul><li><p>\u4E00\u9636\u6BB5\uFF1A\u4E1A\u52A1\u6570\u636E\u548C\u56DE\u6EDA\u65E5\u5FD7\u8BB0\u5F55\u5728\u540C\u4E00\u4E2A\u672C\u5730\u4E8B\u52A1\u4E2D\u63D0\u4EA4\uFF0C\u91CA\u653E\u672C\u5730\u9501\u548C\u8FDE\u63A5\u8D44\u6E90\u3002</p></li><li><p>\u4E8C\u9636\u6BB5\uFF1A</p></li><li><ul><li>\u63D0\u4EA4\u5F02\u6B65\u5316\uFF0C\u975E\u5E38\u5FEB\u901F\u5730\u5B8C\u6210\u3002</li></ul></li><li><p>\u56DE\u6EDA\u901A\u8FC7\u4E00\u9636\u6BB5\u7684\u56DE\u6EDA\u65E5\u5FD7\u8FDB\u884C\u53CD\u5411\u8865\u507F\uFF08\u524D\u9762insert\uFF0C\u540E\u9762\u56DE\u6EDA\u65F6\u5C31delete\uFF09\u3002</p></li></ul><p>\u6BCF\u4E2A\u6570\u636E\u5E93\u9664\u4E86\u81EA\u8EAB\u5B58\u50A8\u6570\u636E\u7684\u8868\u4EE5\u5916\uFF0C\u90FD\u4F1A\u6709\u4E00\u4E2A\u4E8B\u52A1\u56DE\u6EDA\u8868\uFF1Aundo_log</p><p>Seata\u5E93\u4E2D\u5B58\u5728\uFF1Abranch_table\\global_table\\lock_table\\distributed_lock(\u9AD8\u7248\u672C\u624D\u6709)\u8FD9\u6837\u4E00\u4E9B\u8868</p><h6 id="_5-2-1-\u4E00\u9636\u6BB5\u52A0\u8F7D" tabindex="-1"><a class="header-anchor" href="#_5-2-1-\u4E00\u9636\u6BB5\u52A0\u8F7D" aria-hidden="true">#</a> 5.2.1 \u4E00\u9636\u6BB5\u52A0\u8F7D</h6><p>\u5728\u4E00\u9636\u6BB5\uFF0CSeata \u4F1A\u62E6\u622A\u201C\u4E1A\u52A1 SQL\u201D\uFF0C</p><p>1 \u89E3\u6790 SQL \u8BED\u4E49\uFF0C\u627E\u5230\u201C\u4E1A\u52A1 SQL\u201D\u8981\u66F4\u65B0\u7684\u4E1A\u52A1\u6570\u636E\uFF0C\u5728\u4E1A\u52A1\u6570\u636E\u88AB\u66F4\u65B0\u524D\uFF0C\u5C06\u5176\u4FDD\u5B58\u6210\u201Cbefore image\u201D\uFF08\u524D\u7F6E\u955C\u50CF\uFF09</p><p>2 \u6267\u884C\u201C\u4E1A\u52A1 SQL\u201D\u66F4\u65B0\u4E1A\u52A1\u6570\u636E\uFF0C\u5728\u4E1A\u52A1\u6570\u636E\u66F4\u65B0\u4E4B\u540E\uFF0C</p><p>3 \u5176\u4FDD\u5B58\u6210\u201Cafter image\u201D\uFF0C\u6700\u540E\u751F\u6210\u884C\u9501\u3002</p><p>\u4EE5\u4E0A\u64CD\u4F5C\u5168\u90E8\u5728\u4E00\u4E2A\u6570\u636E\u5E93\u4E8B\u52A1\u5185\u5B8C\u6210\uFF0C\u8FD9\u6837\u4FDD\u8BC1\u4E86\u4E00\u9636\u6BB5\u64CD\u4F5C\u7684\u539F\u5B50\u6027\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636892157973-e4a5ccaf-71c5-481e-9417-6b64d389f36f.png" alt="img"></p><h6 id="_5-2-2-\u4E8C\u9636\u6BB5\u63D0\u4EA4" tabindex="-1"><a class="header-anchor" href="#_5-2-2-\u4E8C\u9636\u6BB5\u63D0\u4EA4" aria-hidden="true">#</a> 5.2.2 \u4E8C\u9636\u6BB5\u63D0\u4EA4</h6><p>\u56E0\u4E3A\u201C\u4E1A\u52A1 SQL\u201D\u5728<strong>\u4E00\u9636\u6BB5</strong>\u5DF2\u7ECF\u63D0\u4EA4\u81F3\u6570\u636E\u5E93\uFF0C<strong>\u4E8C\u9636\u6BB5\u5982\u679C\u987A\u5229\u63D0\u4EA4\u7684\u8BDD</strong>\uFF0C\u90A3\u4E48Seata\u6846\u67B6\u53EA\u9700\u5C06\u4E00\u9636\u6BB5\u4FDD\u5B58\u7684\u5FEB\u7167\u6570\u636E\u548C\u884C\u9501\u5220\u6389\uFF0C\u5B8C\u6210\u6570\u636E\u6E05\u7406\u5373\u53EF\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636892304290-bd0f0263-9336-4877-bf03-59f5f86cfe87.png" alt="img"></p><h6 id="_5-2-3-\u4E8C\u9636\u6BB5\u56DE\u6EDA" tabindex="-1"><a class="header-anchor" href="#_5-2-3-\u4E8C\u9636\u6BB5\u56DE\u6EDA" aria-hidden="true">#</a> 5.2.3 \u4E8C\u9636\u6BB5\u56DE\u6EDA</h6><p>\u4E8C\u9636\u6BB5\u5982\u679C\u662F\u56DE\u6EDA\u7684\u8BDD\uFF0CSeata \u5C31\u9700\u8981\u56DE\u6EDA\u4E00\u9636\u6BB5\u5DF2\u7ECF\u6267\u884C\u7684\u201C\u4E1A\u52A1 SQL\u201D\uFF0C\u8FD8\u539F\u4E1A\u52A1\u6570\u636E\u3002</p><p>\u56DE\u6EDA\u65B9\u5F0F\u4FBF\u662F\u7528\u201Cbefore image\u201D\u8FD8\u539F\u4E1A\u52A1\u6570\u636E\uFF1B\u4F46\u5728\u8FD8\u539F\u524D\u8981\u9996\u5148\u8981\u6821\u9A8C\u810F\u5199\uFF0C\u5BF9\u6BD4\u201C\u6570\u636E\u5E93\u5F53\u524D\u4E1A\u52A1\u6570\u636E\u201D\u548C \u201Cafter image\u201D\u3002\u5982\u679C\u4E24\u4EFD\u6570\u636E\u5B8C\u5168\u4E00\u81F4\u5C31\u8BF4\u660E\u6CA1\u6709\u810F\u5199\uFF0C\u53EF\u4EE5\u8FD8\u539F\u4E1A\u52A1\u6570\u636E\uFF0C\u5982\u679C\u4E0D\u4E00\u81F4\u5C31\u8BF4\u660E\u6709\u810F\u5199\uFF0C\u51FA\u73B0\u810F\u5199\u5C31\u9700\u8981\u8F6C\u4EBA\u5DE5\u5904\u7406\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636892634620-1e6c1596-baba-4aed-b840-8afdfd320e05.png" alt="img"></p><h5 id="_5-3-debug\u67E5\u770B\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#_5-3-debug\u67E5\u770B\u6D41\u7A0B" aria-hidden="true">#</a> 5.3 debug\u67E5\u770B\u6D41\u7A0B</h5><p>\u6700\u5F00\u662Fseata\u5E93\u4E2D\u7684\u4E09\u5F20\u8868\u662F\u6CA1\u6709\u6570\u636E\u7684</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636892970332-138694e4-498e-4c57-82a3-9ed40feea4df.png" alt="img"></p><p>2003\u6253\u4E0A\u65AD\u70B9\uFF0Cdebug\u542F\u52A8</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636892865851-b541d0b7-3e91-463f-9bd2-628c25379099.png" alt="img"></p>',23),ie=s("\u8BBF\u95EE"),ue={href:"http://localhost:2001/order/create?userId=1&productId=1&count=10&money=100%E3%80%82",target:"_blank",rel:"noopener noreferrer"},ke=s("http://localhost:2001/order/create?userId=1&productId=1&count=10&money=100\u3002"),re=p(`<p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636893040133-6768d513-0c8a-4d32-a308-35c88331fce8.png" alt="img"></p><p>\u6B64\u65F6seata\u5E93\u4E2D\u7684\u4E09\u4E2A\u8868\u90FD\u662F\u6709\u6570\u636E\u7684\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636893186504-d9e4f100-7ad0-4235-b27c-9b0565fefc9a.png" alt="img"></p><p>\u770B\u4E00\u4E0Bbranch_table\uFF0C\u8BB0\u5F55\u4E86\u5404\u4E2ARM\u7684\u4FE1\u606F\uFF0C\u5206\u522B\u5BF9\u5E94order\u3001storage\u3001account\u4E09\u4E2A\u5FAE\u670D\u52A1</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636893708587-5f6e35c2-bed9-4c95-9927-6c3c45dd1856.png" alt="img"></p><p>\u53EF\u4EE5\u770B\u5230xid\u8DDFglobal_table\u4E2D\u7684xid\u4E00\u81F4\u3002</p><p>\u518D\u770Bglobal_table\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636893900347-9735778c-ccf0-41a4-8b31-701541eb2db2.png" alt="img"></p><p>\u67E5\u770Block_table\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636894052476-c9a96333-e331-4d37-bdd1-28d92feadb68.png" alt="img"></p><p>\u67E5\u770B\u5404\u4E1A\u52A1\u4E2D\u7684undo_log\u8868\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636894224215-644fbe92-cec7-4f64-b4d5-9a3aab5daf85.png" alt="img"></p><p>rollback_info\u662FJSON\u5B57\u7B26\u4E32\uFF0C\u5B58\u50A8\u4E86beforeimage\u3001afterimage\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;@class&quot;</span><span class="token operator">:</span> <span class="token string">&quot;io.seata.rm.datasource.undo.BranchUndoLog&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;xid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;192.168.190.1:8091:2090602861&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;branchId&quot;</span><span class="token operator">:</span> <span class="token number">2090602864</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sqlUndoLogs&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;java.util.ArrayList&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;@class&quot;</span><span class="token operator">:</span> <span class="token string">&quot;io.seata.rm.datasource.undo.SQLUndoLog&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;sqlType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;INSERT&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;tableName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\`t_order\`&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;beforeImage&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>   
          <span class="token property">&quot;@class&quot;</span><span class="token operator">:</span> <span class="token string">&quot;io.seata.rm.datasource.sql.struct.TableRecords$EmptyTableRecords&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;tableName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\`t_order\`&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;rows&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;java.util.ArrayList&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span><span class="token punctuation">]</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">&quot;afterImage&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;@class&quot;</span><span class="token operator">:</span> <span class="token string">&quot;io.seata.rm.datasource.sql.struct.TableRecords&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;tableName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;\`t_order\`&quot;</span><span class="token punctuation">,</span>
          <span class="token property">&quot;rows&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token string">&quot;java.util.ArrayList&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
              <span class="token punctuation">{</span>
                <span class="token property">&quot;@class&quot;</span><span class="token operator">:</span> <span class="token string">&quot;io.seata.rm.datasource.sql.struct.Row&quot;</span><span class="token punctuation">,</span>
                <span class="token property">&quot;fields&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                  <span class="token string">&quot;java.util.ArrayList&quot;</span><span class="token punctuation">,</span>
                  <span class="token punctuation">[</span>
                    <span class="token punctuation">{</span>
                      <span class="token property">&quot;@class&quot;</span><span class="token operator">:</span> <span class="token string">&quot;io.seata.rm.datasource.sql.struct.Field&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;keyType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;PrimaryKey&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">-5</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token string">&quot;java.lang.Long&quot;</span><span class="token punctuation">,</span>
                        <span class="token number">10</span>
                      <span class="token punctuation">]</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>
                      <span class="token property">&quot;@class&quot;</span><span class="token operator">:</span> <span class="token string">&quot;io.seata.rm.datasource.sql.struct.Field&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user_id&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;keyType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NULL&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">-5</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token string">&quot;java.lang.Long&quot;</span><span class="token punctuation">,</span>
                        <span class="token number">1</span>
                      <span class="token punctuation">]</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>
                      <span class="token property">&quot;@class&quot;</span><span class="token operator">:</span> <span class="token string">&quot;io.seata.rm.datasource.sql.struct.Field&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;product_id&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;keyType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NULL&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">-5</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token string">&quot;java.lang.Long&quot;</span><span class="token punctuation">,</span>
                        <span class="token number">1</span>
                      <span class="token punctuation">]</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>
                      <span class="token property">&quot;@class&quot;</span><span class="token operator">:</span> <span class="token string">&quot;io.seata.rm.datasource.sql.struct.Field&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;count&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;keyType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NULL&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">10</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>
                      <span class="token property">&quot;@class&quot;</span><span class="token operator">:</span> <span class="token string">&quot;io.seata.rm.datasource.sql.struct.Field&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;money&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;keyType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NULL&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token string">&quot;java.math.BigDecimal&quot;</span><span class="token punctuation">,</span>
                        <span class="token number">100</span>
                      <span class="token punctuation">]</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">{</span>
                      <span class="token property">&quot;@class&quot;</span><span class="token operator">:</span> <span class="token string">&quot;io.seata.rm.datasource.sql.struct.Field&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;status&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;keyType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;NULL&quot;</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
                      <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">0</span>
                    <span class="token punctuation">}</span>
                  <span class="token punctuation">]</span>
                <span class="token punctuation">]</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u67E5\u770Bseata_storage\u5E93\u4E2D\u7684undo_log\u8868\u7684roobal_info\u4FE1\u606F\uFF0C\u53EF\u4EE5\u770B\u5230beforeimage\u548Cafterimage\u5206\u522B\u4FDD\u5B58\u4E86\u4FEE\u6539\u524D\u540E\u7684\u4FE1\u606F\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636894851233-f395aad7-5132-4491-a0fd-c90e401e134d.png" alt="img"></p><p>debug\u653E\u884C\uFF0Cseata\u5E93\u4E2D\u8868\u4E2D\u7684\u4E2D\u95F4\u6570\u636E\u548Cundo_log\u8868\u7684\u6570\u636E\u90FD\u5220\u9664\u4E86\u3002\uFF08\u6211\u7684seata_account\u8868\u7684undo_log\u4E2D\u6CA1\u6709\u88AB\u5220\u9664\uFF0C\u7B49\u4E86\u534A\u5929\u4E5F\u6CA1\u6709\u3002\uFF09\u5F02\u6B65\u4EFB\u52A1\u9636\u6BB5\u7684\u5206\u652F\u63D0\u4EA4\u8BF7\u6C42\u5C06\u5F02\u6B65\u548C\u6279\u91CF\u5730\u5220\u9664\u76F8\u5E94\u7684undo_log\u8BB0\u5F55\u3002</p><p>\u53D1\u73B0account2003\u5FAE\u670D\u52A1\u7684\u65E5\u5FD7\u8DDF2001\u548C2002\u90FD\u4E0D\u4E00\u6837</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636895782328-2b4843e2-5f95-4114-9e67-f56109b324c1.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636895848770-086d3c08-3fec-4737-a06d-58f864bf1c7f.png" alt="img"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636895894922-459ce6b3-1c5a-4094-b894-2a6680d9b30c.png" alt="img"></p><h5 id="_5-4-\u6574\u4F53\u6D41\u7A0B\u56FE" tabindex="-1"><a class="header-anchor" href="#_5-4-\u6574\u4F53\u6D41\u7A0B\u56FE" aria-hidden="true">#</a> 5.4 \u6574\u4F53\u6D41\u7A0B\u56FE</h5><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/1636895943341-66b19f9d-e125-4536-8882-5c4c1f26fd91.png" alt="img"></p>`,23);function de(me,ge){const a=l("ExternalLinkIcon");return o(),c("div",null,[u,n("p",null,[n("a",k,[r,t(a)])]),d,m,g,v,b,n("p",null,[n("a",h,[y,t(a)])]),f,n("p",null,[n("a",q,[w,t(a)])]),_,n("p",null,[x,n("a",I,[S,t(a)])]),E,n("p",null,[n("a",A,[C,t(a)])]),n("p",null,[n("a",T,[R,t(a)])]),n("p",null,[L,n("a",N,[j,t(a)])]),D,n("p",null,[n("a",B,[M,t(a)])]),n("p",null,[P,n("a",O,[F,t(a)])]),n("p",null,[n("a",U,[H,t(a)])]),G,n("p",null,[V,n("a",Q,[z,t(a)])]),K,Y,X,W,$,n("p",null,[J,n("a",Z,[nn,t(a)]),sn]),an,tn,pn,n("p",null,[n("a",en,[on,t(a)])]),cn,n("p",null,[ln,n("a",un,[kn,t(a)])]),rn,n("p",null,[dn,n("a",mn,[gn,t(a)])]),vn,bn,n("p",null,[hn,n("a",yn,[fn,t(a)]),qn]),wn,n("p",null,[_n,n("a",xn,[In,t(a)])]),Sn,En,An,Cn,Tn,Rn,Ln,Nn,jn,Dn,Bn,n("p",null,[Mn,n("a",Pn,[On,t(a)])]),Fn,n("p",null,[Un,n("a",Hn,[Gn,t(a)])]),Vn,n("p",null,[n("a",Qn,[zn,t(a)])]),Kn,n("p",null,[n("a",Yn,[Xn,t(a)])]),Wn,n("p",null,[$n,n("a",Jn,[Zn,t(a)]),ns]),ss,n("p",null,[as,n("a",ts,[ps,t(a)]),es]),n("p",null,[os,n("a",cs,[ls,t(a)]),is]),us,n("p",null,[ks,n("a",rs,[ds,t(a)]),ms,n("a",gs,[vs,t(a)]),bs]),hs,n("p",null,[n("a",ys,[fs,t(a)]),qs]),ws,_s,xs,n("p",null,[Is,n("a",Ss,[Es,t(a)])]),n("p",null,[As,n("a",Cs,[Ts,t(a)])]),Rs,n("p",null,[n("a",Ls,[Ns,t(a)])]),js,n("p",null,[n("a",Ds,[Bs,t(a)]),Ms,n("a",Ps,[Os,t(a)])]),Fs,Us,n("p",null,[n("a",Hs,[Gs,t(a)])]),Vs,Qs,n("p",null,[n("a",zs,[Ks,t(a)])]),Ys,n("p",null,[Xs,n("a",Ws,[$s,t(a)])]),Js,n("p",null,[n("a",Zs,[na,t(a)])]),sa,aa,ta,pa,n("p",null,[ea,n("a",oa,[ca,t(a)]),la]),ia,n("p",null,[ua,n("a",ka,[ra,t(a)]),da]),ma,n("p",null,[n("a",ga,[va,t(a)]),ba]),ha,n("p",null,[n("a",ya,[fa,t(a)]),qa]),wa,n("p",null,[n("a",_a,[xa,t(a)])]),Ia,n("p",null,[n("a",Sa,[Ea,t(a)])]),Aa,n("ol",null,[n("li",null,[Ca,n("a",Ta,[Ra,t(a)])])]),La,Na,n("ol",null,[n("li",null,[ja,n("a",Da,[Ba,t(a)])])]),Ma,n("ol",null,[n("li",null,[Pa,n("a",Oa,[Fa,t(a)])])]),Ua,n("p",null,[Ha,n("a",Ga,[Va,t(a)]),Qa]),za,n("p",null,[n("a",Ka,[Ya,t(a)])]),Xa,n("p",null,[Wa,$a,Ja,n("a",Za,[nt,t(a)]),st]),at,n("p",null,[tt,n("a",pt,[et,t(a)])]),ot,n("p",null,[n("a",ct,[lt,t(a)])]),it,n("p",null,[n("a",ut,[kt,t(a)])]),rt,n("p",null,[n("a",dt,[mt,t(a)])]),gt,n("p",null,[vt,n("a",bt,[ht,t(a)])]),yt,n("p",null,[ft,n("a",qt,[wt,t(a)])]),_t,n("p",null,[xt,n("a",It,[St,t(a)])]),Et,n("p",null,[At,n("a",Ct,[Tt,t(a)])]),Rt,n("p",null,[Lt,n("a",Nt,[jt,t(a)])]),Dt,n("p",null,[Bt,n("a",Mt,[Pt,t(a)])]),Ot,n("p",null,[Ft,n("a",Ut,[Ht,t(a)])]),Gt,n("p",null,[n("a",Vt,[Qt,t(a)]),zt,n("a",Kt,[Yt,t(a)])]),Xt,n("p",null,[Wt,n("a",$t,[Jt,t(a)])]),Zt,np,sp,ap,tp,pp,n("p",null,[ep,op,cp,n("a",lp,[ip,t(a)])]),up,n("p",null,[kp,n("a",rp,[dp,t(a)])]),mp,n("p",null,[n("a",gp,[vp,t(a)])]),bp,n("p",null,[hp,n("a",yp,[fp,t(a)])]),qp,n("p",null,[wp,n("a",_p,[xp,t(a)]),Ip,Sp,Ep]),Ap,n("p",null,[n("a",Cp,[Tp,t(a)]),Rp,n("a",Lp,[Np,t(a)])]),jp,n("ol",null,[n("li",null,[n("a",Dp,[Bp,t(a)])]),n("li",null,[n("a",Mp,[Pp,t(a)])]),n("li",null,[n("a",Op,[Fp,t(a)])]),n("li",null,[n("a",Up,[Hp,t(a)])]),n("li",null,[n("a",Gp,[Vp,t(a)])])]),Qp,n("p",null,[zp,n("a",Kp,[Yp,t(a)])]),Xp,Wp,$p,Jp,Zp,n("p",null,[ne,se,ae,n("a",te,[pe,t(a)])]),ee,n("p",null,[n("a",oe,[ce,t(a)])]),le,n("p",null,[ie,n("a",ue,[ke,t(a)])]),re])}var he=e(i,[["render",de],["__file","SpringCloudAibaba.html.vue"]]);export{he as default};
