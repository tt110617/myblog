import{_ as l}from"./plugin-vue_export-helper.21dcd24c.js";import{o as a,c as d,a as i,b as r,d as n,e,r as c}from"./app.6a2d513d.js";const u={},o=n('<h1 id="\u56DB\u3001mysql\u65E5\u5FD7\u4E0E\u5907\u4EFD\u7BC7" tabindex="-1"><a class="header-anchor" href="#\u56DB\u3001mysql\u65E5\u5FD7\u4E0E\u5907\u4EFD\u7BC7" aria-hidden="true">#</a> \u56DB\u3001MySQL\u65E5\u5FD7\u4E0E\u5907\u4EFD\u7BC7</h1><h2 id="\u7B2C17\u7AE0-\u5176\u4ED6\u6570\u636E\u5E93\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#\u7B2C17\u7AE0-\u5176\u4ED6\u6570\u636E\u5E93\u65E5\u5FD7" aria-hidden="true">#</a> \u7B2C17\u7AE0_\u5176\u4ED6\u6570\u636E\u5E93\u65E5\u5FD7</h2><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715141705004.png" alt="image-20220715141705004" style="float:left;"><p><strong>\u5343\u4E07\u4E0D\u8981\u5C0F\u770B\u65E5\u5FD7</strong>\u3002\u5F88\u591A\u770B\u4F3C\u5947\u602A\u7684\u95EE\u9898\uFF0C\u7B54\u6848\u5F80\u5F80\u5C31\u85CF\u5728\u65E5\u5FD7\u91CC\u3002\u5F88\u591A\u60C5\u51B5\u4E0B\uFF0C\u53EA\u6709\u901A\u8FC7\u67E5\u770B\u65E5\u5FD7\u624D \u80FD\u53D1\u73B0\u95EE\u9898\u7684\u539F\u56E0\uFF0C\u771F\u6B63\u89E3\u51B3\u95EE\u9898\u3002\u6240\u4EE5\uFF0C\u4E00\u5B9A\u8981\u5B66\u4F1A\u67E5\u770B\u65E5\u5FD7\uFF0C\u517B\u6210\u68C0\u67E5\u65E5\u5FD7\u7684\u4E60\u60EF\uFF0C\u5BF9\u63D0\u5347\u4F60\u7684\u6570 \u636E\u5E93\u5E94\u7528\u5F00\u53D1\u80FD\u529B\u81F3\u5173\u91CD\u8981\u3002</p>',4),m=e("MySQL8.0 \u5B98\u7F51\u65E5\u5FD7\u5730\u5740\uFF1A\u201C "),t={href:"https://dev.mysql.com/doc/refman/8.0/en/server-logs.html",target:"_blank",rel:"noopener noreferrer"},v=e("https://dev.mysql.com/doc/refman/8.0/en/server-logs.html"),g=e(" \u201D"),p=n(`<h3 id="_1-mysql\u652F\u6301\u7684\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_1-mysql\u652F\u6301\u7684\u65E5\u5FD7" aria-hidden="true">#</a> 1. MySQL\u652F\u6301\u7684\u65E5\u5FD7</h3><h5 id="_1-1-\u65E5\u5FD7\u7C7B\u578B" tabindex="-1"><a class="header-anchor" href="#_1-1-\u65E5\u5FD7\u7C7B\u578B" aria-hidden="true">#</a> 1.1 \u65E5\u5FD7\u7C7B\u578B</h5><p>MySQL\u6709\u4E0D\u540C\u7C7B\u578B\u7684\u65E5\u5FD7\u6587\u4EF6\uFF0C\u7528\u6765\u5B58\u50A8\u4E0D\u540C\u7C7B\u578B\u7684\u65E5\u5FD7\uFF0C\u5206\u4E3A <code>\u4E8C\u8FDB\u5236\u65E5\u5FD7</code> \u3001 <code>\u9519\u8BEF\u65E5\u5FD7</code> \u3001 <code>\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7</code> \u548C <code>\u6162\u67E5\u8BE2\u65E5\u5FD7</code> \uFF0C\u8FD9\u4E5F\u662F\u5E38\u7528\u76844\u79CD\u3002MySQL 8\u53C8\u65B0\u589E\u4E24\u79CD\u652F\u6301\u7684\u65E5\u5FD7\uFF1A <code>\u4E2D\u7EE7\u65E5\u5FD7</code> \u548C <code>\u6570\u636E\u5B9A\u4E49\u8BED\u53E5\u65E5\u5FD7</code> \u3002\u4F7F \u7528\u8FD9\u4E9B\u65E5\u5FD7\u6587\u4EF6\uFF0C\u53EF\u4EE5\u67E5\u770BMySQL\u5185\u90E8\u53D1\u751F\u7684\u4E8B\u60C5\u3002</p><p>\u8FD96\u7C7B\u65E5\u5FD7\u5206\u522B\u4E3A\uFF1A</p><ul><li><strong>\u6162\u67E5\u8BE2\u65E5\u5FD7</strong>\uFF1A\u8BB0\u5F55\u6240\u6709\u6267\u884C\u65F6\u95F4\u8D85\u8FC7 long_query_time \u7684\u6240\u6709\u67E5\u8BE2\uFF0C\u65B9\u4FBF\u6211\u4EEC\u5BF9\u67E5\u8BE2\u8FDB\u884C\u4F18\u5316\u3002</li><li><strong>\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7</strong>\uFF1A\u8BB0\u5F55\u6240\u6709\u8FDE\u63A5\u7684\u8D77\u59CB\u65F6\u95F4\u548C\u7EC8\u6B62\u65F6\u95F4\uFF0C\u4EE5\u53CA\u8FDE\u63A5\u53D1\u9001\u7ED9\u6570\u636E\u5E93\u670D\u52A1\u5668\u7684\u6240\u6709\u6307\u4EE4\uFF0C \u5BF9\u6211\u4EEC\u590D\u539F\u64CD\u4F5C\u7684\u5B9E\u9645\u573A\u666F\u3001\u53D1\u73B0\u95EE\u9898\uFF0C\u751A\u81F3\u662F\u5BF9\u6570\u636E\u5E93\u64CD\u4F5C\u7684\u5BA1\u8BA1\u90FD\u6709\u5F88\u5927\u7684\u5E2E\u52A9\u3002</li><li><strong>\u9519\u8BEF\u65E5\u5FD7</strong>\uFF1A\u8BB0\u5F55MySQL\u670D\u52A1\u7684\u542F\u52A8\u3001\u8FD0\u884C\u6216\u505C\u6B62MySQL\u670D\u52A1\u65F6\u51FA\u73B0\u7684\u95EE\u9898\uFF0C\u65B9\u4FBF\u6211\u4EEC\u4E86\u89E3\u670D\u52A1\u5668\u7684 \u72B6\u6001\uFF0C\u4ECE\u800C\u5BF9\u670D\u52A1\u5668\u8FDB\u884C\u7EF4\u62A4\u3002</li><li><strong>\u4E8C\u8FDB\u5236\u65E5\u5FD7</strong>\uFF1A\u8BB0\u5F55\u6240\u6709\u66F4\u6539\u6570\u636E\u7684\u8BED\u53E5\uFF0C\u53EF\u4EE5\u7528\u4E8E <code>\u4E3B\u4ECE\u670D\u52A1\u5668\u4E4B\u95F4\u7684\u6570\u636E\u540C\u6B65\uFF0C\u4EE5\u53CA\u670D\u52A1\u5668\u9047\u5230\u6545\u969C\u65F6\u6570\u636E\u7684\u65E0\u635F\u5931\u6062\u590D</code>\u3002</li><li><strong>\u4E2D\u7EE7\u65E5\u5FD7</strong>\uFF1A\u7528\u4E8E\u4E3B\u4ECE\u670D\u52A1\u5668\u67B6\u6784\u4E2D\uFF0C<code>\u4ECE\u670D\u52A1\u5668\u7528\u6765\u5B58\u653E\u4E3B\u670D\u52A1\u5668\u4E8C\u8FDB\u5236\u65E5\u5FD7\u5185\u5BB9\u7684\u4E00\u4E2A\u4E2D\u95F4\u6587\u4EF6</code>\u3002 \u4ECE\u670D\u52A1\u5668\u901A\u8FC7\u8BFB\u53D6\u4E2D\u7EE7\u65E5\u5FD7\u7684\u5185\u5BB9\uFF0C\u6765\u540C\u6B65\u4E3B\u670D\u52A1\u5668\u4E0A\u7684\u64CD\u4F5C\u3002</li><li><strong>\u6570\u636E\u5B9A\u4E49\u8BED\u53E5\u65E5\u5FD7</strong>\uFF1A\u8BB0\u5F55\u6570\u636E\u5B9A\u4E49\u8BED\u53E5\u6267\u884C\u7684\u5143\u6570\u636E\u64CD\u4F5C\u3002</li></ul><p>\u9664\u4E8C\u8FDB\u5236\u65E5\u5FD7\u5916\uFF0C\u5176\u4ED6\u65E5\u5FD7\u90FD\u662F <code>\u6587\u672C\u6587\u4EF6</code> \u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u6240\u6709\u65E5\u5FD7\u521B\u5EFA\u4E8E <code>MySQL\u6570\u636E\u76EE\u5F55</code> \u4E2D\u3002</p><h5 id="_1-2-\u65E5\u5FD7\u7684\u5F0A\u7AEF" tabindex="-1"><a class="header-anchor" href="#_1-2-\u65E5\u5FD7\u7684\u5F0A\u7AEF" aria-hidden="true">#</a> 1.2 \u65E5\u5FD7\u7684\u5F0A\u7AEF</h5><ul><li>\u65E5\u5FD7\u529F\u80FD\u4F1A <code>\u964D\u4F4EMySQL\u6570\u636E\u5E93\u7684\u6027\u80FD</code> \u3002\u4F8B\u5982\uFF0C\u5728\u67E5\u8BE2\u975E\u5E38\u9891\u7E41\u7684MySQL\u6570\u636E\u5E93\u7CFB\u7EDF\u4E2D\uFF0C\u5982\u679C\u5F00\u542F\u4E86\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7\u548C\u6162\u67E5\u8BE2\u65E5\u5FD7\uFF0CMySQL\u6570\u636E\u5E93\u4F1A\u82B1\u8D39\u5F88\u591A\u65F6\u95F4\u8BB0\u5F55\u65E5\u5FD7\u3002</li><li>\u65E5\u5FD7\u4F1A <code>\u5360\u7528\u5927\u91CF\u7684\u78C1\u76D8\u7A7A\u95F4</code> \u3002\u5BF9\u4E8E\u7528\u6237\u91CF\u975E\u5E38\u5927\uFF0C\u64CD\u4F5C\u975E\u5E38\u9891\u7E41\u7684\u6570\u636E\u5E93\uFF0C\u65E5\u5FD7\u6587\u4EF6\u9700\u8981\u7684\u5B58\u50A8\u7A7A\u95F4\u8BBE\u7F6E\u6BD4\u6570\u636E\u5E93\u6587\u4EF6\u9700\u8981\u7684\u5B58\u50A8\u7A7A\u95F4\u8FD8\u8981\u5927\u3002</li></ul><h3 id="_2-\u6162\u67E5\u8BE2\u65E5\u5FD7-slow-query-log" tabindex="-1"><a class="header-anchor" href="#_2-\u6162\u67E5\u8BE2\u65E5\u5FD7-slow-query-log" aria-hidden="true">#</a> 2. \u6162\u67E5\u8BE2\u65E5\u5FD7(slow query log)</h3><p>\u524D\u9762\u7AE0\u8282\u300A\u7B2C09\u7AE0_\u6027\u80FD\u5206\u6790\u5DE5\u5177\u7684\u4F7F\u7528\u300B\u5DF2\u7ECF\u8BE6\u7EC6\u8BB2\u8FF0\u3002</p><h3 id="_3-\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7-general-query-log" tabindex="-1"><a class="header-anchor" href="#_3-\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7-general-query-log" aria-hidden="true">#</a> 3. \u901A\u7528\u67E5\u8BE2\u65E5\u5FD7(general query log)</h3><p>\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7\u7528\u6765 <code>\u8BB0\u5F55\u7528\u6237\u7684\u6240\u6709\u64CD\u4F5C</code> \uFF0C\u5305\u62EC\u542F\u52A8\u548C\u5173\u95EDMySQL\u670D\u52A1\u3001\u6240\u6709\u7528\u6237\u7684\u8FDE\u63A5\u5F00\u59CB\u65F6\u95F4\u548C\u622A\u6B62 \u65F6\u95F4\u3001\u53D1\u7ED9 MySQL \u6570\u636E\u5E93\u670D\u52A1\u5668\u7684\u6240\u6709 SQL \u6307\u4EE4\u7B49\u3002\u5F53\u6211\u4EEC\u7684\u6570\u636E\u53D1\u751F\u5F02\u5E38\u65F6\uFF0C<strong>\u67E5\u770B\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7\uFF0C \u8FD8\u539F\u64CD\u4F5C\u65F6\u7684\u5177\u4F53\u573A\u666F</strong>\uFF0C\u53EF\u4EE5\u5E2E\u52A9\u6211\u4EEC\u51C6\u786E\u5B9A\u4F4D\u95EE\u9898\u3002</p><h5 id="_3-1-\u95EE\u9898\u573A\u666F" tabindex="-1"><a class="header-anchor" href="#_3-1-\u95EE\u9898\u573A\u666F" aria-hidden="true">#</a> 3.1 \u95EE\u9898\u573A\u666F</h5><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715145650406.png" alt="image-20220715145650406" style="float:left;"><h5 id="_3-2-\u67E5\u770B\u5F53\u524D\u72B6\u6001" tabindex="-1"><a class="header-anchor" href="#_3-2-\u67E5\u770B\u5F53\u524D\u72B6\u6001" aria-hidden="true">#</a> 3.2 \u67E5\u770B\u5F53\u524D\u72B6\u6001</h5><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql&gt; SHOW VARIABLES LIKE &#39;%general%&#39;;
+------------------+------------------------------+
| Variable_name    | Value                        |
+------------------+------------------------------+
| general_log      | OFF                          | #\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7\u5904\u4E8E\u5173\u95ED\u72B6\u6001
| general_log_file | /var/lib/mysql/atguigu01.log | #\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7\u6587\u4EF6\u7684\u540D\u79F0\u662Fatguigu01.log
+------------------+------------------------------+
2 rows in set (0.03 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715155010381.png" alt="image-20220715155010381" style="float:left;"><h5 id="_3-3-\u542F\u52A8\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_3-3-\u542F\u52A8\u65E5\u5FD7" aria-hidden="true">#</a> 3.3 \u542F\u52A8\u65E5\u5FD7</h5><p><strong>\u65B9\u5F0F1\uFF1A\u6C38\u4E45\u6027\u65B9\u5F0F</strong></p><p>\u4FEE\u6539my.cnf\u6216\u8005my.ini\u914D\u7F6E\u6587\u4EF6\u6765\u8BBE\u7F6E\u3002\u5728[mysqld]\u7EC4\u4E0B\u52A0\u5165log\u9009\u9879\uFF0C\u5E76\u91CD\u542FMySQL\u670D\u52A1\u3002\u683C\u5F0F\u5982\u4E0B\uFF1A</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code>[mysqld]
<span class="token key attr-name">general_log</span><span class="token punctuation">=</span><span class="token value attr-value">ON</span>
<span class="token key attr-name">general_log_file</span><span class="token punctuation">=</span><span class="token value attr-value">[path[filename]] #\u65E5\u5FD7\u6587\u4EF6\u6240\u5728\u76EE\u5F55\u8DEF\u5F84\uFF0Cfilename\u4E3A\u65E5\u5FD7\u6587\u4EF6</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u4E0D\u6307\u5B9A\u76EE\u5F55\u548C\u6587\u4EF6\u540D\uFF0C\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7\u5C06\u9ED8\u8BA4\u5B58\u50A8\u5728MySQL\u6570\u636E\u76EE\u5F55\u4E2D\u7684hostname.log\u6587\u4EF6\u4E2D\uFF0C hostname\u8868\u793A\u4E3B\u673A\u540D\u3002</p><p><strong>\u65B9\u5F0F2\uFF1A\u4E34\u65F6\u6027\u65B9\u5F0F</strong></p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SET GLOBAL general_log=on; # \u5F00\u542F\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SET GLOBAL general_log_file=\u2019path/filename\u2019; # \u8BBE\u7F6E\u65E5\u5FD7\u6587\u4EF6\u4FDD\u5B58\u4F4D\u7F6E
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5BF9\u5E94\u7684\uFF0C\u5173\u95ED\u64CD\u4F5CSQL\u547D\u4EE4\u5982\u4E0B\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SET GLOBAL general_log=off; # \u5173\u95ED\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u67E5\u770B\u8BBE\u7F6E\u540E\u60C5\u51B5\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SHOW VARIABLES LIKE &#39;general_log%&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_3-4-\u67E5\u770B\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_3-4-\u67E5\u770B\u65E5\u5FD7" aria-hidden="true">#</a> 3.4 \u67E5\u770B\u65E5\u5FD7</h5><p>\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7\u662F\u4EE5 <code>\u6587\u672C\u6587\u4EF6</code> \u7684\u5F62\u5F0F\u5B58\u50A8\u5728\u6587\u4EF6\u7CFB\u7EDF\u4E2D\u7684\uFF0C\u53EF\u4EE5\u4F7F\u7528 <code>\u6587\u672C\u7F16\u8F91\u5668</code> \u76F4\u63A5\u6253\u5F00\u65E5\u5FD7\u6587\u4EF6\u3002\u6BCF\u53F0 MySQL\u670D\u52A1\u5668\u7684\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7\u5185\u5BB9\u662F\u4E0D\u540C\u7684\u3002</p><ul><li>\u5728Windows\u64CD\u4F5C\u7CFB\u7EDF\u4E2D\uFF0C\u4F7F\u7528\u6587\u672C\u6587\u4EF6\u67E5\u770B\u5668\uFF1B</li><li>\u5728Linux\u7CFB\u7EDF\u4E2D\uFF0C\u53EF\u4EE5\u4F7F\u7528vi\u5DE5\u5177\u6216\u8005gedit\u5DE5\u5177\u67E5\u770B\uFF1B</li><li>\u5728Mac OSX\u7CFB\u7EDF\u4E2D\uFF0C\u53EF\u4EE5\u4F7F\u7528\u6587\u672C\u6587\u4EF6\u67E5\u770B\u5668\u6216\u8005vi\u7B49\u5DE5\u5177\u67E5\u770B\u3002</li></ul><p>\u4ECE <code>SHOW VARIABLES LIKE &#39;general_log%&#39;</code>; \u7ED3\u679C\u4E2D\u53EF\u4EE5\u770B\u5230\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7\u7684\u4F4D\u7F6E\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>/usr/sbin/mysqld, Version: 8.0.26 (MySQL Community Server - GPL). started with:
Tcp port: 3306 Unix socket: /var/lib/mysql/mysql.sock
Time Id Command Argument
2022-01-04T07:44:58.052890Z 10 Query SHOW VARIABLES LIKE &#39;%general%&#39;
2022-01-04T07:45:15.666672Z 10 Query SHOW VARIABLES LIKE &#39;general_log%&#39;
2022-01-04T07:45:28.970765Z 10 Query select * from student
2022-01-04T07:47:38.706804Z 11 Connect root@localhost on using Socket
2022-01-04T07:47:38.707435Z 11 Query select @@version_comment limit 1
2022-01-04T07:48:21.384886Z 12 Connect root@172.16.210.1 on using TCP/IP
2022-01-04T07:48:21.385253Z 12 Query SET NAMES utf8
2022-01-04T07:48:21.385640Z 12 Query USE \`atguigu12\`
2022-01-04T07:48:21.386179Z 12 Query SHOW FULL TABLES WHERE Table_Type !=
&#39;VIEW&#39;
2022-01-04T07:48:23.901778Z 13 Connect root@172.16.210.1 on using TCP/IP
2022-01-04T07:48:23.902128Z 13 Query SET NAMES utf8
2022-01-04T07:48:23.905179Z 13 Query USE \`atguigu\`
2022-01-04T07:48:23.905825Z 13 Query SHOW FULL TABLES WHERE Table_Type !=
&#39;VIEW&#39;
2022-01-04T07:48:32.163833Z 14 Connect root@172.16.210.1 on using TCP/IP
2022-01-04T07:48:32.164451Z 14 Query SET NAMES utf8
2022-01-04T07:48:32.164840Z 14 Query USE \`atguigu\`
2022-01-04T07:48:40.006687Z 14 Query select * from account
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7\u91CC\u9762\uFF0C\u6211\u4EEC\u53EF\u4EE5\u6E05\u695A\u5730\u770B\u5230\uFF0C\u4EC0\u4E48\u65F6\u5019\u5F00\u542F\u4E86\u65B0\u7684\u5BA2\u6237\u7AEF\u767B\u9646\u6570\u636E\u5E93\uFF0C\u767B\u5F55\u4E4B\u540E\u505A\u4E86\u4EC0\u4E48 SQL \u64CD\u4F5C\uFF0C\u9488\u5BF9\u7684\u662F\u54EA\u4E2A\u6570\u636E\u8868\u7B49\u4FE1\u606F\u3002</p><h5 id="_3-5-\u505C\u6B62\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_3-5-\u505C\u6B62\u65E5\u5FD7" aria-hidden="true">#</a> 3.5 \u505C\u6B62\u65E5\u5FD7</h5><p><strong>\u65B9\u5F0F1\uFF1A\u6C38\u4E45\u6027\u65B9\u5F0F</strong></p><p>\u4FEE\u6539 <code>my.cnf</code> \u6216\u8005 <code>my.ini</code> \u6587\u4EF6\uFF0C\u628A[mysqld]\u7EC4\u4E0B\u7684 <code>general_log</code> \u503C\u8BBE\u7F6E\u4E3A <code>OFF</code> \u6216\u8005\u628Ageneral_log\u4E00\u9879 \u6CE8\u91CA\u6389\u3002\u4FEE\u6539\u4FDD\u5B58\u540E\uFF0C\u518D<code>\u91CD\u542FMySQL\u670D\u52A1</code> \uFF0C\u5373\u53EF\u751F\u6548\u3002</p><p>\u4E3E\u4F8B1\uFF1A</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code>[mysqld]
<span class="token key attr-name">general_log</span><span class="token punctuation">=</span><span class="token value attr-value">OFF</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E3E\u4F8B2\uFF1A</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code>[mysqld]
<span class="token comment">#general_log=ON</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u65B9\u5F0F2\uFF1A\u4E34\u65F6\u6027\u65B9\u5F0F</strong></p><p>\u4F7F\u7528SET\u8BED\u53E5\u505C\u6B62MySQL\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7\u529F\u80FD\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SET GLOBAL general_log=off;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u67E5\u8BE2\u901A\u7528\u65E5\u5FD7\u529F\u80FD\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SHOW VARIABLES LIKE &#39;general_log%&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_3-6-\u5220\u9664-\u5237\u65B0\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_3-6-\u5220\u9664-\u5237\u65B0\u65E5\u5FD7" aria-hidden="true">#</a> 3.6 \u5220\u9664\\\u5237\u65B0\u65E5\u5FD7</h5><p>\u5982\u679C\u6570\u636E\u7684\u4F7F\u7528\u975E\u5E38\u9891\u7E41\uFF0C\u90A3\u4E48\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7\u4F1A\u5360\u7528\u670D\u52A1\u5668\u975E\u5E38\u5927\u7684\u78C1\u76D8\u7A7A\u95F4\u3002\u6570\u636E\u7BA1\u7406\u5458\u53EF\u4EE5\u5220\u9664\u5F88\u957F\u65F6\u95F4\u4E4B\u524D\u7684\u67E5\u8BE2\u65E5\u5FD7\uFF0C\u4EE5\u4FDD\u8BC1MySQL\u670D\u52A1\u5668\u4E0A\u7684\u786C\u76D8\u7A7A\u95F4\u3002</p><p><strong>\u624B\u52A8\u5220\u9664\u6587\u4EF6</strong></p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SHOW VARIABLES LIKE &#39;general_log%&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u770B\u51FA\uFF0C\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7\u7684\u76EE\u5F55\u9ED8\u8BA4\u4E3AMySQL\u6570\u636E\u76EE\u5F55\u3002\u5728\u8BE5\u76EE\u5F55\u4E0B\u624B\u52A8\u5220\u9664\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7 atguigu01.log</p><p>\u4F7F\u7528\u5982\u4E0B\u547D\u4EE4\u91CD\u65B0\u751F\u6210\u67E5\u8BE2\u65E5\u5FD7\u6587\u4EF6\uFF0C\u5177\u4F53\u547D\u4EE4\u5982\u4E0B\u3002\u5237\u65B0MySQL\u6570\u636E\u76EE\u5F55\uFF0C\u53D1\u73B0\u521B\u5EFA\u4E86\u65B0\u7684\u65E5\u5FD7\u6587 \u4EF6\u3002\u524D\u63D0\u4E00\u5B9A\u8981\u5F00\u542F\u901A\u7528\u65E5\u5FD7\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqladmin -uroot -p flush-logs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5982\u679C\u5E0C\u671B\u5907\u4EFD\u65E7\u7684\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7\uFF0C\u5C31\u5FC5\u987B\u5148\u5C06\u65E7\u7684\u65E5\u5FD7\u6587\u4EF6\u590D\u5236\u51FA\u6765\u6216\u8005\u6539\u540D\uFF0C\u7136\u540E\u6267\u884C\u4E0A\u9762\u7684mysqladmin\u547D\u4EE4\u3002\u6B63\u786E\u6D41\u7A0B\u5982\u4E0B\uFF1A</p><div class="language-liunx ext-liunx line-numbers-mode"><pre class="language-liunx"><code>cd mysql-data-directory # \u8F93\u5165\u81EA\u5DF1\u7684\u901A\u7528\u65E5\u5FD7\u6587\u4EF6\u6240\u5728\u76EE\u5F55
mv mysql.general.log mysql.general.log.old # \u6307\u5B9A\u65E7\u7684\u6587\u4EF6\u540D \u4EE5\u53CA \u65B0\u7684\u6587\u4EF6\u540D
mysqladmin -uroot -p flush-logs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-\u9519\u8BEF\u65E5\u5FD7-error-log" tabindex="-1"><a class="header-anchor" href="#_4-\u9519\u8BEF\u65E5\u5FD7-error-log" aria-hidden="true">#</a> 4. \u9519\u8BEF\u65E5\u5FD7(error log)</h3><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715160249271.png" alt="image-20220715160249271" style="float:left;"><h5 id="_4-1-\u542F\u52A8\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_4-1-\u542F\u52A8\u65E5\u5FD7" aria-hidden="true">#</a> 4.1 \u542F\u52A8\u65E5\u5FD7</h5><p>\u5728MySQL\u6570\u636E\u5E93\u4E2D\uFF0C\u9519\u8BEF\u65E5\u5FD7\u529F\u80FD\u662F <code>\u9ED8\u8BA4\u5F00\u542F</code> \u7684\u3002\u800C\u4E14\uFF0C\u9519\u8BEF\u65E5\u5FD7 <code>\u65E0\u6CD5\u88AB\u7981\u6B62</code> \u3002</p><p>\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u9519\u8BEF\u65E5\u5FD7\u5B58\u50A8\u5728MySQL\u6570\u636E\u5E93\u7684\u6570\u636E\u6587\u4EF6\u5939\u4E0B\uFF0C\u540D\u79F0\u9ED8\u8BA4\u4E3A <code>mysqld.log</code> \uFF08Linux\u7CFB\u7EDF\uFF09\u6216 <code>hostname.err</code> \uFF08mac\u7CFB\u7EDF\uFF09\u3002\u5982\u679C\u9700\u8981\u5236\u5B9A\u6587\u4EF6\u540D\uFF0C\u5219\u9700\u8981\u5728my.cnf\u6216\u8005my.ini\u4E2D\u505A\u5982\u4E0B\u914D\u7F6E\uFF1A</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code>[mysqld]
<span class="token key attr-name">log-error</span><span class="token punctuation">=</span><span class="token value attr-value">[path/[filename]] #path\u4E3A\u65E5\u5FD7\u6587\u4EF6\u6240\u5728\u7684\u76EE\u5F55\u8DEF\u5F84\uFF0Cfilename\u4E3A\u65E5\u5FD7\u6587\u4EF6\u540D</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FEE\u6539\u914D\u7F6E\u9879\u540E\uFF0C\u9700\u8981\u91CD\u542FMySQL\u670D\u52A1\u4EE5\u751F\u6548\u3002</p><h5 id="_4-2-\u67E5\u770B\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_4-2-\u67E5\u770B\u65E5\u5FD7" aria-hidden="true">#</a> 4.2 \u67E5\u770B\u65E5\u5FD7</h5><p>MySQL\u9519\u8BEF\u65E5\u5FD7\u662F\u4EE5\u6587\u672C\u6587\u4EF6\u5F62\u5F0F\u5B58\u50A8\u7684\uFF0C\u53EF\u4EE5\u4F7F\u7528\u6587\u672C\u7F16\u8F91\u5668\u76F4\u63A5\u67E5\u770B\u3002</p><p>\u67E5\u8BE2\u9519\u8BEF\u65E5\u5FD7\u7684\u5B58\u50A8\u8DEF\u5F84\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql&gt; SHOW VARIABLES LIKE &#39;log_err%&#39;;
+----------------------------+----------------------------------------+
| Variable_name              | Value                                  |
+----------------------------+----------------------------------------+
| log_error                  | /var/log/mysqld.log                    |
| log_error_services         | log_filter_internal; log_sink_internal |
| log_error_suppression_list |                                        |
| log_error_verbosity        | 2                                      |
+----------------------------+----------------------------------------+
4 rows in set (0.01 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6267\u884C\u7ED3\u679C\u4E2D\u53EF\u4EE5\u770B\u5230\u9519\u8BEF\u65E5\u5FD7\u6587\u4EF6\u662Fmysqld.log\uFF0C\u4F4D\u4E8EMySQL\u9ED8\u8BA4\u7684\u6570\u636E\u76EE\u5F55\u4E0B\u3002</p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715160657093.png" alt="image-20220715160657093" style="float:left;"><h5 id="_4-3-\u5220\u9664-\u5237\u65B0\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_4-3-\u5220\u9664-\u5237\u65B0\u65E5\u5FD7" aria-hidden="true">#</a> 4.3 \u5220\u9664\\\u5237\u65B0\u65E5\u5FD7</h5><p>\u5BF9\u4E8E\u5F88\u4E45\u4EE5\u524D\u7684\u9519\u8BEF\u65E5\u5FD7\uFF0C\u6570\u636E\u5E93\u7BA1\u7406\u5458\u67E5\u770B\u8FD9\u4E9B\u9519\u8BEF\u65E5\u5FD7\u7684\u53EF\u80FD\u6027\u4E0D\u5927\uFF0C\u53EF\u4EE5\u5C06\u8FD9\u4E9B\u9519\u8BEF\u65E5\u5FD7\u5220\u9664\uFF0C \u4EE5\u4FDD\u8BC1MySQL\u670D\u52A1\u5668\u4E0A\u7684 <code>\u786C\u76D8\u7A7A\u95F4</code> \u3002MySQL\u7684\u9519\u8BEF\u65E5\u5FD7\u662F\u4EE5\u6587\u672C\u6587\u4EF6\u7684\u5F62\u5F0F\u5B58\u50A8\u5728\u6587\u4EF6\u7CFB\u7EDF\u4E2D\u7684\uFF0C\u53EF\u4EE5 <code>\u76F4\u63A5\u5220\u9664</code> \u3002</p><ul><li><p>\u7B2C\u4E00\u6B65\uFF08\u65B9\u5F0F1\uFF09\uFF1A\u5220\u9664\u64CD\u4F5C</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>rm -f /var/lib/mysql/mysqld.log
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5728\u8FD0\u884C\u72B6\u6001\u4E0B\u5220\u9664\u9519\u8BEF\u65E5\u5FD7\u6587\u4EF6\u540E\uFF0CMySQL\u5E76\u4E0D\u4F1A\u81EA\u52A8\u521B\u5EFA\u65E5\u5FD7\u6587\u4EF6\u3002</p></li><li><p>\u7B2C\u4E00\u6B65\uFF08\u65B9\u5F0F2\uFF09\uFF1A\u91CD\u547D\u540D\u6587\u4EF6</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mv /var/log/mysqld.log /var/log/mysqld.log.old
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>\u7B2C\u4E8C\u6B65\uFF1A\u91CD\u5EFA\u65E5\u5FD7</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqladmin -uroot -p flush-logs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u53EF\u80FD\u4F1A\u62A5\u9519</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>[root@atguigu01 log]# mysqladmin -uroot -p flush-logs
Enter password:
mysqladmin: refresh failed; error: &#39;Could not open file &#39;/var/log/mysqld.log&#39; for
error logging.&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5B98\u7F51\u63D0\u793A\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715161132368.png" alt="image-20220715161132368"></p></li></ul><p>\u8865\u5145\u64CD\u4F5C\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>install -omysql -gmysql -m0644 /dev/null /var/log/mysqld.log
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715161216556.png" alt="image-20220715161216556" style="float:left;"><h5 id="_4-4-mysql-8-0-\u65B0\u7279\u6027" tabindex="-1"><a class="header-anchor" href="#_4-4-mysql-8-0-\u65B0\u7279\u6027" aria-hidden="true">#</a> 4.4 MySQL 8.0 \u65B0\u7279\u6027</h5><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715161321565.png" alt="image-20220715161321565" style="float:left;"><blockquote><p>\u5C0F\u7ED3\uFF1A</p><p>\u901A\u5E38\u60C5\u51B5\u4E0B\uFF0C\u7BA1\u7406\u5458\u4E0D\u9700\u8981\u67E5\u770B\u9519\u8BEF\u65E5\u5FD7\u3002\u4F46\u662F\uFF0CMySQL\u670D\u52A1\u5668\u53D1\u751F\u5F02\u5E38\u65F6\uFF0C\u7BA1\u7406\u5458\u53EF\u4EE5\u4ECE\u9519\u8BEF\u65E5\u5FD7\u4E2D\u627E\u5230\u53D1\u751F\u5F02\u5E38\u7684\u65F6\u95F4\u3001\u539F\u56E0\uFF0C\u7136\u540E\u6839\u636E\u8FD9\u4E9B\u4FE1\u606F\u6765\u89E3\u51B3\u5F02\u5E38\u3002</p></blockquote><h3 id="_5-\u4E8C\u8FDB\u5236\u65E5\u5FD7-bin-log" tabindex="-1"><a class="header-anchor" href="#_5-\u4E8C\u8FDB\u5236\u65E5\u5FD7-bin-log" aria-hidden="true">#</a> 5. \u4E8C\u8FDB\u5236\u65E5\u5FD7(bin log)</h3><p>binlog\u53EF\u4EE5\u8BF4\u662FMySQL\u4E2D\u6BD4\u8F83 <code>\u91CD\u8981</code> \u7684\u65E5\u5FD7\u4E86\uFF0C\u5728\u65E5\u5E38\u5F00\u53D1\u53CA\u8FD0\u7EF4\u8FC7\u7A0B\u4E2D\uFF0C\u7ECF\u5E38\u4F1A\u9047\u5230\u3002</p><p>binlog\u5373binary log\uFF0C\u4E8C\u8FDB\u5236\u65E5\u5FD7\u6587\u4EF6\uFF0C\u4E5F\u53EB\u4F5C\u53D8\u66F4\u65E5\u5FD7\uFF08update log\uFF09\u3002\u5B83\u8BB0\u5F55\u4E86\u6570\u636E\u5E93\u6240\u6709\u6267\u884C\u7684 <code>DDL</code> \u548C <code>DML</code> \u7B49\u6570\u636E\u5E93\u66F4\u65B0\u4E8B\u4EF6\u7684\u8BED\u53E5\uFF0C\u4F46\u662F\u4E0D\u5305\u542B\u6CA1\u6709\u4FEE\u6539\u4EFB\u4F55\u6570\u636E\u7684\u8BED\u53E5\uFF08\u5982\u6570\u636E\u67E5\u8BE2\u8BED\u53E5select\u3001 show\u7B49\uFF09\u3002</p><p>\u5B83\u4EE5<code>\u4E8B\u4EF6\u5F62\u5F0F</code>\u8BB0\u5F55\u5E76\u4FDD\u5B58\u5728<code>\u4E8C\u8FDB\u5236\u6587\u4EF6</code>\u4E2D\u3002\u901A\u8FC7\u8FD9\u4E9B\u4FE1\u606F\uFF0C\u6211\u4EEC\u53EF\u4EE5\u518D\u73B0\u6570\u636E\u66F4\u65B0\u64CD\u4F5C\u7684\u5168\u8FC7\u7A0B\u3002</p><blockquote><p>\u5982\u679C\u60F3\u8981\u8BB0\u5F55\u6240\u6709\u8BED\u53E5\uFF08\u4F8B\u5982\uFF0C\u4E3A\u4E86\u8BC6\u522B\u6709\u95EE\u9898\u7684\u67E5\u8BE2\uFF09\uFF0C\u9700\u8981\u4F7F\u7528\u901A\u7528\u67E5\u8BE2\u65E5\u5FD7\u3002</p></blockquote><p>binlog\u4E3B\u8981\u5E94\u7528\u573A\u666F\uFF1A</p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715161800635.png" alt="image-20220715161800635" style="zoom:100%;"><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715161842703.png" alt="image-20220715161842703"></p><h5 id="_5-1-\u67E5\u770B\u9ED8\u8BA4\u60C5\u51B5" tabindex="-1"><a class="header-anchor" href="#_5-1-\u67E5\u770B\u9ED8\u8BA4\u60C5\u51B5" aria-hidden="true">#</a> 5.1 \u67E5\u770B\u9ED8\u8BA4\u60C5\u51B5</h5><p>\u67E5\u770B\u8BB0\u5F55\u4E8C\u8FDB\u5236\u65E5\u5FD7\u662F\u5426\u5F00\u542F\uFF1A\u5728MySQL8\u4E2D\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u4E8C\u8FDB\u5236\u6587\u4EF6\u662F\u5F00\u542F\u7684\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql&gt; show variables like &#39;%log_bin%&#39;;
+---------------------------------+----------------------------------+
| Variable_name                   | Value                            |
+---------------------------------+----------------------------------+
| log_bin                         | ON                               |
| log_bin_basename                | /var/lib/mysql/binlog            |
| log_bin_index                   | /var/lib/mysql/binlog.index      |
| log_bin_trust_function_creators | OFF                              |
| log_bin_use_v1_row_events       | OFF                              |
| sql_log_bin                     | ON                               |
+---------------------------------+----------------------------------+
6 rows in set (0.00 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715163520596.png" alt="image-20220715163520596" style="float:left;"><h5 id="_5-2-\u65E5\u5FD7\u53C2\u6570\u8BBE\u7F6E" tabindex="-1"><a class="header-anchor" href="#_5-2-\u65E5\u5FD7\u53C2\u6570\u8BBE\u7F6E" aria-hidden="true">#</a> 5.2 \u65E5\u5FD7\u53C2\u6570\u8BBE\u7F6E</h5><p><strong>\u65B9\u5F0F1\uFF1A\u6C38\u4E45\u6027\u65B9\u5F0F</strong></p><p>\u4FEE\u6539MySQL\u7684 <code>my.cnf</code> \u6216 <code>my.ini</code> \u6587\u4EF6\u53EF\u4EE5\u8BBE\u7F6E\u4E8C\u8FDB\u5236\u65E5\u5FD7\u7684\u76F8\u5173\u53C2\u6570\uFF1A</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code>[mysqld]
<span class="token comment">#\u542F\u7528\u4E8C\u8FDB\u5236\u65E5\u5FD7</span>
<span class="token key attr-name">log-bin</span><span class="token punctuation">=</span><span class="token value attr-value">atguigu-bin</span>
<span class="token key attr-name">binlog_expire_logs_seconds</span><span class="token punctuation">=</span><span class="token value attr-value">600</span>
<span class="token key attr-name">max_binlog_size</span><span class="token punctuation">=</span><span class="token value attr-value">100M</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715163811664.png" alt="image-20220715163811664" style="float:left;"><p>\u91CD\u65B0\u542F\u52A8MySQL\u670D\u52A1\uFF0C\u67E5\u8BE2\u4E8C\u8FDB\u5236\u65E5\u5FD7\u7684\u4FE1\u606F\uFF0C\u6267\u884C\u7ED3\u679C\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql&gt; show variables like &#39;%log_bin%&#39;;
+---------------------------------+----------------------------------+
| Variable_name                   | Value                            |
+---------------------------------+----------------------------------+
| log_bin                         | ON                               |
| log_bin_basename                | /var/lib/mysql/atguigu-bin       |
| log_bin_index                   | /var/lib/mysql/atguigu-bin.index |
| log_bin_trust_function_creators | OFF                              |
| log_bin_use_v1_row_events       | OFF                              |
| sql_log_bin                     | ON                               |
+---------------------------------+----------------------------------+
6 rows in set (0.00 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u8BBE\u7F6E\u5E26\u6587\u4EF6\u5939\u7684bin-log\u65E5\u5FD7\u5B58\u653E\u76EE\u5F55</strong></p><p>\u5982\u679C\u60F3\u6539\u53D8\u65E5\u5FD7\u6587\u4EF6\u7684\u76EE\u5F55\u548C\u540D\u79F0\uFF0C\u53EF\u4EE5\u5BF9my.cnf\u6216my.ini\u4E2D\u7684log_bin\u53C2\u6570\u4FEE\u6539\u5982\u4E0B\uFF1A</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code>[mysqld]
<span class="token key attr-name">log-bin</span><span class="token punctuation">=</span><span class="token value attr-value">&quot;/var/lib/mysql/binlog/atguigu-bin&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6CE8\u610F\uFF1A\u65B0\u5EFA\u7684\u6587\u4EF6\u5939\u9700\u8981\u4F7F\u7528mysql\u7528\u6237\uFF0C\u4F7F\u7528\u4E0B\u9762\u7684\u547D\u4EE4\u5373\u53EF\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>chown -R -v mysql:mysql binlog
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715164107352.png" alt="image-20220715164107352" style="float:left;"><p><strong>\u65B9\u5F0F2\uFF1A\u4E34\u65F6\u6027\u65B9\u5F0F</strong></p><p>\u5982\u679C\u4E0D\u5E0C\u671B\u901A\u8FC7\u4FEE\u6539\u914D\u7F6E\u6587\u4EF6\u5E76\u91CD\u542F\u7684\u65B9\u5F0F\u8BBE\u7F6E\u4E8C\u8FDB\u5236\u65E5\u5FD7\u7684\u8BDD\uFF0C\u8FD8\u53EF\u4EE5\u4F7F\u7528\u5982\u4E0B\u6307\u4EE4\uFF0C\u9700\u8981\u6CE8\u610F\u7684\u662F \u5728mysql8\u4E2D\u53EA\u6709 <code>\u4F1A\u8BDD\u7EA7\u522B</code> \u7684\u8BBE\u7F6E\uFF0C\u6CA1\u6709\u4E86global\u7EA7\u522B\u7684\u8BBE\u7F6E\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code># global \u7EA7\u522B
mysql&gt; set global sql_log_bin=0;
ERROR 1228 (HY000): Variable &#39;sql_log_bin&#39; is a SESSION variable and can\`t be used
with SET GLOBAL

# session\u7EA7\u522B
mysql&gt; SET sql_log_bin=0;
Query OK, 0 rows affected (0.01 \u79D2)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_5-3-\u67E5\u770B\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_5-3-\u67E5\u770B\u65E5\u5FD7" aria-hidden="true">#</a> 5.3 \u67E5\u770B\u65E5\u5FD7</h5><p>\u5F53MySQL\u521B\u5EFA\u4E8C\u8FDB\u5236\u65E5\u5FD7\u6587\u4EF6\u65F6\uFF0C\u5148\u521B\u5EFA\u4E00\u4E2A\u4EE5\u201Cfilename\u201D\u4E3A\u540D\u79F0\u3001\u4EE5\u201C.index\u201D\u4E3A\u540E\u7F00\u7684\u6587\u4EF6\uFF0C\u518D\u521B\u5EFA\u4E00 \u4E2A\u4EE5\u201Cfilename\u201D\u4E3A\u540D\u79F0\u3001\u4EE5\u201C.000001\u201D\u4E3A\u540E\u7F00\u7684\u6587\u4EF6\u3002</p><p>MySQL\u670D\u52A1 <code>\u91CD\u65B0\u542F\u52A8\u4E00\u6B21</code> \uFF0C\u4EE5\u201C.000001\u201D\u4E3A\u540E\u7F00\u7684\u6587\u4EF6\u5C31\u4F1A\u589E\u52A0\u4E00\u4E2A\uFF0C\u5E76\u4E14\u540E\u7F00\u540D\u63091\u9012\u589E\u3002\u5373\u65E5\u5FD7\u6587\u4EF6\u7684 \u4E2A\u6570\u4E0EMySQL\u670D\u52A1\u542F\u52A8\u7684\u6B21\u6570\u76F8\u540C\uFF1B\u5982\u679C\u65E5\u5FD7\u957F\u5EA6\u8D85\u8FC7\u4E86 <code>max_binlog_size</code> \u7684\u4E0A\u9650\uFF08\u9ED8\u8BA4\u662F1GB\uFF09\uFF0C\u5C31\u4F1A\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u65E5\u5FD7\u6587\u4EF6\u3002</p><p>\u67E5\u770B\u5F53\u524D\u7684\u4E8C\u8FDB\u5236\u65E5\u5FD7\u6587\u4EF6\u5217\u8868\u53CA\u5927\u5C0F\u3002\u6307\u4EE4\u5982\u4E0B\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql&gt; SHOW BINARY LOGS;
+--------------------+-----------+-----------+
| Log_name           | File_size | Encrypted |
+--------------------+-----------+-----------+
| atguigu-bin.000001 | 156       | No        |
+--------------------+-----------+-----------+
1 \u884C\u4E8E\u6570\u636E\u96C6 (0.02 \u79D2)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6240\u6709\u5BF9\u6570\u636E\u5E93\u7684\u4FEE\u6539\u90FD\u4F1A\u8BB0\u5F55\u5728binlog\u4E2D\u3002\u4F46binlog\u662F\u4E8C\u8FDB\u5236\u6587\u4EF6\uFF0C\u65E0\u6CD5\u76F4\u63A5\u67E5\u770B\uFF0C\u60F3\u8981\u66F4\u76F4\u89C2\u7684\u89C2\u6D4B\u5B83\u5C31\u8981\u501F\u52A9<code>mysqlbinlog</code>\u547D\u4EE4\u5DE5\u5177\u4E86\u3002\u6307\u4EE4\u5982\u4E0B\uFF1A\u5728\u67E5\u770B\u6267\u884C\uFF0C\u5148\u6267\u884C\u4E00\u6761SQL\u8BED\u53E5\uFF0C\u5982\u4E0B</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>update student set name=&#39;\u5F20\u4E09_back&#39; where id=1;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5F00\u59CB\u67E5\u770Bbinlog</p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715164718970.png" alt="image-20220715164718970" style="float:left;"><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715164743351.png" alt="image-20220715164743351" style="float:left;"><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715164809401.png" alt="image-20220715164809401" style="float:left;"><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqlbinlog -v &quot;/var/lib/mysql/binlog/atguigu-bin.000002&quot;
#220105 9:16:37 server id 1 end_log_pos 324 CRC32 0x6b31978b Query thread_id=10
exec_time=0 error_code=0
SET TIMESTAMP=1641345397/*!*/;
SET @@session.pseudo_thread_id=10/*!*/;
SET @@session.foreign_key_checks=1, @@session.sql_auto_is_null=0,
@@session.unique_checks=1, @@session.autocommit=1/*!*/;
SET @@session.sql_mode=1168113696/*!*/;
SET @@session.auto_increment_increment=1, @@session.auto_increment_offset=1/*!*/;
/*!\\C utf8mb3 *//*!*/;
SET
@@session.character_set_client=33,@@session.collation_connection=33,@@session.collatio
n_server=255/*!*/;
SET @@session.lc_time_names=0/*!*/;
SET @@session.collation_database=DEFAULT/*!*/;
/*!80011 SET @@session.default_collation_for_utf8mb4=255*//*!*/;
BEGIN
/*!*/;
# at 324
#220105 9:16:37 server id 1 end_log_pos 391 CRC32 0x74f89890 Table_map:
\`atguigu14\`.\`student\` mapped to number 85
# at 391
#220105 9:16:37 server id 1 end_log_pos 470 CRC32 0xc9920491 Update_rows: table id
85 flags: STMT_END_F

BINLOG &#39;
dfHUYRMBAAAAQwAAAIcBAAAAAFUAAAAAAAEACWF0Z3VpZ3UxNAAHc3R1ZGVudAADAw8PBDwAHgAG
AQEAAgEhkJj4dA==
dfHUYR8BAAAATwAAANYBAAAAAFUAAAAAAAEAAgAD//8AAQAAAAblvKDkuIkG5LiA54+tAAEAAAAL
5byg5LiJX2JhY2sG5LiA54+tkQSSyQ==
&#39;/*!*/;
### UPDATE \`atguigu\`.\`student\`
### WHERE
### @1=1
### @2=&#39;\u5F20\u4E09&#39;
### @3=&#39;\u4E00\u73ED&#39;
### SET
### @1=1
### @2=&#39;\u5F20\u4E09_back&#39;
### @3=&#39;\u4E00\u73ED&#39;
# at 470
#220105 9:16:37 server id 1 end_log_pos 501 CRC32 0xca01d30f Xid = 15
COMMIT/*!*/;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u524D\u9762\u7684\u547D\u4EE4\u540C\u65F6\u663E\u793Abinlog\u683C\u5F0F\u7684\u8BED\u53E5\uFF0C\u4F7F\u7528\u5982\u4E0B\u547D\u4EE4\u4E0D\u663E\u793A\u5B83</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqlbinlog -v --base64-output=DECODE-ROWS &quot;/var/lib/mysql/binlog/atguigu-bin.000002&quot;
#220105 9:16:37 server id 1 end_log_pos 324 CRC32 0x6b31978b Query thread_id=10
exec_time=0 error_code=0
SET TIMESTAMP=1641345397/*!*/;
SET @@session.pseudo_thread_id=10/*!*/;
SET @@session.foreign_key_checks=1, @@session.sql_auto_is_null=0,
@@session.unique_checks=1, @@session.autocommit=1/*!*/;
SET @@session.sql_mode=1168113696/*!*/;
SET @@session.auto_increment_increment=1, @@session.auto_increment_offset=1/*!*/;
/*!\\C utf8mb3 *//*!*/;
SET
@@session.character_set_client=33,@@session.collation_connection=33,@@session.collatio
n_server=255/*!*/;
SET @@session.lc_time_names=0/*!*/;
SET @@session.collation_database=DEFAULT/*!*/;
/*!80011 SET @@session.default_collation_for_utf8mb4=255*//*!*/;
BEGIN
/*!*/;
# at 324
#220105 9:16:37 server id 1 end_log_pos 391 CRC32 0x74f89890 Table_map:
\`atguigu14\`.\`student\` mapped to number 85
# at 391
#220105 9:16:37 server id 1 end_log_pos 470 CRC32 0xc9920491 Update_rows: table id
85 flags: STMT_END_F
### UPDATE \`atguigu14\`.\`student\`
### WHERE
### @1=1
### @2=&#39;\u5F20\u4E09&#39;
### @3=&#39;\u4E00\u73ED&#39;
### SET
### @1=1
### @2=&#39;\u5F20\u4E09_back&#39;
### @3=&#39;\u4E00\u73ED&#39;
# at 470
#220105 9:16:37 server id 1 end_log_pos 501 CRC32 0xca01d30f Xid = 15
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5173\u4E8Emysqlbinlog\u5DE5\u5177\u7684\u4F7F\u7528\u6280\u5DE7\u8FD8\u6709\u5F88\u591A\uFF0C\u4F8B\u5982\u53EA\u89E3\u6790\u5BF9\u67D0\u4E2A\u5E93\u7684\u64CD\u4F5C\u6216\u8005\u67D0\u4E2A\u65F6\u95F4\u6BB5\u5185\u7684\u64CD\u4F5C\u7B49\u3002\u7B80\u5355\u5206\u4EAB\u51E0\u4E2A\u5E38\u7528\u7684\u8BED\u53E5\uFF0C\u66F4\u591A\u64CD\u4F5C\u53EF\u4EE5\u53C2\u8003\u5B98\u65B9\u6587\u6863\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code># \u53EF\u67E5\u770B\u53C2\u6570\u5E2E\u52A9
mysqlbinlog --no-defaults --help
# \u67E5\u770B\u6700\u540E100\u884C
mysqlbinlog --no-defaults --base64-output=decode-rows -vv atguigu-bin.000002 |tail
-100
# \u6839\u636Eposition\u67E5\u627E
mysqlbinlog --no-defaults --base64-output=decode-rows -vv atguigu-bin.000002 |grep -A
20 &#39;4939002&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u9762\u8FD9\u79CD\u529E\u6CD5\u8BFB\u53D6\u51FAbinlog\u65E5\u5FD7\u7684\u5168\u6587\u5185\u5BB9\u6BD4\u8F83\u591A\uFF0C\u4E0D\u5BB9\u6613\u5206\u8FA8\u67E5\u770B\u5230pos\u70B9\u4FE1\u606F\uFF0C\u4E0B\u9762\u4ECB\u7ECD\u4E00\u79CD\u66F4\u4E3A\u65B9\u4FBF\u7684\u67E5\u8BE2\u547D\u4EE4\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql&gt; show binlog events [IN &#39;log_name&#39;] [FROM pos] [LIMIT [offset,] row_count];
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><code>IN &#39;log_name&#39;</code> \uFF1A\u6307\u5B9A\u8981\u67E5\u8BE2\u7684binlog\u6587\u4EF6\u540D\uFF08\u4E0D\u6307\u5B9A\u5C31\u662F\u7B2C\u4E00\u4E2Abinlog\u6587\u4EF6\uFF09</li><li><code>FROM pos</code> \uFF1A\u6307\u5B9A\u4ECE\u54EA\u4E2Apos\u8D77\u59CB\u70B9\u5F00\u59CB\u67E5\u8D77\uFF08\u4E0D\u6307\u5B9A\u5C31\u662F\u4ECE\u6574\u4E2A\u6587\u4EF6\u9996\u4E2Apos\u70B9\u5F00\u59CB\u7B97\uFF09</li><li><code>LIMIT [offset]</code> \uFF1A\u504F\u79FB\u91CF(\u4E0D\u6307\u5B9A\u5C31\u662F0)</li><li><code>row_count</code> :\u67E5\u8BE2\u603B\u6761\u6570\uFF08\u4E0D\u6307\u5B9A\u5C31\u662F\u6240\u6709\u884C\uFF09</li></ul><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql&gt; show binlog events in &#39;atguigu-bin.000002&#39;;
+--------------------+-----+----------------+-----------+-------------+--------------------------------------------------------+
| Log_name           | Pos | Event_type     | Server_id | End_log_pos | Info                                                   |
+--------------------+-----+----------------+-----------+-------------+--------------------------------------------------------+
| atguigu-bin.000002 | 4   | Format_desc    | 1         | 125         | Server ver: 8.0.26, Binlog ver: 4                      |
| atguigu-bin.000002 | 125 | Previous_gtids | 1         | 156         |                                                        |
| atguigu-bin.000002 | 156 | Anonymous_Gtid | 1         | 235         | SET @@SESSION.GTID_NEXT= &#39;ANONYMOUS&#39;                   |
| atguigu-bin.000002 | 235 | Query          | 1         | 324         | BEGIN                                                  |
| atguigu-bin.000002 | 324 | Table_map      | 1         | 391         | table_id: 85(atguigu14.student)                        |
| atguigu-bin.000002 | 391 | Update_rows    | 1         | 470         | table_id: 85flags: STMT_END_F                          |
| atguigu-bin.000002 | 470 | Xid            | 1         | 501         | COMMIT /*xid=15 */                                     |
| atguigu-bin.000002 | 501 | Anonymous_Gtid | 1         | 578         | SET @@SESSION.GTID_NEXT= &#39;ANONYMOUS&#39;                   |
| atguigu-bin.000002 | 578 | Query     | 1 | 721 | use \`atguigu14\`; create table test(id int, title varchar(100)) /* xid=19 */ |
| atguigu-bin.000002 | 721 | Anonymous_Gtid | 1         | 800         | SET @@SESSION.GTID_NEXT= &#39;ANONYMOUS&#39;                   |
| atguigu-bin.000002 | 800 | Query          | 1         | 880         | BEGIN                                                  |
| atguigu-bin.000002 | 880 | Table_map      | 1         | 943         | table_id: 89(atguigu14.test)                           |
| atguigu-bin.000002 | 943 | Write_rows     | 1         | 992         | table_id: 89 flags: STMT_END_F                         |
| atguigu-bin.000002 | 992 | Xid            | 1         | 1023        | COMMIT /*xid=21 */                                     |
+--------------------+-----+----------------+-----------+-------------+--------------------------------------------------------+
14 \u884C\u4E8E\u6570\u636E\u96C6 (0.02 \u79D2)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715165603879.png" alt="image-20220715165603879" style="float:left;"><p>\u4E0A\u9762\u6211\u4EEC\u8BB2\u4E86\u8FD9\u4E48\u591A\u90FD\u662F\u57FA\u4E8Ebinlog\u7684\u9ED8\u8BA4\u683C\u5F0F\uFF0Cbinlog\u683C\u5F0F\u67E5\u770B</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql&gt; show variables like &#39;binlog_format&#39;;
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| binlog_format | ROW   |
+---------------+-------+
1 \u884C\u4E8E\u6570\u636E\u96C6 (0.02 \u79D2)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u9664\u6B64\u4E4B\u5916\uFF0Cbinlog\u8FD8\u67092\u79CD\u683C\u5F0F\uFF0C\u5206\u522B\u662F<code>Statement</code>\u548C<code>Mixed</code></p><ul><li><p>Statement</p><p>\u6BCF\u4E00\u6761\u4F1A\u4FEE\u6539\u6570\u636E\u7684 <code>sql</code> \u90FD\u4F1A\u8BB0\u5F55\u5728binlog\u4E2D\u3002</p><p>\u4F18\u70B9\uFF1A\u4E0D\u9700\u8981\u8BB0\u5F55\u6BCF\u4E00\u884C\u7684\u53D8\u5316\uFF0C\u51CF\u5C11\u4E86binlog\u65E5\u5FD7\u91CF\uFF0C\u8282\u7EA6\u4E86IO\uFF0C\u63D0\u9AD8\u6027\u80FD\u3002</p></li><li><p>Row</p><p>5.1.5\u7248\u672C\u7684MySQL\u624D\u5F00\u59CB\u652F\u6301row level \u7684\u590D\u5236\uFF0C\u5B83\u4E0D\u8BB0\u5F55sql\u8BED\u53E5\u4E0A\u4E0B\u6587\u76F8\u5173\u4FE1\u606F\uFF0C<code>\u4EC5\u4FDD\u5B58\u54EA\u6761\u8BB0\u5F55\u88AB\u4FEE\u6539</code>\u3002</p><p>\u4F18\u70B9\uFF1Arow level \u7684\u65E5\u5FD7\u5185\u5BB9\u4F1A\u975E\u5E38\u6E05\u695A\u7684\u8BB0\u5F55\u4E0B\u6BCF\u4E00\u884C\u6570\u636E\u4FEE\u6539\u7684\u7EC6\u8282\u3002\u800C\u4E14\u4E0D\u4F1A\u51FA\u73B0\u67D0\u4E9B\u7279\u5B9A\u60C5\u51B5\u4E0B \u7684\u5B58\u50A8\u8FC7\u7A0B\uFF0C\u6216function\uFF0C\u4EE5\u53CAtrigger\u7684\u8C03\u7528\u548C\u89E6\u53D1\u65E0\u6CD5\u88AB\u6B63\u786E\u590D\u5236\u7684\u95EE\u9898\u3002</p></li><li><p>Mixed</p><p>\u4ECE5.1.8\u7248\u672C\u5F00\u59CB\uFF0CMySQL\u63D0\u4F9B\u4E86Mixed\u683C\u5F0F\uFF0C\u5B9E\u9645\u4E0A\u5C31\u662FStatement\u4E0ERow\u7684\u7ED3\u5408\u3002</p><p>\u8BE6\u7EC6\u60C5\u51B5\uFF0C\u4E0B\u7AE0\u8BB2\u89E3\u3002</p></li></ul><h5 id="_5-4-\u4F7F\u7528\u65E5\u5FD7\u6062\u590D\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#_5-4-\u4F7F\u7528\u65E5\u5FD7\u6062\u590D\u6570\u636E" aria-hidden="true">#</a> 5.4 \u4F7F\u7528\u65E5\u5FD7\u6062\u590D\u6570\u636E</h5><p>\u5982\u679CMySQL\u670D\u52A1\u5668\u542F\u7528\u4E86\u4E8C\u8FDB\u5236\u65E5\u5FD7\uFF0C\u5728\u6570\u636E\u5E93\u51FA\u73B0\u610F\u5916\u4E22\u5931\u6570\u636E\u65F6\uFF0C\u53EF\u4EE5\u4F7F\u7528MySQLbinlog\u5DE5\u5177\u4ECE\u6307\u5B9A\u7684\u65F6\u95F4\u70B9\u5F00\u59CB\uFF08\u4F8B\u5982\uFF0C\u6700\u540E\u4E00\u6B21\u5907\u4EFD\uFF09\u76F4\u5230\u73B0\u5728\u6216\u53E6\u4E00\u4E2A\u6307\u5B9A\u7684\u65F6\u95F4\u70B9\u7684\u65E5\u5FD7\u4E2D\u56DE\u590D\u6570\u636E\u3002</p><p>mysqlbinlog\u6062\u590D\u6570\u636E\u7684\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqlbinlog [option] filename|mysql \u2013uuser -ppass;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8FD9\u4E2A\u547D\u4EE4\u53EF\u4EE5\u8FD9\u6837\u7406\u89E3\uFF1A\u4F7F\u7528mysqlbinlog\u547D\u4EE4\u6765\u8BFB\u53D6filename\u4E2D\u7684\u5185\u5BB9\uFF0C\u7136\u540E\u4F7F\u7528mysql\u547D\u4EE4\u5C06\u8FD9\u4E9B\u5185\u5BB9\u6062\u590D\u5230\u6570\u636E\u5E93\u4E2D\u3002</p><ul><li><p><code>filename</code> \uFF1A\u662F\u65E5\u5FD7\u6587\u4EF6\u540D\u3002</p></li><li><p><code>option</code> \uFF1A\u53EF\u9009\u9879\uFF0C\u6BD4\u8F83\u91CD\u8981\u7684\u4E24\u5BF9option\u53C2\u6570\u662F--start-date\u3001--stop-date \u548C --start-position\u3001-- stop-position\u3002</p><ul><li><code>--start-date</code> \u548C<code> --stop-date</code> \uFF1A\u53EF\u4EE5\u6307\u5B9A\u6062\u590D\u6570\u636E\u5E93\u7684\u8D77\u59CB\u65F6\u95F4\u70B9\u548C\u7ED3\u675F\u65F6\u95F4\u70B9\u3002</li><li><code>--start-position</code>\u548C<code>--stop-position</code> \uFF1A\u53EF\u4EE5\u6307\u5B9A\u6062\u590D\u6570\u636E\u7684\u5F00\u59CB\u4F4D\u7F6E\u548C\u7ED3\u675F\u4F4D\u7F6E\u3002</li></ul></li></ul><blockquote><p>\u6CE8\u610F\uFF1A\u4F7F\u7528mysqlbinlog\u547D\u4EE4\u8FDB\u884C\u6062\u590D\u64CD\u4F5C\u65F6\uFF0C\u5FC5\u987B\u662F\u7F16\u53F7\u5C0F\u7684\u5148\u6062\u590D\uFF0C\u4F8B\u5982atguigu-bin.000001\u5FC5\u987B\u5728atguigu-bin.000002\u4E4B\u524D\u6062\u590D\u3002</p></blockquote><p>\u8BE6\u89C1p189\uFF0C\u7531\u4E8E\u7FFB\u9875\u8FC7\u5FEB\uFF0C\u8FD9\u90E8\u5206\u6CA1\u529E\u6CD5\u8BB0\u5F55\u3002</p><h5 id="_5-5-\u5220\u9664\u4E8C\u8FDB\u5236\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_5-5-\u5220\u9664\u4E8C\u8FDB\u5236\u65E5\u5FD7" aria-hidden="true">#</a> 5.5 \u5220\u9664\u4E8C\u8FDB\u5236\u65E5\u5FD7</h5><p>MySQL\u7684\u4E8C\u8FDB\u5236\u6587\u4EF6\u53EF\u4EE5\u914D\u7F6E\u81EA\u52A8\u5220\u9664\uFF0C\u540C\u65F6MySQL\u4E5F\u63D0\u4F9B\u4E86\u5B89\u5168\u7684\u624B\u52A8\u5220\u9664\u4E8C\u8FDB\u5236\u6587\u4EF6\u7684\u65B9\u6CD5\u3002 <code>PURGE MASTER LOGS</code> \u53EA\u5220\u9664\u6307\u5B9A\u90E8\u5206\u7684\u4E8C\u8FDB\u5236\u65E5\u5FD7\u6587\u4EF6\uFF0C <code>RESET MASTER</code> \u5220\u9664\u6240\u6709\u7684\u4E8C\u8FDB\u5236\u65E5\u5FD7\u6587 \u4EF6\u3002\u5177\u4F53\u5982\u4E0B\uFF1A</p><p><strong>1. PURGE MASTER LOGS\uFF1A\u5220\u9664\u6307\u5B9A\u65E5\u5FD7\u6587\u4EF6</strong></p><p>PURGE MASTER LOGS\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>PURGE {MASTER | BINARY} LOGS TO \u2018\u6307\u5B9A\u65E5\u5FD7\u6587\u4EF6\u540D\u2019
PURGE {MASTER | BINARY} LOGS BEFORE \u2018\u6307\u5B9A\u65E5\u671F\u2019
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715171712026.png" alt="image-20220715171712026" style="float:left;"><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715172015185.png" alt="image-20220715172015185" style="float:left;"><p><strong>2. RESET MASTER: \u5220\u9664\u6240\u6709\u4E8C\u8FDB\u5236\u65E5\u5FD7\u6587\u4EF6</strong></p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715172104967.png" alt="image-20220715172104967" style="float:left;"><h5 id="_5-6-\u5176\u5B83\u573A\u666F" tabindex="-1"><a class="header-anchor" href="#_5-6-\u5176\u5B83\u573A\u666F" aria-hidden="true">#</a> 5.6 \u5176\u5B83\u573A\u666F</h5><p>\u4E8C\u8FDB\u5236\u65E5\u5FD7\u53EF\u4EE5\u901A\u8FC7\u6570\u636E\u5E93\u7684 <code>\u5168\u91CF\u5907\u4EFD</code> \u548C\u4E8C\u8FDB\u5236\u65E5\u5FD7\u4E2D\u4FDD\u5B58\u7684 <code>\u589E\u91CF\u4FE1\u606F</code> \uFF0C\u5B8C\u6210\u6570\u636E\u5E93\u7684 <code>\u65E0\u635F\u5931\u6062\u590D</code> \u3002 \u4F46\u662F\uFF0C\u5982\u679C\u9047\u5230\u6570\u636E\u91CF\u5927\u3001\u6570\u636E\u5E93\u548C\u6570\u636E\u8868\u5F88\u591A\uFF08\u6BD4\u5982\u5206\u5E93\u5206\u8868\u7684\u5E94\u7528\uFF09\u7684\u573A\u666F\uFF0C\u7528\u4E8C\u8FDB\u5236\u65E5\u5FD7\u8FDB\u884C\u6570\u636E\u6062\u590D\uFF0C\u662F\u5F88\u6709\u6311\u6218\u6027\u7684\uFF0C\u56E0\u4E3A\u8D77\u6B62\u4F4D\u7F6E\u4E0D\u5BB9\u6613\u7BA1\u7406\u3002</p><p>\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u4E00\u4E2A\u6709\u6548\u7684\u89E3\u51B3\u529E\u6CD5\u662F <code>\u914D\u7F6E\u4E3B\u4ECE\u6570\u636E\u5E93\u670D\u52A1\u5668</code> \uFF0C\u751A\u81F3\u662F <code>\u4E00\u4E3B\u591A\u4ECE</code> \u7684\u67B6\u6784\uFF0C\u628A\u4E8C\u8FDB\u5236\u65E5\u5FD7\u6587\u4EF6\u7684\u5185\u5BB9\u901A\u8FC7\u4E2D\u7EE7\u65E5\u5FD7\uFF0C\u540C\u6B65\u5230\u4ECE\u6570\u636E\u5E93\u670D\u52A1\u5668\u4E2D\uFF0C\u8FD9\u6837\u5C31\u53EF\u4EE5\u6709\u6548\u907F\u514D\u6570\u636E\u5E93\u6545\u969C\u5BFC\u81F4\u7684\u6570\u636E\u5F02\u5E38\u7B49\u95EE\u9898\u3002</p><h3 id="_6-\u518D\u8C08\u4E8C\u8FDB\u5236\u65E5\u5FD7-binlog" tabindex="-1"><a class="header-anchor" href="#_6-\u518D\u8C08\u4E8C\u8FDB\u5236\u65E5\u5FD7-binlog" aria-hidden="true">#</a> 6. \u518D\u8C08\u4E8C\u8FDB\u5236\u65E5\u5FD7(binlog)</h3><h5 id="_6-1-\u5199\u5165\u673A\u5236" tabindex="-1"><a class="header-anchor" href="#_6-1-\u5199\u5165\u673A\u5236" aria-hidden="true">#</a> 6.1 \u5199\u5165\u673A\u5236</h5><p>binlog\u7684\u5199\u5165\u65F6\u673A\u4E5F\u975E\u5E38\u7B80\u5355\uFF0C\u4E8B\u52A1\u6267\u884C\u8FC7\u7A0B\u4E2D\uFF0C\u5148\u628A\u65E5\u5FD7\u5199\u5230 <code>binlog cache</code> \uFF0C\u4E8B\u52A1\u63D0\u4EA4\u7684\u65F6\u5019\uFF0C\u518D\u628Abinlog cache\u5199\u5230binlog\u6587\u4EF6\u4E2D\u3002\u56E0\u4E3A\u4E00\u4E2A\u4E8B\u52A1\u7684binlog\u4E0D\u80FD\u88AB\u62C6\u5F00\uFF0C\u65E0\u8BBA\u8FD9\u4E2A\u4E8B\u52A1\u591A\u5927\uFF0C\u4E5F\u8981\u786E\u4FDD\u4E00\u6B21\u6027\u5199\u5165\uFF0C\u6240\u4EE5\u7CFB\u7EDF\u4F1A\u7ED9\u6BCF\u4E2A\u7EBF\u7A0B\u5206\u914D\u4E00\u4E2A\u5757\u5185\u5B58\u4F5C\u4E3Abinlog cache\u3002</p><p>\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7<code>binlog_cache_size</code>\u53C2\u6570\u63A7\u5236\u5355\u4E2A\u7EBF\u7A0B binlog cache \u5927\u5C0F\uFF0C\u5982\u679C\u5B58\u50A8\u5185\u5BB9\u8D85\u8FC7\u4E86\u8FD9\u4E2A\u53C2\u6570\uFF0C\u5C31\u8981\u6682\u5B58\u5230\u78C1\u76D8\uFF08Swap\uFF09\u3002binlog\u65E5\u5FD7\u5237\u76D8\u6D41\u7A0B\u5982\u4E0B\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715172958729.png" alt="image-20220715172958729"></p><blockquote><ul><li>\u4E0A\u56FE\u7684write\uFF0C\u662F\u6307\u628A\u65E5\u5FD7\u5199\u5165\u5230\u6587\u4EF6\u7CFB\u7EDF\u7684page cache\uFF0C\u5E76\u6CA1\u6709\u628A\u6570\u636E\u6301\u4E45\u5316\u5230\u78C1\u76D8\uFF0C\u6240\u4EE5\u901F\u5EA6\u6BD4\u8F83\u5FEB</li><li>\u4E0A\u56FE\u7684fsync\uFF0C\u624D\u662F\u5C06\u6570\u636E\u6301\u4E45\u5316\u5230\u78C1\u76D8\u7684\u64CD\u4F5C</li></ul></blockquote><p>write\u548Cfsync\u7684\u65F6\u673A\uFF0C\u53EF\u4EE5\u7531\u53C2\u6570 <code>sync_binlog</code> \u63A7\u5236\uFF0C\u9ED8\u8BA4\u662F <code>0</code> \u3002\u4E3A0\u7684\u65F6\u5019\uFF0C\u8868\u793A\u6BCF\u6B21\u63D0\u4EA4\u4E8B\u52A1\u90FD\u53EA write\uFF0C\u7531\u7CFB\u7EDF\u81EA\u884C\u5224\u65AD\u4EC0\u4E48\u65F6\u5019\u6267\u884Cfsync\u3002\u867D\u7136\u6027\u80FD\u5F97\u5230\u63D0\u5347\uFF0C\u4F46\u662F\u673A\u5668\u5B95\u673A\uFF0Cpage cache\u91CC\u9762\u7684 binglog \u4F1A\u4E22\u5931\u3002\u5982\u4E0B\u56FE\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715193749462.png" alt="image-20220715193749462"></p><p>\u4E3A\u4E86\u5B89\u5168\u8D77\u89C1\uFF0C\u53EF\u4EE5\u8BBE\u7F6E\u4E3A <code>1</code> \uFF0C\u8868\u793A\u6BCF\u6B21\u63D0\u4EA4\u4E8B\u52A1\u90FD\u4F1A\u6267\u884Cfsync\uFF0C\u5C31\u5982\u540C<strong>redo log \u5237\u76D8\u6D41\u7A0B</strong>\u4E00\u6837\u3002 \u6700\u540E\u8FD8\u6709\u4E00\u79CD\u6298\u4E2D\u65B9\u5F0F\uFF0C\u53EF\u4EE5\u8BBE\u7F6E\u4E3AN(N&gt;1)\uFF0C\u8868\u793A\u6BCF\u6B21\u63D0\u4EA4\u4E8B\u52A1\u90FDwrite\uFF0C\u4F46\u7D2F\u79EFN\u4E2A\u4E8B\u52A1\u540E\u624Dfsync\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715194624080.png" alt="image-20220715194624080"></p><p>\u5728\u51FA\u73B0IO\u74F6\u9888\u7684\u573A\u666F\u91CC\uFF0C\u5C06sync_binlog\u8BBE\u7F6E\u6210\u4E00\u4E2A\u6BD4\u8F83\u5927\u7684\u503C\uFF0C\u53EF\u4EE5\u63D0\u5347\u6027\u80FD\u3002\u540C\u6837\u7684\uFF0C\u5982\u679C\u673A\u5668\u5B95\u673A\uFF0C\u4F1A\u4E22\u5931\u6700\u8FD1N\u4E2A\u4E8B\u52A1\u7684binlog\u65E5\u5FD7\u3002</p><h5 id="_6-2-binlog\u4E0Eredolog\u5BF9\u6BD4" tabindex="-1"><a class="header-anchor" href="#_6-2-binlog\u4E0Eredolog\u5BF9\u6BD4" aria-hidden="true">#</a> 6.2 binlog\u4E0Eredolog\u5BF9\u6BD4</h5><ul><li>redo log \u5B83\u662F <code>\u7269\u7406\u65E5\u5FD7</code> \uFF0C\u8BB0\u5F55\u5185\u5BB9\u662F\u201C\u5728\u67D0\u4E2A\u6570\u636E\u9875\u4E0A\u505A\u4E86\u4EC0\u4E48\u4FEE\u6539\u201D\uFF0C\u5C5E\u4E8E InnoDB \u5B58\u50A8\u5F15\u64CE\u5C42\u4EA7\u751F\u7684\u3002</li><li>\u800C binlog \u662F <code>\u903B\u8F91\u65E5\u5FD7</code> \uFF0C\u8BB0\u5F55\u5185\u5BB9\u662F\u8BED\u53E5\u7684\u539F\u59CB\u903B\u8F91\uFF0C\u7C7B\u4F3C\u4E8E\u201C\u7ED9 ID=2 \u8FD9\u4E00\u884C\u7684 c \u5B57\u6BB5\u52A0 1\u201D\uFF0C\u5C5E\u4E8E MySQL Server \u5C42\u3002</li><li>\u867D\u7136\u5B83\u4EEC\u90FD\u5C5E\u4E8E\u6301\u4E45\u5316\u7684\u4FDD\u8BC1\uFF0C\u4F46\u662F\u4FA7\u91CD\u70B9\u4E0D\u540C\u3002 <ul><li>redo log\u8BA9InnoDB\u5B58\u50A8\u5F15\u64CE\u62E5\u6709\u4E86\u5D29\u6E83\u6062\u590D\u80FD\u529B\u3002</li><li>binlog\u4FDD\u8BC1\u4E86MySQL\u96C6\u7FA4\u67B6\u6784\u7684\u6570\u636E\u4E00\u81F4\u6027\u3002</li></ul></li></ul><h5 id="_6-3-\u4E24\u9636\u6BB5\u63D0\u4EA4" tabindex="-1"><a class="header-anchor" href="#_6-3-\u4E24\u9636\u6BB5\u63D0\u4EA4" aria-hidden="true">#</a> 6.3 \u4E24\u9636\u6BB5\u63D0\u4EA4</h5><p>\u5728\u6267\u884C\u66F4\u65B0\u8BED\u53E5\u8FC7\u7A0B\uFF0C\u4F1A\u8BB0\u5F55redo log\u4E0Ebinlog\u4E24\u5757\u65E5\u5FD7\uFF0C\u4EE5\u57FA\u672C\u7684\u4E8B\u52A1\u4E3A\u5355\u4F4D\uFF0C<code>redo log\u5728\u4E8B\u52A1\u6267\u884C\u8FC7\u7A0B\u4E2D\u53EF\u4EE5\u4E0D\u65AD\u5199\u5165\uFF0C\u800Cbinlog\u53EA\u6709\u5728\u63D0\u4EA4\u4E8B\u52A1\u65F6\u624D\u5199\u5165</code> \uFF0C\u6240\u4EE5redo log\u4E0Ebinlog\u7684 <code>\u5199\u5165\u65F6\u673A</code> \u4E0D\u4E00\u6837\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715194959405.png" alt="image-20220715194959405"></p><p><strong>redo log\u4E0Ebinlog\u4E24\u4EFD\u65E5\u5FD7\u4E4B\u95F4\u7684\u903B\u8F91\u4E0D\u4E00\u81F4\uFF0C\u4F1A\u51FA\u73B0\u4EC0\u4E48\u95EE\u9898\uFF1F</strong></p><p>\u4EE5update\u8BED\u53E5\u4E3A\u4F8B\uFF0C\u5047\u8BBE<code>id=2</code>\u7684\u8BB0\u5F55\uFF0C\u5B57\u6BB5<code>c</code>\u503C\u662F<code>0</code>\uFF0C\u628A\u5B57\u6BB5c\u503C\u66F4\u65B0\u4E3A<code>1</code>\uFF0CSQL\u8BED\u53E5\u4E3Aupdate T set c = 1 where id = 2\u3002</p><p>\u5047\u8BBE\u6267\u884C\u8FC7\u7A0B\u4E2D\u5199\u5B8Credo log\u65E5\u5FD7\u540E\uFF0Cbinlog\u65E5\u5FD7\u5199\u671F\u95F4\u53D1\u751F\u4E86\u5F02\u5E38\uFF0C\u4F1A\u51FA\u73B0\u4EC0\u4E48\u60C5\u51B5\u5462\uFF1F</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715195016492.png" alt="image-20220715195016492"></p><p>\u7531\u4E8Ebinlog\u6CA1\u5199\u5B8C\u5C31\u5F02\u5E38\uFF0C\u8FD9\u65F6\u5019binlog\u91CC\u9762\u6CA1\u6709\u5BF9\u5E94\u7684\u4FEE\u6539\u8BB0\u5F55\u3002\u56E0\u6B64\uFF0C<code>\u4E4B\u540E\u7528binlog\u65E5\u5FD7\u6062\u590D\u6570\u636E\u65F6\uFF0C\u5C31\u4F1A\u5C11\u8FD9\u4E00\u6B21\u66F4\u65B0\uFF0C\u6062\u590D\u51FA\u6765\u7684\u8FD9\u4E00\u884Cc\u503C\u4E3A0\uFF0C\u800C\u539F\u5E93\u56E0\u4E3Aredo log\u65E5\u5FD7\u6062\u590D\uFF0C\u8FD9\u4E00\u884Cc\u7684\u503C\u662F1\uFF0C\u6700\u7EC8\u6570\u636E\u4E0D\u4E00\u81F4\u3002</code></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715195521986.png" alt="image-20220715195521986"></p><p>\u4E3A\u4E86\u89E3\u51B3 <strong>\u4E24\u4EFD\u65E5\u5FD7\u4E4B\u95F4\u7684\u903B\u8F91\u4E00\u81F4\u95EE\u9898</strong>\uFF0CInnoDB\u5B58\u50A8\u5F15\u64CE\u4F7F\u7528 <strong>\u4E24\u9636\u6BB5\u63D0\u4EA4</strong> \u65B9\u6848\u3002\u539F\u7406\u5F88\u7B80\u5355\uFF0C\u5C06redo log\u7684\u5199\u5165\u62C6\u6210\u4E86\u4E24\u4E2A\u6B65\u9AA4 <code>prepare\u548Ccommit</code> \uFF0C\u8FD9\u5C31\u662F<strong>\u4E24\u9636\u6BB5\u63D0\u4EA4</strong>\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715195635196.png" alt="image-20220715195635196"></p><p>\u4F7F\u7528\u4E24\u9636\u6BB5\u63D0\u4EA4\u540E\uFF0C\u5199\u5165binlog\u65F6\u53D1\u751F\u5F02\u5E38\u4E5F\u4E0D\u4F1A\u6709\u5F71\u54CD\uFF0C<strong>\u56E0\u4E3AMySQL\u6839\u636Eredo log\u65E5\u5FD7\u6062\u590D\u6570\u636E\u65F6\uFF0C\u53D1\u73B0redo log\u8FD8\u5904\u4E8Eprepare\u9636\u6BB5\uFF0C\u5E76\u4E14\u6CA1\u6709\u5BF9\u5E94binlog\u65E5\u5FD7\uFF0C\u5C31\u4F1A\u56DE\u6EDA\u8BE5\u4E8B\u52A1\u3002</strong></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715200248193.png" alt="image-20220715200248193"></p><p>\u53E6\u4E00\u4E2A\u573A\u666F\uFF0C<strong>redo log\u8BBE\u7F6Ecommit\u9636\u6BB5\u53D1\u751F\u5F02\u5E38\uFF0C\u90A3\u4F1A\u4E0D\u4F1A\u56DE\u6EDA\u4E8B\u52A1\u5462\uFF1F</strong></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715200321717.png" alt="image-20220715200321717"></p><p><strong>\u5E76\u4E0D\u4F1A\u56DE\u6EDA\u4E8B\u52A1</strong>\uFF0C\u5B83\u4F1A\u6267\u884C\u4E0A\u56FE\u6846\u4F4F\u7684\u903B\u8F91\uFF0C\u867D\u7136redo log\u662F\u5904\u4E8Eprepare\u9636\u6BB5\uFF0C<strong>\u4F46\u662F\u80FD\u901A\u8FC7\u4E8B\u52A1id\u627E\u5230\u5BF9\u5E94\u7684binlog\u65E5\u5FD7</strong>\uFF0C\u6240\u4EE5MySQL\u8BA4\u4E3A\u662F\u5B8C\u6574\u7684\uFF0C\u5C31\u4F1A\u63D0\u4EA4\u4E8B\u52A1\u6062\u590D\u6570\u636E\u3002</p><h3 id="_7-\u4E2D\u7EE7\u65E5\u5FD7-relay-log" tabindex="-1"><a class="header-anchor" href="#_7-\u4E2D\u7EE7\u65E5\u5FD7-relay-log" aria-hidden="true">#</a> 7. \u4E2D\u7EE7\u65E5\u5FD7(relay log)</h3><h5 id="_7-1-\u4ECB\u7ECD" tabindex="-1"><a class="header-anchor" href="#_7-1-\u4ECB\u7ECD" aria-hidden="true">#</a> 7.1 \u4ECB\u7ECD</h5><p><strong>\u4E2D\u7EE7\u65E5\u5FD7\u53EA\u5728\u4E3B\u4ECE\u670D\u52A1\u5668\u67B6\u6784\u7684\u4ECE\u670D\u52A1\u5668\u4E0A\u5B58\u5728</strong>\u3002\u4ECE\u670D\u52A1\u5668\u4E3A\u4E86\u4E0E\u4E3B\u670D\u52A1\u5668\u4FDD\u6301\u4E00\u81F4\uFF0C\u8981\u4ECE\u4E3B\u670D\u52A1\u5668\u8BFB\u53D6\u4E8C\u8FDB\u5236\u65E5\u5FD7\u7684\u5185\u5BB9\uFF0C\u5E76\u4E14\u628A\u8BFB\u53D6\u5230\u7684\u4FE1\u606F\u5199\u5165 <code>\u672C\u5730\u7684\u65E5\u5FD7\u6587\u4EF6</code> \u4E2D\uFF0C\u8FD9\u4E2A\u4ECE\u670D\u52A1\u5668\u672C\u5730\u7684\u65E5\u5FD7\u6587\u4EF6\u5C31\u53EB <code>\u4E2D\u7EE7\u65E5\u5FD7</code> \u3002\u7136\u540E\uFF0C\u4ECE\u670D\u52A1\u5668\u8BFB\u53D6\u4E2D\u7EE7\u65E5\u5FD7\uFF0C\u5E76\u6839\u636E\u4E2D\u7EE7\u65E5\u5FD7\u7684\u5185\u5BB9\u5BF9\u4ECE\u670D\u52A1\u5668\u7684\u6570\u636E\u8FDB\u884C\u66F4\u65B0\uFF0C\u5B8C\u6210\u4E3B \u4ECE\u670D\u52A1\u5668\u7684 <strong>\u6570\u636E\u540C\u6B65</strong> \u3002</p><p>\u642D\u5EFA\u597D\u4E3B\u4ECE\u670D\u52A1\u5668\u4E4B\u540E\uFF0C\u4E2D\u7EE7\u65E5\u5FD7\u9ED8\u8BA4\u4F1A\u4FDD\u5B58\u5728\u4ECE\u670D\u52A1\u5668\u7684\u6570\u636E\u76EE\u5F55\u4E0B\u3002</p><p>\u6587\u4EF6\u540D\u7684\u683C\u5F0F\u662F\uFF1A<code> \u4ECE\u670D\u52A1\u5668\u540D -relay-bin.\u5E8F\u53F7</code> \u3002\u4E2D\u7EE7\u65E5\u5FD7\u8FD8\u6709\u4E00\u4E2A\u7D22\u5F15\u6587\u4EF6\uFF1A<code>\u4ECE\u670D\u52A1\u5668\u540D -relaybin.index</code> \uFF0C\u7528\u6765\u5B9A\u4F4D\u5F53\u524D\u6B63\u5728\u4F7F\u7528\u7684\u4E2D\u7EE7\u65E5\u5FD7\u3002</p><h5 id="_7-2-\u67E5\u770B\u4E2D\u7EE7\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_7-2-\u67E5\u770B\u4E2D\u7EE7\u65E5\u5FD7" aria-hidden="true">#</a> 7.2 \u67E5\u770B\u4E2D\u7EE7\u65E5\u5FD7</h5><p>\u4E2D\u7EE7\u65E5\u5FD7\u4E0E\u4E8C\u8FDB\u5236\u65E5\u5FD7\u7684\u683C\u5F0F\u76F8\u540C\uFF0C\u53EF\u4EE5\u7528 <code>mysqlbinlog</code> \u5DE5\u5177\u8FDB\u884C\u67E5\u770B\u3002\u4E0B\u9762\u662F\u4E2D\u7EE7\u65E5\u5FD7\u7684\u4E00\u4E2A\u7247\u6BB5\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SET TIMESTAMP=1618558728/*!*/;
BEGIN
/*!*/;
# at 950
#210416 15:38:48 server id 1 end_log_pos 832 CRC32 0xcc16d651 Table_map:
\`atguigu\`.\`test\` mapped to number 91
# at 1000
#210416 15:38:48 server id 1 end_log_pos 872 CRC32 0x07e4047c Delete_rows: table id
91 flags: STMT_END_F -- server id 1 \u662F\u4E3B\u670D\u52A1\u5668\uFF0C\u610F\u601D\u662F\u4E3B\u670D\u52A1\u5668\u5220\u4E86\u4E00\u884C\u6570\u636E
BINLOG &#39;
CD95YBMBAAAAMgAAAEADAAAAAFsAAAAAAAEABGRlbW8ABHRlc3QAAQMAAQEBAFHWFsw=
CD95YCABAAAAKAAAAGgDAAAAAFsAAAAAAAEAAgAB/wABAAAAfATkBw==
&#39;/*!*/;
# at 1040
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u4E00\u6BB5\u7684\u610F\u601D\u662F\uFF0C\u4E3B\u670D\u52A1\u5668\uFF08\u201Cserver id 1\u201D\uFF09\u5BF9\u8868 atguigu.test \u8FDB\u884C\u4E86 2 \u6B65\u64CD\u4F5C\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>\u5B9A\u4F4D\u5230\u8868 atguigu.test \u7F16\u53F7\u662F 91 \u7684\u8BB0\u5F55\uFF0C\u65E5\u5FD7\u4F4D\u7F6E\u662F 832\uFF1B
\u5220\u9664\u7F16\u53F7\u662F 91 \u7684\u8BB0\u5F55\uFF0C\u65E5\u5FD7\u4F4D\u7F6E\u662F 872
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_7-3-\u6062\u590D\u7684\u5178\u578B\u9519\u8BEF" tabindex="-1"><a class="header-anchor" href="#_7-3-\u6062\u590D\u7684\u5178\u578B\u9519\u8BEF" aria-hidden="true">#</a> 7.3 \u6062\u590D\u7684\u5178\u578B\u9519\u8BEF</h5><p>\u5982\u679C\u4ECE\u670D\u52A1\u5668\u5B95\u673A\uFF0C\u6709\u7684\u65F6\u5019\u4E3A\u4E86\u7CFB\u7EDF\u6062\u590D\uFF0C\u8981\u91CD\u88C5\u64CD\u4F5C\u7CFB\u7EDF\uFF0C\u8FD9\u6837\u5C31\u53EF\u80FD\u4F1A\u5BFC\u81F4\u4F60\u7684 <code>\u670D\u52A1\u5668\u540D\u79F0</code> \u4E0E\u4E4B\u524D <code>\u4E0D\u540C</code> \u3002\u800C\u4E2D\u7EE7\u65E5\u5FD7\u91CC\u662F <code>\u5305\u542B\u4ECE\u670D\u52A1\u5668\u540D</code> \u7684\u3002\u5728\u8FD9\u79CD\u60C5\u51B5\u4E0B\uFF0C\u5C31\u53EF\u80FD\u5BFC\u81F4\u4F60\u6062\u590D\u4ECE\u670D\u52A1\u5668\u7684\u65F6\u5019\uFF0C\u65E0\u6CD5 \u4ECE\u5B95\u673A\u524D\u7684\u4E2D\u7EE7\u65E5\u5FD7\u91CC\u8BFB\u53D6\u6570\u636E\uFF0C\u4EE5\u4E3A\u662F\u65E5\u5FD7\u6587\u4EF6\u635F\u574F\u4E86\uFF0C\u5176\u5B9E\u662F\u540D\u79F0\u4E0D\u5BF9\u4E86\u3002</p><p>\u89E3\u51B3\u7684\u65B9\u6CD5\u4E5F\u5F88\u7B80\u5355\uFF0C\u628A\u4ECE\u670D\u52A1\u5668\u7684\u540D\u79F0\u6539\u56DE\u4E4B\u524D\u7684\u540D\u79F0\u3002</p><h5 id="_7-4-\u4E3A\u4EC0\u4E48\u8981\u6709\u4E2D\u7EE7\u65E5\u5FD7" tabindex="-1"><a class="header-anchor" href="#_7-4-\u4E3A\u4EC0\u4E48\u8981\u6709\u4E2D\u7EE7\u65E5\u5FD7" aria-hidden="true">#</a> 7.4 \u4E3A\u4EC0\u4E48\u8981\u6709\u4E2D\u7EE7\u65E5\u5FD7</h5><p>\u5047\u5982\u6CA1\u6709\u4E2D\u7EE7\u65E5\u5FD7\u7684\u8BDD\uFF0C\u76F8\u5F53\u4E8E\u4E00\u4E2A\u7EBF\u7A0B\u65E2\u8981\u5145\u5F53 IO \u7EBF\u7A0B\uFF0C\u53C8\u8981\u5145\u5F53 SQL \u7EBF\u7A0B\u3002\u65E2\u8981\u8BFB\u53D6 Binlog \uFF0C\u53C8\u8981\u5C06 Binlog \u7684\u5185\u5BB9\u5199\u5165\u5230\u4ECE\u5E93\u4E2D\u3002\u5F88\u660E\u663E\uFF0C\u4E24\u8005\u4F1A\u76F8\u4E92\u963B\u585E\uFF0C\u8BFB Binlog \u7684\u65F6\u5019\u5C31\u4E0D\u80FD\u91CD\u653E Binlog\uFF0C\u8FD9\u6837\uFF0C\u5C31\u5F88\u5BB9\u6613\u5BFC\u81F4\u4E3B\u4ECE\u5EF6\u8FDF\u3002</p><p>\u4E2D\u7EE7\u65E5\u5FD7\uFF0C<code>\u5B9E\u9645\u4E0A\u662F\u5C06\u8BFB\u548C\u5199\u8FD9\u4E24\u4E2A\u52A8\u4F5C\u8FDB\u884C\u89E3\u8026\u3002</code></p><h2 id="\u7B2C18\u7AE0-\u4E3B\u4ECE\u590D\u5236" tabindex="-1"><a class="header-anchor" href="#\u7B2C18\u7AE0-\u4E3B\u4ECE\u590D\u5236" aria-hidden="true">#</a> \u7B2C18\u7AE0_\u4E3B\u4ECE\u590D\u5236</h2><h3 id="_1-\u4E3B\u4ECE\u590D\u5236\u6982\u8FF0" tabindex="-1"><a class="header-anchor" href="#_1-\u4E3B\u4ECE\u590D\u5236\u6982\u8FF0" aria-hidden="true">#</a> 1. \u4E3B\u4ECE\u590D\u5236\u6982\u8FF0</h3><h5 id="_1-1-\u5982\u4F55\u63D0\u5347\u6570\u636E\u5E93\u5E76\u53D1\u80FD\u529B" tabindex="-1"><a class="header-anchor" href="#_1-1-\u5982\u4F55\u63D0\u5347\u6570\u636E\u5E93\u5E76\u53D1\u80FD\u529B" aria-hidden="true">#</a> 1.1 \u5982\u4F55\u63D0\u5347\u6570\u636E\u5E93\u5E76\u53D1\u80FD\u529B</h5><p>\u5728\u5B9E\u9645\u5DE5\u4F5C\u4E2D\uFF0C\u6211\u4EEC\u5E38\u5E38\u5C06<code>Redis</code>\u4F5C\u4E3A\u7F13\u5B58\u4E0E<code>MySQL</code>\u914D\u5408\u6765\u4F7F\u7528\uFF0C\u5F53\u6709\u8BF7\u6C42\u7684\u65F6\u5019\uFF0C\u9996\u5148\u4F1A\u4ECE\u7F13\u5B58\u4E2D\u8FDB\u884C\u67E5\u627E\uFF0C\u5982\u679C\u5B58\u5728\u5C31\u76F4\u63A5\u53D6\u51FA\u3002\u5982\u679C\u4E0D\u5B58\u5728\u518D\u8BBF\u95EE\u6570\u636E\u5E93\uFF0C\u8FD9\u6837\u5C31<code>\u63D0\u5347\u4E86\u8BFB\u53D6\u7684\u6548\u7387</code>\uFF0C\u4E5F\u51CF\u5C11\u4E86\u5BF9\u540E\u7AEF\u6570\u636E\u5E93\u7684<code>\u8BBF\u95EE\u538B\u529B</code>\u3002Redis\u7684\u7F13\u5B58\u67B6\u6784\u662F<code>\u9AD8\u5E76\u53D1\u67B6\u6784</code>\u4E2D\u975E\u5E38\u91CD\u8981\u7684\u4E00\u73AF\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715202237535.png" alt="image-20220715202237535"></p><p>\u6B64\u5916\uFF0C\u4E00\u822C\u5E94\u7528\u5BF9\u6570\u636E\u5E93\u800C\u8A00\u90FD\u662F\u201C <code>\u8BFB\u591A\u5199\u5C11</code> \u201D\uFF0C\u4E5F\u5C31\u8BF4\u5BF9\u6570\u636E\u5E93\u8BFB\u53D6\u6570\u636E\u7684\u538B\u529B\u6BD4\u8F83\u5927\uFF0C\u6709\u4E00\u4E2A\u601D\u8DEF\u5C31\u662F\u91C7\u7528\u6570\u636E\u5E93\u96C6\u7FA4\u7684\u65B9\u6848\uFF0C\u505A <code>\u4E3B\u4ECE\u67B6\u6784</code> \u3001\u8FDB\u884C <code>\u8BFB\u5199\u5206\u79BB</code> \uFF0C\u8FD9\u6837\u540C\u6837\u53EF\u4EE5\u63D0\u5347\u6570\u636E\u5E93\u7684\u5E76\u53D1\u5904\u7406\u80FD\u529B\u3002\u4F46\u5E76\u4E0D\u662F\u6240\u6709\u7684\u5E94\u7528\u90FD\u9700\u8981\u5BF9\u6570\u636E\u5E93\u8FDB\u884C\u4E3B\u4ECE\u67B6\u6784\u7684\u8BBE\u7F6E\uFF0C\u6BD5\u7ADF\u8BBE\u7F6E\u67B6\u6784\u672C\u8EAB\u662F\u6709\u6210\u672C\u7684\u3002</p><p>\u5982\u679C\u6211\u4EEC\u7684\u76EE\u7684\u5728\u4E8E\u63D0\u5347\u6570\u636E\u5E93\u9AD8\u5E76\u53D1\u8BBF\u95EE\u7684\u6548\u7387\uFF0C\u90A3\u4E48\u9996\u5148\u8003\u8651\u7684\u662F\u5982\u4F55 <code>\u4F18\u5316SQL\u548C\u7D22\u5F15</code> \uFF0C\u8FD9\u79CD\u65B9\u5F0F \u7B80\u5355\u6709\u6548\uFF1B\u5176\u6B21\u624D\u662F\u91C7\u7528 <code>\u7F13\u5B58\u7684\u7B56\u7565</code> \uFF0C\u6BD4\u5982\u4F7F\u7528 Redis\u5C06\u70ED\u70B9\u6570\u636E\u4FDD\u5B58\u5728\u5185\u5B58\u6570\u636E\u5E93\u4E2D\uFF0C\u63D0\u5347\u8BFB\u53D6\u7684\u6548\u7387\uFF1B\u6700\u540E\u624D\u662F\u5BF9\u6570\u636E\u5E93\u91C7\u7528 <code>\u4E3B\u4ECE\u67B6\u6784</code> \uFF0C\u8FDB\u884C\u8BFB\u5199\u5206\u79BB\u3002</p><p>\u6309\u7167\u4E0A\u9762\u7684\u65B9\u5F0F\u8FDB\u884C\u4F18\u5316\uFF0C\u4F7F\u7528\u548C\u7EF4\u62A4\u7684\u6210\u672C\u662F\u7531\u4F4E\u5230\u9AD8\u7684\u3002</p><h5 id="_1-2-\u4E3B\u4ECE\u590D\u5236\u7684\u4F5C\u7528" tabindex="-1"><a class="header-anchor" href="#_1-2-\u4E3B\u4ECE\u590D\u5236\u7684\u4F5C\u7528" aria-hidden="true">#</a> 1.2 \u4E3B\u4ECE\u590D\u5236\u7684\u4F5C\u7528</h5><p>\u4E3B\u4ECE\u540C\u6B65\u8BBE\u8BA1\u4E0D\u4EC5\u53EF\u4EE5\u63D0\u9AD8\u6570\u636E\u5E93\u7684\u541E\u5410\u91CF\uFF0C\u8FD8\u6709\u4EE5\u4E0B 3 \u4E2A\u65B9\u9762\u7684\u4F5C\u7528\u3002</p><p>**\u7B2C1\u4E2A\u4F5C\u7528\uFF1A\u8BFB\u5199\u5206\u79BB\u3002**\u6211\u4EEC\u53EF\u4EE5\u901A\u8FC7\u4E3B\u4ECE\u590D\u5236\u7684\u65B9\u5F0F\u6765<code>\u540C\u6B65\u6570\u636E</code>\uFF0C\u7136\u540E\u901A\u8FC7\u8BFB\u5199\u5206\u79BB\u63D0\u9AD8\u6570\u636E\u5E93\u5E76\u53D1\u5904\u7406\u80FD\u529B\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715212521601.png" alt="image-20220715212521601"></p><p><strong>\u5176\u4E2D\u4E00\u4E2A\u662FMaster\u4E3B\u5E93\uFF0C\u8D1F\u8D23\u5199\u5165\u6570\u636E\uFF0C\u6211\u4EEC\u79F0\u4E4B\u4E3A\uFF1A\u5199\u5E93\u3002</strong></p><p><strong>\u5176\u4ED6\u90FD\u662FSlave\u4ECE\u5E93\uFF0C\u8D1F\u8D23\u8BFB\u53D6\u6570\u636E\uFF0C\u6211\u4EEC\u79F0\u4E4B\u4E3A\uFF1A\u8BFB\u5E93\u3002</strong></p><p>\u5F53\u4E3B\u5E93\u8FDB\u884C\u66F4\u65B0\u7684\u65F6\u5019\uFF0C\u4F1A\u81EA\u52A8\u5C06\u6570\u636E\u590D\u5236\u5230\u4ECE\u5E93\u4E2D\uFF0C\u800C\u6211\u4EEC\u5728\u5BA2\u6237\u7AEF\u8BFB\u53D6\u6570\u636E\u7684\u65F6\u5019\uFF0C\u4F1A\u4ECE\u4ECE\u5E93\u8FDB\u884C\u8BFB\u53D6\u3002</p><p>\u9762\u5BF9\u201C\u8BFB\u591A\u5199\u5C11\u201D\u7684\u9700\u6C42\uFF0C\u91C7\u7528\u8BFB\u5199\u5206\u79BB\u7684\u65B9\u5F0F\uFF0C\u53EF\u4EE5\u5B9E\u73B0<code>\u66F4\u9AD8\u7684\u5E76\u53D1\u8BBF\u95EE</code>\u3002\u540C\u65F6\uFF0C\u6211\u4EEC\u8FD8\u80FD\u5BF9\u4ECE\u670D\u52A1\u5668\u8FDB\u884C<code>\u8D1F\u8F7D\u5747\u8861</code>\uFF0C\u8BA9\u4E0D\u540C\u7684\u8BFB\u8BF7\u6C42\u6309\u7167\u7B56\u7565\u5747\u5300\u5730\u5206\u53D1\u5230\u4E0D\u540C\u7684\u4ECE\u670D\u52A1\u5668\u4E0A\uFF0C\u8BA9<code>\u8BFB\u53D6\u66F4\u52A0\u987A\u7545</code>\u3002\u8BFB\u53D6\u987A\u7545\u7684\u53E6\u4E00\u4E2A\u539F\u56E0\uFF0C\u5C31\u662F<code>\u51CF\u5C11\u4E86\u9501\u8868</code>\u7684\u5F71\u54CD\uFF0C\u6BD4\u5982\u6211\u4EEC\u8BA9\u4E3B\u5E93\u8D1F\u8D23\u5199\uFF0C\u5F53\u4E3B\u5E93\u51FA\u73B0\u5199\u9501\u7684\u65F6\u5019\uFF0C\u4E0D\u4F1A\u5F71\u54CD\u5230\u4ECE\u5E93\u8FDB\u884CSELECT\u7684\u8BFB\u53D6\u3002</p><p>**\u7B2C2\u4E2A\u4F5C\u7528\u5C31\u662F\u6570\u636E\u5907\u4EFD\u3002**\u6211\u4EEC\u901A\u8FC7\u4E3B\u4ECE\u590D\u5236\u5C06\u4E3B\u5E93\u4E0A\u7684\u6570\u636E\u590D\u5236\u5230\u4ECE\u5E93\u4E0A\uFF0C\u76F8\u5F53\u4E8E\u4E00\u79CD<code>\u70ED\u5907\u4EFD\u673A\u5236</code>\uFF0C\u4E5F\u5C31\u662F\u5728\u4E3B\u5E93\u6B63\u5E38\u8FD0\u884C\u7684\u60C5\u51B5\u4E0B\u8FDB\u884C\u7684\u5907\u4EFD\uFF0C\u4E0D\u4F1A\u5F71\u54CD\u5230\u670D\u52A1\u3002</p><p>**\u7B2C3\u4E2A\u4F5C\u7528\u662F\u5177\u6709\u9AD8\u53EF\u7528\u6027\u3002**\u6570\u636E\u5907\u4EFD\u5B9E\u9645\u4E0A\u662F\u4E00\u79CD\u5197\u4F59\u7684\u673A\u5236\uFF0C\u901A\u8FC7\u8FD9\u79CD\u5197\u4F59\u7684\u65B9\u5F0F\u53EF\u4EE5\u6362\u53D6\u6570\u636E\u5E93\u7684\u9AD8\u53EF\u7528\u6027\uFF0C\u4E5F\u5C31\u662F\u5F53\u670D\u52A1\u5668\u51FA\u73B0\u6545\u969C\u6216\u5B95\u673A\u7684\u60C5\u51B5\u4E0B\uFF0C\u53EF\u4EE5\u5207\u6362\u5230\u4ECE\u670D\u52A1\u5668\u4E0A\uFF0C\u4FDD\u8BC1\u670D\u52A1\u7684\u6B63\u5E38\u8FD0\u884C\u3002</p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715214055057.png" alt="image-20220715214055057" style="float:left;"><h3 id="_2-\u4E3B\u4ECE\u590D\u5236\u7684\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#_2-\u4E3B\u4ECE\u590D\u5236\u7684\u539F\u7406" aria-hidden="true">#</a> 2. \u4E3B\u4ECE\u590D\u5236\u7684\u539F\u7406</h3><p><code>Slave</code> \u4F1A\u4ECE <code>Master</code> \u8BFB\u53D6 <code>binlog</code> \u6765\u8FDB\u884C\u6570\u636E\u540C\u6B65\u3002</p><h5 id="_2-1-\u539F\u7406\u5256\u6790" tabindex="-1"><a class="header-anchor" href="#_2-1-\u539F\u7406\u5256\u6790" aria-hidden="true">#</a> 2.1 \u539F\u7406\u5256\u6790</h5><p><strong>\u4E09\u4E2A\u7EBF\u7A0B</strong></p><p>\u5B9E\u9645\u4E0A\u4E3B\u4ECE\u540C\u6B65\u7684\u539F\u7406\u5C31\u662F\u57FA\u4E8E binlog \u8FDB\u884C\u6570\u636E\u540C\u6B65\u7684\u3002\u5728\u4E3B\u4ECE\u590D\u5236\u8FC7\u7A0B\u4E2D\uFF0C\u4F1A\u57FA\u4E8E <code>3 \u4E2A\u7EBF\u7A0B</code> \u6765\u64CD \u4F5C\uFF0C\u4E00\u4E2A\u4E3B\u5E93\u7EBF\u7A0B\uFF0C\u4E24\u4E2A\u4ECE\u5E93\u7EBF\u7A0B\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715215944767.png" alt="image-20220715215944767"></p><p><code>\u4E8C\u8FDB\u5236\u65E5\u5FD7\u8F6C\u50A8\u7EBF\u7A0B</code> \uFF08Binlog dump thread\uFF09\u662F\u4E00\u4E2A\u4E3B\u5E93\u7EBF\u7A0B\u3002\u5F53\u4ECE\u5E93\u7EBF\u7A0B\u8FDE\u63A5\u7684\u65F6\u5019\uFF0C \u4E3B\u5E93\u53EF\u4EE5\u5C06\u4E8C\u8FDB \u5236\u65E5\u5FD7\u53D1\u9001\u7ED9\u4ECE\u5E93\uFF0C\u5F53\u4E3B\u5E93\u8BFB\u53D6\u4E8B\u4EF6\uFF08Event\uFF09\u7684\u65F6\u5019\uFF0C\u4F1A\u5728 Binlog \u4E0A <code>\u52A0\u9501</code> \uFF0C\u8BFB\u53D6\u5B8C\u6210\u4E4B\u540E\uFF0C\u518D\u5C06\u9501\u91CA\u653E\u6389\u3002</p><p><code>\u4ECE\u5E93 I/O \u7EBF\u7A0B</code> \u4F1A\u8FDE\u63A5\u5230\u4E3B\u5E93\uFF0C\u5411\u4E3B\u5E93\u53D1\u9001\u8BF7\u6C42\u66F4\u65B0 Binlog\u3002\u8FD9\u65F6\u4ECE\u5E93\u7684 I/O \u7EBF\u7A0B\u5C31\u53EF\u4EE5\u8BFB\u53D6\u5230\u4E3B\u5E93\u7684\u4E8C\u8FDB\u5236\u65E5\u5FD7\u8F6C\u50A8\u7EBF\u7A0B\u53D1\u9001\u7684 Binlog \u66F4\u65B0\u90E8\u5206\uFF0C\u5E76\u4E14\u62F7\u8D1D\u5230\u672C\u5730\u7684\u4E2D\u7EE7\u65E5\u5FD7 \uFF08Relay log\uFF09\u3002</p><p><code>\u4ECE\u5E93 SQL \u7EBF\u7A0B</code> \u4F1A\u8BFB\u53D6\u4ECE\u5E93\u4E2D\u7684\u4E2D\u7EE7\u65E5\u5FD7\uFF0C\u5E76\u4E14\u6267\u884C\u65E5\u5FD7\u4E2D\u7684\u4E8B\u4EF6\uFF0C\u5C06\u4ECE\u5E93\u4E2D\u7684\u6570\u636E\u4E0E\u4E3B\u5E93\u4FDD\u6301\u540C\u6B65\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715220037213.png" alt="image-20220715220037213"></p><blockquote><p>\u6CE8\u610F\uFF1A</p><p>\u4E0D\u662F\u6240\u6709\u7248\u672C\u7684MySQL\u90FD\u9ED8\u8BA4\u5F00\u542F\u670D\u52A1\u5668\u7684\u4E8C\u8FDB\u5236\u65E5\u5FD7\u3002\u5728\u8FDB\u884C\u4E3B\u4ECE\u540C\u6B65\u7684\u65F6\u5019\uFF0C\u6211\u4EEC\u9700\u8981\u5148\u68C0\u67E5\u670D\u52A1\u5668\u662F\u5426\u5DF2\u7ECF\u5F00\u542F\u4E86\u4E8C\u8FDB\u5236\u65E5\u5FD7\u3002</p><p>\u9664\u975E\u7279\u6B8A\u6307\u5B9A\uFF0C\u9ED8\u8BA4\u60C5\u51B5\u4E0B\u4ECE\u670D\u52A1\u5668\u4F1A\u6267\u884C\u6240\u6709\u4E3B\u670D\u52A1\u5668\u4E2D\u4FDD\u5B58\u7684\u4E8B\u4EF6\u3002\u4E5F\u53EF\u4EE5\u901A\u8FC7\u914D\u7F6E\uFF0C\u4F7F\u4ECE\u670D\u52A1\u5668\u6267\u884C\u7279\u5B9A\u7684\u4E8B\u4EF6\u3002</p></blockquote><p><strong>\u590D\u5236\u4E09\u6B65\u9AA4</strong></p><p>\u6B65\u9AA41\uFF1A <code>Master</code> \u5C06\u5199\u64CD\u4F5C\u8BB0\u5F55\u5230\u4E8C\u8FDB\u5236\u65E5\u5FD7\uFF08 <code>binlog</code> \uFF09\u3002</p><p>\u6B65\u9AA42\uFF1A <code>Slave</code> \u5C06 <code>Master</code> \u7684binary log events\u62F7\u8D1D\u5230\u5B83\u7684\u4E2D\u7EE7\u65E5\u5FD7\uFF08 <code>relay log</code> \uFF09\uFF1B</p><p>\u6B65\u9AA43\uFF1A <code>Slave</code> \u91CD\u505A\u4E2D\u7EE7\u65E5\u5FD7\u4E2D\u7684\u4E8B\u4EF6\uFF0C\u5C06\u6539\u53D8\u5E94\u7528\u5230\u81EA\u5DF1\u7684\u6570\u636E\u5E93\u4E2D\u3002 MySQL\u590D\u5236\u662F\u5F02\u6B65\u7684\u4E14\u4E32\u884C\u5316\u7684\uFF0C\u800C\u4E14\u91CD\u542F\u540E\u4ECE <code>\u63A5\u5165\u70B9</code> \u5F00\u59CB\u590D\u5236\u3002</p><p><strong>\u590D\u5236\u7684\u95EE\u9898</strong></p><p>\u590D\u5236\u7684\u6700\u5927\u95EE\u9898\uFF1A <code>\u5EF6\u65F6</code></p><h5 id="_2-2-\u590D\u5236\u7684\u57FA\u672C\u539F\u5219" tabindex="-1"><a class="header-anchor" href="#_2-2-\u590D\u5236\u7684\u57FA\u672C\u539F\u5219" aria-hidden="true">#</a> 2.2 \u590D\u5236\u7684\u57FA\u672C\u539F\u5219</h5><ul><li>\u6BCF\u4E2A <code>Slave</code> \u53EA\u6709\u4E00\u4E2A <code>Master</code></li><li>\u6BCF\u4E2A <code>Slave</code> \u53EA\u80FD\u6709\u4E00\u4E2A\u552F\u4E00\u7684\u670D\u52A1\u5668ID</li><li>\u6BCF\u4E2A <code>Master</code> \u53EF\u4EE5\u6709\u591A\u4E2A <code>Slave</code></li></ul><h3 id="_3-\u4E00\u4E3B\u4E00\u4ECE\u67B6\u6784\u642D\u5EFA" tabindex="-1"><a class="header-anchor" href="#_3-\u4E00\u4E3B\u4E00\u4ECE\u67B6\u6784\u642D\u5EFA" aria-hidden="true">#</a> 3. \u4E00\u4E3B\u4E00\u4ECE\u67B6\u6784\u642D\u5EFA</h3><p>\u4E00\u53F0 <code>\u4E3B\u673A</code> \u7528\u4E8E\u5904\u7406\u6240\u6709 <code>\u5199\u8BF7\u6C42</code> \uFF0C\u4E00\u53F0 <code>\u4ECE\u673A</code> \u8D1F\u8D23\u6240\u6709 <code>\u8BFB\u8BF7\u6C42</code> \uFF0C\u67B6\u6784\u56FE\u5982\u4E0B:</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220715220852836.png" alt="image-20220715220852836"></p><h5 id="_3-1-\u51C6\u5907\u5DE5\u4F5C" tabindex="-1"><a class="header-anchor" href="#_3-1-\u51C6\u5907\u5DE5\u4F5C" aria-hidden="true">#</a> 3.1 \u51C6\u5907\u5DE5\u4F5C</h5><p>1\u3001\u51C6\u5907 2\u53F0 CentOS \u865A\u62DF\u673A \uFF08\u5177\u4F53\u8BBE\u7F6E\u5185\u5BB9\u5728P192\uFF09</p><p>2\u3001\u6BCF\u53F0\u865A\u62DF\u673A\u4E0A\u9700\u8981\u5B89\u88C5\u597DMySQL (\u53EF\u4EE5\u662FMySQL8.0 )</p><p>\u8BF4\u660E\uFF1A\u524D\u9762\u6211\u4EEC\u8BB2\u8FC7\u5982\u4F55\u514B\u9686\u4E00\u53F0CentOS\u3002\u5927\u5BB6\u53EF\u4EE5\u5728\u4E00\u53F0CentOS\u4E0A\u5B89\u88C5\u597DMySQL\uFF0C\u8FDB\u800C\u901A\u8FC7\u514B\u9686\u7684\u65B9\u5F0F\u590D\u5236\u51FA1\u53F0\u5305\u542BMySQL\u7684\u865A\u62DF\u673A\u3002</p><p>\u6CE8\u610F\uFF1A\u514B\u9686\u7684\u65B9\u5F0F\u9700\u8981\u4FEE\u6539\u65B0\u514B\u9686\u51FA\u6765\u4E3B\u673A\u7684\uFF1A\u2460 <code>MAC\u5730\u5740</code> \u2461 <code>hostname</code> \u2462<code> IP \u5730\u5740</code> \u2463 <code>UUID</code> \u3002</p><p>\u6B64\u5916\uFF0C\u514B\u9686\u7684\u65B9\u5F0F\u751F\u6210\u7684\u865A\u62DF\u673A\uFF08\u5305\u542BMySQL Server\uFF09\uFF0C\u5219\u514B\u9686\u7684\u865A\u62DF\u673AMySQL Server\u7684UUID\u76F8\u540C\uFF0C\u5FC5\u987B\u4FEE\u6539\uFF0C\u5426\u5219\u5728\u6709\u4E9B\u573A\u666F\u4F1A\u62A5\u9519\u3002\u6BD4\u5982\uFF1A <code>show slave status\\G</code> \uFF0C\u62A5\u5982\u4E0B\u7684\u9519\u8BEF\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>Last_IO_Error: Fatal error: The slave I/O thread stops because master and slave have
equal MySQL server UUIDs; these UUIDs must be different for replication to work.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4FEE\u6539MySQL Server \u7684UUID\u65B9\u5F0F\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>vim /var/lib/mysql/auto.cnf

systemctl restart mysqld
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-2-\u4E3B\u673A\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_3-2-\u4E3B\u673A\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> 3.2 \u4E3B\u673A\u914D\u7F6E\u6587\u4EF6</h5><p>\u5EFA\u8BAEmysql\u7248\u672C\u4E00\u81F4\u4E14\u540E\u53F0\u4EE5\u670D\u52A1\u8FD0\u884C\uFF0C\u4E3B\u4ECE\u6240\u6709\u914D\u7F6E\u9879\u90FD\u914D\u7F6E\u5728 <code>[mysqld]</code> \u8282\u70B9\u4E0B\uFF0C\u4E14\u90FD\u662F\u5C0F\u5199\u5B57\u6BCD\u3002</p><p>\u5177\u4F53\u53C2\u6570\u914D\u7F6E\u5982\u4E0B\uFF1A</p><ul><li>\u5FC5\u9009</li></ul><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token comment">#[\u5FC5\u987B]\u4E3B\u670D\u52A1\u5668\u552F\u4E00ID</span>
<span class="token key attr-name">server-id</span><span class="token punctuation">=</span><span class="token value attr-value">1</span>

<span class="token comment">#[\u5FC5\u987B]\u542F\u7528\u4E8C\u8FDB\u5236\u65E5\u5FD7,\u6307\u540D\u8DEF\u5F84\u3002\u6BD4\u5982\uFF1A\u81EA\u5DF1\u672C\u5730\u7684\u8DEF\u5F84/log/mysqlbin</span>
<span class="token key attr-name">log-bin</span><span class="token punctuation">=</span><span class="token value attr-value">atguigu-bin</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>\u53EF\u9009</li></ul><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token comment">#[\u53EF\u9009] 0\uFF08\u9ED8\u8BA4\uFF09\u8868\u793A\u8BFB\u5199\uFF08\u4E3B\u673A\uFF09\uFF0C1\u8868\u793A\u53EA\u8BFB\uFF08\u4ECE\u673A\uFF09</span>
<span class="token key attr-name">read-only</span><span class="token punctuation">=</span><span class="token value attr-value">0</span>

<span class="token comment">#\u8BBE\u7F6E\u65E5\u5FD7\u6587\u4EF6\u4FDD\u7559\u7684\u65F6\u957F\uFF0C\u5355\u4F4D\u662F\u79D2</span>
<span class="token key attr-name">binlog_expire_logs_seconds</span><span class="token punctuation">=</span><span class="token value attr-value">6000</span>

<span class="token comment">#\u63A7\u5236\u5355\u4E2A\u4E8C\u8FDB\u5236\u65E5\u5FD7\u5927\u5C0F\u3002\u6B64\u53C2\u6570\u7684\u6700\u5927\u548C\u9ED8\u8BA4\u503C\u662F1GB</span>
<span class="token key attr-name">max_binlog_size</span><span class="token punctuation">=</span><span class="token value attr-value">200M</span>

<span class="token comment">#[\u53EF\u9009]\u8BBE\u7F6E\u4E0D\u8981\u590D\u5236\u7684\u6570\u636E\u5E93</span>
<span class="token key attr-name">binlog-ignore-db</span><span class="token punctuation">=</span><span class="token value attr-value">test</span>

<span class="token comment">#[\u53EF\u9009]\u8BBE\u7F6E\u9700\u8981\u590D\u5236\u7684\u6570\u636E\u5E93,\u9ED8\u8BA4\u5168\u90E8\u8BB0\u5F55\u3002\u6BD4\u5982\uFF1Abinlog-do-db=atguigu_master_slave</span>
<span class="token key attr-name">binlog-do-db</span><span class="token punctuation">=</span><span class="token value attr-value">\u9700\u8981\u590D\u5236\u7684\u4E3B\u6570\u636E\u5E93\u540D\u5B57</span>

<span class="token comment">#[\u53EF\u9009]\u8BBE\u7F6Ebinlog\u683C\u5F0F</span>
<span class="token key attr-name">binlog_format</span><span class="token punctuation">=</span><span class="token value attr-value">STATEMENT</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u91CD\u542F\u540E\u53F0mysql\u670D\u52A1\uFF0C\u4F7F\u914D\u7F6E\u751F\u6548\u3002</p><blockquote><p>\u6CE8\u610F\uFF1A</p><p>\u5148\u642D\u5EFA\u5B8C\u4E3B\u4ECE\u590D\u5236\uFF0C\u518D\u521B\u5EFA\u6570\u636E\u5E93\u3002</p><p>MySQL\u4E3B\u4ECE\u590D\u5236\u8D77\u59CB\u65F6\uFF0C\u4ECE\u673A\u4E0D\u7EE7\u627F\u4E3B\u673A\u6570\u636E\u3002</p></blockquote><p><strong>\u2460 binlog\u683C\u5F0F\u8BBE\u7F6E\uFF1A</strong></p><p>\u683C\u5F0F1\uFF1A <code>STATEMENT\u6A21\u5F0F</code> \uFF08\u57FA\u4E8ESQL\u8BED\u53E5\u7684\u590D\u5236(statement-based replication, SBR)\uFF09</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">binlog_format</span><span class="token punctuation">=</span><span class="token value attr-value">STATEMENT</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6BCF\u4E00\u6761\u4F1A\u4FEE\u6539\u6570\u636E\u7684sql\u8BED\u53E5\u4F1A\u8BB0\u5F55\u5230binlog\u4E2D\u3002\u8FD9\u662F\u9ED8\u8BA4\u7684binlog\u683C\u5F0F\u3002</p><ul><li>SBR \u7684\u4F18\u70B9\uFF1A <ul><li>\u5386\u53F2\u60A0\u4E45\uFF0C\u6280\u672F\u6210\u719F</li><li>\u4E0D\u9700\u8981\u8BB0\u5F55\u6BCF\u4E00\u884C\u7684\u53D8\u5316\uFF0C\u51CF\u5C11\u4E86binlog\u65E5\u5FD7\u91CF\uFF0C\u6587\u4EF6\u8F83\u5C0F</li><li>binlog\u4E2D\u5305\u542B\u4E86\u6240\u6709\u6570\u636E\u5E93\u66F4\u6539\u4FE1\u606F\uFF0C\u53EF\u4EE5\u636E\u6B64\u6765\u5BA1\u6838\u6570\u636E\u5E93\u7684\u5B89\u5168\u7B49\u60C5\u51B5</li><li>binlog\u53EF\u4EE5\u7528\u4E8E\u5B9E\u65F6\u7684\u8FD8\u539F\uFF0C\u800C\u4E0D\u4EC5\u4EC5\u7528\u4E8E\u590D\u5236</li><li>\u4E3B\u4ECE\u7248\u672C\u53EF\u4EE5\u4E0D\u4E00\u6837\uFF0C\u4ECE\u670D\u52A1\u5668\u7248\u672C\u53EF\u4EE5\u6BD4\u4E3B\u670D\u52A1\u5668\u7248\u672C\u9AD8</li></ul></li><li>SBR \u7684\u7F3A\u70B9\uFF1A <ul><li>\u4E0D\u662F\u6240\u6709\u7684UPDATE\u8BED\u53E5\u90FD\u80FD\u88AB\u590D\u5236\uFF0C\u5C24\u5176\u662F\u5305\u542B\u4E0D\u786E\u5B9A\u64CD\u4F5C\u7684\u65F6\u5019</li></ul></li><li>\u4F7F\u7528\u4EE5\u4E0B\u51FD\u6570\u7684\u8BED\u53E5\u4E5F\u65E0\u6CD5\u88AB\u590D\u5236\uFF1ALOAD_FILE()\u3001UUID()\u3001USER()\u3001FOUND_ROWS()\u3001SYSDATE() (\u9664\u975E\u542F\u52A8\u65F6\u542F\u7528\u4E86 --sysdate-is-now \u9009\u9879) <ul><li>INSERT ... SELECT \u4F1A\u4EA7\u751F\u6BD4 RBR \u66F4\u591A\u7684\u884C\u7EA7\u9501</li><li>\u590D\u5236\u9700\u8981\u8FDB\u884C\u5168\u8868\u626B\u63CF(WHERE \u8BED\u53E5\u4E2D\u6CA1\u6709\u4F7F\u7528\u5230\u7D22\u5F15)\u7684 UPDATE \u65F6\uFF0C\u9700\u8981\u6BD4 RBR \u8BF7\u6C42\u66F4\u591A\u7684\u884C\u7EA7\u9501</li><li>\u5BF9\u4E8E\u6709 AUTO_INCREMENT \u5B57\u6BB5\u7684 InnoDB\u8868\u800C\u8A00\uFF0CINSERT \u8BED\u53E5\u4F1A\u963B\u585E\u5176\u4ED6 INSERT \u8BED\u53E5</li><li>\u5BF9\u4E8E\u4E00\u4E9B\u590D\u6742\u7684\u8BED\u53E5\uFF0C\u5728\u4ECE\u670D\u52A1\u5668\u4E0A\u7684\u8017\u8D44\u6E90\u60C5\u51B5\u4F1A\u66F4\u4E25\u91CD\uFF0C\u800C RBR \u6A21\u5F0F\u4E0B\uFF0C\u53EA\u4F1A\u5BF9\u90A3\u4E2A\u53D1 \u751F\u53D8\u5316\u7684\u8BB0\u5F55\u4EA7\u751F\u5F71\u54CD</li><li>\u6267\u884C\u590D\u6742\u8BED\u53E5\u5982\u679C\u51FA\u9519\u7684\u8BDD\uFF0C\u4F1A\u6D88\u8017\u66F4\u591A\u8D44\u6E90</li><li>\u6570\u636E\u8868\u5FC5\u987B\u51E0\u4E4E\u548C\u4E3B\u670D\u52A1\u5668\u4FDD\u6301\u4E00\u81F4\u624D\u884C\uFF0C\u5426\u5219\u53EF\u80FD\u4F1A\u5BFC\u81F4\u590D\u5236\u51FA\u9519</li></ul></li></ul><p><strong>\u2461 ROW\u6A21\u5F0F\uFF08\u57FA\u4E8E\u884C\u7684\u590D\u5236(row-based replication, RBR)\uFF09</strong></p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">binlog_format</span><span class="token punctuation">=</span><span class="token value attr-value">ROW</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>5.1.5\u7248\u672C\u7684MySQL\u624D\u5F00\u59CB\u652F\u6301\uFF0C<strong>\u4E0D\u8BB0\u5F55\u6BCF\u6761sql\u8BED\u53E5\u7684\u4E0A\u4E0B\u6587\u4FE1\u606F\uFF0C\u4EC5\u8BB0\u5F55\u54EA\u6761\u6570\u636E\u88AB\u4FEE\u6539\u4E86\uFF0C\u4FEE\u6539\u6210\u4EC0\u4E48\u6837\u4E86\u3002</strong></p><ul><li>RBR \u7684\u4F18\u70B9\uFF1A <ul><li>\u4EFB\u4F55\u60C5\u51B5\u90FD\u53EF\u4EE5\u88AB\u590D\u5236\uFF0C\u8FD9\u5BF9\u590D\u5236\u6765\u8BF4\u662F\u6700 <code>\u5B89\u5168\u53EF\u9760</code> \u7684\u3002\uFF08\u6BD4\u5982\uFF1A\u4E0D\u4F1A\u51FA\u73B0\u67D0\u4E9B\u7279\u5B9A\u60C5\u51B5\u4E0B \u7684\u5B58\u50A8\u8FC7\u7A0B\u3001function\u3001trigger\u7684\u8C03\u7528\u548C\u89E6\u53D1\u65E0\u6CD5\u88AB\u6B63\u786E\u590D\u5236\u7684\u95EE\u9898\uFF09</li><li>\u591A\u6570\u60C5\u51B5\u4E0B\uFF0C\u4ECE\u670D\u52A1\u5668\u4E0A\u7684\u8868\u5982\u679C\u6709\u4E3B\u952E\u7684\u8BDD\uFF0C\u590D\u5236\u5C31\u4F1A\u5FEB\u4E86\u5F88\u591A</li><li>\u590D\u5236\u4EE5\u4E0B\u51E0\u79CD\u8BED\u53E5\u65F6\u7684\u884C\u9501\u66F4\u5C11\uFF1AINSERT ... SELECT\u3001\u5305\u542B AUTO_INCREMENT \u5B57\u6BB5\u7684 INSERT\u3001 \u6CA1\u6709\u9644\u5E26\u6761\u4EF6\u6216\u8005\u5E76\u6CA1\u6709\u4FEE\u6539\u5F88\u591A\u8BB0\u5F55\u7684 UPDATE \u6216 DELETE \u8BED\u53E5</li><li>\u6267\u884C INSERT\uFF0CUPDATE\uFF0CDELETE \u8BED\u53E5\u65F6\u9501\u66F4\u5C11</li><li>\u4ECE\u670D\u52A1\u5668\u4E0A\u91C7\u7528 \u591A\u7EBF\u7A0B \u6765\u6267\u884C\u590D\u5236\u6210\u4E3A\u53EF\u80FD</li></ul></li><li>RBR \u7684\u7F3A\u70B9\uFF1A <ul><li>binlog \u5927\u4E86\u5F88\u591A</li><li>\u590D\u6742\u7684\u56DE\u6EDA\u65F6 binlog \u4E2D\u4F1A\u5305\u542B\u5927\u91CF\u7684\u6570\u636E</li><li>\u4E3B\u670D\u52A1\u5668\u4E0A\u6267\u884C UPDATE \u8BED\u53E5\u65F6\uFF0C\u6240\u6709\u53D1\u751F\u53D8\u5316\u7684\u8BB0\u5F55\u90FD\u4F1A\u5199\u5230 binlog \u4E2D\uFF0C\u800C SBR \u53EA\u4F1A\u5199\u4E00\u6B21\uFF0C\u8FD9\u4F1A\u5BFC\u81F4\u9891\u7E41\u53D1\u751F binlog \u7684\u5E76\u53D1\u5199\u95EE\u9898</li><li>\u65E0\u6CD5\u4ECE binlog \u4E2D\u770B\u5230\u90FD\u590D\u5236\u4E86\u4E9B\u4EC0\u4E48\u8BED\u53E5</li></ul></li></ul><p><strong>\u2462 MIXED\u6A21\u5F0F\uFF08\u6DF7\u5408\u6A21\u5F0F\u590D\u5236(mixed-based replication, MBR)\uFF09</strong></p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">binlog_format</span><span class="token punctuation">=</span><span class="token value attr-value">MIXED</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4ECE5.1.8\u7248\u672C\u5F00\u59CB\uFF0CMySQL\u63D0\u4F9B\u4E86Mixed\u683C\u5F0F\uFF0C<strong>\u5B9E\u9645\u4E0A\u5C31\u662FStatement\u4E0ERow\u7684\u7ED3\u5408\u3002</strong></p><p>\u5728Mixed\u6A21\u5F0F\u4E0B\uFF0C<code>\u4E00\u822C\u7684\u8BED\u53E5\u4FEE\u6539\u4F7F\u7528statment\u683C\u5F0F\u4FDD\u5B58binlog\u3002\u5982\u4E00\u4E9B\u51FD\u6570\uFF0Cstatement\u65E0\u6CD5\u5B8C\u6210\u4E3B\u4ECE\u590D\u5236\u7684\u64CD\u4F5C\uFF0C\u5219\u91C7\u7528row\u683C\u5F0F\u4FDD\u5B58binlog</code>\u3002</p><p>MySQL\u4F1A\u6839\u636E\u6267\u884C\u7684\u6BCF\u4E00\u6761\u5177\u4F53\u7684sql\u8BED\u53E5\u6765\u533A\u5206\u5BF9\u5F85\u8BB0\u5F55\u7684\u65E5\u5FD7\u5F62\u5F0F\uFF0C\u4E5F\u5C31\u662F\u5728Statement\u548CRow\u4E4B\u95F4\u9009\u62E9\u4E00\u79CD\u3002</p><h5 id="_3-3-\u4ECE\u673A\u914D\u7F6E\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_3-3-\u4ECE\u673A\u914D\u7F6E\u6587\u4EF6" aria-hidden="true">#</a> 3.3 \u4ECE\u673A\u914D\u7F6E\u6587\u4EF6</h5><p>\u8981\u6C42\u4E3B\u4ECE\u6240\u6709\u914D\u7F6E\u9879\u90FD\u914D\u7F6E\u5728 <code>my.cnf</code> \u7684 <code>[mysqld]</code> \u680F\u4F4D\u4E0B\uFF0C\u4E14\u90FD\u662F\u5C0F\u5199\u5B57\u6BCD\u3002</p><ul><li><p>\u5FC5\u9009</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>#[\u5FC5\u987B]\u4ECE\u670D\u52A1\u5668\u552F\u4E00ID
server-id=2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u53EF\u9009</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>#[\u53EF\u9009]\u542F\u7528\u4E2D\u7EE7\u65E5\u5FD7
relay-log=mysql-relay
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>\u91CD\u542F\u540E\u53F0mysql\u670D\u52A1\uFF0C\u4F7F\u914D\u7F6E\u751F\u6548\u3002</p><blockquote><p>\u6CE8\u610F\uFF1A\u4E3B\u4ECE\u673A\u90FD\u5173\u95ED\u9632\u706B\u5899 service iptables stop ##CentOS 6 systemctl stop firewalld.service ##CentOS 7</p></blockquote><h5 id="_3-4-\u4E3B\u673A-\u5EFA\u7ACB\u8D26\u6237\u5E76\u6388\u6743" tabindex="-1"><a class="header-anchor" href="#_3-4-\u4E3B\u673A-\u5EFA\u7ACB\u8D26\u6237\u5E76\u6388\u6743" aria-hidden="true">#</a> 3.4 \u4E3B\u673A\uFF1A\u5EFA\u7ACB\u8D26\u6237\u5E76\u6388\u6743</h5><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>#\u5728\u4E3B\u673AMySQL\u91CC\u6267\u884C\u6388\u6743\u4E3B\u4ECE\u590D\u5236\u7684\u547D\u4EE4
GRANT REPLICATION SLAVE ON *.* TO &#39;slave1&#39;@&#39;\u4ECE\u673A\u5668\u6570\u636E\u5E93IP&#39; IDENTIFIED BY &#39;abc123&#39;; #5.5,5.7
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u6CE8\u610F\uFF1A\u5982\u679C\u4F7F\u7528\u7684\u662FMySQL8\uFF0C\u9700\u8981\u5982\u4E0B\u7684\u65B9\u5F0F\u5EFA\u7ACB\u8D26\u6237\uFF0C\u5E76\u6388\u6743slave:</strong></p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>CREATE USER &#39;slave1&#39;@&#39;%&#39; IDENTIFIED BY &#39;123456&#39;;

GRANT REPLICATION SLAVE ON *.* TO &#39;slave1&#39;@&#39;%&#39;;

#\u6B64\u8BED\u53E5\u5FC5\u987B\u6267\u884C\u3002\u5426\u5219\u89C1\u4E0B\u9762\u3002
ALTER USER &#39;slave1&#39;@&#39;%&#39; IDENTIFIED WITH mysql_native_password BY &#39;123456&#39;;

flush privileges;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>\u6CE8\u610F\uFF1A\u5728\u4ECE\u673A\u6267\u884Cshow slave status\\G\u65F6\u62A5\u9519\uFF1A</p><p>Last_IO_Error: error connecting to master &#39;slave1@192.168.1.150:3306&#39; - retry-time: 60 retries: 1 message:</p><p>Authentication plugin &#39;caching_sha2_password&#39; reported error: Authentication requires secure connection.</p></blockquote><p>\u67E5\u8BE2Master\u7684\u72B6\u6001\uFF0C\u5E76\u8BB0\u5F55\u4E0BFile\u548CPosition\u7684\u503C\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>show master status;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718140722740.png" alt="image-20220718140722740"></p><ul><li>\u8BB0\u5F55\u4E0BFile\u548CPosition\u7684\u503C</li></ul><blockquote><p>\u6CE8\u610F\uFF1A\u6267\u884C\u5B8C\u6B64\u6B65\u9AA4\u540E<strong>\u4E0D\u8981\u518D\u64CD\u4F5C\u4E3B\u670D\u52A1\u5668MySQL</strong>\uFF0C\u9632\u6B62\u4E3B\u670D\u52A1\u5668\u72B6\u6001\u503C\u53D8\u5316\u3002</p></blockquote><h5 id="_3-5-\u4ECE\u673A-\u914D\u7F6E\u9700\u8981\u590D\u5236\u7684\u4E3B\u673A" tabindex="-1"><a class="header-anchor" href="#_3-5-\u4ECE\u673A-\u914D\u7F6E\u9700\u8981\u590D\u5236\u7684\u4E3B\u673A" aria-hidden="true">#</a> 3.5 \u4ECE\u673A\uFF1A\u914D\u7F6E\u9700\u8981\u590D\u5236\u7684\u4E3B\u673A</h5><p>**\u6B65\u9AA41\uFF1A**\u4ECE\u673A\u4E0A\u590D\u5236\u4E3B\u673A\u7684\u547D\u4EE4</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>CHANGE MASTER TO
MASTER_HOST=&#39;\u4E3B\u673A\u7684IP\u5730\u5740&#39;,
MASTER_USER=&#39;\u4E3B\u673A\u7528\u6237\u540D&#39;,
MASTER_PASSWORD=&#39;\u4E3B\u673A\u7528\u6237\u540D\u7684\u5BC6\u7801&#39;,
MASTER_LOG_FILE=&#39;mysql-bin.\u5177\u4F53\u6570\u5B57&#39;,
MASTER_LOG_POS=\u5177\u4F53\u503C;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E3E\u4F8B\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>CHANGE MASTER TO
MASTER_HOST=&#39;192.168.1.150&#39;,MASTER_USER=&#39;slave1&#39;,MASTER_PASSWORD=&#39;123456&#39;,MASTER_LOG_F
ILE=&#39;atguigu-bin.000007&#39;,MASTER_LOG_POS=154;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718140946747.png" alt="image-20220718140946747"></p><p><strong>\u6B65\u9AA42\uFF1A</strong></p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>#\u542F\u52A8slave\u540C\u6B65
START SLAVE;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718141825228.png" alt="image-20220718141825228"></p><p>\u5982\u679C\u62A5\u9519\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718141841862.png" alt="image-20220718141841862"></p><p>\u53EF\u4EE5\u6267\u884C\u5982\u4E0B\u64CD\u4F5C\uFF0C\u5220\u9664\u4E4B\u524D\u7684relay_log\u4FE1\u606F\u3002\u7136\u540E\u91CD\u65B0\u6267\u884C CHANGE MASTER TO ...\u8BED\u53E5\u5373\u53EF\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql&gt; reset slave; #\u5220\u9664SLAVE\u6570\u636E\u5E93\u7684relaylog\u65E5\u5FD7\u6587\u4EF6\uFF0C\u5E76\u91CD\u65B0\u542F\u7528\u65B0\u7684relaylog\u6587\u4EF6
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u63A5\u7740\uFF0C\u67E5\u770B\u540C\u6B65\u72B6\u6001\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SHOW SLAVE STATUS\\G;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718141951374.png" alt="image-20220718141951374"></p><blockquote><p>\u4E0A\u9762\u4E24\u4E2A\u53C2\u6570\u90FD\u662FYes\uFF0C\u5219\u8BF4\u660E\u4E3B\u4ECE\u914D\u7F6E\u6210\u529F\uFF01</p></blockquote><p>\u663E\u5F0F\u5982\u4E0B\u7684\u60C5\u51B5\uFF0C\u5C31\u662F\u4E0D\u6B63\u786E\u7684\u3002\u53EF\u80FD\u9519\u8BEF\u7684\u539F\u56E0\u6709\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>1. \u7F51\u7EDC\u4E0D\u901A
2. \u8D26\u6237\u5BC6\u7801\u9519\u8BEF
3. \u9632\u706B\u5899
4. mysql\u914D\u7F6E\u6587\u4EF6\u95EE\u9898
5. \u8FDE\u63A5\u670D\u52A1\u5668\u65F6\u8BED\u6CD5
6. \u4E3B\u670D\u52A1\u5668mysql\u6743\u9650
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718142045114.png" alt="image-20220718142045114" style="zoom:80%;"><h5 id="_3-6-\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#_3-6-\u6D4B\u8BD5" aria-hidden="true">#</a> 3.6 \u6D4B\u8BD5</h5><p>\u4E3B\u673A\u65B0\u5EFA\u5E93\u3001\u65B0\u5EFA\u8868\u3001insert\u8BB0\u5F55\uFF0C\u4ECE\u673A\u590D\u5236\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>CREATE DATABASE atguigu_master_slave;

CREATE TABLE mytbl(id INT,NAME VARCHAR(16));

INSERT INTO mytbl VALUES(1, &#39;zhang3&#39;);

INSERT INTO mytbl VALUES(2,@@hostname);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-7-\u505C\u6B62\u4E3B\u4ECE\u540C\u6B65" tabindex="-1"><a class="header-anchor" href="#_3-7-\u505C\u6B62\u4E3B\u4ECE\u540C\u6B65" aria-hidden="true">#</a> 3.7 \u505C\u6B62\u4E3B\u4ECE\u540C\u6B65</h5><ul><li><p>\u505C\u6B62\u4E3B\u4ECE\u540C\u6B65\u547D\u4EE4\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>stop slave;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>\u5982\u4F55\u91CD\u65B0\u914D\u7F6E\u4E3B\u4ECE</p><p>\u5982\u679C\u505C\u6B62\u4ECE\u670D\u52A1\u5668\u590D\u5236\u529F\u80FD\uFF0C\u518D\u4F7F\u7528\u9700\u8981\u91CD\u65B0\u914D\u7F6E\u4E3B\u4ECE\u3002\u5426\u5219\u4F1A\u62A5\u9519\u5982\u4E0B\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718142549168.png" alt="image-20220718142549168"></p></li></ul><p>\u91CD\u65B0\u914D\u7F6E\u4E3B\u4ECE\uFF0C\u9700\u8981\u5728\u4ECE\u673A\u4E0A\u6267\u884C\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>stop slave;

reset master; #\u5220\u9664Master\u4E2D\u6240\u6709\u7684binglog\u6587\u4EF6\uFF0C\u5E76\u5C06\u65E5\u5FD7\u7D22\u5F15\u6587\u4EF6\u6E05\u7A7A\uFF0C\u91CD\u65B0\u5F00\u59CB\u6240\u6709\u65B0\u7684\u65E5\u5FD7\u6587\u4EF6(\u614E\u7528)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-8-\u540E\u7EED" tabindex="-1"><a class="header-anchor" href="#_3-8-\u540E\u7EED" aria-hidden="true">#</a> 3.8 \u540E\u7EED</h5><p><strong>\u642D\u5EFA\u4E3B\u4ECE\u590D\u5236\uFF1A\u53CC\u4E3B\u53CC\u4ECE</strong></p><p>\u4E00\u4E2A\u4E3B\u673Am1\u7528\u4E8E\u5904\u7406\u6240\u6709\u5199\u8BF7\u6C42\uFF0C\u5B83\u7684\u4ECE\u673As1\u548C\u53E6\u4E00\u53F0\u4E3B\u673Am2\u8FD8\u6709\u5B83\u7684\u4ECE\u673As2\u8D1F\u8D23\u6240\u6709\u8BFB\u8BF7\u6C42\u3002\u5F53m1\u4E3B\u673A\u5B95\u673A\u540E\uFF0Cm2\u4E3B\u673A\u8D1F\u8D23\u5199\u8BF7\u6C42\uFF0Cm1\u3001m2\u4E92\u4E3A\u5907\u673A\u3002\u7ED3\u6784\u56FE\u5982\u4E0B\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718143705843.png" alt="image-20220718143705843"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718143716620.png" alt="image-20220718143716620"></p><h3 id="_4-\u540C\u6B65\u6570\u636E\u4E00\u81F4\u6027\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#_4-\u540C\u6B65\u6570\u636E\u4E00\u81F4\u6027\u95EE\u9898" aria-hidden="true">#</a> 4. \u540C\u6B65\u6570\u636E\u4E00\u81F4\u6027\u95EE\u9898</h3><p><strong>\u4E3B\u4ECE\u540C\u6B65\u7684\u8981\u6C42\uFF1A</strong></p><ul><li>\u8BFB\u5E93\u548C\u5199\u5E93\u7684\u6570\u636E\u4E00\u81F4(\u6700\u7EC8\u4E00\u81F4)\uFF1B</li><li>\u5199\u6570\u636E\u5FC5\u987B\u5199\u5230\u5199\u5E93\uFF1B</li><li>\u8BFB\u6570\u636E\u5FC5\u987B\u5230\u8BFB\u5E93(\u4E0D\u4E00\u5B9A)\uFF1B</li></ul><h5 id="_4-1-\u7406\u89E3\u4E3B\u4ECE\u5EF6\u8FDF\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#_4-1-\u7406\u89E3\u4E3B\u4ECE\u5EF6\u8FDF\u95EE\u9898" aria-hidden="true">#</a> 4.1 \u7406\u89E3\u4E3B\u4ECE\u5EF6\u8FDF\u95EE\u9898</h5><p>\u8FDB\u884C\u4E3B\u4ECE\u540C\u6B65\u7684\u5185\u5BB9\u662F\u4E8C\u8FDB\u5236\u65E5\u5FD7\uFF0C\u5B83\u662F\u4E00\u4E2A\u6587\u4EF6\uFF0C\u5728\u8FDB\u884C <code>\u7F51\u7EDC\u4F20\u8F93</code> \u7684\u8FC7\u7A0B\u4E2D\u5C31\u4E00\u5B9A\u4F1A <code>\u5B58\u5728\u4E3B\u4ECE\u5EF6\u8FDF</code> \uFF08\u6BD4\u5982 500ms\uFF09\uFF0C\u8FD9\u6837\u5C31\u53EF\u80FD\u9020\u6210\u7528\u6237\u5728\u4ECE\u5E93\u4E0A\u8BFB\u53D6\u7684\u6570\u636E\u4E0D\u662F\u6700\u65B0\u7684\u6570\u636E\uFF0C\u4E5F\u5C31\u662F\u4E3B\u4ECE\u540C\u6B65\u4E2D\u7684 <code>\u6570\u636E\u4E0D\u4E00\u81F4\u6027</code> \u95EE\u9898\u3002</p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718144051094.png" alt="image-20220718144051094" style="float:left;"><h5 id="_4-2-\u4E3B\u4ECE\u5EF6\u8FDF\u95EE\u9898\u539F\u56E0" tabindex="-1"><a class="header-anchor" href="#_4-2-\u4E3B\u4ECE\u5EF6\u8FDF\u95EE\u9898\u539F\u56E0" aria-hidden="true">#</a> 4.2 \u4E3B\u4ECE\u5EF6\u8FDF\u95EE\u9898\u539F\u56E0</h5><p>\u5728\u7F51\u7EDC\u6B63\u5E38\u7684\u65F6\u5019\uFF0C\u65E5\u5FD7\u4ECE\u4E3B\u5E93\u4F20\u7ED9\u4ECE\u5E93\u6240\u9700\u7684\u65F6\u95F4\u662F\u5F88\u77ED\u7684\uFF0C\u5373T2-T1\u7684\u503C\u662F\u975E\u5E38\u5C0F\u7684\u3002\u5373\uFF0C\u7F51\u7EDC\u6B63\u5E38\u60C5\u51B5\u4E0B\uFF0C\u4E3B\u5907\u5EF6\u8FDF\u7684\u4E3B\u8981\u6765\u6E90\u662F\u5907\u5E93\u63A5\u6536\u5B8Cbinlog\u548C\u6267\u884C\u5B8C\u8FD9\u4E2A\u4E8B\u52A1\u4E4B\u95F4\u7684\u65F6\u95F4\u5DEE\u3002</p><p>**\u4E3B\u5907\u5EF6\u8FDF\u6700\u76F4\u63A5\u7684\u8868\u73B0\u662F\uFF0C\u4ECE\u5E93\u6D88\u8D39\u4E2D\u7EE7\u65E5\u5FD7\uFF08relay log\uFF09\u7684\u901F\u5EA6\uFF0C\u6BD4\u4E3B\u5E93\u751F\u4EA7binlog\u7684\u901F\u5EA6\u8981\u6162\u3002**\u9020\u6210\u539F\u56E0\uFF1A</p><p>1\u3001\u4ECE\u5E93\u7684\u673A\u5668\u6027\u80FD\u6BD4\u4E3B\u5E93\u8981\u5DEE</p><p>2\u3001\u4ECE\u5E93\u7684\u538B\u529B\u5927</p><p>3\u3001\u5927\u4E8B\u52A1\u7684\u6267\u884C</p><p>**\u4E3E\u4F8B1\uFF1A**\u4E00\u6B21\u6027\u7528delete\u8BED\u53E5\u5220\u9664\u592A\u591A\u6570\u636E</p><p>\u7ED3\u8BBA\uFF1A\u540E\u7EED\u518D\u5220\u9664\u6570\u636E\u7684\u65F6\u5019\uFF0C\u8981\u63A7\u5236\u6BCF\u4E2A\u4E8B\u52A1\u5220\u9664\u7684\u6570\u636E\u91CF\uFF0C\u5206\u6210\u591A\u6B21\u5220\u9664\u3002</p><p>**\u4E3E\u4F8B2\uFF1A**\u4E00\u6B21\u6027\u7528insert...select\u63D2\u5165\u592A\u591A\u6570\u636E</p><p>**\u4E3E\u4F8B3\uFF1A**\u5927\u8868DDL</p><p>\u6BD4\u5982\u5728\u4E3B\u5E93\u5BF9\u4E00\u5F20500W\u7684\u8868\u6DFB\u52A0\u4E00\u4E2A\u5B57\u6BB5\u8017\u8D39\u4E8610\u5206\u949F\uFF0C\u90A3\u4E48\u4ECE\u8282\u70B9\u4E0A\u4E5F\u4F1A\u8017\u8D3910\u5206\u949F\u3002</p><h5 id="_4-3-\u5982\u4F55\u51CF\u5C11\u4E3B\u4ECE\u5EF6\u8FDF" tabindex="-1"><a class="header-anchor" href="#_4-3-\u5982\u4F55\u51CF\u5C11\u4E3B\u4ECE\u5EF6\u8FDF" aria-hidden="true">#</a> 4.3 \u5982\u4F55\u51CF\u5C11\u4E3B\u4ECE\u5EF6\u8FDF</h5><p>\u82E5\u60F3\u8981\u51CF\u5C11\u4E3B\u4ECE\u5EF6\u8FDF\u7684\u65F6\u95F4\uFF0C\u53EF\u4EE5\u91C7\u53D6\u4E0B\u9762\u7684\u529E\u6CD5\uFF1A</p><ol><li>\u964D\u4F4E\u591A\u7EBF\u7A0B\u5927\u4E8B\u52A1\u5E76\u53D1\u7684\u6982\u7387\uFF0C\u4F18\u5316\u4E1A\u52A1\u903B\u8F91</li><li>\u4F18\u5316SQL\uFF0C\u907F\u514D\u6162SQL\uFF0C <code>\u51CF\u5C11\u6279\u91CF\u64CD\u4F5C</code> \uFF0C\u5EFA\u8BAE\u5199\u811A\u672C\u4EE5update-sleep\u8FD9\u6837\u7684\u5F62\u5F0F\u5B8C\u6210\u3002</li><li><code>\u63D0\u9AD8\u4ECE\u5E93\u673A\u5668\u7684\u914D\u7F6E</code> \uFF0C\u51CF\u5C11\u4E3B\u5E93\u5199binlog\u548C\u4ECE\u5E93\u8BFBbinlog\u7684\u6548\u7387\u5DEE\u3002</li><li>\u5C3D\u91CF\u91C7\u7528 <code>\u77ED\u7684\u94FE\u8DEF</code> \uFF0C\u4E5F\u5C31\u662F\u4E3B\u5E93\u548C\u4ECE\u5E93\u670D\u52A1\u5668\u7684\u8DDD\u79BB\u5C3D\u91CF\u8981\u77ED\uFF0C\u63D0\u5347\u7AEF\u53E3\u5E26\u5BBD\uFF0C\u51CF\u5C11binlog\u4F20\u8F93\u7684\u7F51\u7EDC\u5EF6\u65F6\u3002</li><li>\u5B9E\u65F6\u6027\u8981\u6C42\u7684\u4E1A\u52A1\u8BFB\u5F3A\u5236\u8D70\u4E3B\u5E93\uFF0C\u4ECE\u5E93\u53EA\u505A\u707E\u5907\uFF0C\u5907\u4EFD\u3002</li></ol><h5 id="_4-4-\u5982\u4F55\u89E3\u51B3\u4E00\u81F4\u6027\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#_4-4-\u5982\u4F55\u89E3\u51B3\u4E00\u81F4\u6027\u95EE\u9898" aria-hidden="true">#</a> 4.4 \u5982\u4F55\u89E3\u51B3\u4E00\u81F4\u6027\u95EE\u9898</h5><p>\u5982\u679C\u64CD\u4F5C\u7684\u6570\u636E\u5B58\u50A8\u5728\u540C\u4E00\u4E2A\u6570\u636E\u5E93\u4E2D\uFF0C\u90A3\u4E48\u5BF9\u6570\u636E\u8FDB\u884C\u66F4\u65B0\u7684\u65F6\u5019\uFF0C\u53EF\u4EE5\u5BF9\u8BB0\u5F55\u52A0\u5199\u9501\uFF0C\u8FD9\u6837\u5728\u8BFB\u53D6\u7684\u65F6\u5019\u5C31\u4E0D\u4F1A\u53D1\u751F\u6570\u636E\u4E0D\u4E00\u81F4\u7684\u60C5\u51B5\u3002\u4F46\u8FD9\u65F6\u4ECE\u5E93\u7684\u4F5C\u7528\u5C31\u662F <code>\u5907\u4EFD</code> \uFF0C\u5E76\u6CA1\u6709\u8D77\u5230 <code>\u8BFB\u5199\u5206\u79BB</code> \uFF0C\u5206\u62C5\u4E3B\u5E93 <code>\u8BFB\u538B\u529B</code> \u7684\u4F5C\u7528\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718144341584.png" alt="image-20220718144341584"></p><p>\u8BFB\u5199\u5206\u79BB\u60C5\u51B5\u4E0B\uFF0C\u89E3\u51B3\u4E3B\u4ECE\u540C\u6B65\u4E2D\u6570\u636E\u4E0D\u4E00\u81F4\u7684\u95EE\u9898\uFF0C \u5C31\u662F\u89E3\u51B3\u4E3B\u4ECE\u4E4B\u95F4 <code>\u6570\u636E\u590D\u5236\u65B9\u5F0F</code> \u7684\u95EE\u9898\uFF0C\u5982\u679C\u6309\u7167\u6570\u636E\u4E00\u81F4\u6027 <code>\u4ECE\u5F31\u5230\u5F3A</code> \u6765\u8FDB\u884C\u5212\u5206\uFF0C\u6709\u4EE5\u4E0B 3 \u79CD\u590D\u5236\u65B9\u5F0F\u3002</p><h6 id="\u65B9\u6CD5-1-\u5F02\u6B65\u590D\u5236" tabindex="-1"><a class="header-anchor" href="#\u65B9\u6CD5-1-\u5F02\u6B65\u590D\u5236" aria-hidden="true">#</a> \u65B9\u6CD5 1\uFF1A\u5F02\u6B65\u590D\u5236</h6><p>\u5F02\u6B65\u6A21\u5F0F\u5C31\u662F\u5BA2\u6237\u7AEF\u63D0\u4EA4 COMMIT \u4E4B\u540E\u4E0D\u9700\u8981\u7B49\u4ECE\u5E93\u8FD4\u56DE\u4EFB\u4F55\u7ED3\u679C\uFF0C\u800C\u662F\u76F4\u63A5\u5C06\u7ED3\u679C\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7AEF\uFF0C\u8FD9\u6837\u505A\u7684\u597D\u5904\u662F\u4E0D\u4F1A\u5F71\u54CD\u4E3B\u5E93\u5199\u7684\u6548\u7387\uFF0C\u4F46\u53EF\u80FD\u4F1A\u5B58\u5728\u4E3B\u5E93\u5B95\u673A\uFF0C\u800CBinlog\u8FD8\u6CA1\u6709\u540C\u6B65\u5230\u4ECE\u5E93\u7684\u60C5\u51B5\uFF0C\u4E5F\u5C31\u662F\u6B64\u65F6\u7684\u4E3B\u5E93\u548C\u4ECE\u5E93\u6570\u636E\u4E0D\u4E00\u81F4\u3002\u8FD9\u65F6\u5019\u4ECE\u4ECE\u5E93\u4E2D\u9009\u62E9\u4E00\u4E2A\u4F5C\u4E3A\u65B0\u4E3B\uFF0C\u90A3\u4E48\u65B0\u4E3B\u5219\u53EF\u80FD\u7F3A\u5C11\u539F\u6765\u4E3B\u670D\u52A1\u5668\u4E2D\u5DF2\u63D0\u4EA4\u7684\u4E8B\u52A1\u3002\u6240\u4EE5\uFF0C\u8FD9\u79CD\u590D\u5236\u6A21\u5F0F\u4E0B\u7684\u6570\u636E\u4E00\u81F4\u6027\u662F\u6700\u5F31\u7684\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718144410731.png" alt="image-20220718144410731"></p><h6 id="\u65B9\u6CD5-2-\u534A\u540C\u6B65\u590D\u5236" tabindex="-1"><a class="header-anchor" href="#\u65B9\u6CD5-2-\u534A\u540C\u6B65\u590D\u5236" aria-hidden="true">#</a> \u65B9\u6CD5 2\uFF1A\u534A\u540C\u6B65\u590D\u5236</h6><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718144926758.png" alt="image-20220718144926758" style="float:left;"><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718144958357.png" alt="image-20220718144958357"></p><h6 id="\u65B9\u6CD5-3-\u7EC4\u590D\u5236" tabindex="-1"><a class="header-anchor" href="#\u65B9\u6CD5-3-\u7EC4\u590D\u5236" aria-hidden="true">#</a> \u65B9\u6CD5 3\uFF1A\u7EC4\u590D\u5236</h6><p>\u5F02\u6B65\u590D\u5236\u548C\u534A\u540C\u6B65\u590D\u5236\u90FD\u65E0\u6CD5\u6700\u7EC8\u4FDD\u8BC1\u6570\u636E\u7684\u4E00\u81F4\u6027\u95EE\u9898\uFF0C\u534A\u540C\u6B65\u590D\u5236\u662F\u901A\u8FC7\u5224\u65AD\u4ECE\u5E93\u54CD\u5E94\u7684\u4E2A\u6570\u6765\u51B3\u5B9A\u662F\u5426\u8FD4\u56DE\u7ED9\u5BA2\u6237\u7AEF\uFF0C\u867D\u7136\u6570\u636E\u4E00\u81F4\u6027\u76F8\u6BD4\u4E8E\u5F02\u6B65\u590D\u5236\u6709\u63D0\u5347\uFF0C\u4F46\u4ECD\u7136\u65E0\u6CD5\u6EE1\u8DB3\u5BF9\u6570\u636E\u4E00\u81F4\u6027\u8981\u6C42\u9AD8\u7684\u573A\u666F\uFF0C\u6BD4\u5982\u91D1\u878D\u9886\u57DF\u3002MGR \u5F88\u597D\u5730\u5F25\u8865\u4E86\u8FD9\u4E24\u79CD\u590D\u5236\u6A21\u5F0F\u7684\u4E0D\u8DB3\u3002</p><p>\u7EC4\u590D\u5236\u6280\u672F\uFF0C\u7B80\u79F0 MGR\uFF08MySQL Group Replication\uFF09\u3002\u662F MySQL \u5728 5.7.17 \u7248\u672C\u4E2D\u63A8\u51FA\u7684\u4E00\u79CD\u65B0\u7684\u6570\u636E\u590D\u5236\u6280\u672F\uFF0C\u8FD9\u79CD\u590D\u5236\u6280\u672F\u662F\u57FA\u4E8E Paxos \u534F\u8BAE\u7684\u72B6\u6001\u673A\u590D\u5236\u3002</p><p><strong>MGR \u662F\u5982\u4F55\u5DE5\u4F5C\u7684</strong></p><p>\u9996\u5148\u6211\u4EEC\u5C06\u591A\u4E2A\u8282\u70B9\u5171\u540C\u7EC4\u6210\u4E00\u4E2A\u590D\u5236\u7EC4\uFF0C\u5728 <code>\u6267\u884C\u8BFB\u5199\uFF08RW\uFF09\u4E8B\u52A1</code> \u7684\u65F6\u5019\uFF0C\u9700\u8981\u901A\u8FC7\u4E00\u81F4\u6027\u534F\u8BAE\u5C42 \uFF08Consensus \u5C42\uFF09\u7684\u540C\u610F\uFF0C\u4E5F\u5C31\u662F\u8BFB\u5199\u4E8B\u52A1\u60F3\u8981\u8FDB\u884C\u63D0\u4EA4\uFF0C\u5FC5\u987B\u8981\u7ECF\u8FC7\u7EC4\u91CC\u201C\u5927\u591A\u6570\u4EBA\u201D\uFF08\u5BF9\u5E94 Node \u8282 \u70B9\uFF09\u7684\u540C\u610F\uFF0C\u5927\u591A\u6570\u6307\u7684\u662F\u540C\u610F\u7684\u8282\u70B9\u6570\u91CF\u9700\u8981\u5927\u4E8E \uFF08N/2+1\uFF09\uFF0C\u8FD9\u6837\u624D\u53EF\u4EE5\u8FDB\u884C\u63D0\u4EA4\uFF0C\u800C\u4E0D\u662F\u539F\u53D1\u8D77\u65B9\u4E00\u4E2A\u8BF4\u4E86\u7B97\u3002\u800C\u9488\u5BF9 <code>\u53EA\u8BFB\uFF08RO\uFF09\u4E8B\u52A1</code> \u5219\u4E0D\u9700\u8981\u7ECF\u8FC7\u7EC4\u5185\u540C\u610F\uFF0C\u76F4\u63A5 COMMIT \u5373\u53EF\u3002</p><p>\u5728\u4E00\u4E2A\u590D\u5236\u7EC4\u5185\u6709\u591A\u4E2A\u8282\u70B9\u7EC4\u6210\uFF0C\u5B83\u4EEC\u5404\u81EA\u7EF4\u62A4\u4E86\u81EA\u5DF1\u7684\u6570\u636E\u526F\u672C\uFF0C\u5E76\u4E14\u5728\u4E00\u81F4\u6027\u534F\u8BAE\u5C42\u5B9E\u73B0\u4E86\u539F\u5B50\u6D88 \u606F\u548C\u5168\u5C40\u6709\u5E8F\u6D88\u606F\uFF0C\u4ECE\u800C\u4FDD\u8BC1\u7EC4\u5185\u6570\u636E\u7684\u4E00\u81F4\u6027\u3002</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718145235499.png" alt="image-20220718145235499"></p><p>MGR \u5C06 MySQL \u5E26\u5165\u4E86\u6570\u636E\u5F3A\u4E00\u81F4\u6027\u7684\u65F6\u4EE3\uFF0C\u662F\u4E00\u4E2A\u5212\u65F6\u4EE3\u7684\u521B\u65B0\uFF0C\u5176\u4E2D\u4E00\u4E2A\u91CD\u8981\u7684\u539F\u56E0\u5C31\u662FMGR \u662F\u57FA \u4E8E Paxos \u534F\u8BAE\u7684\u3002Paxos \u7B97\u6CD5\u662F\u7531 2013 \u5E74\u7684\u56FE\u7075\u5956\u83B7\u5F97\u8005 Leslie Lamport \u4E8E 1990 \u5E74\u63D0\u51FA\u7684\uFF0C\u6709\u5173\u8FD9\u4E2A\u7B97\u6CD5\u7684\u51B3\u7B56\u673A\u5236\u53EF\u4EE5\u641C\u4E00\u4E0B\u3002\u4E8B\u5B9E\u4E0A\uFF0CPaxos \u7B97\u6CD5\u63D0\u51FA\u6765\u4E4B\u540E\u5C31\u4F5C\u4E3A <code>\u5206\u5E03\u5F0F\u4E00\u81F4\u6027\u7B97\u6CD5</code> \u88AB\u5E7F\u6CDB\u5E94\u7528\uFF0C\u6BD4\u5982 Apache \u7684 ZooKeeper \u4E5F\u662F\u57FA\u4E8E Paxos \u5B9E\u73B0\u7684\u3002</p><h3 id="_5-\u77E5\u8BC6\u5EF6\u4F38" tabindex="-1"><a class="header-anchor" href="#_5-\u77E5\u8BC6\u5EF6\u4F38" aria-hidden="true">#</a> 5. \u77E5\u8BC6\u5EF6\u4F38</h3><p>\u5728\u4E3B\u4ECE\u67B6\u6784\u7684\u914D\u7F6E\u4E2D\uFF0C\u5982\u679C\u60F3\u8981\u91C7\u53D6\u8BFB\u5199\u5206\u79BB\u7684\u7B56\u7565\uFF0C\u6211\u4EEC\u53EF\u4EE5<code> \u81EA\u5DF1\u7F16\u5199\u7A0B\u5E8F</code> \uFF0C\u4E5F\u53EF\u4EE5\u901A\u8FC7 <code>\u7B2C\u4E09\u65B9\u7684\u4E2D\u95F4\u4EF6</code> \u6765\u5B9E\u73B0\u3002</p><ul><li>\u81EA\u5DF1\u7F16\u5199\u7A0B\u5E8F\u7684\u597D\u5904\u5C31\u5728\u4E8E\u6BD4\u8F83\u81EA\u4E3B\uFF0C\u6211\u4EEC\u53EF\u4EE5\u81EA\u5DF1\u5224\u65AD\u54EA\u4E9B\u67E5\u8BE2\u5728\u4ECE\u5E93\u4E0A\u6765\u6267\u884C\uFF0C\u9488\u5BF9\u5B9E\u65F6\u6027\u8981 \u6C42\u9AD8\u7684\u9700\u6C42\uFF0C\u6211\u4EEC\u8FD8\u53EF\u4EE5\u8003\u8651\u54EA\u4E9B\u67E5\u8BE2\u53EF\u4EE5\u5728\u4E3B\u5E93\u4E0A\u6267\u884C\u3002\u540C\u65F6\uFF0C\u7A0B\u5E8F\u76F4\u63A5\u8FDE\u63A5\u6570\u636E\u5E93\uFF0C\u51CF\u5C11\u4E86\u4E2D\u95F4\u4EF6\u5C42\uFF0C\u76F8\u5F53\u4E8E\u51CF\u5C11\u4E86\u6027\u80FD\u635F\u8017\u3002</li><li>\u91C7\u7528\u4E2D\u95F4\u4EF6\u7684\u65B9\u6CD5\u6709\u5F88\u660E\u663E\u7684\u4F18\u52BF\uFF0C<code> \u529F\u80FD\u5F3A\u5927</code> \uFF0C <code>\u4F7F\u7528\u7B80\u5355</code> \u3002\u4F46\u56E0\u4E3A\u5728\u5BA2\u6237\u7AEF\u548C\u6570\u636E\u5E93\u4E4B\u95F4\u589E\u52A0\u4E86 \u4E2D\u95F4\u4EF6\u5C42\u4F1A\u6709\u4E00\u4E9B <code>\u6027\u80FD\u635F\u8017</code> \uFF0C\u540C\u65F6\u5546\u4E1A\u4E2D\u95F4\u4EF6\u4E5F\u662F\u6709\u4F7F\u7528\u6210\u672C\u7684\u3002\u6211\u4EEC\u4E5F\u53EF\u4EE5\u8003\u8651\u91C7\u53D6\u4E00\u4E9B\u4F18\u79C0\u7684\u5F00\u6E90\u5DE5\u5177\u3002</li></ul><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718145428456.png" alt="image-20220718145428456"></p><p>\u2460 <code>Cobar</code> \u5C5E\u4E8E\u963F\u91CCB2B\u4E8B\u4E1A\u7FA4\uFF0C\u59CB\u4E8E2008\u5E74\uFF0C\u5728\u963F\u91CC\u670D\u5F793\u5E74\u591A\uFF0C\u63A5\u7BA13000+\u4E2AMySQL\u6570\u636E\u5E93\u7684 schema,\u96C6\u7FA4\u65E5\u5904\u7406\u5728\u7EBFSQL\u8BF7\u6C4250\u4EBF\u6B21\u4EE5\u4E0A\u3002\u7531\u4E8ECobar\u53D1\u8D77\u4EBA\u7684\u79BB\u804C\uFF0CCobar\u505C\u6B62\u7EF4\u62A4\u3002</p><p>\u2461 <code>Mycat</code> \u662F\u5F00\u6E90\u793E\u533A\u5728\u963F\u91CCcobar\u57FA\u7840\u4E0A\u8FDB\u884C\u4E8C\u6B21\u5F00\u53D1\uFF0C\u89E3\u51B3\u4E86cobar\u5B58\u5728\u7684\u95EE\u9898\uFF0C\u5E76\u4E14\u52A0\u5165\u4E86\u8BB8 \u591A\u65B0\u7684\u529F\u80FD\u5728\u5176\u4E2D\u3002\u9752\u51FA\u4E8E\u84DD\u800C\u80DC\u4E8E\u84DD\u3002</p><p>\u2462 <code>OneProxy</code> \u57FA\u4E8EMySQL\u5B98\u65B9\u7684proxy\u601D\u60F3\u5229\u7528c\u8BED\u8A00\u8FDB\u884C\u5F00\u53D1\u7684\uFF0COneProxy\u662F\u4E00\u6B3E\u5546\u4E1A \u6536\u8D39 \u7684\u4E2D \u95F4\u4EF6\u3002\u820D\u5F03\u4E86\u4E00\u4E9B\u529F\u80FD\uFF0C\u4E13\u6CE8\u5728 \u6027\u80FD\u548C\u7A33\u5B9A\u6027\u4E0A \u3002</p><p>\u2463 <code>kingshard</code> \u7531\u5C0F\u56E2\u961F\u7528go\u8BED\u8A00\u5F00\u53D1\uFF0C\u8FD8\u9700\u8981\u53D1\u5C55\uFF0C\u9700\u8981\u4E0D\u65AD\u5B8C\u5584\u3002</p><p>\u2464 <code>Vitess</code> \u662FYoutube\u751F\u4EA7\u5728\u4F7F\u7528\uFF0C\u67B6\u6784\u5F88\u590D\u6742\u3002\u4E0D\u652F\u6301MySQL\u539F\u751F\u534F\u8BAE\uFF0C\u4F7F\u7528 \u9700\u8981\u5927\u91CF\u6539\u9020\u6210 \u672C \u3002</p><p>\u2465 <code>Atlas</code> \u662F360\u56E2\u961F\u57FA\u4E8Emysql proxy\u6539\u5199\uFF0C\u529F\u80FD\u8FD8\u9700\u5B8C\u5584\uFF0C\u9AD8\u5E76\u53D1\u4E0B\u4E0D\u7A33\u5B9A\u3002</p><p>\u2466 <code>MaxScale</code> \u662Fmariadb\uFF08MySQL\u539F\u4F5C\u8005\u7EF4\u62A4\u7684\u4E00\u4E2A\u7248\u672C\uFF09 \u7814\u53D1\u7684\u4E2D\u95F4\u4EF6</p><p>\u2467 <code>MySQLRoute</code> \u662FMySQL\u5B98\u65B9Oracle\u516C\u53F8\u53D1\u5E03\u7684\u4E2D\u95F4\u4EF6</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718145523643.png" alt="image-20220718145523643"></p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718145534856.png" alt="image-20220718145534856"></p><p>\u4E3B\u5907\u5207\u6362\uFF1A</p><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718145548526.png" alt="image-20220718145548526"></p><ul><li>\u4E3B\u52A8\u5207\u6362</li><li>\u88AB\u52A8\u5207\u6362</li><li>\u5982\u4F55\u5224\u65AD\u4E3B\u5E93\u51FA\u95EE\u9898\u4E86\uFF1F\u5982\u4F55\u89E3\u51B3\u8FC7\u7A0B\u4E2D\u7684\u6570\u636E\u4E0D\u4E00\u81F4\u6027\u95EE\u9898 ?</li></ul><h2 id="\u7B2C19\u7AE0-\u6570\u636E\u5E93\u5907\u4EFD\u4E0E\u6062\u590D" tabindex="-1"><a class="header-anchor" href="#\u7B2C19\u7AE0-\u6570\u636E\u5E93\u5907\u4EFD\u4E0E\u6062\u590D" aria-hidden="true">#</a> \u7B2C19\u7AE0_\u6570\u636E\u5E93\u5907\u4EFD\u4E0E\u6062\u590D</h2><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718145936444.png" alt="image-20220718145936444" style="float:left;"><h3 id="_1-\u7269\u7406\u5907\u4EFD\u4E0E\u903B\u8F91\u5907\u4EFD" tabindex="-1"><a class="header-anchor" href="#_1-\u7269\u7406\u5907\u4EFD\u4E0E\u903B\u8F91\u5907\u4EFD" aria-hidden="true">#</a> 1. \u7269\u7406\u5907\u4EFD\u4E0E\u903B\u8F91\u5907\u4EFD</h3><p>**\u7269\u7406\u5907\u4EFD\uFF1A**\u5907\u4EFD\u6570\u636E\u6587\u4EF6\uFF0C\u8F6C\u50A8\u6570\u636E\u5E93\u7269\u7406\u6587\u4EF6\u5230\u67D0\u4E00\u76EE\u5F55\u3002\u7269\u7406\u5907\u4EFD\u6062\u590D\u901F\u5EA6\u6BD4\u8F83\u5FEB\uFF0C\u4F46\u5360\u7528\u7A7A\u95F4\u6BD4\u8F83\u5927\uFF0CMySQL\u4E2D\u53EF\u4EE5\u7528 <code>xtrabackup</code> \u5DE5\u5177\u6765\u8FDB\u884C\u7269\u7406\u5907\u4EFD\u3002</p><p>**\u903B\u8F91\u5907\u4EFD\uFF1A**\u5BF9\u6570\u636E\u5E93\u5BF9\u8C61\u5229\u7528\u5DE5\u5177\u8FDB\u884C\u5BFC\u51FA\u5DE5\u4F5C\uFF0C\u6C47\u603B\u5165\u5907\u4EFD\u6587\u4EF6\u5185\u3002\u903B\u8F91\u5907\u4EFD\u6062\u590D\u901F\u5EA6\u6162\uFF0C\u4F46\u5360\u7528\u7A7A\u95F4\u5C0F\uFF0C\u66F4\u7075\u6D3B\u3002MySQL \u4E2D\u5E38\u7528\u7684\u903B\u8F91\u5907\u4EFD\u5DE5\u5177\u4E3A <code>mysqldump</code> \u3002\u903B\u8F91\u5907\u4EFD\u5C31\u662F <code>\u5907\u4EFDsql\u8BED\u53E5</code> \uFF0C\u5728\u6062\u590D\u7684 \u65F6\u5019\u6267\u884C\u5907\u4EFD\u7684sql\u8BED\u53E5\u5B9E\u73B0\u6570\u636E\u5E93\u6570\u636E\u7684\u91CD\u73B0\u3002</p><h3 id="_2-mysqldump\u5B9E\u73B0\u903B\u8F91\u5907\u4EFD" tabindex="-1"><a class="header-anchor" href="#_2-mysqldump\u5B9E\u73B0\u903B\u8F91\u5907\u4EFD" aria-hidden="true">#</a> 2. mysqldump\u5B9E\u73B0\u903B\u8F91\u5907\u4EFD</h3><p>mysqldump\u662FMySQL\u63D0\u4F9B\u7684\u4E00\u4E2A\u975E\u5E38\u6709\u7528\u7684\u6570\u636E\u5E93\u5907\u4EFD\u5DE5\u5177\u3002</p><h5 id="_2-1-\u5907\u4EFD\u4E00\u4E2A\u6570\u636E\u5E93" tabindex="-1"><a class="header-anchor" href="#_2-1-\u5907\u4EFD\u4E00\u4E2A\u6570\u636E\u5E93" aria-hidden="true">#</a> 2.1 \u5907\u4EFD\u4E00\u4E2A\u6570\u636E\u5E93</h5><p>mysqldump\u547D\u4EE4\u6267\u884C\u65F6\uFF0C\u53EF\u4EE5\u5C06\u6570\u636E\u5E93\u5907\u4EFD\u6210\u4E00\u4E2A<code>\u6587\u672C\u6587\u4EF6</code>\uFF0C\u8BE5\u6587\u4EF6\u4E2D\u5B9E\u9645\u4E0A\u5305\u542B\u591A\u4E2A<code>CREATE</code>\u548C<code>INSERT</code>\u8BED\u53E5\uFF0C\u4F7F\u7528\u8FD9\u4E9B\u8BED\u53E5\u53EF\u4EE5\u91CD\u65B0\u521B\u5EFA\u8868\u548C\u63D2\u5165\u6570\u636E\u3002</p><ul><li>\u67E5\u51FA\u9700\u8981\u5907\u4EFD\u7684\u8868\u7684\u7ED3\u6784\uFF0C\u5728\u6587\u672C\u6587\u4EF6\u4E2D\u751F\u6210\u4E00\u4E2ACREATE\u8BED\u53E5</li><li>\u5C06\u8868\u4E2D\u7684\u6240\u6709\u8BB0\u5F55\u8F6C\u6362\u4E3A\u4E00\u6761INSERT\u8BED\u53E5\u3002</li></ul><p><strong>\u57FA\u672C\u8BED\u6CD5\uFF1A</strong></p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump \u2013u \u7528\u6237\u540D\u79F0 \u2013h \u4E3B\u673A\u540D\u79F0 \u2013p\u5BC6\u7801 \u5F85\u5907\u4EFD\u7684\u6570\u636E\u5E93\u540D\u79F0[tbname, [tbname...]]&gt; \u5907\u4EFD\u6587\u4EF6\u540D\u79F0.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>\u8BF4\u660E\uFF1A \u5907\u4EFD\u7684\u6587\u4EF6\u5E76\u975E\u4E00\u5B9A\u8981\u6C42\u540E\u7F00\u540D\u4E3A.sql\uFF0C\u4F8B\u5982\u540E\u7F00\u540D\u4E3A.txt\u7684\u6587\u4EF6\u4E5F\u662F\u53EF\u4EE5\u7684\u3002</p></blockquote><p>\u4E3E\u4F8B\uFF1A\u4F7F\u7528root\u7528\u6237\u5907\u4EFDatguigu\u6570\u636E\u5E93\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump -uroot -p atguigu&gt;atguigu.sql #\u5907\u4EFD\u6587\u4EF6\u5B58\u50A8\u5728\u5F53\u524D\u76EE\u5F55\u4E0B
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump -uroot -p atguigudb1 &gt; /var/lib/mysql/atguigu.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5907\u4EFD\u6587\u4EF6\u5256\u6790\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- MySQL dump 10.13 Distrib 8.0.26, for Linux (x86_64)
--
-- Host: localhost Database: atguigu
-- ------------------------------------------------------
-- Server version 8.0.26

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!50503 SET NAMES utf8mb4 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE=&#39;+00:00&#39; */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=&#39;NO_AUTO_VALUE_ON_ZERO&#39; */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Current Database: \`atguigu\`
--

CREATE DATABASE /*!32312 IF NOT EXISTS*/ \`atguigu\` /*!40100 DEFAULT CHARACTER SET
utf8mb4 COLLATE utf8mb4_0900_ai_ci */ /*!80016 DEFAULT ENCRYPTION=&#39;N&#39; */;

USE \`atguigu\`;

--
-- Table structure for table \`student\`
--

DROP TABLE IF EXISTS \`student\`;
/*!40101 SET @saved_cs_client = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE \`student\` (
\`studentno\` int NOT NULL,
\`name\` varchar(20) DEFAULT NULL,
\`class\` varchar(20) DEFAULT NULL,
PRIMARY KEY (\`studentno\`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3;
/*!40101 SET character_set_client = @saved_cs_client */;
INSERT INTO \`student\` VALUES (1,&#39;\u5F20\u4E09_back&#39;,&#39;\u4E00\u73ED&#39;),(3,&#39;\u674E\u56DB&#39;,&#39;\u4E00\u73ED&#39;),(8,&#39;\u738B\u4E94&#39;,&#39;\u4E8C\u73ED&#39;),
(15,&#39;\u8D75\u516D&#39;,&#39;\u4E8C\u73ED&#39;),(20,&#39;\u94B1\u4E03&#39;,&#39;&gt;\u4E09\u73ED&#39;),(22,&#39;zhang3_update&#39;,&#39;1ban&#39;),(24,&#39;wang5&#39;,&#39;2ban&#39;);
/*!40000 ALTER TABLE \`student\` ENABLE KEYS */;
UNLOCK TABLES;
        .
        .
        .
        .
/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
-- Dump completed on 2022-01-07 9:58:23
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-2-\u5907\u4EFD\u5168\u90E8\u6570\u636E\u5E93" tabindex="-1"><a class="header-anchor" href="#_2-2-\u5907\u4EFD\u5168\u90E8\u6570\u636E\u5E93" aria-hidden="true">#</a> 2.2 \u5907\u4EFD\u5168\u90E8\u6570\u636E\u5E93</h5><p>\u82E5\u60F3\u7528mysqldump\u5907\u4EFD\u6574\u4E2A\u5B9E\u4F8B\uFF0C\u53EF\u4EE5\u4F7F\u7528 --all-databases \u6216 -A \u53C2\u6570\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump -uroot -pxxxxxx --all-databases &gt; all_database.sql
mysqldump -uroot -pxxxxxx -A &gt; all_database.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-3-\u5907\u4EFD\u90E8\u5206\u6570\u636E\u5E93" tabindex="-1"><a class="header-anchor" href="#_2-3-\u5907\u4EFD\u90E8\u5206\u6570\u636E\u5E93" aria-hidden="true">#</a> 2.3 \u5907\u4EFD\u90E8\u5206\u6570\u636E\u5E93</h5><p>\u4F7F\u7528 <code>--databases</code> \u6216 <code>-B</code> \u53C2\u6570\u4E86\uFF0C\u8BE5\u53C2\u6570\u540E\u9762\u8DDF\u6570\u636E\u5E93\u540D\u79F0\uFF0C\u591A\u4E2A\u6570\u636E\u5E93\u95F4\u7528\u7A7A\u683C\u9694\u5F00\u3002\u5982\u679C\u6307\u5B9A databases\u53C2\u6570\uFF0C\u5907\u4EFD\u6587\u4EF6\u4E2D\u4F1A\u5B58\u5728\u521B\u5EFA\u6570\u636E\u5E93\u7684\u8BED\u53E5\uFF0C\u5982\u679C\u4E0D\u6307\u5B9A\u53C2\u6570\uFF0C\u5219\u4E0D\u5B58\u5728\u3002\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump \u2013u user \u2013h host \u2013p --databases [\u6570\u636E\u5E93\u7684\u540D\u79F01 [\u6570\u636E\u5E93\u7684\u540D\u79F02...]] &gt; \u5907\u4EFD\u6587\u4EF6\u540D\u79F0.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4E3E\u4F8B\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump -uroot -p --databases atguigu atguigu12 &gt;two_database.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6216</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump -uroot -p -B atguigu atguigu12 &gt; two_database.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_2-4-\u5907\u4EFD\u90E8\u5206\u8868" tabindex="-1"><a class="header-anchor" href="#_2-4-\u5907\u4EFD\u90E8\u5206\u8868" aria-hidden="true">#</a> 2.4 \u5907\u4EFD\u90E8\u5206\u8868</h5><p>\u6BD4\u5982\uFF0C\u5728\u8868\u53D8\u66F4\u524D\u505A\u4E2A\u5907\u4EFD\u3002\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump \u2013u user \u2013h host \u2013p \u6570\u636E\u5E93\u7684\u540D\u79F0 [\u8868\u540D1 [\u8868\u540D2...]] &gt; \u5907\u4EFD\u6587\u4EF6\u540D\u79F0.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4E3E\u4F8B\uFF1A\u5907\u4EFDatguigu\u6570\u636E\u5E93\u4E0B\u7684book\u8868</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump -uroot -p atguigu book&gt; book.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>book.sql\u6587\u4EF6\u5185\u5BB9\u5982\u4E0B</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump -uroot -p atguigu book&gt; book.sql^C
[root@node1 ~]# ls
kk kubekey kubekey-v1.1.1-linux-amd64.tar.gz README.md test1.sql two_database.sql
[root@node1 ~]# mysqldump -uroot -p atguigu book&gt; book.sql
Enter password:
[root@node1 ~]# ls
book.sql kk kubekey kubekey-v1.1.1-linux-amd64.tar.gz README.md test1.sql
two_database.sql
[root@node1 ~]# vi book.sql
-- MySQL dump 10.13 Distrib 8.0.26, for Linux (x86_64)
--
-- Host: localhost Database: atguigu
-- ------------------------------------------------------
-- Server version 8.0.26

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!50503 SET NAMES utf8mb4 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE=&#39;+00:00&#39; */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=&#39;NO_AUTO_VALUE_ON_ZERO&#39; */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table \`book\`
--

DROP TABLE IF EXISTS \`book\`;
/*!40101 SET @saved_cs_client = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE \`book\` (
\`bookid\` int unsigned NOT NULL AUTO_INCREMENT,
\`card\` int unsigned NOT NULL,
\`test\` varchar(255) COLLATE utf8_bin DEFAULT NULL,
PRIMARY KEY (\`bookid\`),
KEY \`Y\` (\`card\`)
) ENGINE=InnoDB AUTO_INCREMENT=101 DEFAULT CHARSET=utf8mb3 COLLATE=utf8_bin;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table \`book\`
--

LOCK TABLES \`book\` WRITE;
/*!40000 ALTER TABLE \`book\` DISABLE KEYS */;
INSERT INTO \`book\` VALUES (1,9,NULL),(2,10,NULL),(3,4,NULL),(4,8,NULL),(5,7,NULL),
(6,10,NULL),(7,11,NULL),(8,3,NULL),(9,1,NULL),(10,17,NULL),(11,19,NULL),(12,4,NULL),
(13,1,NULL),(14,14,NULL),(15,5,NULL),(16,5,NULL),(17,8,NULL),(18,3,NULL),(19,12,NULL),
(20,11,NULL),(21,9,NULL),(22,20,NULL),(23,13,NULL),(24,3,NULL),(25,18,NULL),
(26,20,NULL),(27,5,NULL),(28,6,NULL),(29,15,NULL),(30,15,NULL),(31,12,NULL),
(32,11,NULL),(33,20,NULL),(34,5,NULL),(35,4,NULL),(36,6,NULL),(37,17,NULL),
(38,5,NULL),(39,16,NULL),(40,6,NULL),(41,18,NULL),(42,12,NULL),(43,6,NULL),
(44,12,NULL),(45,2,NULL),(46,12,NULL),(47,15,NULL),(48,17,NULL),(49,2,NULL),
(50,16,NULL),(51,13,NULL),(52,17,NULL),(53,7,NULL),(54,2,NULL),(55,9,NULL),
(56,1,NULL),(57,14,NULL),(58,7,NULL),(59,15,NULL),(60,12,NULL),(61,13,NULL),
(62,8,NULL),(63,2,NULL),(64,6,NULL),(65,2,NULL),(66,12,NULL),(67,12,NULL),(68,4,NULL),
(69,5,NULL),(70,10,NULL),(71,16,NULL),(72,8,NULL),(73,14,NULL),(74,5,NULL),
(75,4,NULL),(76,3,NULL),(77,2,NULL),(78,2,NULL),(79,2,NULL),(80,3,NULL),(81,8,NULL),
(82,14,NULL),(83,5,NULL),(84,4,NULL),(85,2,NULL),(86,20,NULL),(87,12,NULL),
(88,1,NULL),(89,8,NULL),(90,18,NULL),(91,3,NULL),(92,3,NULL),(93,6,NULL),(94,1,NULL),
(95,4,NULL),(96,17,NULL),(97,15,NULL),(98,1,NULL),(99,20,NULL),(100,15,NULL);
/*!40000 ALTER TABLE \`book\` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u770B\u5230\uFF0Cbook\u6587\u4EF6\u548C\u5907\u4EFD\u7684\u5E93\u6587\u4EF6\u7C7B\u4F3C\u3002\u4E0D\u540C\u7684\u662F\uFF0Cbook\u6587\u4EF6\u53EA\u5305\u542Bbook\u8868\u7684DROP\u3001CREATE\u548C INSERT\u8BED\u53E5\u3002</p><p>\u5907\u4EFD\u591A\u5F20\u8868\u4F7F\u7528\u4E0B\u9762\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982\u5907\u4EFDbook\u548Caccount\u8868\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>#\u5907\u4EFD\u591A\u5F20\u8868
mysqldump -uroot -p atguigu book account &gt; 2_tables_bak.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-5-\u5907\u4EFD\u5355\u8868\u7684\u90E8\u5206\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#_2-5-\u5907\u4EFD\u5355\u8868\u7684\u90E8\u5206\u6570\u636E" aria-hidden="true">#</a> 2.5 \u5907\u4EFD\u5355\u8868\u7684\u90E8\u5206\u6570\u636E</h5><p>\u6709\u4E9B\u65F6\u5019\u4E00\u5F20\u8868\u7684\u6570\u636E\u91CF\u5F88\u5927\uFF0C\u6211\u4EEC\u53EA\u9700\u8981\u90E8\u5206\u6570\u636E\u3002\u8FD9\u65F6\u5C31\u53EF\u4EE5\u4F7F\u7528 --where \u9009\u9879\u4E86\u3002where\u540E\u9762\u9644\u5E26\u9700\u8981\u6EE1\u8DB3\u7684\u6761\u4EF6\u3002</p><p>\u4E3E\u4F8B\uFF1A\u5907\u4EFDstudent\u8868\u4E2Did\u5C0F\u4E8E10\u7684\u6570\u636E\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump -uroot -p atguigu student --where=&quot;id &lt; 10 &quot; &gt; student_part_id10_low_bak.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5185\u5BB9\u5982\u4E0B\u6240\u793A\uFF0Cinsert\u8BED\u53E5\u53EA\u6709id\u5C0F\u4E8E10\u7684\u90E8\u5206</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>LOCK TABLES \`student\` WRITE;
/*!40000 ALTER TABLE \`student\` DISABLE KEYS */;
INSERT INTO \`student\` VALUES (1,100002,&#39;JugxTY&#39;,157,280),(2,100003,&#39;QyUcCJ&#39;,251,277),
(3,100004,&#39;lATUPp&#39;,80,404),(4,100005,&#39;BmFsXI&#39;,240,171),(5,100006,&#39;mkpSwJ&#39;,388,476),
(6,100007,&#39;ujMgwN&#39;,259,124),(7,100008,&#39;HBJTqX&#39;,429,168),(8,100009,&#39;dvQSQA&#39;,61,504),
(9,100010,&#39;HljpVJ&#39;,234,185);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-6-\u6392\u9664\u67D0\u4E9B\u8868\u7684\u5907\u4EFD" tabindex="-1"><a class="header-anchor" href="#_2-6-\u6392\u9664\u67D0\u4E9B\u8868\u7684\u5907\u4EFD" aria-hidden="true">#</a> 2.6 \u6392\u9664\u67D0\u4E9B\u8868\u7684\u5907\u4EFD</h5><p>\u5982\u679C\u6211\u4EEC\u60F3\u5907\u4EFD\u67D0\u4E2A\u5E93\uFF0C\u4F46\u662F\u67D0\u4E9B\u8868\u6570\u636E\u91CF\u5F88\u5927\u6216\u8005\u4E0E\u4E1A\u52A1\u5173\u8054\u4E0D\u5927\uFF0C\u8FD9\u4E2A\u65F6\u5019\u53EF\u4EE5\u8003\u8651\u6392\u9664\u6389\u8FD9\u4E9B\u8868\uFF0C\u540C\u6837\u7684\uFF0C\u9009\u9879 <code>--ignore-table</code> \u53EF\u4EE5\u5B8C\u6210\u8FD9\u4E2A\u529F\u80FD\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump -uroot -p atguigu --ignore-table=atguigu.student &gt; no_stu_bak.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u901A\u8FC7\u5982\u4E0B\u6307\u5B9A\u5224\u5B9A\u6587\u4EF6\u4E2D\u6CA1\u6709student\u8868\u7ED3\u6784\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>grep &quot;student&quot; no_stu_bak.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_2-7-\u53EA\u5907\u4EFD\u7ED3\u6784\u6216\u53EA\u5907\u4EFD\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#_2-7-\u53EA\u5907\u4EFD\u7ED3\u6784\u6216\u53EA\u5907\u4EFD\u6570\u636E" aria-hidden="true">#</a> 2.7 \u53EA\u5907\u4EFD\u7ED3\u6784\u6216\u53EA\u5907\u4EFD\u6570\u636E</h5><p>\u53EA\u5907\u4EFD\u7ED3\u6784\u7684\u8BDD\u53EF\u4EE5\u4F7F\u7528 <code>--no-data</code> \u7B80\u5199\u4E3A <code>-d</code> \u9009\u9879\uFF1B\u53EA\u5907\u4EFD\u6570\u636E\u53EF\u4EE5\u4F7F\u7528 <code>--no-create-info</code> \u7B80\u5199\u4E3A <code>-t</code>\u9009\u9879\u3002</p><ul><li><p>\u53EA\u5907\u4EFD\u7ED3\u6784</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump -uroot -p atguigu --no-data &gt; atguigu_no_data_bak.sql
#\u4F7F\u7528grep\u547D\u4EE4\uFF0C\u6CA1\u6709\u627E\u5230insert\u76F8\u5173\u8BED\u53E5\uFF0C\u8868\u793A\u6CA1\u6709\u6570\u636E\u5907\u4EFD\u3002
[root@node1 ~]# grep &quot;INSERT&quot; atguigu_no_data_bak.sql
[root@node1 ~]#
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>\u53EA\u5907\u4EFD\u6570\u636E</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump -uroot -p atguigu --no-create-info &gt; atguigu_no_create_info_bak.sql
#\u4F7F\u7528grep\u547D\u4EE4\uFF0C\u6CA1\u6709\u627E\u5230create\u76F8\u5173\u8BED\u53E5\uFF0C\u8868\u793A\u6CA1\u6709\u6570\u636E\u7ED3\u6784\u3002
[root@node1 ~]# grep &quot;CREATE&quot; atguigu_no_create_info_bak.sql
[root@node1 ~]#
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h5 id="_2-8-\u5907\u4EFD\u4E2D\u5305\u542B\u5B58\u50A8\u8FC7\u7A0B\u3001\u51FD\u6570\u3001\u4E8B\u4EF6" tabindex="-1"><a class="header-anchor" href="#_2-8-\u5907\u4EFD\u4E2D\u5305\u542B\u5B58\u50A8\u8FC7\u7A0B\u3001\u51FD\u6570\u3001\u4E8B\u4EF6" aria-hidden="true">#</a> 2.8 \u5907\u4EFD\u4E2D\u5305\u542B\u5B58\u50A8\u8FC7\u7A0B\u3001\u51FD\u6570\u3001\u4E8B\u4EF6</h5><p>mysqldump\u5907\u4EFD\u9ED8\u8BA4\u662F\u4E0D\u5305\u542B\u5B58\u50A8\u8FC7\u7A0B\uFF0C\u81EA\u5B9A\u4E49\u51FD\u6570\u53CA\u4E8B\u4EF6\u7684\u3002\u53EF\u4EE5\u4F7F\u7528 <code>--routines</code> \u6216 <code>-R</code> \u9009\u9879\u6765\u5907\u4EFD\u5B58\u50A8\u8FC7\u7A0B\u53CA\u51FD\u6570\uFF0C\u4F7F\u7528 <code>--events</code> \u6216 <code>-E</code> \u53C2\u6570\u6765\u5907\u4EFD\u4E8B\u4EF6\u3002</p><p>\u4E3E\u4F8B\uFF1A\u5907\u4EFD\u6574\u4E2Aatguigu\u5E93\uFF0C\u5305\u542B\u5B58\u50A8\u8FC7\u7A0B\u53CA\u4E8B\u4EF6\uFF1A</p><ul><li>\u4F7F\u7528\u4E0B\u9762\u7684SQL\u53EF\u4EE5\u67E5\u770B\u5F53\u524D\u5E93\u6709\u54EA\u4E9B\u5B58\u50A8\u8FC7\u7A0B\u6216\u8005\u51FD\u6570</li></ul><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql&gt; SELECT SPECIFIC_NAME,ROUTINE_TYPE ,ROUTINE_SCHEMA FROM
information_schema.Routines WHERE ROUTINE_SCHEMA=&quot;atguigu&quot;;
+---------------+--------------+----------------+
| SPECIFIC_NAME | ROUTINE_TYPE | ROUTINE_SCHEMA |
+---------------+--------------+----------------+
| rand_num      | FUNCTION     | atguigu        |
| rand_string   | FUNCTION     | atguigu        |
| BatchInsert   | PROCEDURE    | atguigu        |
| insert_class  | PROCEDURE    | atguigu        |
| insert_order  | PROCEDURE    | atguigu        |
| insert_stu    | PROCEDURE    | atguigu        |
| insert_user   | PROCEDURE    | atguigu        |
| ts_insert     | PROCEDURE    | atguigu        |
+---------------+--------------+----------------+
9 rows in set (0.02 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0B\u9762\u5907\u4EFDatguigu\u5E93\u7684\u6570\u636E\uFF0C\u51FD\u6570\u4EE5\u53CA\u5B58\u50A8\u8FC7\u7A0B\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump -uroot -p -R -E --databases atguigu &gt; fun_atguigu_bak.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u67E5\u8BE2\u5907\u4EFD\u6587\u4EF6\u4E2D\u662F\u5426\u5B58\u5728\u51FD\u6570\uFF0C\u5982\u4E0B\u6240\u793A\uFF0C\u53EF\u4EE5\u770B\u5230\u786E\u5B9E\u5305\u542B\u4E86\u51FD\u6570\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>grep -C 5 &quot;rand_num&quot; fun_atguigu_bak.sql
--
--
-- Dumping routines for database &#39;atguigu&#39;
--
/*!50003 DROP FUNCTION IF EXISTS \`rand_num\` */;
/*!50003 SET @saved_cs_client = @@character_set_client */ ;
/*!50003 SET @saved_cs_results = @@character_set_results */ ;
/*!50003 SET @saved_col_connection = @@collation_connection */ ;
/*!50003 SET character_set_client = utf8mb3 */ ;
/*!50003 SET character_set_results = utf8mb3 */ ;
/*!50003 SET collation_connection = utf8_general_ci */ ;
/*!50003 SET @saved_sql_mode = @@sql_mode */ ;
/*!50003 SET sql_mode =
&#39;ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISIO
N_BY_ZERO,NO_ENGINE_SUBSTITUTION&#39; */ ;
DELIMITER ;;
CREATE DEFINER=\`root\`@\`%\` FUNCTION \`rand_num\`(from_num BIGINT ,to_num BIGINT) RETURNS
bigint
BEGIN
DECLARE i BIGINT DEFAULT 0;
SET i = FLOOR(from_num +RAND()*(to_num - from_num+1)) ;
RETURN i;
END ;;
--
BEGIN
DECLARE i INT DEFAULT 0;
    SET autocommit = 0;
    REPEAT
    SET i = i + 1;
    INSERT INTO class ( classname,address,monitor ) VALUES
    (rand_string(8),rand_string(10),rand_num());
    UNTIL i = max_num
    END REPEAT;
    COMMIT;
END ;;
DELIMITER ;
--
BEGIN
DECLARE i INT DEFAULT 0;
    SET autocommit = 0; #\u8BBE\u7F6E\u624B\u52A8\u63D0\u4EA4\u4E8B\u52A1
    REPEAT #\u5FAA\u73AF
    SET i = i + 1; #\u8D4B\u503C
    INSERT INTO order_test (order_id, trans_id ) VALUES
    (rand_num(1,7000000),rand_num(100000000000000000,700000000000000000));
    UNTIL i = max_num
    END REPEAT;
    COMMIT; #\u63D0\u4EA4\u4E8B\u52A1
END ;;
DELIMITER ;
--
BEGIN
DECLARE i INT DEFAULT 0;
    SET autocommit = 0; #\u8BBE\u7F6E\u624B\u52A8\u63D0\u4EA4\u4E8B\u52A1
    REPEAT #\u5FAA\u73AF
    SET i = i + 1; #\u8D4B\u503C
    INSERT INTO student (stuno, name ,age ,classId ) VALUES
    ((START+i),rand_string(6),rand_num(),rand_num());
    UNTIL i = max_num
    END REPEAT;
    COMMIT; #\u63D0\u4EA4\u4E8B\u52A1
END ;;
DELIMITER ;
--
BEGIN
DECLARE i INT DEFAULT 0;
    SET autocommit = 0;
    REPEAT
    SET i = i + 1;
    INSERT INTO \`user\` ( name,age,sex ) VALUES (&quot;atguigu&quot;,rand_num(1,20),&quot;male&quot;);
    UNTIL i = max_num
    END REPEAT;
    COMMIT;
END ;;
DELIMITER ;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_2-9-mysqldump\u5E38\u7528\u9009\u9879" tabindex="-1"><a class="header-anchor" href="#_2-9-mysqldump\u5E38\u7528\u9009\u9879" aria-hidden="true">#</a> 2.9 mysqldump\u5E38\u7528\u9009\u9879</h5><p>mysqldump\u5176\u4ED6\u5E38\u7528\u9009\u9879\u5982\u4E0B\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>--add-drop-database\uFF1A\u5728\u6BCF\u4E2ACREATE DATABASE\u8BED\u53E5\u524D\u6DFB\u52A0DROP DATABASE\u8BED\u53E5\u3002

--add-drop-tables\uFF1A\u5728\u6BCF\u4E2ACREATE TABLE\u8BED\u53E5\u524D\u6DFB\u52A0DROP TABLE\u8BED\u53E5\u3002

--add-locking\uFF1A\u7528LOCK TABLES\u548CUNLOCK TABLES\u8BED\u53E5\u5F15\u7528\u6BCF\u4E2A\u8868\u8F6C\u50A8\u3002\u91CD\u8F7D\u8F6C\u50A8\u6587\u4EF6\u65F6\u63D2\u5165\u5F97\u66F4\u5FEB\u3002

--all-database, -A\uFF1A\u8F6C\u50A8\u6240\u6709\u6570\u636E\u5E93\u4E2D\u7684\u6240\u6709\u8868\u3002\u4E0E\u4F7F\u7528--database\u9009\u9879\u76F8\u540C\uFF0C\u5728\u547D\u4EE4\u884C\u4E2D\u547D\u540D\u6240\u6709\u6570\u636E\u5E93\u3002

--comment[=0|1]\uFF1A\u5982\u679C\u8BBE\u7F6E\u4E3A0\uFF0C\u7981\u6B62\u8F6C\u50A8\u6587\u4EF6\u4E2D\u7684\u5176\u4ED6\u4FE1\u606F\uFF0C\u4F8B\u5982\u7A0B\u5E8F\u7248\u672C\u3001\u670D\u52A1\u5668\u7248\u672C\u548C\u4E3B\u673A\u3002--skipcomments\u4E0E--comments=0\u7684\u7ED3\u679C\u76F8\u540C\u3002\u9ED8\u8BA4\u503C\u4E3A1\uFF0C\u5373\u5305\u62EC\u989D\u5916\u4FE1\u606F\u3002

--compact\uFF1A\u4EA7\u751F\u5C11\u91CF\u8F93\u51FA\u3002\u8BE5\u9009\u9879\u7981\u7528\u6CE8\u91CA\u5E76\u542F\u7528--skip-add-drop-tables\u3001--no-set-names\u3001--skipdisable-keys\u548C--skip-add-locking\u9009\u9879\u3002

--compatible=name\uFF1A\u4EA7\u751F\u4E0E\u5176\u4ED6\u6570\u636E\u5E93\u7CFB\u7EDF\u6216\u65E7\u7684MySQL\u670D\u52A1\u5668\u66F4\u517C\u5BB9\u7684\u8F93\u51FA\uFF0C\u503C\u53EF\u4EE5\u4E3Aansi\u3001MySQL323\u3001MySQL40\u3001postgresql\u3001oracle\u3001mssql\u3001db2\u3001maxdb\u3001no_key_options\u3001no_table_options\u6216\u8005no_field_options\u3002

--complete_insert, -c\uFF1A\u4F7F\u7528\u5305\u62EC\u5217\u540D\u7684\u5B8C\u6574\u7684INSERT\u8BED\u53E5\u3002

--debug[=debug_options], -#[debug_options]\uFF1A\u5199\u8C03\u8BD5\u65E5\u5FD7\u3002

--delete\uFF0C-D\uFF1A\u5BFC\u5165\u6587\u672C\u6587\u4EF6\u524D\u6E05\u7A7A\u8868\u3002

--default-character-set=charset\uFF1A\u4F7F\u7528charsets\u9ED8\u8BA4\u5B57\u7B26\u96C6\u3002\u5982\u679C\u6CA1\u6709\u6307\u5B9A\uFF0C\u5C31\u4F7F\u7528utf8\u3002

--delete--master-logs\uFF1A\u5728\u4E3B\u590D\u5236\u670D\u52A1\u5668\u4E0A\uFF0C\u5B8C\u6210\u8F6C\u50A8\u64CD\u4F5C\u540E\u5220\u9664\u4E8C\u8FDB\u5236\u65E5\u5FD7\u3002\u8BE5\u9009\u9879\u81EA\u52A8\u542F\u7528-masterdata\u3002

--extended-insert\uFF0C-e\uFF1A\u4F7F\u7528\u5305\u62EC\u51E0\u4E2AVALUES\u5217\u8868\u7684\u591A\u884CINSERT\u8BED\u6CD5\u3002\u8FD9\u6837\u4F7F\u5F97\u8F6C\u50A8\u6587\u4EF6\u66F4\u5C0F\uFF0C\u91CD\u8F7D\u6587\u4EF6\u65F6\u53EF\u4EE5\u52A0\u901F\u63D2\u5165\u3002

--flush-logs\uFF0C-F\uFF1A\u5F00\u59CB\u8F6C\u50A8\u524D\u5237\u65B0MySQL\u670D\u52A1\u5668\u65E5\u5FD7\u6587\u4EF6\u3002\u8BE5\u9009\u9879\u8981\u6C42RELOAD\u6743\u9650\u3002

--force\uFF0C-f\uFF1A\u5728\u8868\u8F6C\u50A8\u8FC7\u7A0B\u4E2D\uFF0C\u5373\u4F7F\u51FA\u73B0SQL\u9519\u8BEF\u4E5F\u7EE7\u7EED\u3002

--lock-all-tables\uFF0C-x\uFF1A\u5BF9\u6240\u6709\u6570\u636E\u5E93\u4E2D\u7684\u6240\u6709\u8868\u52A0\u9501\u3002\u5728\u6574\u4F53\u8F6C\u50A8\u8FC7\u7A0B\u4E2D\u901A\u8FC7\u5168\u5C40\u9501\u5B9A\u6765\u5B9E\u73B0\u3002\u8BE5\u9009\u9879\u81EA\u52A8\u5173\u95ED--single-transaction\u548C--lock-tables\u3002

--lock-tables\uFF0C-l\uFF1A\u5F00\u59CB\u8F6C\u50A8\u524D\u9501\u5B9A\u6240\u6709\u8868\u3002\u7528READ LOCAL\u9501\u5B9A\u8868\u4EE5\u5141\u8BB8\u5E76\u884C\u63D2\u5165MyISAM\u8868\u3002\u5BF9\u4E8E\u4E8B\u52A1\u8868\uFF08\u4F8B\u5982InnoDB\u548CBDB\uFF09\uFF0C--single-transaction\u662F\u4E00\u4E2A\u66F4\u597D\u7684\u9009\u9879\uFF0C\u56E0\u4E3A\u5B83\u6839\u672C\u4E0D\u9700\u8981\u9501\u5B9A\u8868\u3002

--no-create-db\uFF0C-n\uFF1A\u8BE5\u9009\u9879\u7981\u7528CREATE DATABASE /*!32312 IF NOT EXIST*/db_name\u8BED\u53E5\uFF0C\u5982\u679C\u7ED9\u51FA--database\u6216--all-database\u9009\u9879\uFF0C\u5C31\u5305\u542B\u5230\u8F93\u51FA\u4E2D\u3002

--no-create-info\uFF0C-t\uFF1A\u53EA\u5BFC\u51FA\u6570\u636E\uFF0C\u800C\u4E0D\u6DFB\u52A0CREATE TABLE\u8BED\u53E5\u3002

--no-data\uFF0C-d\uFF1A\u4E0D\u5199\u8868\u7684\u4EFB\u4F55\u884C\u4FE1\u606F\uFF0C\u53EA\u8F6C\u50A8\u8868\u7684\u7ED3\u6784\u3002

--opt\uFF1A\u8BE5\u9009\u9879\u662F\u901F\u8BB0\uFF0C\u5B83\u53EF\u4EE5\u5FEB\u901F\u8FDB\u884C\u8F6C\u50A8\u64CD\u4F5C\u5E76\u4EA7\u751F\u4E00\u4E2A\u80FD\u5F88\u5FEB\u88C5\u5165MySQL\u670D\u52A1\u5668\u7684\u8F6C\u50A8\u6587\u4EF6\u3002\u8BE5\u9009\u9879\u9ED8\u8BA4\u5F00\u542F\uFF0C\u4F46\u53EF\u4EE5\u7528--skip-opt\u7981\u7528\u3002

--password[=password]\uFF0C-p[password]\uFF1A\u5F53\u8FDE\u63A5\u670D\u52A1\u5668\u65F6\u4F7F\u7528\u7684\u5BC6\u7801\u3002

-port=port_num\uFF0C-P port_num\uFF1A\u7528\u4E8E\u8FDE\u63A5\u7684TCP/IP\u7AEF\u53E3\u53F7\u3002

--protocol={TCP|SOCKET|PIPE|MEMORY}\uFF1A\u4F7F\u7528\u7684\u8FDE\u63A5\u534F\u8BAE\u3002

--replace\uFF0C-r \u2013replace\u548C--ignore\uFF1A\u63A7\u5236\u66FF\u6362\u6216\u590D\u5236\u552F\u4E00\u952E\u503C\u5DF2\u6709\u8BB0\u5F55\u7684\u8F93\u5165\u8BB0\u5F55\u7684\u5904\u7406\u3002\u5982\u679C\u6307\u5B9A--replace\uFF0C\u65B0\u884C\u66FF\u6362\u6709\u76F8\u540C\u7684\u552F\u4E00\u952E\u503C\u7684\u5DF2\u6709\u884C\uFF1B\u5982\u679C\u6307\u5B9A--ignore\uFF0C\u590D\u5236\u5DF2\u6709\u7684\u552F\u4E00\u952E\u503C\u7684\u8F93\u5165\u884C\u88AB\u8DF3\u8FC7\u3002\u5982\u679C\u4E0D\u6307\u5B9A\u8FD9\u4E24\u4E2A\u9009\u9879\uFF0C\u5F53\u53D1\u73B0\u4E00\u4E2A\u590D\u5236\u952E\u503C\u65F6\u4F1A\u51FA\u73B0\u4E00\u4E2A\u9519\u8BEF\uFF0C\u5E76\u4E14\u5FFD\u89C6\u6587\u672C\u6587\u4EF6\u7684\u5269\u4F59\u90E8\u5206\u3002

--silent\uFF0C-s\uFF1A\u6C89\u9ED8\u6A21\u5F0F\u3002\u53EA\u6709\u51FA\u73B0\u9519\u8BEF\u65F6\u624D\u8F93\u51FA\u3002

--socket=path\uFF0C-S path\uFF1A\u5F53\u8FDE\u63A5localhost\u65F6\u4F7F\u7528\u7684\u5957\u63A5\u5B57\u6587\u4EF6\uFF08\u4E3A\u9ED8\u8BA4\u4E3B\u673A\uFF09\u3002

--user=user_name\uFF0C-u user_name\uFF1A\u5F53\u8FDE\u63A5\u670D\u52A1\u5668\u65F6MySQL\u4F7F\u7528\u7684\u7528\u6237\u540D\u3002

--verbose\uFF0C-v\uFF1A\u5197\u957F\u6A21\u5F0F\uFF0C\u6253\u5370\u51FA\u7A0B\u5E8F\u64CD\u4F5C\u7684\u8BE6\u7EC6\u4FE1\u606F\u3002

--xml\uFF0C-X\uFF1A\u4EA7\u751FXML\u8F93\u51FA\u3002
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD0\u884C\u5E2E\u52A9\u547D\u4EE4 <code>mysqldump --help</code> \uFF0C\u53EF\u4EE5\u83B7\u5F97\u7279\u5B9A\u7248\u672C\u7684\u5B8C\u6574\u9009\u9879\u5217\u8868\u3002</p><blockquote><p>\u63D0\u793A \u5982\u679C\u8FD0\u884Cmysqldump\u6CA1\u6709--quick\u6216--opt\u9009\u9879\uFF0Cmysqldump\u5728\u8F6C\u50A8\u7ED3\u679C\u524D\u5C06\u6574\u4E2A\u7ED3\u679C\u96C6\u88C5\u5165\u5185 \u5B58\u3002\u5982\u679C\u8F6C\u50A8\u5927\u6570\u636E\u5E93\u53EF\u80FD\u4F1A\u51FA\u73B0\u95EE\u9898\uFF0C\u8BE5\u9009\u9879\u9ED8\u8BA4\u542F\u7528\uFF0C\u4F46\u53EF\u4EE5\u7528--skip-opt\u7981\u7528\u3002\u5982\u679C\u4F7F\u7528\u6700 \u65B0\u7248\u672C\u7684mysqldump\u7A0B\u5E8F\u5907\u4EFD\u6570\u636E\uFF0C\u5E76\u7528\u4E8E\u6062\u590D\u5230\u6BD4\u8F83\u65E7\u7248\u672C\u7684MySQL\u670D\u52A1\u5668\u4E2D\uFF0C\u5219\u4E0D\u8981\u4F7F\u7528--opt \u6216-e\u9009\u9879\u3002</p></blockquote><h3 id="_3-mysql\u547D\u4EE4\u6062\u590D\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#_3-mysql\u547D\u4EE4\u6062\u590D\u6570\u636E" aria-hidden="true">#</a> 3. mysql\u547D\u4EE4\u6062\u590D\u6570\u636E</h3><p>\u4F7F\u7528mysqldump\u547D\u4EE4\u5C06\u6570\u636E\u5E93\u4E2D\u7684\u6570\u636E\u5907\u4EFD\u6210\u4E00\u4E2A\u6587\u672C\u6587\u4EF6\u3002\u9700\u8981\u6062\u590D\u65F6\uFF0C\u53EF\u4EE5\u4F7F\u7528<code>mysql\u547D\u4EE4</code>\u6765\u6062\u590D\u5907\u4EFD\u7684\u6570\u636E\u3002</p><p>mysql\u547D\u4EE4\u53EF\u4EE5\u6267\u884C\u5907\u4EFD\u6587\u4EF6\u4E2D\u7684<code>CREATE\u8BED\u53E5</code>\u548C<code>INSERT\u8BED\u53E5</code>\u3002\u901A\u8FC7CREATE\u8BED\u53E5\u6765\u521B\u5EFA\u6570\u636E\u5E93\u548C\u8868\u3002\u901A\u8FC7INSERT\u8BED\u53E5\u6765\u63D2\u5165\u5907\u4EFD\u7684\u6570\u636E\u3002</p><p>\u57FA\u672C\u8BED\u6CD5\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql \u2013u root \u2013p [dbname] &lt; backup.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5176\u4E2D\uFF0Cdbname\u53C2\u6570\u8868\u793A\u6570\u636E\u5E93\u540D\u79F0\u3002\u8BE5\u53C2\u6570\u662F\u53EF\u9009\u53C2\u6570\uFF0C\u53EF\u4EE5\u6307\u5B9A\u6570\u636E\u5E93\u540D\uFF0C\u4E5F\u53EF\u4EE5\u4E0D\u6307\u5B9A\u3002\u6307\u5B9A\u6570\u636E\u5E93\u540D\u65F6\uFF0C\u8868\u793A\u8FD8\u539F\u8BE5\u6570\u636E\u5E93\u4E0B\u7684\u8868\u3002\u6B64\u65F6\u9700\u8981\u786E\u4FDDMySQL\u670D\u52A1\u5668\u4E2D\u5DF2\u7ECF\u521B\u5EFA\u4E86\u8BE5\u540D\u7684\u6570\u636E\u5E93\u3002\u4E0D\u6307\u5B9A\u6570\u636E\u5E93\u540D\uFF0C\u8868\u793A\u8FD8\u539F\u6587\u4EF6\u4E2D\u6240\u6709\u7684\u6570\u636E\u5E93\u3002\u6B64\u65F6sql\u6587\u4EF6\u4E2D\u5305\u542B\u6709CREATE DATABASE\u8BED\u53E5\uFF0C\u4E0D\u9700\u8981MySQL\u670D\u52A1\u5668\u4E2D\u5DF2\u5B58\u5728\u7684\u8FD9\u4E9B\u6570\u636E\u5E93\u3002</p><h5 id="_3-1-\u5355\u5E93\u5907\u4EFD\u4E2D\u6062\u590D\u5355\u5E93" tabindex="-1"><a class="header-anchor" href="#_3-1-\u5355\u5E93\u5907\u4EFD\u4E2D\u6062\u590D\u5355\u5E93" aria-hidden="true">#</a> 3.1 \u5355\u5E93\u5907\u4EFD\u4E2D\u6062\u590D\u5355\u5E93</h5><p>\u4F7F\u7528root\u7528\u6237\uFF0C\u5C06\u4E4B\u524D\u7EC3\u4E60\u4E2D\u5907\u4EFD\u7684atguigu.sql\u6587\u4EF6\u4E2D\u7684\u5907\u4EFD\u5BFC\u5165\u6570\u636E\u5E93\u4E2D\uFF0C\u547D\u4EE4\u5982\u4E0B\uFF1A</p><p>\u5982\u679C\u5907\u4EFD\u6587\u4EF6\u4E2D\u5305\u542B\u4E86\u521B\u5EFA\u6570\u636E\u5E93\u7684\u8BED\u53E5\uFF0C\u5219\u6062\u590D\u7684\u65F6\u5019\u4E0D\u9700\u8981\u6307\u5B9A\u6570\u636E\u5E93\u540D\u79F0\uFF0C\u5982\u4E0B\u6240\u793A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql -uroot -p &lt; atguigu.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5426\u5219\u9700\u8981\u6307\u5B9A\u6570\u636E\u5E93\u540D\u79F0\uFF0C\u5982\u4E0B\u6240\u793A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql -uroot -p atguigu4&lt; atguigu.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="_3-2-\u5168\u91CF\u5907\u4EFD\u6062\u590D" tabindex="-1"><a class="header-anchor" href="#_3-2-\u5168\u91CF\u5907\u4EFD\u6062\u590D" aria-hidden="true">#</a> 3.2 \u5168\u91CF\u5907\u4EFD\u6062\u590D</h5><p>\u5982\u679C\u6211\u4EEC\u73B0\u5728\u6709\u6628\u5929\u7684\u5168\u91CF\u5907\u4EFD\uFF0C\u73B0\u5728\u60F3\u6574\u4E2A\u6062\u590D\uFF0C\u5219\u53EF\u4EE5\u8FD9\u6837\u64CD\u4F5C\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql \u2013u root \u2013p &lt; all.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql -uroot -pxxxxxx &lt; all.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6267\u884C\u5B8C\u540E\uFF0CMySQL\u6570\u636E\u5E93\u4E2D\u5C31\u5DF2\u7ECF\u6062\u590D\u4E86all.sql\u6587\u4EF6\u4E2D\u7684\u6240\u6709\u6570\u636E\u5E93\u3002</p><h5 id="_3-3-\u5168\u91CF\u5907\u4EFD\u6062\u590D" tabindex="-1"><a class="header-anchor" href="#_3-3-\u5168\u91CF\u5907\u4EFD\u6062\u590D" aria-hidden="true">#</a> 3.3 \u5168\u91CF\u5907\u4EFD\u6062\u590D</h5><p>\u53EF\u80FD\u6709\u8FD9\u6837\u7684\u9700\u6C42\uFF0C\u6BD4\u5982\u8BF4\u6211\u4EEC\u53EA\u60F3\u6062\u590D\u67D0\u4E00\u4E2A\u5E93\uFF0C\u4F46\u662F\u6211\u4EEC\u6709\u7684\u662F\u6574\u4E2A\u5B9E\u4F8B\u7684\u5907\u4EFD\uFF0C\u8FD9\u4E2A\u65F6\u5019\u6211\u4EEC\u53EF\u4EE5\u4ECE\u5168\u91CF\u5907\u4EFD\u4E2D\u5206\u79BB\u51FA\u5355\u4E2A\u5E93\u7684\u5907\u4EFD\u3002</p><p>\u4E3E\u4F8B\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>sed -n &#39;/^-- Current Database: \`atguigu\`/,/^-- Current Database: \`/p&#39; all_database.sql &gt; atguigu.sql
#\u5206\u79BB\u5B8C\u6210\u540E\u6211\u4EEC\u518D\u5BFC\u5165atguigu.sql\u5373\u53EF\u6062\u590D\u5355\u4E2A\u5E93
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="_3-4-\u4ECE\u5355\u5E93\u5907\u4EFD\u4E2D\u6062\u590D\u5355\u8868" tabindex="-1"><a class="header-anchor" href="#_3-4-\u4ECE\u5355\u5E93\u5907\u4EFD\u4E2D\u6062\u590D\u5355\u8868" aria-hidden="true">#</a> 3.4 \u4ECE\u5355\u5E93\u5907\u4EFD\u4E2D\u6062\u590D\u5355\u8868</h5><p>\u8FD9\u4E2A\u9700\u6C42\u8FD8\u662F\u6BD4\u8F83\u5E38\u89C1\u7684\u3002\u6BD4\u5982\u8BF4\u6211\u4EEC\u77E5\u9053\u54EA\u4E2A\u8868\u8BEF\u64CD\u4F5C\u4E86\uFF0C\u90A3\u4E48\u5C31\u53EF\u4EE5\u7528\u5355\u8868\u6062\u590D\u7684\u65B9\u5F0F\u6765\u6062\u590D\u3002</p><p>\u4E3E\u4F8B\uFF1A\u6211\u4EEC\u6709atguigu\u6574\u5E93\u7684\u5907\u4EFD\uFF0C\u4F46\u662F\u7531\u4E8Eclass\u8868\u8BEF\u64CD\u4F5C\uFF0C\u9700\u8981\u5355\u72EC\u6062\u590D\u51FA\u8FD9\u5F20\u8868\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>cat atguigu.sql | sed -e &#39;/./{H;$!d;}&#39; -e &#39;x;/CREATE TABLE \`class\`/!d;q&#39; &gt; class_structure.sql
cat atguigu.sql | grep --ignore-case &#39;insert into \`class\`&#39; &gt; class_data.sql
#\u7528shell\u8BED\u6CD5\u5206\u79BB\u51FA\u521B\u5EFA\u8868\u7684\u8BED\u53E5\u53CA\u63D2\u5165\u6570\u636E\u7684\u8BED\u53E5\u540E \u518D\u4F9D\u6B21\u5BFC\u51FA\u5373\u53EF\u5B8C\u6210\u6062\u590D

use atguigu;
mysql&gt; source class_structure.sql;
Query OK, 0 rows affected, 1 warning (0.00 sec)

mysql&gt; source class_data.sql;
Query OK, 1 row affected (0.01 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-\u7269\u7406\u5907\u4EFD-\u76F4\u63A5\u590D\u5236\u6574\u4E2A\u6570\u636E\u5E93" tabindex="-1"><a class="header-anchor" href="#_4-\u7269\u7406\u5907\u4EFD-\u76F4\u63A5\u590D\u5236\u6574\u4E2A\u6570\u636E\u5E93" aria-hidden="true">#</a> 4. \u7269\u7406\u5907\u4EFD\uFF1A\u76F4\u63A5\u590D\u5236\u6574\u4E2A\u6570\u636E\u5E93</h3><p>\u76F4\u63A5\u5C06MySQL\u4E2D\u7684\u6570\u636E\u5E93\u6587\u4EF6\u590D\u5236\u51FA\u6765\u3002\u8FD9\u79CD\u65B9\u6CD5\u6700\u7B80\u5355\uFF0C\u901F\u5EA6\u4E5F\u6700\u5FEB\u3002MySQL\u7684\u6570\u636E\u5E93\u76EE\u5F55\u4F4D\u7F6E\u4E0D\u4E00 \u5B9A\u76F8\u540C\uFF1A</p><ul><li>\u5728Windows\u5E73\u53F0\u4E0B\uFF0CMySQL 8.0\u5B58\u653E\u6570\u636E\u5E93\u7684\u76EE\u5F55\u901A\u5E38\u9ED8\u8BA4\u4E3A \u201C C:\\ProgramData\\MySQL\\MySQL Server 8.0\\Data \u201D\u6216\u8005\u5176\u4ED6\u7528\u6237\u81EA\u5B9A\u4E49\u76EE\u5F55\uFF1B</li><li>\u5728Linux\u5E73\u53F0\u4E0B\uFF0C\u6570\u636E\u5E93\u76EE\u5F55\u4F4D\u7F6E\u901A\u5E38\u4E3A/var/lib/mysql/\uFF1B</li><li>\u5728MAC OSX\u5E73\u53F0\u4E0B\uFF0C\u6570\u636E\u5E93\u76EE\u5F55\u4F4D\u7F6E\u901A\u5E38\u4E3A\u201C/usr/local/mysql/data\u201D</li></ul><p>\u4F46\u4E3A\u4E86\u4FDD\u8BC1\u5907\u4EFD\u7684\u4E00\u81F4\u6027\u3002\u9700\u8981\u4FDD\u8BC1\uFF1A</p><ul><li>\u65B9\u5F0F1\uFF1A\u5907\u4EFD\u524D\uFF0C\u5C06\u670D\u52A1\u5668\u505C\u6B62\u3002</li><li>\u65B9\u5F0F2\uFF1A\u5907\u4EFD\u524D\uFF0C\u5BF9\u76F8\u5173\u8868\u6267\u884C FLUSH TABLES WITH READ LOCK \u64CD\u4F5C\u3002\u8FD9\u6837\u5F53\u590D\u5236\u6570\u636E\u5E93\u76EE\u5F55\u4E2D \u7684\u6587\u4EF6\u65F6\uFF0C\u5141\u8BB8\u5176\u4ED6\u5BA2\u6237\u7EE7\u7EED\u67E5\u8BE2\u8868\u3002\u540C\u65F6\uFF0CFLUSH TABLES\u8BED\u53E5\u6765\u786E\u4FDD\u5F00\u59CB\u5907\u4EFD\u524D\u5C06\u6240\u6709\u6FC0\u6D3B\u7684\u7D22 \u5F15\u9875\u5199\u5165\u786C\u76D8\u3002</li></ul><p>\u8FD9\u79CD\u65B9\u5F0F\u65B9\u4FBF\u3001\u5FEB\u901F\uFF0C\u4F46\u4E0D\u662F\u6700\u597D\u7684\u5907\u4EFD\u65B9\u6CD5\uFF0C\u56E0\u4E3A\u5B9E\u9645\u60C5\u51B5\u53EF\u80FD <code>\u4E0D\u5141\u8BB8\u505C\u6B62MySQL\u670D\u52A1\u5668</code> \u6216\u8005 <code>\u9501\u4F4F\u8868</code> \uFF0C\u800C\u4E14\u8FD9\u79CD\u65B9\u6CD5 \u5BF9InnoDB\u5B58\u50A8\u5F15\u64CE \u7684\u8868\u4E0D\u9002\u7528\u3002\u5BF9\u4E8EMyISAM\u5B58\u50A8\u5F15\u64CE\u7684\u8868\uFF0C\u8FD9\u6837\u5907\u4EFD\u548C\u8FD8\u539F\u5F88\u65B9\u4FBF\uFF0C\u4F46\u662F\u8FD8\u539F\u65F6\u6700\u597D\u662F\u76F8\u540C\u7248\u672C\u7684MySQL\u6570\u636E\u5E93\uFF0C\u5426\u5219\u53EF\u80FD\u4F1A\u5B58\u5728\u6587\u4EF6\u7C7B\u578B\u4E0D\u540C\u7684\u60C5\u51B5\u3002</p><p>\u6CE8\u610F\uFF0C\u7269\u7406\u5907\u4EFD\u5B8C\u6BD5\u540E\uFF0C\u6267\u884C UNLOCK TABLES \u6765\u7ED3\u7B97\u5176\u4ED6\u5BA2\u6237\u5BF9\u8868\u7684\u4FEE\u6539\u884C\u4E3A\u3002</p><blockquote><p>\u8BF4\u660E\uFF1A \u5728MySQL\u7248\u672C\u53F7\u4E2D\uFF0C\u7B2C\u4E00\u4E2A\u6570\u5B57\u8868\u793A\u4E3B\u7248\u672C\u53F7\uFF0C\u4E3B\u7248\u672C\u53F7\u76F8\u540C\u7684MySQL\u6570\u636E\u5E93\u6587\u4EF6\u683C\u5F0F\u76F8\u540C\u3002</p></blockquote><p>\u6B64\u5916\uFF0C\u8FD8\u53EF\u4EE5\u8003\u8651\u4F7F\u7528\u76F8\u5173\u5DE5\u5177\u5B9E\u73B0\u5907\u4EFD\u3002\u6BD4\u5982\uFF0C <code>MySQLhotcopy</code> \u5DE5\u5177\u3002MySQLhotcopy\u662F\u4E00\u4E2APerl\u811A\u672C\uFF0C\u5B83\u4F7F\u7528LOCK TABLES\u3001FLUSH TABLES\u548Ccp\u6216scp\u6765\u5FEB\u901F\u5907\u4EFD\u6570\u636E\u5E93\u3002\u5B83\u662F\u5907\u4EFD\u6570\u636E\u5E93\u6216\u5355\u4E2A\u8868\u6700\u5FEB\u7684\u9014\u5F84\uFF0C\u4F46\u5B83\u53EA\u80FD\u8FD0\u884C\u5728\u6570\u636E\u5E93\u76EE\u5F55\u6240\u5728\u7684\u673A\u5668\u4E0A\uFF0C\u5E76\u4E14\u53EA\u80FD\u5907\u4EFDMyISAM\u7C7B\u578B\u7684\u8868\u3002\u591A\u7528\u4E8Emysql5.5\u4E4B\u524D\u3002</p><h3 id="_5-\u7269\u7406\u6062\u590D-\u76F4\u63A5\u590D\u5236\u5230\u6570\u636E\u5E93\u76EE\u5F55" tabindex="-1"><a class="header-anchor" href="#_5-\u7269\u7406\u6062\u590D-\u76F4\u63A5\u590D\u5236\u5230\u6570\u636E\u5E93\u76EE\u5F55" aria-hidden="true">#</a> 5. \u7269\u7406\u6062\u590D\uFF1A\u76F4\u63A5\u590D\u5236\u5230\u6570\u636E\u5E93\u76EE\u5F55</h3><p><strong>\u6B65\u9AA4\uFF1A</strong></p><p>1\uFF09\u6F14\u793A\u5220\u9664\u5907\u4EFD\u7684\u6570\u636E\u5E93\u4E2D\u6307\u5B9A\u8868\u7684\u6570\u636E</p><p>2\uFF09\u5C06\u5907\u4EFD\u7684\u6570\u636E\u5E93\u6570\u636E\u62F7\u8D1D\u5230\u6570\u636E\u76EE\u5F55\u4E0B\uFF0C\u5E76\u91CD\u542FMySQL\u670D\u52A1\u5668</p><p>3\uFF09\u67E5\u8BE2\u76F8\u5173\u8868\u7684\u6570\u636E\u662F\u5426\u6062\u590D\u3002\u9700\u8981\u4F7F\u7528\u4E0B\u9762\u7684<code> chown</code> \u64CD\u4F5C\u3002</p><p><strong>\u8981\u6C42\uFF1A</strong></p><ul><li>\u5FC5\u987B\u786E\u4FDD\u5907\u4EFD\u6570\u636E\u7684\u6570\u636E\u5E93\u548C\u5F85\u6062\u590D\u7684\u6570\u636E\u5E93\u670D\u52A1\u5668\u7684\u4E3B\u7248\u672C\u53F7\u76F8\u540C\u3002 <ul><li>\u56E0\u4E3A\u53EA\u6709MySQL\u6570\u636E\u5E93\u4E3B\u7248\u672C\u53F7\u76F8\u540C\u65F6\uFF0C\u624D\u80FD\u4FDD\u8BC1\u8FD9\u4E24\u4E2AMySQL\u6570\u636E\u5E93\u6587\u4EF6\u7C7B\u578B\u662F\u76F8\u540C\u7684\u3002</li></ul></li><li>\u8FD9\u79CD\u65B9\u5F0F\u5BF9 <code>MyISAM\u7C7B\u578B\u7684\u8868\u6BD4\u8F83\u6709\u6548</code> \uFF0C\u5BF9\u4E8EInnoDB\u7C7B\u578B\u7684\u8868\u5219\u4E0D\u53EF\u7528\u3002 <ul><li>\u56E0\u4E3AInnoDB\u8868\u7684\u8868\u7A7A\u95F4\u4E0D\u80FD\u76F4\u63A5\u590D\u5236\u3002</li></ul></li><li>\u5728Linux\u64CD\u4F5C\u7CFB\u7EDF\u4E0B\uFF0C\u590D\u5236\u5230\u6570\u636E\u5E93\u76EE\u5F55\u540E\uFF0C\u4E00\u5B9A\u8981\u5C06\u6570\u636E\u5E93\u7684\u7528\u6237\u548C\u7EC4\u53D8\u6210mysql\uFF0C\u547D\u4EE4\u5982\u4E0B\uFF1A</li></ul><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>chown -R mysql.mysql /var/lib/mysql/dbname
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5176\u4E2D\uFF0C\u4E24\u4E2Amysql\u5206\u522B\u8868\u793A\u7EC4\u548C\u7528\u6237\uFF1B\u201C-R\u201D\u53C2\u6570\u53EF\u4EE5\u6539\u53D8\u6587\u4EF6\u5939\u4E0B\u7684\u6240\u6709\u5B50\u6587\u4EF6\u7684\u7528\u6237\u548C\u7EC4\uFF1B\u201Cdbname\u201D\u53C2\u6570\u8868\u793A\u6570\u636E\u5E93\u76EE\u5F55\u3002</p><blockquote><p>\u63D0\u793A Linux\u64CD\u4F5C\u7CFB\u7EDF\u4E0B\u7684\u6743\u9650\u8BBE\u7F6E\u975E\u5E38\u4E25\u683C\u3002\u901A\u5E38\u60C5\u51B5\u4E0B\uFF0CMySQL\u6570\u636E\u5E93\u53EA\u6709root\u7528\u6237\u548Cmysql\u7528\u6237 \u7EC4\u4E0B\u7684mysql\u7528\u6237\u624D\u53EF\u4EE5\u8BBF\u95EE\uFF0C\u56E0\u6B64\u5C06\u6570\u636E\u5E93\u76EE\u5F55\u590D\u5236\u5230\u6307\u5B9A\u6587\u4EF6\u5939\u540E\uFF0C\u4E00\u5B9A\u8981\u4F7F\u7528chown\u547D\u4EE4\u5C06 \u6587\u4EF6\u5939\u7684\u7528\u6237\u7EC4\u53D8\u4E3Amysql\uFF0C\u5C06\u7528\u6237\u53D8\u4E3Amysql\u3002</p></blockquote><h3 id="_6-\u8868\u7684\u5BFC\u51FA\u4E0E\u5BFC\u5165" tabindex="-1"><a class="header-anchor" href="#_6-\u8868\u7684\u5BFC\u51FA\u4E0E\u5BFC\u5165" aria-hidden="true">#</a> 6. \u8868\u7684\u5BFC\u51FA\u4E0E\u5BFC\u5165</h3><h5 id="_6-1-\u8868\u7684\u5BFC\u51FA" tabindex="-1"><a class="header-anchor" href="#_6-1-\u8868\u7684\u5BFC\u51FA" aria-hidden="true">#</a> 6.1 \u8868\u7684\u5BFC\u51FA</h5><h6 id="_1-\u4F7F\u7528select-into-outfile\u5BFC\u51FA\u6587\u672C\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_1-\u4F7F\u7528select-into-outfile\u5BFC\u51FA\u6587\u672C\u6587\u4EF6" aria-hidden="true">#</a> 1. \u4F7F\u7528SELECT\u2026INTO OUTFILE\u5BFC\u51FA\u6587\u672C\u6587\u4EF6</h6><p>\u5728MySQL\u4E2D\uFF0C\u53EF\u4EE5\u4F7F\u7528SELECT\u2026INTO OUTFILE\u8BED\u53E5\u5C06\u8868\u7684\u5185\u5BB9\u5BFC\u51FA\u6210\u4E00\u4E2A\u6587\u672C\u6587\u4EF6\u3002</p><p>**\u4E3E\u4F8B\uFF1A**\u4F7F\u7528SELECT\u2026INTO OUTFILE\u5C06atguigu\u6570\u636E\u5E93\u4E2Daccount\u8868\u4E2D\u7684\u8BB0\u5F55\u5BFC\u51FA\u5230\u6587\u672C\u6587\u4EF6\u3002</p><p>\uFF081\uFF09\u9009\u62E9\u6570\u636E\u5E93atguigu\uFF0C\u5E76\u67E5\u8BE2account\u8868\uFF0C\u6267\u884C\u7ED3\u679C\u5982\u4E0B\u6240\u793A\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>use atguigu;
select * from account;
mysql&gt; select * from account;
+----+--------+---------+
| id | name | balance |
+----+--------+---------+
| 1 | \u5F20\u4E09 | 90 |
| 2 | \u674E\u56DB | 100 |
| 3 | \u738B\u4E94 | 0 |
+----+--------+---------+
3 rows in set (0.01 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\uFF082\uFF09mysql\u9ED8\u8BA4\u5BF9\u5BFC\u51FA\u7684\u76EE\u5F55\u6709\u6743\u9650\u9650\u5236\uFF0C\u4E5F\u5C31\u662F\u8BF4\u4F7F\u7528\u547D\u4EE4\u884C\u8FDB\u884C\u5BFC\u51FA\u7684\u65F6\u5019\uFF0C\u9700\u8981\u6307\u5B9A\u76EE\u5F55\u8FDB\u884C\u64CD\u4F5C\u3002</p><p>\u67E5\u8BE2secure_file_priv\u503C\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql&gt; SHOW GLOBAL VARIABLES LIKE &#39;%secure%&#39;;
+--------------------------+-----------------------+
| Variable_name            | Value                 |
+--------------------------+-----------------------+
| require_secure_transport | OFF                   |
| secure_file_priv         | /var/lib/mysql-files/ |
+--------------------------+-----------------------+
2 rows in set (0.02 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718163627669.png" alt="image-20220718163627669" style="float:left;"><p>\uFF083\uFF09\u4E0A\u9762\u7ED3\u679C\u4E2D\u663E\u793A\uFF0Csecure_file_priv\u53D8\u91CF\u7684\u503C\u4E3A/var/lib/mysql-files/\uFF0C\u5BFC\u51FA\u76EE\u5F55\u8BBE\u7F6E\u4E3A\u8BE5\u76EE\u5F55\uFF0CSQL\u8BED\u53E5\u5982\u4E0B\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SELECT * FROM account INTO OUTFILE &quot;/var/lib/mysql-files/account.txt&quot;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\uFF084\uFF09\u67E5\u770B /var/lib/mysql-files/account.txt\`\u6587\u4EF6\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>1 \u5F20\u4E09 90
2 \u674E\u56DB 100
3 \u738B\u4E94 0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_2-\u4F7F\u7528mysqldump\u547D\u4EE4\u5BFC\u51FA\u6587\u672C\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_2-\u4F7F\u7528mysqldump\u547D\u4EE4\u5BFC\u51FA\u6587\u672C\u6587\u4EF6" aria-hidden="true">#</a> 2. \u4F7F\u7528mysqldump\u547D\u4EE4\u5BFC\u51FA\u6587\u672C\u6587\u4EF6</h6><p>**\u4E3E\u4F8B1\uFF1A**\u4F7F\u7528mysqldump\u547D\u4EE4\u5C06\u5C06atguigu\u6570\u636E\u5E93\u4E2Daccount\u8868\u4E2D\u7684\u8BB0\u5F55\u5BFC\u51FA\u5230\u6587\u672C\u6587\u4EF6\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump -uroot -p -T &quot;/var/lib/mysql-files/&quot; atguigu account
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>mysqldump\u547D\u4EE4\u6267\u884C\u5B8C\u6BD5\u540E\uFF0C\u5728\u6307\u5B9A\u7684\u76EE\u5F55/var/lib/mysql-files/\u4E0B\u751F\u6210\u4E86account.sql\u548Caccount.txt\u6587\u4EF6\u3002</p><p>\u6253\u5F00account.sql\u6587\u4EF6\uFF0C\u5176\u5185\u5BB9\u5305\u542B\u521B\u5EFAaccount\u8868\u7684CREATE\u8BED\u53E5\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>[root@node1 mysql-files]# cat account.sql
-- MySQL dump 10.13 Distrib 8.0.26, for Linux (x86_64)
--
-- Host: localhost Database: atguigu
-- ------------------------------------------------------
-- Server version 8.0.26
/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!50503 SET NAMES utf8mb4 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE=&#39;+00:00&#39; */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=&#39;&#39; */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table \`account\`
--

DROP TABLE IF EXISTS \`account\`;
/*!40101 SET @saved_cs_client = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE \`account\` (
\`id\` int NOT NULL AUTO_INCREMENT,
\`name\` varchar(255) NOT NULL,
\`balance\` int NOT NULL,
PRIMARY KEY (\`id\`)
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8mb3;
/*!40101 SET character_set_client = @saved_cs_client */;

/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2022-01-07 23:19:27
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6253\u5F00account.txt\u6587\u4EF6\uFF0C\u5176\u5185\u5BB9\u53EA\u5305\u542Baccount\u8868\u4E2D\u7684\u6570\u636E\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>[root@node1 mysql-files]# cat account.txt
1 \u5F20\u4E09 90
2 \u674E\u56DB 100
3 \u738B\u4E94 0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>**\u4E3E\u4F8B2\uFF1A**\u4F7F\u7528mysqldump\u5C06atguigu\u6570\u636E\u5E93\u4E2D\u7684account\u8868\u5BFC\u51FA\u5230\u6587\u672C\u6587\u4EF6\uFF0C\u4F7F\u7528FIELDS\u9009\u9879\uFF0C\u8981\u6C42\u5B57\u6BB5\u4E4B \u95F4\u4F7F\u7528\u9017\u53F7\u201C\uFF0C\u201D\u95F4\u9694\uFF0C\u6240\u6709\u5B57\u7B26\u7C7B\u578B\u5B57\u6BB5\u503C\u7528\u53CC\u5F15\u53F7\u62EC\u8D77\u6765\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqldump -uroot -p -T &quot;/var/lib/mysql-files/&quot; atguigu account --fields-terminatedby=&#39;,&#39; --fields-optionally-enclosed-by=&#39;\\&quot;&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8BED\u53E5mysqldump\u8BED\u53E5\u6267\u884C\u6210\u529F\u4E4B\u540E\uFF0C\u6307\u5B9A\u76EE\u5F55\u4E0B\u4F1A\u51FA\u73B0\u4E24\u4E2A\u6587\u4EF6account.sql\u548Caccount.txt\u3002</p><p>\u6253\u5F00account.sql\u6587\u4EF6\uFF0C\u5176\u5185\u5BB9\u5305\u542B\u521B\u5EFAaccount\u8868\u7684CREATE\u8BED\u53E5\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>[root@node1 mysql-files]# cat account.sql
-- MySQL dump 10.13 Distrib 8.0.26, for Linux (x86_64)
--
-- Host: localhost Database: atguigu
-- ------------------------------------------------------
-- Server version 8.0.26
/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!50503 SET NAMES utf8mb4 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE=&#39;+00:00&#39; */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=&#39;&#39; */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;
--
-- Table structure for table \`account\`
--
DROP TABLE IF EXISTS \`account\`;
/*!40101 SET @saved_cs_client = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE \`account\` (
\`id\` int NOT NULL AUTO_INCREMENT,
\`name\` varchar(255) NOT NULL,
\`balance\` int NOT NULL,
PRIMARY KEY (\`id\`)
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8mb3;
/*!40101 SET character_set_client = @saved_cs_client */;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;
/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
-- Dump completed on 2022-01-07 23:36:39
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6253\u5F00account.txt\u6587\u4EF6\uFF0C\u5176\u5185\u5BB9\u5305\u542B\u521B\u5EFAaccount\u8868\u7684\u6570\u636E\u3002\u4ECE\u6587\u4EF6\u4E2D\u53EF\u4EE5\u770B\u51FA\uFF0C\u5B57\u6BB5\u4E4B\u95F4\u7528\u9017\u53F7\u9694\u5F00\uFF0C\u5B57 \u7B26\u7C7B\u578B\u7684\u503C\u88AB\u53CC\u5F15\u53F7\u62EC\u8D77\u6765\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>[root@node1 mysql-files]# cat account.txt
1,&quot;\u5F20\u4E09&quot;,90
2,&quot;\u674E\u56DB&quot;,100
3,&quot;\u738B\u4E94&quot;,0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_3-\u4F7F\u7528mysql\u547D\u4EE4\u5BFC\u51FA\u6587\u672C\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_3-\u4F7F\u7528mysql\u547D\u4EE4\u5BFC\u51FA\u6587\u672C\u6587\u4EF6" aria-hidden="true">#</a> 3. \u4F7F\u7528mysql\u547D\u4EE4\u5BFC\u51FA\u6587\u672C\u6587\u4EF6</h6><p>**\u4E3E\u4F8B1\uFF1A**\u4F7F\u7528mysql\u8BED\u53E5\u5BFC\u51FAatguigu\u6570\u636E\u4E2Daccount\u8868\u4E2D\u7684\u8BB0\u5F55\u5230\u6587\u672C\u6587\u4EF6\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql -uroot -p --execute=&quot;SELECT * FROM account;&quot; atguigu&gt; &quot;/var/lib/mysql-files/account.txt&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6253\u5F00account.txt\u6587\u4EF6\uFF0C\u5176\u5185\u5BB9\u5305\u542B\u521B\u5EFAaccount\u8868\u7684\u6570\u636E\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>[root@node1 mysql-files]# cat account.txt
id name balance
1 \u5F20\u4E09 90
2 \u674E\u56DB 100
3 \u738B\u4E94 0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>**\u4E3E\u4F8B2\uFF1A**\u5C06atguigu\u6570\u636E\u5E93account\u8868\u4E2D\u7684\u8BB0\u5F55\u5BFC\u51FA\u5230\u6587\u672C\u6587\u4EF6\uFF0C\u4F7F\u7528--veritcal\u53C2\u6570\u5C06\u8BE5\u6761\u4EF6\u8BB0\u5F55\u5206\u4E3A\u591A\u884C\u663E\u793A\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql -uroot -p --vertical --execute=&quot;SELECT * FROM account;&quot; atguigu &gt; &quot;/var/lib/mysql-files/account_1.txt&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6253\u5F00account_1.txt\u6587\u4EF6\uFF0C\u5176\u5185\u5BB9\u5305\u542B\u521B\u5EFAaccount\u8868\u7684\u6570\u636E\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>[root@node1 mysql-files]# cat account_1.txt
*************************** 1. row ***************************
id: 1
name: \u5F20\u4E09
balance: 90
*************************** 2. row ***************************
id: 2
name: \u674E\u56DB
balance: 100
*************************** 3. row ***************************
id: 3
name: \u738B\u4E94
balance: 0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>**\u4E3E\u4F8B3\uFF1A**\u5C06atguigu\u6570\u636E\u5E93account\u8868\u4E2D\u7684\u8BB0\u5F55\u5BFC\u51FA\u5230xml\u6587\u4EF6\uFF0C\u4F7F\u7528--xml\u53C2\u6570\uFF0C\u5177\u4F53\u8BED\u53E5\u5982\u4E0B\u3002</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql -uroot -p --xml --execute=&quot;SELECT * FROM account;&quot; atguigu&gt;&quot;/var/lib/mysqlfiles/account_3.xml&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>[root@node1 mysql-files]# cat account_3.xml
&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;resultset statement=&quot;SELECT * FROM account&quot;
xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;
&lt;row&gt;
&lt;field name=&quot;id&quot;&gt;1&lt;/field&gt;
&lt;field name=&quot;name&quot;&gt;\u5F20\u4E09&lt;/field&gt;
&lt;field name=&quot;balance&quot;&gt;90&lt;/field&gt;
&lt;/row&gt;
&lt;row&gt;
&lt;field name=&quot;id&quot;&gt;2&lt;/field&gt;
&lt;field name=&quot;name&quot;&gt;\u674E\u56DB&lt;/field&gt;
&lt;field name=&quot;balance&quot;&gt;100&lt;/field&gt;
&lt;/row&gt;
&lt;row&gt;
&lt;field name=&quot;id&quot;&gt;3&lt;/field&gt;
&lt;field name=&quot;name&quot;&gt;\u738B\u4E94&lt;/field&gt;
&lt;field name=&quot;balance&quot;&gt;0&lt;/field&gt;
&lt;/row&gt;
&lt;/resultset&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8BF4\u660E\uFF1A\u5982\u679C\u8981\u5C06\u8868\u6570\u636E\u5BFC\u51FA\u5230html\u6587\u4EF6\u4E2D\uFF0C\u53EF\u4EE5\u4F7F\u7528 <code>--html</code> \u9009\u9879\u3002\u7136\u540E\u53EF\u4EE5\u4F7F\u7528\u6D4F\u89C8\u5668\u6253\u5F00\u3002</p><h5 id="_6-2-\u8868\u7684\u5BFC\u5165" tabindex="-1"><a class="header-anchor" href="#_6-2-\u8868\u7684\u5BFC\u5165" aria-hidden="true">#</a> 6.2 \u8868\u7684\u5BFC\u5165</h5><h6 id="_1-\u4F7F\u7528load-data-infile\u65B9\u5F0F\u5BFC\u5165\u6587\u672C\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_1-\u4F7F\u7528load-data-infile\u65B9\u5F0F\u5BFC\u5165\u6587\u672C\u6587\u4EF6" aria-hidden="true">#</a> 1. \u4F7F\u7528LOAD DATA INFILE\u65B9\u5F0F\u5BFC\u5165\u6587\u672C\u6587\u4EF6</h6><p><strong>\u4E3E\u4F8B1\uFF1A</strong></p><p>\u4F7F\u7528SELECT...INTO OUTFILE\u5C06atguigu\u6570\u636E\u5E93\u4E2Daccount\u8868\u7684\u8BB0\u5F55\u5BFC\u51FA\u5230\u6587\u672C\u6587\u4EF6</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SELECT * FROM atguigu.account INTO OUTFILE &#39;/var/lib/mysql-files/account_0.txt&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5220\u9664account\u8868\u4E2D\u7684\u6570\u636E\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>DELETE FROM atguigu.account;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4ECE\u6587\u672C\u6587\u4EF6account.txt\u4E2D\u6062\u590D\u6570\u636E\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>LOAD DATA INFILE &#39;/var/lib/mysql-files/account_0.txt&#39; INTO TABLE atguigu.account;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u67E5\u8BE2account\u8868\u4E2D\u7684\u6570\u636E\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql&gt; select * from account;
+----+--------+---------+
| id | name   | balance |
+----+--------+---------+
| 1 | \u5F20\u4E09     | 90      |
| 2 | \u674E\u56DB     | 100     |
| 3 | \u738B\u4E94     | 0       |
+----+--------+---------+
3 rows in set (0.00 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u4E3E\u4F8B2\uFF1A</strong> \u9009\u62E9\u6570\u636E\u5E93atguigu\uFF0C\u4F7F\u7528SELECT\u2026INTO OUTFILE\u5C06atguigu\u6570\u636E\u5E93account\u8868\u4E2D\u7684\u8BB0\u5F55\u5BFC\u51FA\u5230\u6587\u672C\u6587\u4EF6\uFF0C\u4F7F\u7528FIELDS\u9009\u9879\u548CLINES\u9009\u9879\uFF0C\u8981\u6C42\u5B57\u6BB5\u4E4B\u95F4\u4F7F\u7528\u9017\u53F7&quot;\uFF0C&quot;\u95F4\u9694\uFF0C\u6240\u6709\u5B57\u6BB5\u503C\u7528\u53CC\u5F15\u53F7\u62EC\u8D77\u6765\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SELECT * FROM atguigu.account INTO OUTFILE &#39;/var/lib/mysql-files/account_1.txt&#39; FIELDS TERMINATED BY &#39;,&#39; ENCLOSED BY &#39;\\&quot;&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5220\u9664account\u8868\u4E2D\u7684\u6570\u636E\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>DELETE FROM atguigu.account;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4ECE/var/lib/mysql-files/account.txt\u4E2D\u5BFC\u5165\u6570\u636E\u5230account\u8868\u4E2D\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>LOAD DATA INFILE &#39;/var/lib/mysql-files/account_1.txt&#39; INTO TABLE atguigu.account FIELDS TERMINATED BY &#39;,&#39; ENCLOSED BY &#39;\\&quot;&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u67E5\u8BE2account\u8868\u4E2D\u7684\u6570\u636E\uFF0C\u5177\u4F53SQL\u5982\u4E0B\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>select * from account;
mysql&gt; select * from account;
+----+--------+---------+
| id | name   | balance |
+----+--------+---------+
| 1 | \u5F20\u4E09     | 90      |
| 2 | \u674E\u56DB     | 100     |
| 3 | \u738B\u4E94     | 0       |
+----+--------+---------+
3 rows in set (0.00 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h6 id="_2-\u4F7F\u7528mysqlimport\u65B9\u5F0F\u5BFC\u5165\u6587\u672C\u6587\u4EF6" tabindex="-1"><a class="header-anchor" href="#_2-\u4F7F\u7528mysqlimport\u65B9\u5F0F\u5BFC\u5165\u6587\u672C\u6587\u4EF6" aria-hidden="true">#</a> 2. \u4F7F\u7528mysqlimport\u65B9\u5F0F\u5BFC\u5165\u6587\u672C\u6587\u4EF6</h6><p><strong>\u4E3E\u4F8B\uFF1A</strong></p><p>\u5BFC\u51FA\u6587\u4EF6account.txt\uFF0C\u5B57\u6BB5\u4E4B\u95F4\u4F7F\u7528\u9017\u53F7&quot;\uFF0C&quot;\u95F4\u9694\uFF0C\u5B57\u6BB5\u503C\u7528\u53CC\u5F15\u53F7\u62EC\u8D77\u6765\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SELECT * FROM atguigu.account INTO OUTFILE &#39;/var/lib/mysql-files/account.txt&#39; FIELDS TERMINATED BY &#39;,&#39; ENCLOSED BY &#39;\\&quot;&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5220\u9664account\u8868\u4E2D\u7684\u6570\u636E\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>DELETE FROM atguigu.account;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4F7F\u7528mysqlimport\u547D\u4EE4\u5C06account.txt\u6587\u4EF6\u5185\u5BB9\u5BFC\u5165\u5230\u6570\u636E\u5E93atguigu\u7684account\u8868\u4E2D\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysqlimport -uroot -p atguigu &#39;/var/lib/mysql-files/account.txt&#39; --fields-terminated-by=&#39;,&#39; --fields-optionally-enclosed-by=&#39;\\&quot;&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u67E5\u8BE2account\u8868\u4E2D\u7684\u6570\u636E\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>select * from account;
mysql&gt; select * from account;
+----+--------+---------+
| id | name   | balance |
+----+--------+---------+
| 1 | \u5F20\u4E09     | 90      |
| 2 | \u674E\u56DB     | 100     |
| 3 | \u738B\u4E94     | 0       |
+----+--------+---------+
3 rows in set (0.00 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-\u6570\u636E\u5E93\u8FC1\u79FB" tabindex="-1"><a class="header-anchor" href="#_7-\u6570\u636E\u5E93\u8FC1\u79FB" aria-hidden="true">#</a> 7. \u6570\u636E\u5E93\u8FC1\u79FB</h3><h5 id="_7-1-\u6982\u8FF0" tabindex="-1"><a class="header-anchor" href="#_7-1-\u6982\u8FF0" aria-hidden="true">#</a> 7.1 \u6982\u8FF0</h5><p>\u6570\u636E\u8FC1\u79FB\uFF08data migration\uFF09\u662F\u6307\u9009\u62E9\u3001\u51C6\u5907\u3001\u63D0\u53D6\u548C\u8F6C\u6362\u6570\u636E\uFF0C\u5E76<strong>\u5C06\u6570\u636E\u4ECE\u4E00\u4E2A\u8BA1\u7B97\u673A\u5B58\u50A8\u7CFB\u7EDF\u6C38\u4E45\u5730\u4F20\u8F93\u5230\u53E6\u4E00\u4E2A\u8BA1\u7B97\u673A\u5B58\u50A8\u7CFB\u7EDF\u7684\u8FC7\u7A0B</strong>\u3002\u6B64\u5916\uFF0C<code> \u9A8C\u8BC1\u8FC1\u79FB\u6570\u636E\u7684\u5B8C\u6574\u6027</code> \u548C <code>\u9000\u5F79\u539F\u6765\u65E7\u7684\u6570\u636E\u5B58\u50A8</code> \uFF0C\u4E5F\u88AB\u8BA4\u4E3A\u662F\u6574\u4E2A\u6570\u636E\u8FC1\u79FB\u8FC7\u7A0B\u7684\u4E00\u90E8\u5206\u3002</p><p>\u6570\u636E\u5E93\u8FC1\u79FB\u7684\u539F\u56E0\u662F\u591A\u6837\u7684\uFF0C\u5305\u62EC\u670D\u52A1\u5668\u6216\u5B58\u50A8\u8BBE\u5907\u66F4\u6362\u3001\u7EF4\u62A4\u6216\u5347\u7EA7\uFF0C\u5E94\u7528\u7A0B\u5E8F\u8FC1\u79FB\uFF0C\u7F51\u7AD9\u96C6\u6210\uFF0C\u707E\u96BE\u6062\u590D\u548C\u6570\u636E\u4E2D\u5FC3\u8FC1\u79FB\u3002</p><p>\u6839\u636E\u4E0D\u540C\u7684\u9700\u6C42\u53EF\u80FD\u8981\u91C7\u53D6\u4E0D\u540C\u7684\u8FC1\u79FB\u65B9\u6848\uFF0C\u4F46\u603B\u4F53\u6765\u8BB2\uFF0CMySQL \u6570\u636E\u8FC1\u79FB\u65B9\u6848\u5927\u81F4\u53EF\u4EE5\u5206\u4E3A<code>\u7269\u7406\u8FC1\u79FB</code>\u548C <code>\u903B\u8F91\u8FC1\u79FB</code> \u4E24\u7C7B\u3002\u901A\u5E38\u4EE5\u5C3D\u53EF\u80FD <code>\u81EA\u52A8\u5316</code> \u7684\u65B9\u5F0F\u6267\u884C\uFF0C\u4ECE\u800C\u5C06\u4EBA\u529B\u8D44\u6E90\u4ECE\u7E41\u7410\u7684\u4EFB\u52A1\u4E2D\u89E3\u653E\u51FA\u6765\u3002</p><h5 id="_7-2-\u8FC1\u79FB\u65B9\u6848" tabindex="-1"><a class="header-anchor" href="#_7-2-\u8FC1\u79FB\u65B9\u6848" aria-hidden="true">#</a> 7.2 \u8FC1\u79FB\u65B9\u6848</h5><ul><li>\u7269\u7406\u8FC1\u79FB</li></ul><p>\u7269\u7406\u8FC1\u79FB\u9002\u7528\u4E8E\u5927\u6570\u636E\u91CF\u4E0B\u7684\u6574\u4F53\u8FC1\u79FB\u3002\u4F7F\u7528\u7269\u7406\u8FC1\u79FB\u65B9\u6848\u7684\u4F18\u70B9\u662F\u6BD4\u8F83\u5FEB\u901F\uFF0C\u4F46\u9700\u8981\u505C\u673A\u8FC1\u79FB\u5E76\u4E14\u8981 \u6C42 MySQL \u7248\u672C\u53CA\u914D\u7F6E\u5FC5\u987B\u548C\u539F\u670D\u52A1\u5668\u76F8\u540C\uFF0C\u4E5F\u53EF\u80FD\u5F15\u8D77\u672A\u77E5\u95EE\u9898\u3002</p><p>\u7269\u7406\u8FC1\u79FB\u5305\u62EC\u62F7\u8D1D\u6570\u636E\u6587\u4EF6\u548C\u4F7F\u7528 XtraBackup \u5907\u4EFD\u5DE5\u5177\u4E24\u79CD\u3002</p><p>\u4E0D\u540C\u670D\u52A1\u5668\u4E4B\u95F4\u53EF\u4EE5\u91C7\u7528\u7269\u7406\u8FC1\u79FB\uFF0C\u6211\u4EEC\u53EF\u4EE5\u5728\u65B0\u7684\u670D\u52A1\u5668\u4E0A\u5B89\u88C5\u597D\u540C\u7248\u672C\u7684\u6570\u636E\u5E93\u8F6F\u4EF6\uFF0C\u521B\u5EFA\u597D\u76F8\u540C\u76EE\u5F55\uFF0C\u5EFA\u8BAE\u914D\u7F6E\u6587\u4EF6\u4E5F\u8981\u548C\u539F\u6570\u636E\u5E93\u76F8\u540C\uFF0C\u7136\u540E\u4ECE\u539F\u6570\u636E\u5E93\u65B9\u62F7\u8D1D\u6765\u6570\u636E\u6587\u4EF6\u53CA\u65E5\u5FD7\u6587\u4EF6\uFF0C\u914D\u7F6E\u597D\u6587\u4EF6\u7EC4\u6743\u9650\uFF0C\u4E4B\u540E\u5728\u65B0\u670D\u52A1\u5668\u8FD9\u8FB9\u4F7F\u7528 mysqld \u547D\u4EE4\u542F\u52A8\u6570\u636E\u5E93\u3002</p><ul><li>\u903B\u8F91\u8FC1\u79FB</li></ul><p>\u903B\u8F91\u8FC1\u79FB\u9002\u7528\u8303\u56F4\u66F4\u5E7F\uFF0C\u65E0\u8BBA\u662F <code>\u90E8\u5206\u8FC1\u79FB</code> \u8FD8\u662F <code>\u5168\u91CF\u8FC1\u79FB</code> \uFF0C\u90FD\u53EF\u4EE5\u4F7F\u7528\u903B\u8F91\u8FC1\u79FB\u3002\u903B\u8F91\u8FC1\u79FB\u4E2D\u4F7F\u7528\u6700\u591A\u7684\u5C31\u662F\u901A\u8FC7 mysqldump \u7B49\u5907\u4EFD\u5DE5\u5177\u3002</p><h5 id="_7-3-\u8FC1\u79FB\u6CE8\u610F\u70B9" tabindex="-1"><a class="header-anchor" href="#_7-3-\u8FC1\u79FB\u6CE8\u610F\u70B9" aria-hidden="true">#</a> 7.3 \u8FC1\u79FB\u6CE8\u610F\u70B9</h5><p><strong>1. \u76F8\u540C\u7248\u672C\u7684\u6570\u636E\u5E93\u4E4B\u95F4\u8FC1\u79FB\u6CE8\u610F\u70B9</strong></p><p>\u6307\u7684\u662F\u5728\u4E3B\u7248\u672C\u53F7\u76F8\u540C\u7684MySQL\u6570\u636E\u5E93\u4E4B\u95F4\u8FDB\u884C\u6570\u636E\u5E93\u79FB\u52A8\u3002</p><p><code>\u65B9\u5F0F1</code>\uFF1A \u56E0\u4E3A\u8FC1\u79FB\u524D\u540EMySQL\u6570\u636E\u5E93\u7684 <code>\u4E3B\u7248\u672C\u53F7\u76F8\u540C</code> \uFF0C\u6240\u4EE5\u53EF\u4EE5\u901A\u8FC7\u590D\u5236\u6570\u636E\u5E93\u76EE\u5F55\u6765\u5B9E\u73B0\u6570\u636E\u5E93\u8FC1\u79FB\uFF0C\u4F46\u662F\u7269\u7406\u8FC1\u79FB\u65B9\u5F0F\u53EA\u9002\u7528\u4E8EMyISAM\u5F15\u64CE\u7684\u8868\u3002\u5BF9\u4E8EInnoDB\u8868\uFF0C\u4E0D\u80FD\u7528\u76F4\u63A5\u590D\u5236\u6587\u4EF6\u7684\u65B9\u5F0F\u5907\u4EFD\u6570\u636E\u5E93\u3002</p><p><code>\u65B9\u5F0F2</code>\uFF1A \u6700\u5E38\u89C1\u548C\u6700\u5B89\u5168\u7684\u65B9\u5F0F\u662F\u4F7F\u7528 <code>mysqldump\u547D\u4EE4</code> \u5BFC\u51FA\u6570\u636E\uFF0C\u7136\u540E\u5728\u76EE\u6807\u6570\u636E\u5E93\u670D\u52A1\u5668\u4E2D\u4F7F\u7528 MySQL\u547D\u4EE4\u5BFC\u5165\u3002</p><p>\u4E3E\u4F8B\uFF1A</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>#host1\u7684\u673A\u5668\u4E2D\u5907\u4EFD\u6240\u6709\u6570\u636E\u5E93,\u5E76\u5C06\u6570\u636E\u5E93\u8FC1\u79FB\u5230\u540D\u4E3Ahost2\u7684\u673A\u5668\u4E0A
mysqldump \u2013h host1 \u2013uroot \u2013p \u2013-all-databases|
mysql \u2013h host2 \u2013uroot \u2013p
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728\u4E0A\u8FF0\u8BED\u53E5\u4E2D\uFF0C\u201C|\u201D\u7B26\u53F7\u8868\u793A\u7BA1\u9053\uFF0C\u5176\u4F5C\u7528\u662F\u5C06mysqldump\u5907\u4EFD\u7684\u6587\u4EF6\u7ED9mysql\u547D\u4EE4\uFF1B\u201C--all-databases\u201D\u8868\u793A\u8981\u8FC1\u79FB\u6240\u6709\u7684\u6570\u636E\u5E93\u3002\u901A\u8FC7\u8FD9\u79CD\u65B9\u5F0F\u53EF\u4EE5\u76F4\u63A5\u5B9E\u73B0\u8FC1\u79FB\u3002</p><p><strong>2. \u4E0D\u540C\u7248\u672C\u7684\u6570\u636E\u5E93\u4E4B\u95F4\u8FC1\u79FB\u6CE8\u610F\u70B9</strong></p><p>\u4F8B\u5982\uFF0C\u539F\u6765\u5F88\u591A\u670D\u52A1\u5668\u4F7F\u75285.7\u7248\u672C\u7684MySQL\u6570\u636E\u5E93\uFF0C\u57288.0\u7248\u672C\u63A8\u51FA\u6765\u4EE5\u540E\uFF0C\u6539\u8FDB\u4E865.7\u7248\u672C\u7684\u5F88\u591A\u7F3A\u9677\uFF0C \u56E0\u6B64\u9700\u8981\u628A\u6570\u636E\u5E93\u5347\u7EA7\u52308.0\u7248\u672C</p><p>\u65E7\u7248\u672C\u4E0E\u65B0\u7248\u672C\u7684MySQL\u53EF\u80FD\u4F7F\u7528\u4E0D\u540C\u7684\u9ED8\u8BA4\u5B57\u7B26\u96C6\uFF0C\u4F8B\u5982\u6709\u7684\u65E7\u7248\u672C\u4E2D\u4F7F\u7528latin1\u4F5C\u4E3A\u9ED8\u8BA4\u5B57\u7B26\u96C6\uFF0C\u800C\u6700\u65B0\u7248\u672C\u7684MySQL\u9ED8\u8BA4\u5B57\u7B26\u96C6\u4E3Autf8mb4\u3002\u5982\u679C\u6570\u636E\u5E93\u4E2D\u6709\u4E2D\u6587\u6570\u636E\uFF0C\u90A3\u4E48\u8FC1\u79FB\u8FC7\u7A0B\u4E2D\u9700\u8981\u5BF9 <code>\u9ED8\u8BA4\u5B57\u7B26\u96C6</code> \u8FDB\u884C\u4FEE\u6539 \uFF0C\u4E0D\u7136\u53EF\u80FD\u65E0\u6CD5\u6B63\u5E38\u663E\u793A\u6570\u636E\u3002</p><p>\u9AD8\u7248\u672C\u7684MySQL\u6570\u636E\u5E93\u901A\u5E38\u90FD\u4F1A <code>\u517C\u5BB9\u4F4E\u7248\u672C</code> \uFF0C\u56E0\u6B64\u53EF\u4EE5\u4ECE\u4F4E\u7248\u672C\u7684MySQL\u6570\u636E\u5E93\u8FC1\u79FB\u5230\u9AD8\u7248\u672C\u7684MySQL \u6570\u636E\u5E93\u3002</p><p><strong>3. \u4E0D\u540C\u6570\u636E\u5E93\u4E4B\u95F4\u8FC1\u79FB\u6CE8\u610F\u70B9</strong></p><p>\u4E0D\u540C\u6570\u636E\u5E93\u4E4B\u95F4\u8FC1\u79FB\u662F\u6307\u4ECE\u5176\u4ED6\u7C7B\u578B\u7684\u6570\u636E\u5E93\u8FC1\u79FB\u5230MySQL\u6570\u636E\u5E93\uFF0C\u6216\u8005\u4ECEMySQL\u6570\u636E\u5E93\u8FC1\u79FB\u5230\u5176\u4ED6\u7C7B \u578B\u7684\u6570\u636E\u5E93\u3002\u8FD9\u79CD\u8FC1\u79FB\u6CA1\u6709\u666E\u9002\u7684\u89E3\u51B3\u65B9\u6CD5\u3002</p><p>\u8FC1\u79FB\u4E4B\u524D\uFF0C\u9700\u8981\u4E86\u89E3\u4E0D\u540C\u6570\u636E\u5E93\u7684\u67B6\u6784\uFF0C <code>\u6BD4\u8F83\u5B83\u4EEC\u4E4B\u95F4\u7684\u5DEE\u5F02</code> \u3002\u4E0D\u540C\u6570\u636E\u5E93\u4E2D\u5B9A\u4E49\u76F8\u540C\u7C7B\u578B\u7684\u6570\u636E\u7684 <code>\u5173\u952E\u5B57\u53EF\u80FD\u4F1A\u4E0D\u540C</code> \u3002\u4F8B\u5982\uFF0CMySQL\u4E2D\u65E5\u671F\u5B57\u6BB5\u5206\u4E3ADATE\u548CTIME\u4E24\u79CD\uFF0C\u800CORACLE\u65E5\u671F\u5B57\u6BB5\u53EA\u6709DATE\uFF1BSQL Server\u6570\u636E\u5E93\u4E2D\u6709ntext\u3001Image\u7B49\u6570\u636E\u7C7B\u578B\uFF0CMySQL\u6570\u636E\u5E93\u6CA1\u6709\u8FD9\u4E9B\u6570\u636E\u7C7B\u578B\uFF1BMySQL\u652F\u6301\u7684ENUM\u548CSET \u7C7B\u578B\uFF0C\u8FD9\u4E9BSQL Server\u6570\u636E\u5E93\u4E0D\u652F\u6301\u3002</p><p>\u53E6\u5916\uFF0C\u6570\u636E\u5E93\u5382\u5546\u5E76\u6CA1\u6709\u5B8C\u5168\u6309\u7167SQL\u6807\u51C6\u6765\u8BBE\u8BA1\u6570\u636E\u5E93\u7CFB\u7EDF\uFF0C\u5BFC\u81F4\u4E0D\u540C\u7684\u6570\u636E\u5E93\u7CFB\u7EDF\u7684 <code>SQL\u8BED\u53E5</code> \u6709\u5DEE\u522B\u3002\u4F8B\u5982\uFF0C\u5FAE\u8F6F\u7684SQL Server\u8F6F\u4EF6\u4F7F\u7528\u7684\u662FT-SQL\u8BED\u53E5\uFF0CT-SQL\u4E2D\u5305\u542B\u4E86\u975E\u6807\u51C6\u7684SQL\u8BED\u53E5\uFF0C\u4E0D\u80FD\u548CMySQL\u7684SQL\u8BED\u53E5\u517C\u5BB9\u3002</p><p>\u4E0D\u540C\u7C7B\u578B\u6570\u636E\u5E93\u4E4B\u95F4\u7684\u5DEE\u5F02\u9020\u6210\u4E86\u4E92\u76F8 <code>\u8FC1\u79FB\u7684\u56F0\u96BE</code> \uFF0C\u8FD9\u4E9B\u5DEE\u5F02\u5176\u5B9E\u662F\u5546\u4E1A\u516C\u53F8\u6545\u610F\u9020\u6210\u7684\u6280\u672F\u58C1\u5792\u3002\u4F46 \u662F\u4E0D\u540C\u7C7B\u578B\u7684\u6570\u636E\u5E93\u4E4B\u95F4\u7684\u8FC1\u79FB\u5E76 <code>\u4E0D\u662F\u5B8C\u5168\u4E0D\u53EF\u80FD</code> \u3002\u4F8B\u5982\uFF0C\u53EF\u4EE5\u4F7F\u7528<code> MyODBC</code> \u5B9E\u73B0MySQL\u548CSQL Server\u4E4B \u95F4\u7684\u8FC1\u79FB\u3002MySQL\u5B98\u65B9\u63D0\u4F9B\u7684\u5DE5\u5177 <code>MySQL Migration Toolkit</code> \u4E5F\u53EF\u4EE5\u5728\u4E0D\u540C\u6570\u636E\u4E4B\u95F4\u8FDB\u884C\u6570\u636E\u8FC1\u79FB\u3002 MySQL\u8FC1\u79FB\u5230Oracle\u65F6\uFF0C\u9700\u8981\u4F7F\u7528mysqldump\u547D\u4EE4\u5BFC\u51FAsql\u6587\u4EF6\uFF0C\u7136\u540E\uFF0C <code>\u624B\u52A8\u66F4\u6539</code> sql\u6587\u4EF6\u4E2D\u7684CREATE\u8BED\u53E5\u3002</p><h5 id="_7-4-\u8FC1\u79FB\u5C0F\u7ED3" tabindex="-1"><a class="header-anchor" href="#_7-4-\u8FC1\u79FB\u5C0F\u7ED3" aria-hidden="true">#</a> 7.4 \u8FC1\u79FB\u5C0F\u7ED3</h5><p><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718165515965.png" alt="image-20220718165515965"></p><h3 id="_8-\u5220\u5E93\u4E86\u4E0D\u6562\u8DD1-\u80FD\u5E72\u70B9\u5565" tabindex="-1"><a class="header-anchor" href="#_8-\u5220\u5E93\u4E86\u4E0D\u6562\u8DD1-\u80FD\u5E72\u70B9\u5565" aria-hidden="true">#</a> 8. \u5220\u5E93\u4E86\u4E0D\u6562\u8DD1\uFF0C\u80FD\u5E72\u70B9\u5565\uFF1F</h3><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718165738367.png" alt="image-20220718165738367" style="float:left;"><h5 id="_8-1-delete-\u8BEF\u5220\u884C" tabindex="-1"><a class="header-anchor" href="#_8-1-delete-\u8BEF\u5220\u884C" aria-hidden="true">#</a> 8.1 delete\uFF1A\u8BEF\u5220\u884C</h5><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718165909464.png" alt="image-20220718165909464" style="float:left;"><h5 id="_8-2-truncate-drop-\u8BEF\u5220\u5E93-\u8868" tabindex="-1"><a class="header-anchor" href="#_8-2-truncate-drop-\u8BEF\u5220\u5E93-\u8868" aria-hidden="true">#</a> 8.2 truncate/drop \uFF1A\u8BEF\u5220\u5E93/\u8868</h5><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718170026929.png" alt="image-20220718170026929" style="float:left;"><h5 id="_8-3-\u9884\u9632\u4F7F\u7528truncate-drop\u8BEF\u5220\u5E93-\u8868" tabindex="-1"><a class="header-anchor" href="#_8-3-\u9884\u9632\u4F7F\u7528truncate-drop\u8BEF\u5220\u5E93-\u8868" aria-hidden="true">#</a> 8.3 \u9884\u9632\u4F7F\u7528truncate/drop\u8BEF\u5220\u5E93/\u8868</h5><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718170132339.png" alt="image-20220718170132339" style="float:left;"><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/2541/image-20220718170215247.png" alt="image-20220718170215247" style="float:left;"><h5 id="_8-4-rm-\u8BEF\u5220mysql\u5B9E\u4F8B" tabindex="-1"><a class="header-anchor" href="#_8-4-rm-\u8BEF\u5220mysql\u5B9E\u4F8B" aria-hidden="true">#</a> 8.4 rm\uFF1A\u8BEF\u5220MySQL\u5B9E\u4F8B</h5><p>\u5BF9\u4E8E\u4E00\u4E2A\u6709\u9AD8\u53EF\u7528\u673A\u5236\u7684MySQL\u96C6\u7FA4\u6765\u8BF4\uFF0C\u4E0D\u7528\u62C5\u5FC3 rm\u5220\u9664\u6570\u636E \u4E86\u3002\u53EA\u662F\u5220\u6389\u4E86\u5176\u4E2D\u67D0\u4E00\u4E2A\u8282\u70B9\u7684\u6570\u636E\u7684\u8BDD\uFF0CHA\u7CFB\u7EDF\u5C31\u4F1A\u5F00\u59CB\u5DE5\u4F5C\uFF0C\u9009\u51FA\u4E00\u4E2A\u65B0\u7684\u4E3B\u5E93\uFF0C\u4ECE\u800C\u4FDD\u8BC1\u6574\u4E2A\u96C6\u7FA4\u7684\u6B63\u5E38\u5DE5\u4F5C\u3002\u6211\u4EEC\u8981\u505A\u7684\u5C31\u662F\u5728\u8FD9\u4E2A\u8282\u70B9\u4E0A\u628A\u6570\u636E\u6062\u590D\u56DE\u6765\uFF0C\u518D\u63A5\u5165\u6574\u4E2A\u96C6\u7FA4\u3002</p><p>\u4F46\u5982\u679C\u662F\u6076\u610F\u5730\u628A\u6574\u4E2A\u96C6\u7FA4\u5220\u9664\uFF0C\u90A3\u5C31\u9700\u8981\u8003\u8651\u8DE8\u673A\u623F\u5907\u4EFD\uFF0C\u8DE8\u57CE\u5E02\u5907\u4EFD\u3002</p>`,596);function b(h,y){const s=c("ExternalLinkIcon");return a(),d("div",null,[o,i("p",null,[m,i("a",t,[v,r(s)]),g]),p])}var q=l(u,[["render",b],["__file","mysql04.html.vue"]]);export{q as default};
